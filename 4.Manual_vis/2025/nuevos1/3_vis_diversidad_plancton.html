<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="Es-es" xml:lang="Es-es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz">
<meta name="description" content="….">

<title>Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="3_vis_diversidad_plancton_files/libs/clipboard/clipboard.min.js"></script>
<script src="3_vis_diversidad_plancton_files/libs/quarto-html/quarto.js"></script>
<script src="3_vis_diversidad_plancton_files/libs/quarto-html/popper.min.js"></script>
<script src="3_vis_diversidad_plancton_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="3_vis_diversidad_plancton_files/libs/quarto-html/anchor.min.js"></script>
<link href="3_vis_diversidad_plancton_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="3_vis_diversidad_plancton_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="3_vis_diversidad_plancton_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="3_vis_diversidad_plancton_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="3_vis_diversidad_plancton_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #2b8cbe;
      }
</style>
<script src="3_vis_diversidad_plancton_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="3_vis_diversidad_plancton_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="styles2..css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</h1>
            <p class="subtitle lead">Capítulo 3. Visualización gráfica - Diversidad Alfa y Beta</p>
                  <div>
        <div class="description">
          ….
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p>Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">3 de septiembre de 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Menú flotante</h2>
   
  <ul>
  <li><a href="#capítulo-3.-visualización-gráfica-de-la-diversidad-taxonómica" id="toc-capítulo-3.-visualización-gráfica-de-la-diversidad-taxonómica" class="nav-link active" data-scroll-target="#capítulo-3.-visualización-gráfica-de-la-diversidad-taxonómica">Capítulo 3. Visualización gráfica de la diversidad taxonómica</a>
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#objetivos-del-capítulo" id="toc-objetivos-del-capítulo" class="nav-link" data-scroll-target="#objetivos-del-capítulo">Objetivos del capítulo</a></li>
  <li><a href="#competencias-específicas" id="toc-competencias-específicas" class="nav-link" data-scroll-target="#competencias-específicas">Competencias específicas</a></li>
  <li><a href="#contenido-del-capítulo" id="toc-contenido-del-capítulo" class="nav-link" data-scroll-target="#contenido-del-capítulo"><strong>Contenido del capítulo</strong></a></li>
  <li><a href="#a.-visualización-de-diversidad-alfa-de-mesozooplancton-estuarino" id="toc-a.-visualización-de-diversidad-alfa-de-mesozooplancton-estuarino" class="nav-link" data-scroll-target="#a.-visualización-de-diversidad-alfa-de-mesozooplancton-estuarino">A. Visualización de diversidad alfa de Mesozooplancton estuarino</a>
  <ul>
  <li><a href="#resumen" id="toc-resumen" class="nav-link" data-scroll-target="#resumen">Resumen</a></li>
  <li><a href="#introducción-1" id="toc-introducción-1" class="nav-link" data-scroll-target="#introducción-1">Introducción</a></li>
  <li><a href="#objetivo" id="toc-objetivo" class="nav-link" data-scroll-target="#objetivo">Objetivo</a></li>
  <li><a href="#referentes-bibliográficos" id="toc-referentes-bibliográficos" class="nav-link" data-scroll-target="#referentes-bibliográficos">Referentes bibliográficos</a>
  <ul>
  <li><a href="#referentes-bibliográficos-de-estimadores-paramétricos" id="toc-referentes-bibliográficos-de-estimadores-paramétricos" class="nav-link" data-scroll-target="#referentes-bibliográficos-de-estimadores-paramétricos">Referentes bibliográficos de estimadores paramétricos</a></li>
  <li><a href="#referentes-bibliográficos-de-estimadores-no-paramétricos-inext" id="toc-referentes-bibliográficos-de-estimadores-no-paramétricos-inext" class="nav-link" data-scroll-target="#referentes-bibliográficos-de-estimadores-no-paramétricos-inext">Referentes bibliográficos de estimadores no paramétricos (iNEXT)</a></li>
  </ul></li>
  <li><a href="#cargar-paquetes-y-lectura-de-bases-de-datos" id="toc-cargar-paquetes-y-lectura-de-bases-de-datos" class="nav-link" data-scroll-target="#cargar-paquetes-y-lectura-de-bases-de-datos">Cargar paquetes y lectura de bases de datos</a>
  <ul>
  <li><a href="#base-de-datos-de-los-taxones" id="toc-base-de-datos-de-los-taxones" class="nav-link" data-scroll-target="#base-de-datos-de-los-taxones">Base de datos de los taxones</a></li>
  <li><a href="#estimadores-clásicos-de-diversidad-alfa-por-cada-estación-evaluado" id="toc-estimadores-clásicos-de-diversidad-alfa-por-cada-estación-evaluado" class="nav-link" data-scroll-target="#estimadores-clásicos-de-diversidad-alfa-por-cada-estación-evaluado">3.1 Estimadores clásicos de diversidad alfa por cada Estación evaluado</a></li>
  <li><a href="#diversidad-alfa-con-curvas-rad-localidades" id="toc-diversidad-alfa-con-curvas-rad-localidades" class="nav-link" data-scroll-target="#diversidad-alfa-con-curvas-rad-localidades">3.2 Diversidad alfa con curvas RAD (Localidades)</a>
  <ul class="collapse">
  <li><a href="#automatización-de-las-figuras" id="toc-automatización-de-las-figuras" class="nav-link" data-scroll-target="#automatización-de-las-figuras"><strong>Automatización de las figuras</strong></a></li>
  <li><a href="#a.-ajuste-de-las-curvas-rad" id="toc-a.-ajuste-de-las-curvas-rad" class="nav-link" data-scroll-target="#a.-ajuste-de-las-curvas-rad">a. Ajuste de las curvas RAD</a>
  <ul class="collapse">
  <li><a href="#a.1-interpretación-de-los-ajustes-encontrados-a-cada-curva-rad" id="toc-a.1-interpretación-de-los-ajustes-encontrados-a-cada-curva-rad" class="nav-link" data-scroll-target="#a.1-interpretación-de-los-ajustes-encontrados-a-cada-curva-rad">a.1 Interpretación de los ajustes encontrados a cada curva RAD</a></li>
  </ul></li>
  <li><a href="#b.-figuras-de-los-modelos-rad-por-estación" id="toc-b.-figuras-de-los-modelos-rad-por-estación" class="nav-link" data-scroll-target="#b.-figuras-de-los-modelos-rad-por-estación">b. Figuras de los modelos RAD por Estación</a></li>
  <li><a href="#c.-diagnóstico-de-supuestos" id="toc-c.-diagnóstico-de-supuestos" class="nav-link" data-scroll-target="#c.-diagnóstico-de-supuestos">c.&nbsp;Diagnóstico de supuestos</a>
  <ul class="collapse">
  <li><a href="#homogeneidad-de-covarianzas." id="toc-homogeneidad-de-covarianzas." class="nav-link" data-scroll-target="#homogeneidad-de-covarianzas.">1. Homogeneidad de covarianzas.</a></li>
  <li><a href="#independencia-de-los-datos." id="toc-independencia-de-los-datos." class="nav-link" data-scroll-target="#independencia-de-los-datos.">2. Independencia de los datos.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparación-de-muestras-con-glms-y-permanovas" id="toc-comparación-de-muestras-con-glms-y-permanovas" class="nav-link" data-scroll-target="#comparación-de-muestras-con-glms-y-permanovas">3.3 Comparación de muestras con GLMs y Permanovas</a>
  <ul class="collapse">
  <li><a href="#a.-prueba-con-distribución-poisson-y-binomial-negativo-para-un-taxón." id="toc-a.-prueba-con-distribución-poisson-y-binomial-negativo-para-un-taxón." class="nav-link" data-scroll-target="#a.-prueba-con-distribución-poisson-y-binomial-negativo-para-un-taxón.">a. Prueba con distribución poisson y binomial negativo para un taxón.</a></li>
  <li><a href="#b.-comparación-de-muestras-con-pemanovas" id="toc-b.-comparación-de-muestras-con-pemanovas" class="nav-link" data-scroll-target="#b.-comparación-de-muestras-con-pemanovas">b. Comparación de muestras con Pemanovas</a>
  <ul class="collapse">
  <li><a href="#c.-efecto-de-los-taxones-sobre-la-diferencia-entre-estaciones" id="toc-c.-efecto-de-los-taxones-sobre-la-diferencia-entre-estaciones" class="nav-link" data-scroll-target="#c.-efecto-de-los-taxones-sobre-la-diferencia-entre-estaciones">c.&nbsp;Efecto de los taxones sobre la diferencia entre Estaciones</a></li>
  <li><a href="#d.-prueba-de-comparaciones-múltiples-del-pemanova" id="toc-d.-prueba-de-comparaciones-múltiples-del-pemanova" class="nav-link" data-scroll-target="#d.-prueba-de-comparaciones-múltiples-del-pemanova">d.&nbsp;Prueba de comparaciones múltiples del Pemanova</a></li>
  <li><a href="#f.-análisis-simper" id="toc-f.-análisis-simper" class="nav-link" data-scroll-target="#f.-análisis-simper">f.&nbsp;Análisis SIMPER</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#diversidad-alfa-en-4-pasos.-chao-et-al.-2020." id="toc-diversidad-alfa-en-4-pasos.-chao-et-al.-2020." class="nav-link" data-scroll-target="#diversidad-alfa-en-4-pasos.-chao-et-al.-2020.">3.4 Diversidad alfa en 4 Pasos. Chao <em>et al</em>. (2020).</a>
  <ul class="collapse">
  <li><a href="#patrón-general-de-diversidad-alfa-por-cada-estación." id="toc-patrón-general-de-diversidad-alfa-por-cada-estación." class="nav-link" data-scroll-target="#patrón-general-de-diversidad-alfa-por-cada-estación.">3.4.1 Patrón general de diversidad alfa por cada Estación.</a></li>
  <li><a href="#cuatro-pasos-por-estaciones" id="toc-cuatro-pasos-por-estaciones" class="nav-link" data-scroll-target="#cuatro-pasos-por-estaciones">3.4.2 Cuatro pasos por Estaciones</a>
  <ul class="collapse">
  <li><a href="#a.-paso-1.-perfil-de-completitud" id="toc-a.-paso-1.-perfil-de-completitud" class="nav-link" data-scroll-target="#a.-paso-1.-perfil-de-completitud">a. Paso 1. Perfil de completitud</a></li>
  <li><a href="#b.-paso-2.-perfil-asintótico" id="toc-b.-paso-2.-perfil-asintótico" class="nav-link" data-scroll-target="#b.-paso-2.-perfil-asintótico">b. Paso 2. Perfil asintótico</a></li>
  <li><a href="#c.-paso-3.-perfil-no-asintótico" id="toc-c.-paso-3.-perfil-no-asintótico" class="nav-link" data-scroll-target="#c.-paso-3.-perfil-no-asintótico">c.&nbsp;Paso 3. Perfil no asintótico</a></li>
  <li><a href="#d.-paso-4.-uniformidad" id="toc-d.-paso-4.-uniformidad" class="nav-link" data-scroll-target="#d.-paso-4.-uniformidad">d.&nbsp;Paso 4. Uniformidad</a></li>
  </ul></li>
  <li><a href="#figuras-de-diversidad-alfa" id="toc-figuras-de-diversidad-alfa" class="nav-link" data-scroll-target="#figuras-de-diversidad-alfa">3.4.2.1 Figuras de diversidad alfa</a>
  <ul class="collapse">
  <li><a href="#a.-figuras-del-perfil-asintótico-paso-1" id="toc-a.-figuras-del-perfil-asintótico-paso-1" class="nav-link" data-scroll-target="#a.-figuras-del-perfil-asintótico-paso-1">a. Figuras del perfil asintótico (paso 1)</a></li>
  <li><a href="#b.-figuras-del-perfil-asintótico-paso-2" id="toc-b.-figuras-del-perfil-asintótico-paso-2" class="nav-link" data-scroll-target="#b.-figuras-del-perfil-asintótico-paso-2">b. Figuras del perfil asintótico (paso 2)</a></li>
  <li><a href="#c.-figuras-del-perfil-no-asintótico-paso-3" id="toc-c.-figuras-del-perfil-no-asintótico-paso-3" class="nav-link" data-scroll-target="#c.-figuras-del-perfil-no-asintótico-paso-3">c.&nbsp;Figuras del perfil no asintótico (paso 3)</a></li>
  <li><a href="#d.-figuras-del-perfil-de-uniformidad-paso-4" id="toc-d.-figuras-del-perfil-de-uniformidad-paso-4" class="nav-link" data-scroll-target="#d.-figuras-del-perfil-de-uniformidad-paso-4">d.&nbsp;Figuras del perfil de uniformidad (paso 4)</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#cuestionario" id="toc-cuestionario" class="nav-link" data-scroll-target="#cuestionario">Cuestionario</a></li>
  <li><a href="#errores-comunes-e-interpretación-ecológica" id="toc-errores-comunes-e-interpretación-ecológica" class="nav-link" data-scroll-target="#errores-comunes-e-interpretación-ecológica">Errores comunes e interpretación ecológica</a></li>
  <li><a href="#aplicaciones-ecológicas-y-ambientales" id="toc-aplicaciones-ecológicas-y-ambientales" class="nav-link" data-scroll-target="#aplicaciones-ecológicas-y-ambientales">Aplicaciones ecológicas y ambientales</a></li>
  <li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones">Conclusiones</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<section id="capítulo-3.-visualización-gráfica-de-la-diversidad-taxonómica" class="level1">
<h1>Capítulo 3. Visualización gráfica de la diversidad taxonómica</h1>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La diversidad biológica en ecosistemas fluviales no solo se expresa entre localidades separadas por kilómetros de distancia, sino también a escalas pequeñas como los microhábitats presentes a lo largo de tramos de estos ambientes. En los ríos de montaña, elementos como la grava, la hojarasca o los bancos de arena constituyen nichos diferenciados que sustentan a ensamblajes importantes de invertebrados. Este capítulo se realiza un entrenamiento en la exploración de la diversidad alfa y <strong>beta</strong> de macromesozooplancton estuarino, a partir de registros de abundancia por Estaciones y por microhábitats, en diferentes tramos el río Gaira. Mediante herramientas de visualización gráfica y tablas comparativas, se busca desarrollar una comprensión integrada de cómo varía la diversidad en función del entorno evaluado.</p>
</section>
<section id="objetivos-del-capítulo" class="level2">
<h2 class="anchored" data-anchor-id="objetivos-del-capítulo">Objetivos del capítulo</h2>
<ul>
<li>Analizar la diversidad <strong>alfa</strong> de macroinvertebrados en tres Estaciones del río Gaira: Arimaca, Caracoli y Pozo Azul.</li>
</ul>
<!-- -->
<ul>
<li>Comparar la diversidad entre los distintos microhábitats (Arena, Grava y Hoja) presentes en cada Estación.</li>
</ul>
<!-- -->
<ul>
<li>Visualizar y analizar de manera clara las diferencias en la riqueza y diversidad desde diferentes esratégias gráficas y numéricas.</li>
</ul>
<!-- -->
<ul>
<li>Interpretar patrones de diversidad desde una perspectiva ecológica y ambiental.</li>
</ul>
<!-- -->
<ul>
<li>Identificar patrones repetitivos o contrastantes entre Estaciones y microhábitats y su posible relación con las condiciones ambientales.</li>
</ul>
</section>
<section id="competencias-específicas" class="level2">
<h2 class="anchored" data-anchor-id="competencias-específicas">Competencias específicas</h2>
<ul>
<li>Relacionar tipos de variables ecológicas con sus representaciones gráficas adecuadas.</li>
<li>Generar visualizaciones reproducibles que permitan comunicar resultados con claridad.</li>
<li>Interpretar patrones visuales en función de la ecología de macroinvertebrados.</li>
</ul>
<hr>
</section>
<section id="contenido-del-capítulo" class="level2">
<h2 class="anchored" data-anchor-id="contenido-del-capítulo"><strong>Contenido del capítulo</strong></h2>
<p>Este capítulo se desarrolla a través de dos ejercicios aplicados:</p>
<p><strong>A: Visualización de diversidad alfa de mesozooplancton estuarino (Río Gaira)</strong></p>
<ul>
<li>Carga de paquetes y lectura de bases de datos</li>
<li>Estimadores clásicos de diversidad alfa por cada Estación o estación evaluada</li>
<li>Diversidad alfa con curvas RAD (Localidades)</li>
<li>Comparación de muestras con GLMs y Permanovas</li>
<li>Diversidad alfa en 4 Pasos. Chao et al.&nbsp;(2020)</li>
<li>Cuestionario aplicado</li>
</ul>
<p><strong>Errores comunes e interpretación ecológica</strong></p>
<p><strong>Aplicaciones ecológicas y ambientales</strong></p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Instrucciones</strong>: Primer ejercicio en donde se contextualiza a cada procedimiento realizado.</p>
</div>
</div>
<hr>
</section>
<section id="a.-visualización-de-diversidad-alfa-de-mesozooplancton-estuarino" class="level2">
<h2 class="anchored" data-anchor-id="a.-visualización-de-diversidad-alfa-de-mesozooplancton-estuarino">A. Visualización de diversidad alfa de Mesozooplancton estuarino</h2>
<section id="resumen" class="level3">
<h3 class="anchored" data-anchor-id="resumen">Resumen</h3>
<p>El presente ejercicio consiste en el procesamiento y visualización de datos de abundancia de doce taxones del plancton estuarino, presentes en seis localidades o estaciones (Station), para evaluar protrones relacionados con la diversidad alfa de estos organismos. El arículo de soporte de este trabajo se encuentra en el siguiente <a href="https://link-springer-com.biblioteca.unimagdalena.edu.co/article/10.1007/s13157-025-01951-7">enlace web</a>.</p>
<p><img src="https://media.springernature.com/w158/springer-static/cover-hires/journal/13157?as=webp.png" class="img-fluid"></p>
<hr>
</section>
<section id="introducción-1" class="level3">
<h3 class="anchored" data-anchor-id="introducción-1">Introducción</h3>
<p>Según Whittaker (1972) la diversidad en las comunidades ecológicas, se divide en componentes <em>alfa, beta</em>&nbsp;y&nbsp;<em>gamma</em>. La diversidad&nbsp;<strong><em>alfa</em></strong>&nbsp;se refiere al número de especies obtenidas en una muestra relativamente homogénea, tomada de una comunidad. La diversidad&nbsp;<strong><em>beta</em></strong>&nbsp;corresponde al grado de recambio o reemplazo de especies entre diferentes comunidades en una escala de paisaje, y la diversidad&nbsp;<strong><em>gamma</em></strong>&nbsp;se refiere al número de especies de un grupo de comunidades que integran uno o varios paisajes (diversidad regional) y es el resultado de la suma de las diversidades alfa y beta. Para el caso de la diversidad <strong><em>alfa</em></strong>, se pueden estimar tres formas de medirla: (1) la riqueza, (2) la equidad y (3) la diversidad.</p>
<ol type="1">
<li><p><strong><em>La riqueza</em></strong> (S o q=0), corresponde al número de especies en la muestra evaluada de la comunidad.</p></li>
<li><p><strong><em>La equidad</em></strong> (q=1, q=2), corresponde a la variación en las abundancias relativas de las especies, de la muestra tomada de la comunidad. Permite entender cómo se reparten los recursos las especies y por ello la forma en que cada una de ellas aporta individuos a la comunidad. Para este caso, los índices de Shannon-Weaber y de Simpson son los más utilizados. Debido a que este estimador incorpora tanto a los taxones como a su número de individuos, se considera a la equidad, como una medida menos sesgada que la riqueza para valorar (3) <strong><em>la diversidad</em></strong> en muestras tomadas de una comunidad.</p></li>
<li><p><strong><em>La diversidad</em></strong>, tiene diferentes formas de evaluarse y para este taller, será utilizada la propuesta de Chao et al (2020), basada en 4 pasos, a partir de los números efectivos de Hill (q=0, q=1, q=2), teniendo en cuenta la completitud de las muestras tomadas de la comunidad (paso 1), la diversidad asintótica: la estimada (asintótica) y la observada (empírica) (paso 2), la diversidad no asintótica: la interpolada y la extrapolada (paso 3) y el perfil de uniformidad de cada muestra (paso 4).</p></li>
</ol>
<p><strong>1.Estimadores de riqueza o número de especies (S o q=0).</strong> Si bien, es un estimador sencillo de calcular, lo más complejo es alcanzar el valor máximo que represente a la riqueza completa de taxones de la muestra o muestras de una comunidad, por lo cual, es una medida que depende del esfuerzo de muestreo (tamaño mínimo requerido en la muestra evaluada). Esto constituye un reto importante, para asegurar que los muestreos sean comparables en cuanto al número de individuos y de taxones o de especies censadas. La <strong><em>rarefacción</em></strong> utiliza estrategias de remuestreo, para corregir el número de especies o taxones, tomados de muestras de diferente tamaño.</p>
<p><strong>2.Estimadores de equidad y de diversidad (q=1 y q=2)</strong>. Para medir la diversidad de especies o de taxones de muestras tomadas de una comunidad, existen modelos <em>paramétricos</em> y <em>no paramétricos</em>. (1) <strong><em>Paramétricos</em></strong>, valoran el nivel de ajuste entre la riqueza de especies y sus abundancias de individuos, obtenida de las muestras (series logarítmica, log-normal, entre otras). (2) <strong><em>no Paramétricos</em></strong>, son estimadores de especies no detectadas (nuevas especies) a partir de las especies censadas.</p>
<p>Para el cálculo de <strong><em>estimadores paramétricos</em></strong> de diversidad, se utilizan (1) <strong><em>modelos de abundancia de especies</em></strong>, utilizando diagramas de rangos de abundancia, que relaicionan a las abundancias relativas en escalas logaritmicas (eje y) vs.&nbsp;los rangos de abundancias las especies (eje x) (Whittaker, 1965). Estos estimadores paramétricos se visualizan inicialmente con <em><code>diagramas de rango-abundancia de Whittaker</code></em> y su ajuste a modelos se evalúa con el comando <code>radfit</code> la librería <code>vegan</code>, que contiene algunos patrónes de diversidad como el <em><code>Broken stick</code></em> (vara quebrada), <em><code>Preemtion</code></em>, <em><code>Log-normal</code></em>, <em><code>Zipf</code></em> y <em><code>Zipf-Mandelbrot</code></em>.</p>
<p>Los <strong><em>estimadores no paramétricos</em></strong> de diversidad se evaluarán con un análisis de completitud, asintóticos y no asintóticos, utilizando la librería <code>iNEXT</code>. Esto se basa en la propuesta de <em>Chao et al.&nbsp;(2020)</em>, con la valoración de la diversidad de ensamblajes o muestras de comunidades, a partir de un procedimiento en cuatro (4) pasos y de los estimadores de Hill: q=0, q=1 y q=2.</p>
<hr>
</section>
<section id="objetivo" class="level3">
<h3 class="anchored" data-anchor-id="objetivo">Objetivo</h3>
<p>Valoración de la diversidad alfa en seis estaciones del Golfo de Urabá, mediante (1) <strong><em>estimadores paramétricos</em></strong> (Curvas RAD y modelos de abundancia) y (2) de <strong><em>estimadores no paramétricos</em></strong> (números de Hill q=0, q=1 y q=2; curvas de completitud, asintóticas, no asintóticas y de uniformidad).</p>
<hr>
</section>
<section id="referentes-bibliográficos" class="level3">
<h3 class="anchored" data-anchor-id="referentes-bibliográficos">Referentes bibliográficos</h3>
<section id="referentes-bibliográficos-de-estimadores-paramétricos" class="level4">
<h4 class="anchored" data-anchor-id="referentes-bibliográficos-de-estimadores-paramétricos">Referentes bibliográficos de estimadores paramétricos</h4>
<ol type="1">
<li><p><a href="https://ciespinosa.github.io/AlphaDiversidad/">A Minimal Book Example (2019)</a> Contiene información sobre estimadores de riqueza, de equidad y de diversidad de comunidades, con estimadores paramétricos y no paramétricos.</p></li>
<li><p><a href="https://rpubs.com/dsfernandez/468964">Laboratorio de Ecología de Comunidades: Biodiversidad (2019)</a> Describe a paquetes y funciones de R para el análisis básico de la biodiversidad.</p></li>
<li><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5183127/">An extensive comparison of species-abundance distribution models - Baldridge et al.&nbsp;(2016)</a> Comparativo en los modelos de distribución de abundancia de especies (SAD).</p></li>
<li><p><a href="https://www.herpconbio.org/Volume_13/Issue_3/Crane_etal_2018.pdf">Herpetofaunal Species Abundance - Crane et al.&nbsp;(2018)</a> Describe Modelos de rango - riqueza - abundancia (RAD), incluyendo curvas de Whittaker y análisis no asintóticos para anfibios y reptiles.</p></li>
</ol>
</section>
<section id="referentes-bibliográficos-de-estimadores-no-paramétricos-inext" class="level4">
<h4 class="anchored" data-anchor-id="referentes-bibliográficos-de-estimadores-no-paramétricos-inext">Referentes bibliográficos de estimadores no paramétricos (iNEXT)</h4>
<ol type="1">
<li><p><a href="https://esj-journals.onlinelibrary.wiley.com/doi/10.1111/1440-1703.12102">Quantifying sample completeness and comparing diversities among assemblages - Chao et al.&nbsp;(2020)</a> Describe el protocolo para la valoración de la diversidad verdadera (true diversity) en cuatro pasos.</p></li>
<li><p><a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12349">Estimating diversity and entropy profiles via discovery rates of new species - Chao y Jost (2015)</a> Valoración de la diversidad por perfiles de entropía y estimación de especies no detectadas.</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/iNEXT/vignettes/Introduction.pdf">A Quick Introduction to iNEXT via Examples - Hsieh et al (2022)</a></p></li>
</ol>
<hr>
</section>
</section>
<section id="cargar-paquetes-y-lectura-de-bases-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargar-paquetes-y-lectura-de-bases-de-datos">Cargar paquetes y lectura de bases de datos</h3>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Para diferentes operaciones</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)   <span class="co"># Para la lectura de archivos de Excel</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># Para las figuras de elipses</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)    <span class="co"># Estimadores de diversidad</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)  <span class="co"># Rótulos a los puntos de figuras en ggplot2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)   <span class="co"># Edición de las tablas</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar la última versión de github para iNEXT</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('devtools')</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github('AnneChao/iNEXT.3D')</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT<span class="fl">.3</span>D)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#install_github('AnneChao/iNEXT.4steps')</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT<span class="fl">.4</span>steps)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<section id="base-de-datos-de-los-taxones" class="level4">
<h4 class="anchored" data-anchor-id="base-de-datos-de-los-taxones">Base de datos de los taxones</h4>
<p>Los siguientes procedimientos para el componente tabular son tomados del capítulo de visualización, en el ejercicio de plancton, con algunos ajustes, ya que para este caso solo se seleccionan las abundancias de los taxones, descartando a las variables ambientales.</p>
<p>La base de datos con los 40 taxones se llamará <strong>biol</strong> (<a href="#tbl-tbl38" class="quarto-xref">Tabla&nbsp;1</a>). Se omiten las variables ambientales, las cuales son utilizadas en el capítulo de <strong>exploración general</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar datos desde Excel</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"plancton.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Riqueza"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluir a las variables ambientales</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  biol <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Temperature, Salinity, Density)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abrev =</span> <span class="fu">abbreviate</span>(Groups, <span class="at">minlength =</span> <span class="dv">4</span>)) </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con los datos</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biol) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl38" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl38-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;1: Base de datos biológicos
</figcaption>
<div aria-describedby="tbl-tbl38-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Station</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Size</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Layers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Groups</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundance</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Abrev</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Quetognatos</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Qtgn</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Sergestidae</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Srgs</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Luciferidae</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Lcfr</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Calanoida</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">Clnd</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Cyclopoida</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Cycl</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: left;">Harpacticoida</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Hrpc</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>La siguiente base de datos (<strong>biol1</strong>), se presenta en formato ancho, con los nombres abreviados de los taxones, todos los factores y una referencia por cada fila.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Procesamiento para ajustar los datos en formato ancho</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>biol1 <span class="ot">&lt;-</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  biol <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variables a factores</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Station, Size, Layers), as.factor)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variables agrupadoras como </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station, Size, Layers) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Promedios de las variables ambientales</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Totales de las abundancias por cada factor</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abundance =</span> <span class="fu">list</span>(<span class="fu">setNames</span>(<span class="fu">tapply</span>(Abundance, Abrev,sum,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">default =</span> <span class="dv">0</span>), <span class="fu">unique</span>(Abrev))),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Corregir algunos errores del agrupamiento</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Separar las abundancias en las columnas de cada taxon</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(Abundance) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Crear columna Ref, tomando iniciales de tres factores</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ref =</span> <span class="fu">paste0</span>(<span class="fu">substr</span>(Station, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>               <span class="fu">substr</span>(Size, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>               <span class="fu">substr</span>(Layers, <span class="dv">1</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pasar la columna de referencia (consec) a la 1a columna</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Ref, <span class="fu">everything</span>())</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Validar distribución: Muestra las primeras filas del dataframe `biol_ancho`.</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biol1, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Ref</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Station</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Size</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Layers</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Qtgn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Srgs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lcfr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Clnd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cycl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrpc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lrdp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hvdp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrvN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrdC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrvZ</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Otrs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">22D</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Depth</td>
<td style="text-align: right;">12672</td>
<td style="text-align: right;">408</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">112</td>
</tr>
<tr class="even">
<td style="text-align: left;">22S</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">250 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: right;">568</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">984</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2488</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1096</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25D</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">500 μm</td>
<td style="text-align: left;">Depth</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">355</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">25S</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">500 μm</td>
<td style="text-align: left;">Surface</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10672</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>A continuación se muestra una tabla que relaciona a los taxones (<strong>tabla_abrev</strong>), con sus nombres completos y abreviados, así como sus abundancias totales. Esta tabla es necesaria para orientar al lector sobre los análisis que solo trabajen con los nombres abreviados de estos organismos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer los taxones sin nombres repetidos</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Taxas <span class="ot">&lt;-</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  biol <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Groups) <span class="sc">%&gt;%</span> <span class="co"># Selecciona solo la columna "Taxas"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones con sus abundancias totales</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>tabla_abrev <span class="ot">&lt;-</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span>              <span class="co"># Base de datos en formato ancho</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>          <span class="co"># Elimina cualquier agrupación previa</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Qtgn<span class="sc">:</span>Otrs) <span class="sc">%&gt;%</span>  <span class="co"># Selecciona las columnas de los grupos taxonómicos</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                   sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Abundancia total de cada grupo</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),         <span class="co"># Convierte a formato largo</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Abreviatura"</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Total"</span>)         </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos con nombres completos y abreviados + abundancias totales</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>tabla_abrev <span class="ot">&lt;-</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(Taxas,          <span class="co"># Dataframe de los 12 taxones evaluados.</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        tabla_abrev[,<span class="dv">1</span>], </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        tabla_abrev[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Total)) <span class="sc">%&gt;%</span>        <span class="co"># Ordena de mayor a menor abundancia</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span>     <span class="co"># Crea columna "ID" con numeración </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID, <span class="fu">everything</span>())   <span class="co"># Ordena columnas de la tabla</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulación de los taxones con sus abundancias</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>tabla_abrev <span class="sc">%&gt;%</span> </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Groups</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Abreviatura</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Quetognatos</td>
<td style="text-align: left;">Qtgn</td>
<td style="text-align: right;">33482</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Cyclopoida</td>
<td style="text-align: left;">Cycl</td>
<td style="text-align: right;">24110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Larvas de peces</td>
<td style="text-align: left;">Lrdp</td>
<td style="text-align: right;">2724</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Sergestidae</td>
<td style="text-align: left;">Srgs</td>
<td style="text-align: right;">2073</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Larva Zoea</td>
<td style="text-align: left;">LrdC</td>
<td style="text-align: right;">1823</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Otros</td>
<td style="text-align: left;">LrvZ</td>
<td style="text-align: right;">989</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Larvas de Crustaceo</td>
<td style="text-align: left;">Otrs</td>
<td style="text-align: right;">622</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Larva Nauplio</td>
<td style="text-align: left;">LrvN</td>
<td style="text-align: right;">536</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Calanoida</td>
<td style="text-align: left;">Clnd</td>
<td style="text-align: right;">423</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Harpacticoida</td>
<td style="text-align: left;">Hrpc</td>
<td style="text-align: right;">401</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">Huevos de peces</td>
<td style="text-align: left;">Hvdp</td>
<td style="text-align: right;">363</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: left;">Luciferidae</td>
<td style="text-align: left;">Lcfr</td>
<td style="text-align: right;">151</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>En este sentido se cuenta con las siguientes tablas o dataframes:</p>
<p><strong>biol</strong>: Es el formato original de los datos. Formato <strong>largo</strong> con columnas: Station, Size, Layers, Groups, Abundance, Abrev.</p>
<p><strong>biol1</strong>: Formato <strong>ancho</strong> con las columnas: Ref, Station, Size, Layers, taxones: Qtgn:Otrs.</p>
<p>A continuación se construyen las siguientes tablas o dataframes:</p>
<p><strong>biol2</strong>: Formato <strong>ancho</strong>, en el que cada fila es una de las <strong>estaciones</strong> y las columnas son los <strong>taxones</strong>: Qtgn:Otrs.</p>
<p><strong>biol_sit</strong>: Formato ancho en el que cada fila son los <strong>taxones</strong>: Qtgn:Otrs y las columnas son las <strong>estaciones</strong>.</p>
<p><strong>biol_rad</strong>: Formato largo con tres columnas: Estaciones, Taxones y Abundancias totales de los taxones.</p>
<p>A partir de estas tablas, se construirán algunas resumidas que serán necesarias para los análisis de diversidad alfa que siguen a continuación.</p>
<hr>
</section>
<section id="estimadores-clásicos-de-diversidad-alfa-por-cada-estación-evaluado" class="level4">
<h4 class="anchored" data-anchor-id="estimadores-clásicos-de-diversidad-alfa-por-cada-estación-evaluado">3.1 Estimadores clásicos de diversidad alfa por cada Estación evaluado</h4>
<p>La <a href="#tbl-tbl39" class="quarto-xref">Tabla&nbsp;2</a> Muestra los valores totales de abundancias (total de los tres microhábitats/Estación) de macromesozooplancton estuarino para cada <strong>Estación</strong> evaluado.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar paquetes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupar por Estación y sumar la abundancia de cada taxón por Estación</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>biol2 <span class="ot">&lt;-</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Ref,Size,Layers)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>biol2 <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl39" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl39-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;2: Base de datos con totales de abundancia para cada Estación evaluado
</figcaption>
<div aria-describedby="tbl-tbl39-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Station</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Qtgn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Srgs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lcfr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Clnd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cycl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrpc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lrdp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hvdp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrvN</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrdC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LrvZ</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Otrs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">13300</td>
<td style="text-align: right;">428</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">12411</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2562</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">1099</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">11006</td>
<td style="text-align: right;">947</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">11659</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">282</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">213</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">288</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">1615</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: right;">3911</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">238</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: right;">3362</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">112</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">221</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p>Con los datos de la <a href="#tbl-tbl39" class="quarto-xref">Tabla&nbsp;2</a>, a continuación se calculan algunos índices de diversidad general, en la propuesta de Borcard et al.&nbsp;(2018). q_0, q_1 y q_2 corresponden a los valores de diversidad en términos de riqueza o número de taxones, taxones abundantes de acuerdo a euler elevado a la Shannon y los taxones muy abundantes según el inverso del índice de Simpson, respectivamente. De igual forma se evalúa la unidormidad en la abundancia de los diferentes taxones para cada Estación, con el índice de Pielou.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>biol2_alfa <span class="ot">&lt;-</span> biol2[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimadores de diversidad alfa (segun Borcard et al. 2018)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(biol2_alfa <span class="sc">&gt;</span> <span class="dv">0</span>)   <span class="co"># Riqueza de especies</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(biol2_alfa)    <span class="co"># Riqueza de especies (alterno)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol2_alfa)  <span class="co"># Entropía de Shannon (base e)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>Hb2 <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol2_alfa, <span class="at">base =</span> <span class="dv">2</span>)  <span class="co"># Entropía de Shannon (base 2)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(H)       <span class="co"># Diversidd de Shannon (base e)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>N1b2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>Hb2      <span class="co"># Diversidad de Shannon (base 2)</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol2_alfa, <span class="st">"inv"</span>)  <span class="co"># Diversidad de Simpson (dominancia) </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> H <span class="sc">/</span> <span class="fu">log</span>(N0)   <span class="co"># Equidad de Pielou (evenness)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>E10 <span class="ot">&lt;-</span> N1 <span class="sc">/</span> N0     <span class="co"># Equidad de Shannon (Razón de Hill)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>E20 <span class="ot">&lt;-</span> N2 <span class="sc">/</span> N0     <span class="co"># Equidad de Simpson (Razón de Hill)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos con los valores de los esimadores de diversidad alfa</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>d.alfa <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Estación<span class="ot">=</span> biol2[,<span class="dv">1</span>], <span class="at">q_0=</span> N0, </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">q_1=</span> <span class="fu">round</span>(N1,<span class="dv">1</span>), <span class="at">q_2=</span> <span class="fu">round</span>(N2,<span class="dv">1</span>), </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Equidad_J=</span> <span class="fu">round</span>(J,<span class="dv">2</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Edición de la tabla para su impresión</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>d.alfa <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl40" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;3: Base de datos con diferentes estimadores de diversidad para cada Estación evaluado
</figcaption>
<div aria-describedby="tbl-tbl40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Station</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q_0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q_1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Equidad_J</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">0.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.34</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
</section>
<section id="diversidad-alfa-con-curvas-rad-localidades" class="level4">
<h4 class="anchored" data-anchor-id="diversidad-alfa-con-curvas-rad-localidades">3.2 Diversidad alfa con curvas RAD (Localidades)</h4>
<p>A continuación se construye la tabla <strong>biol_rad</strong> que organiza a las abundancias en rangos, de acuerdo a su magnituud y que servirá de soporte para la figura de las curvas RAD. Esta tabla posteriormente será modificada, elimando las dos últimas columnas, que no se requerirán para los estimadores alfa relacionados.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar paquetes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Este paso se realizó en el procedimiento anterior (biol2)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>biol2 <span class="ot">&lt;-</span>     <span class="co"># Tabla en formato ancho</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span>  <span class="co"># Tabla general con todos los factores</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Ref,Size,Layers)) <span class="sc">%&gt;%</span>  <span class="co"># Excluir estas columnas</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station) <span class="sc">%&gt;%</span>       <span class="co"># Agrupar por estaciones</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="co"># Totales de abundancia</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reestructurar los datos en formato largo por Estación (biol2)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Esta tabla difiere de "biol" porque agrupa solo por estaciones</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>biol_rad <span class="ot">&lt;-</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  biol2 <span class="sc">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Station),   </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Taxas"</span>,      </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Abundancia"</span>        </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Station =</span> Station, <span class="fu">everything</span>())</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir 'Station' y 'Taxas' en factores</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>biol_rad<span class="sc">$</span>Station <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(biol_rad<span class="sc">$</span>Station)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>biol_rad<span class="sc">$</span>Taxas <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(biol_rad<span class="sc">$</span>Taxas)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Insertar rango basado en abundancia descendente</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>biol_rad <span class="ot">&lt;-</span> </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  biol_rad <span class="sc">%&gt;%</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station) <span class="sc">%&gt;%</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rango =</span> <span class="fu">rank</span>(<span class="sc">-</span>Abundancia, <span class="at">ties.method =</span> <span class="st">"min"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular abundancia relativa</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>biol_rad <span class="ot">&lt;-</span> </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  biol_rad <span class="sc">%&gt;%</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station) <span class="sc">%&gt;%</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ab_rel =</span> <span class="fu">round</span>(Abundancia <span class="sc">/</span> <span class="fu">sum</span>(Abundancia), <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar los 15 taxones más abundantes</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Se omite este paso por haber solo 12 taxones</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los seis (6) primeros datos (filas)</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biol_rad) <span class="sc">%&gt;%</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl41" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;4: Base de datos con diferentes estadísticos descriptivos para cada Estación evaluado
</figcaption>
<div aria-describedby="tbl-tbl41-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Station</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Taxas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rango</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ab_rel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Qtgn</td>
<td style="text-align: right;">13300</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.438</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Srgs</td>
<td style="text-align: right;">428</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Lcfr</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Clnd</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Cycl</td>
<td style="text-align: right;">12411</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.409</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Hrpc</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.001</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<p><strong>Nota:</strong> Para hacer lo mismo, pero reemplazando a los Estaciones por Capas de Profundidad o <strong>Layers</strong>, se ajusta el procedimiento anterior cambiando Station por Layers de la tabla <strong>biol1</strong>.</p>
<p>La <a href="#fig-fig39" class="quarto-xref">Figura&nbsp;1</a> muestra el patrón de distribución de abundancias de los <strong>quince taxones más abundantes</strong> de mesozooplancton estuarino, mostrando que algunos taxones dominantes como los Quetognatos (Qtgn) mantienen su patrón de abundancias en todas las estaciones.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)  <span class="co"># insertar rótulos a los puntos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenar los niveles de los paneles</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>biol_rad<span class="sc">$</span>Station <span class="ot">&lt;-</span> <span class="fu">factor</span>(biol_rad<span class="sc">$</span>Station, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"2"</span>,<span class="st">"4"</span>,<span class="st">"7"</span>,<span class="st">"9"</span>,<span class="st">"13"</span>,<span class="st">"15"</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biol_rad, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Rango, <span class="at">y =</span> Ab_rel, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Taxas, <span class="at">label =</span> Taxas)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> Taxas), </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding =</span> <span class="fl">0.4</span>, <span class="at">point.padding =</span> <span class="fl">0.2</span>, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Color de las líneas de conexión</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">"black"</span>,  </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Líneas punteadas</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.linetype =</span> <span class="st">"dashed"</span>,   </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(biol_rad<span class="sc">$</span>Rango), </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by =</span> <span class="dv">4</span>),  <span class="co"># Personalizar eje x</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># Iniciar en 0 y extender</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))) <span class="sc">+</span> </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Rangos de Taxas"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span>(Abundancia<span class="sc">~</span>Relativa)),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Taxas"</span>) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Station, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>(),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>        legend.poEstaciónn <span class="ot">=</span> <span class="st">"none"</span>,  <span class="co"># Oculta la leyenda</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)  <span class="co"># Nombres de panel en negrilla</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig39" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig39-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig39-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig39-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Patrón de distribución-rango-abundancia - RAD - para los quince taxones de macromesozooplancton estuarino más abundantes
</figcaption>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-fig40" class="quarto-xref">Figura&nbsp;2</a> muestra opción de graficar la figura anterior :</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar el gráfico</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biol_rad, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Rango, <span class="at">y =</span> Ab_rel, <span class="at">color =</span> Taxas, <span class="at">label =</span> Taxas)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Taxas), <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.4</span>, <span class="at">point.padding =</span> <span class="fl">0.2</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="st">"gray70"</span>, <span class="at">segment.linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Eje X ascendente</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(biol_rad<span class="sc">$</span>Rango), <span class="at">by =</span> <span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="co"># Escala logarítmica en el eje Y</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>        <span class="co"># Colores personalizados</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"firebrick"</span>, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"tomato"</span>, <span class="st">"orange"</span>))(<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Rangos de Taxas"</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span>(Abundancia<span class="sc">~</span>Relativa))) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Station, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>, <span class="at">base_family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray98"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    legend.poEstaciónn <span class="ot">=</span> <span class="st">"none"</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig40" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig40-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig40-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Patrón de distribución-rango-abundancia - RAD - para los quince taxones de macromesozooplancton estuarino más abundantes
</figcaption>
</figure>
</div>
</div>
</div>
<section id="automatización-de-las-figuras" class="level6">
<h6 class="anchored" data-anchor-id="automatización-de-las-figuras"><strong>Automatización de las figuras</strong></h6>
<p>Para realizar la siguiente figura de curvas RAD de forma más resumida o automatizada, se debe tener en cuenta la siguiente estructura requerida en la función <strong>radfig.R</strong>. *El siguiente comando sirve para ajustar los datos en caso que se cuente con una base de datos similar a la de este ejercicio.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Columnas obligatorias en 'biol_rad':</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Rango:    Número entero (1, 2, 3, ...)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Ab_rel:   Abundancia relativa (0-1)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Taxas:    Nombre de la especie/taxa</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Station:  Identificador de estación/muestra</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para crear el gráfico mejorado</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"radfig.r"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos desde raw data</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>biol_rad <span class="ot">&lt;-</span> <span class="fu">preparar_datos_rad</span>(biol_rad, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"columna_estaciones"</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"columna_especies"</span>, </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"columna_abundancia"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se realiza la figura con los datos del ejercicio.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función requerida para la figura</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)  <span class="co"># Para cargar el enlace de la fuente de la figura</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"radfig.R"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de las curvas RAD</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">create_rad_plot_pro</span>(biol_rad, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_columns =</span> <span class="dv">3</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">point_size =</span> <span class="dv">4</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">text_size =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="3_vis_diversidad_plancton_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los patrones observados en las curvas RAD serán ampliados a continuación, con la evaluación de su ajuste a difrenter modelos estadísticos.</p>
<p>En la Estación 2, la curva muestra una caída abrupta desde el primer taxón dominante (Qtgn) hacia el resto (ajuste a un modelo <em>Preemption</em>), reflejando un escenario de fuerte dominancia por ese tipo de taxones, dejando poco recurso al resto de organismos.</p>
<p>La estación 4 presenta una pendiente más suavizada en comparación con la anterior, con una combinación de taxones abundantes y raros (Cycl, Qtgn, Srgs en la parte alta y una cola larga de taxones raros) (ajuste al modelo <em>Mandelbrot</em>), típico de ambientes en transición con una mezcla de dominancia y presencia de taxones poco abundantes.</p>
<p>En la estación 7, la curva muestra un gradiente mucho más uniforme, sin caídas bruscas, lo que refleja mayor equidad en las abundancias de los taxones (ajuste a un modelo <em>Lognormal</em>), asociado a lugares con alta diversidad y abundancias distribuidas de forma más balanceada entre taxones comunes y raros.</p>
<p>En las estaciones 9, 13 y 15, las curvas presentan caídas escalonadas pero con una clara dominancia inicial (Qtgn, Srgs) y luego una serie de taxones muy poco abundantes en la cola (ajuste al modelo <em>Zipf</em>), asociado a ambientes con recursos limitantes o condiciones de exclusión competitiva, donde pocos taxones logran sostener altas abundancias.</p>
<p>En conjunto, se observa un <strong>gradiente de diversidad alfa</strong>: desde estaciones altamente dominadas (Est. 2, 9, 13, 15), pasando por un ensamble intermedio con mayor complejidad (Est. 4), hasta alcanzar la mayor equidad y diversidad en la Estación 7. Esta gradación sugiere que las condiciones ambientales varían entre las estaciones evaluadas, influyendo en la dominancia, la rareza y la equidad de los taxones presentes.</p>
</section>
<section id="a.-ajuste-de-las-curvas-rad" class="level5">
<h5 class="anchored" data-anchor-id="a.-ajuste-de-las-curvas-rad">a. Ajuste de las curvas RAD</h5>
<p>Los <strong>modelos de distribución de rango-abundancia</strong> (RAD, Rank-Abundance Distribution), son <strong>modelos de ajuste empírico</strong>, que intentan analizar el patrón de distribución de las abundancias de taxones en muestras evaluadas. Se ajustan por <strong>criterios de bondad de ajuste</strong> (como AIC, BIC) que se describen a continuación. Son útiles para <strong>comparar el patrón de diversidad entre diferentes muestras</strong> (ej. entre Estaciones), sometidas a diferentes condiciones ambientales (ej. alteraciones antrópicas).</p>
<p>Usando el comando <code>radfit</code> del paquete <code>vegan</code>, estos <strong>modelos de distribución de rango-abundancia</strong>, se ajustan a una <strong>distribución</strong> <strong>Poisson,</strong> siempre y cuando los valores de los taxones correspondan a datos discretos, conteos o frecuencias de abundancias, como sucede en este ejercicio con los macroinvertebrados evaluados. De esta manera estas distribuciones empíricas pueden ajustarse a <strong>Modelos Lineales Generalizados (GLMs)</strong>, como una opción flexible para modelar datos que no necesariamente siguen una <strong>distribución normal</strong>. Se sugiere probar supuestos como la <strong>independencia</strong> de las observaciones (ej. de los Estaciones comparados) para identificar fuentes de sesgo en la distribución de las abundancias (ej. autocorrelaciones), la <strong>homogeneidad</strong> de las varianzas, para probar si existen sobredispersión de las abundancias (alta heterogeneidad por patrones de agrupamiento por presencia de taxones dominantes). Para casos donde se altera la homogeneidad, se puede probar alternativas a la distribución Poisson como la <strong>Binomial Negativa</strong>.</p>
<p>El comando <code>radfit</code> (ajuste de Modelos - RAD), compara a cinco modelos RAD de la familia GLMs: <strong>Null,</strong> <strong>Preemption, log-normal, Zipf y Mandelbrot</strong>, utilizando los criterios de información de Akaike (<code>AIC</code>) y los Bayesianos o de Schwartz (<code>BIC</code>). Los modelos RAD que se ajustan mejor a los datos, son los que presenten <strong>menor AIC y BIC</strong>.</p>
<p><strong>(1) Modelo nulo (Null)</strong>, a nivel estadístico, no muestran una estructura esperada (patrones aleatorios). A nivel ecológico, no representan un patrón de diversidad definido o predecible, especialmente en ensamblajes que pueden estar recuperándose de alguna perturbación natural o antrópica (sucesiones iniciales).</p>
<p><strong>(2) Modelo premption</strong>, se presenta en lugares en donde los taxones oportunistas pueden estar compitiendo por un recurso limitado (ej. espacio o alimento), tipico de ensamblajes de baja diversidad, debido a posibles efectos de tensores o perturbaciones ambientales. En este sentido, se presentaran pocos taxones dominantes y promueven la competencia del resto de taxas por el recurso limitado.</p>
<p><strong>(3) Modelo Log-Normal</strong>, es típica de ecosistemas tropicales en donde se presentan una alta riqueza, con cierto nivel de uniformidad en las abundancias de los taxones. Típica de suceciones intermedias con baja presión de tensores ambientales.</p>
<p><strong>(4) Modelo Zipf</strong>, se asocia a ensamblajes en los que las especies dominantes ejercen el contro sobre los recursos. Esto se relaciona a un patrón jerárquico, donde uno o pocos taxones dominan en abundancia. Esto puede reflejar mecanismos de competencia en los nichos tróficos. Este patrón se observa en ambientes donde pocos taxones presentan ventajas competitivas para explotar un recurso (ej. mayor tolerancia ambiental, mejor capacidad de explotación de recursos, mayor éxito reproductivo).</p>
<p><strong>(5) Modelo Mandelbrot</strong>, es una variante del modelo Zipf, con una estructura fractal, en donde se presenta una mezcla de taxones dominantes y de taxones raros, debido a una buena estabilidad o integridad del ecosistema asociado.</p>
<p>En este sentido, <strong>ensamblajes con alteraciones o de</strong> <strong>baja integridad del ecosistema</strong> asociado, se relacionan a los modelos Prepmtion y Zipf. <strong>Buenos patrones de diversidad</strong> o de integridad ecológica se asocian a modelos Log-Normal y Mandelbrot. <strong>Patrones impredecibles</strong> se asocian al modelo nulo.</p>
<p><strong>biol3</strong>: Formato largo con columnas: Estación, Taxas, Abundancia, Rango, Ab_rel.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reestructurar los datos en formato largo por Estación (biol3)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Esta tabla difiere de "biol" porque agrupa solo por estaciones</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>biol_rad <span class="ot">&lt;-</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  biol2 <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Station),   </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Taxas"</span>,      </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Abundancia"</span>        </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Station =</span> Station, <span class="fu">everything</span>())</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Organizar datos en formato largo</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>biol_sit <span class="ot">&lt;-</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  biol_rad <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Station, Taxas) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundancia =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Station, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundancia, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># renombrar columnas específicas</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_2   =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_4   =</span> <span class="st">`</span><span class="at">4</span><span class="st">`</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_7   =</span> <span class="st">`</span><span class="at">7</span><span class="st">`</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_9   =</span> <span class="st">`</span><span class="at">9</span><span class="st">`</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_13  =</span> <span class="st">`</span><span class="at">13</span><span class="st">`</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Station_15  =</span> <span class="st">`</span><span class="at">15</span><span class="st">`</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Station_2))</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver primeros datos</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>biol_sit <span class="sc">%&gt;%</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Matriz de abundancia por Estación para análisis RAD"</span>, </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Matriz de abundancia por Estación para análisis RAD</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Taxas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Station_15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Qtgn</td>
<td style="text-align: right;">13300</td>
<td style="text-align: right;">11006</td>
<td style="text-align: right;">288</td>
<td style="text-align: right;">1615</td>
<td style="text-align: right;">3911</td>
<td style="text-align: right;">3362</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cycl</td>
<td style="text-align: right;">12411</td>
<td style="text-align: right;">11659</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lrdp</td>
<td style="text-align: right;">2562</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">LrdC</td>
<td style="text-align: right;">1099</td>
<td style="text-align: right;">213</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">238</td>
<td style="text-align: right;">160</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Srgs</td>
<td style="text-align: right;">428</td>
<td style="text-align: right;">947</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">307</td>
</tr>
<tr class="even">
<td style="text-align: left;">Clnd</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Otrs</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">393</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">LrvZ</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">221</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hvdp</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">282</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lcfr</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LrvN</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hrpc</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">112</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correr modelos GLMs </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>quiet_radfit <span class="ot">&lt;-</span> <span class="cf">function</span>(v){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(v)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> v[<span class="fu">is.finite</span>(v) <span class="sc">&amp;</span> v <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(v) <span class="sc">&lt;</span> <span class="dv">2</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">sort</span>(v, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  con_out <span class="ot">&lt;-</span> <span class="fu">file</span>(<span class="fu">tempfile</span>(), <span class="at">open =</span> <span class="st">"wt"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  con_err <span class="ot">&lt;-</span> <span class="fu">file</span>(<span class="fu">tempfile</span>(), <span class="at">open =</span> <span class="st">"wt"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on.exit</span>({</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sink.number</span>(<span class="at">type =</span> <span class="st">"message"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">sink</span>(<span class="at">type =</span> <span class="st">"message"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sink.number</span>() <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="fu">sink</span>()</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">close</span>(con_out); <span class="fu">close</span>(con_err)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>(con_out)                      <span class="co"># stdout</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>(con_err, <span class="at">type =</span> <span class="st">"message"</span>)    <span class="co"># stderr/messages</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(vegan<span class="sc">::</span><span class="fu">radfit</span>(v), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (on.exit deshace los sinks y cierra conexiones)</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  fit</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>mod.Station_2  <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_2))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, Inf,  : 
  NA/NaN/Inf en 'x'</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod.Station_4  <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_4))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mod.Station_7  <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_7))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mod.Station_9  <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_9))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>mod.Station_13 <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_13))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>mod.Station_15 <span class="ot">&lt;-</span> <span class="fu">quiet_radfit</span>(dplyr<span class="sc">::</span><span class="fu">pull</span>(biol_sit, Station_15))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A diferencia de las figuras anteriores, se utiliza a todos los taxones de cada muestra o localidad evaluada, dado a que al no mostrarse los nombres de los organismos censados, es posible inclur a las muestras completas.</p>
<section id="a.1-interpretación-de-los-ajustes-encontrados-a-cada-curva-rad" class="level6">
<h6 class="anchored" data-anchor-id="a.1-interpretación-de-los-ajustes-encontrados-a-cada-curva-rad">a.1 Interpretación de los ajustes encontrados a cada curva RAD</h6>
<p><strong>Estación 2 (Preemption, AIC = 4107.2).</strong><br>
El ajuste al modelo <em>Preemption</em> sugiere una fuerte dominancia de pocos taxones, con una marcada caída en la abundancia del resto de taxones. Este patrón puede asociarse a condiciones de estrés ambiental, disturbios recientes o limitación fuerte de recursos, donde solo unas pocas especies logran establecerse con éxito, resultando en baja diversidad alfa.</p>
<p><strong>Estación 4 (Mandelbrot, AIC = 6698.9).</strong><br>
El modelo <em>Mandelbrot</em> indica un ensamble con una combinación de especies dominantes y raras, lo cual refleja un patrón intermedio de equidad. Este tipo de distribución suele vincularse con ambientes más estables o en transición, donde este ensamblaje mantiene cierta complejidad estructural, aunque todavía con desigualdad en las abundancias.</p>
<p><strong>Estación 7 (Lognormal, AIC = 74.2).</strong><br>
El ajuste lognormal es típico de comunidades con alta diversidad y abundancias distribuidas de manera más equitativa entre taxones comunes y raros. Este patrón sugiere que la estación presenta condiciones ambientales más favorables y menor grado de perturbación antrópica, favoreciendo una estructura más compleja y diversa del ensamble.</p>
<p><strong>Estaciones 9, 13 y 15 (Zipf, AIC = 235.6, 431.9 y 357.9).</strong><br>
El modelo <em>Zipf</em> se relaciona con baja diversidad y dominancia marcada de pocos taxones. Esto puede reflejar escenarios donde los recursos son limitantes o heterogéneos, favoreciendo solo a unas pocas especies competitivamente superiores, mientras que el resto de los taxones quedan restringidos a abundancias muy bajas.</p>
<p>Los patrones observados evidencian un gradiente de diversidad y estructura comunitaria entre estaciones. Mientras que la Estación 7 se destaca por su <strong>alta diversidad</strong> y equilibrio en las abundancias, otras estaciones (2, 9, 13 y 15) muestran dominancia marcada y <strong>menor complejidad</strong>, lo que sugiere condiciones de mayor perturbación o limitación de recursos. La Estación 4, con un <strong>patrón intermedio</strong>, refleja un ensamble en transición o con estabilidad parcial. En conjunto, estos resultados resaltan cómo los modelos de ajuste a curvas RAD permiten identificar no solo la riqueza y abundancia relativa de los taxones, sino también inferir procesos ecológicos subyacentes, tales como perturbación, competencia y disponibilidad de recursos en los diferentes sitios de muestreo.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Resumen de modelos RAD y su interpretación ecológica por estación</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Estación</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Modelo RAD</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Patrón de diversidad</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Interpretación ecológica</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">2</td>
<td style="text-align: center; width: 5cm;">Preemption</td>
<td style="text-align: center; width: 6cm;">Fuerte dominancia de pocos taxones, baja diversidad</td>
<td style="text-align: center; width: 7cm;">Perturbación o estrés ambiental; pocos taxones acaparan los recursos</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">4</td>
<td style="text-align: center; width: 5cm;">Mandelbrot</td>
<td style="text-align: center; width: 6cm;">Mezcla de taxones dominantes y raros, diversidad intermedia</td>
<td style="text-align: center; width: 7cm;">Ensamble en transición o con estabilidad parcial; estructura más compleja</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">7</td>
<td style="text-align: center; width: 5cm;">Lognormal</td>
<td style="text-align: center; width: 6cm;">Alta equidad y riqueza, mayor diversidad</td>
<td style="text-align: center; width: 7cm;">Comunidad con condiciones favorables y menor perturbación; distribución balanceada</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">9</td>
<td style="text-align: center; width: 5cm;">Zipf</td>
<td style="text-align: center; width: 6cm;">Dominancia marcada con cola larga de taxones raros</td>
<td style="text-align: center; width: 7cm;">Escenario de recursos limitantes o exclusión competitiva; baja diversidad</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">13</td>
<td style="text-align: center; width: 5cm;">Zipf</td>
<td style="text-align: center; width: 6cm;">Patrón similar a la Est. 9</td>
<td style="text-align: center; width: 7cm;">Dominancia fuerte y baja equidad, reflejando condiciones restrictivas</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">15</td>
<td style="text-align: center; width: 5cm;">Zipf</td>
<td style="text-align: center; width: 6cm;">Patrón similar a la Est. 9</td>
<td style="text-align: center; width: 7cm;">Dominancia fuerte y baja equidad, reflejando condiciones restrictivas</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="b.-figuras-de-los-modelos-rad-por-estación" class="level5">
<h5 class="anchored" data-anchor-id="b.-figuras-de-los-modelos-rad-por-estación">b. Figuras de los modelos RAD por Estación</h5>
<p>La línea de mayor grosor es la que representa al&nbsp;<strong>modelo de mayor ajuste</strong>&nbsp;para cada Estación evaluado. A continuación se grafican los diagramas de mayor ajuste.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_2, <span class="at">main=</span><span class="st">"RAD - Station_2"</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_4, <span class="at">main=</span><span class="st">"RAD - Station_4"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_7, <span class="at">main=</span><span class="st">"RAD - Station_7"</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_9, <span class="at">main=</span><span class="st">"RAD - Station_9"</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_13, <span class="at">main=</span><span class="st">"RAD - Station_13"</span>, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_15, <span class="at">main=</span><span class="st">"RAD - Station_15"</span>, </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig41-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig41-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig41-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig41-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3: Ajuste del patron de diversidad de cada Estación evaluado, para los cinco modelos empíricos evaluados
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-fig41-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig41-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig41-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig41-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4: Ajuste del patron de diversidad de cada Estación evaluado, para los cinco modelos empíricos evaluados
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelos con mejor ajuste</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_2<span class="sc">$</span>models<span class="sc">$</span>Preemption, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_2 - Preemption"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_4<span class="sc">$</span>models<span class="sc">$</span>Null, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_4 - Mandelbrot"</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_7<span class="sc">$</span>models<span class="sc">$</span>Mandelbrot, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_7 - Lognormal"</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelos con mejor ajuste</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_2<span class="sc">$</span>models<span class="sc">$</span>Preemption, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_9 - Zipf"</span>, </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_4<span class="sc">$</span>models<span class="sc">$</span>Null, </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_13 - Zipf"</span>, </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.Station_7<span class="sc">$</span>models<span class="sc">$</span>Mandelbrot, </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Estación_15 - Zipf"</span>, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"log10(Ab. Relativa)"</span>, <span class="at">xlab=</span><span class="st">"Rangos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig42-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig42-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig42-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig42-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5: Ajuste del patron de diversidad de cada Estación evaluado, de acuerdo al medelo con menor AIC
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-fig42-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig42-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig42-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig42-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6: Ajuste del patron de diversidad de cada Estación evaluado, de acuerdo al medelo con menor AIC
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Opción gráfica con ggplot2</strong></p>
<p>El código fuente&nbsp;<code>best_adjust.R</code>&nbsp;permite automatizar Distribuciones de Abundancia de Taxas (RAD) usando múltiples ajustes a modelos GLMs y seleccionar el mejor ajuste según el menor criterio AIC.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setup_rad_analysis</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  data,           <span class="co"># DataFrame con los datos</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  group_col,      <span class="co"># Columna de grupos/taxones</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  station_col,    <span class="co"># Columna de estaciones/muestreos</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  abundance_col,  <span class="co"># Columna de abundancias</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">minlength =</span> <span class="dv">4</span>,  <span class="co"># Long. mínima para abreviar nombres</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">station_prefix =</span> <span class="st">"Estación_"</span>  <span class="co"># Prefijo para nombres</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La base de datos o el dataframe se requiere en formato largo como <strong>biol</strong>, con una columna de taxones, otra columna de la observación (ej. Estaciones, estaciones, muestreos, etc) y una tercera columna de abundancias. Para el prsente ejercicio, a continuación, los insumos de la función se denominan “<strong>resultados</strong>”. Con <code>names(resultados)</code>, se pueden obtener los productos tabulares y gráficos del análisis, en formato <code>tidyverse</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"best_adjust.R"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar datos</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"plancton.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Riqueza"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar análisis</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>rad_analysis <span class="ot">&lt;-</span> <span class="fu">setup_rad_analysis</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> biol,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_col =</span> Groups,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">station_col =</span> Station,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">abundance_col =</span> Abundance,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">minlength =</span> <span class="dv">4</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">station_prefix =</span> <span class="st">"Station_"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecutar análisis completo</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  rad_analysis<span class="sc">$</span><span class="fu">run_complete_rad_analysis</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Abundancia por Estación"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, Inf,  : 
  NA/NaN/Inf en 'x'</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla con ajustes seleccionados</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>resultados<span class="sc">$</span>table <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AIC =</span> <span class="fu">round</span>(AIC, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Modelo con mejor ajuste </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">                 (menor AIC) por Estación"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">background =</span> <span class="st">"#4C72B0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Modelo con mejor ajuste (menor AIC) por Estación</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(76, 114, 176, 255) !important;">Estación</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(76, 114, 176, 255) !important;">Modelo</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(76, 114, 176, 255) !important;">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Station_2</td>
<td style="text-align: left;">Preemption</td>
<td style="text-align: right;">4107.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Station_4</td>
<td style="text-align: left;">Mandelbrot</td>
<td style="text-align: right;">6698.9</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Station_7</td>
<td style="text-align: left;">Lognormal</td>
<td style="text-align: right;">74.2</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Station_9</td>
<td style="text-align: left;">Zipf</td>
<td style="text-align: right;">235.6</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Station_13</td>
<td style="text-align: left;">Zipf</td>
<td style="text-align: right;">431.9</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Station_15</td>
<td style="text-align: left;">Zipf</td>
<td style="text-align: right;">357.9</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura con los mejores ajustes en ggplot2</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados<span class="sc">$</span>combined_plot)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="3_vis_diversidad_plancton_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para graficar el modelo seleccionado en cada estación</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"radfit_fig1.r"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción 2: Ultra compacto (1 línea)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">run_rad_analysis_and_plot</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, Inf,  : 
  NA/NaN/Inf en 'x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="3_vis_diversidad_plancton_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Se intentó evaluar la normalidad multivariada de la base de datos “<strong>biol1</strong>”, pero en algunas estaciones matriz es singular, por lo que se relaciona de forma opcional y a continuación se prueba la homogeneidad de las muestras y la independiencia de los datos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 2</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Estacion2 <span class="ot">&lt;-</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 4</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>Estacion4 <span class="ot">&lt;-</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 7</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>Estacion7 <span class="ot">&lt;-</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 9</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>Estacion9 <span class="ot">&lt;-</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 13</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>Estacion13 <span class="ot">&lt;-</span> </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxones de la estación 15</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>Estacion15 <span class="ot">&lt;-</span> </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))  <span class="co"># Datos con taxones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion2)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion4) # Matriz singular</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion7)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion9) # Matriz singular</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion13)</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mardia(Estacion15) # Matriz singular</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="c.-diagnóstico-de-supuestos" class="level5">
<h5 class="anchored" data-anchor-id="c.-diagnóstico-de-supuestos">c.&nbsp;Diagnóstico de supuestos</h5>
<p>Los siguientes estadísticos permiten diagnosticar la precisión de los GLMs con la distribución Poisson, para el análisis de las distribuciones de abundancias por rangos (curvas RAD).</p>
<section id="homogeneidad-de-covarianzas." class="level6">
<h6 class="anchored" data-anchor-id="homogeneidad-de-covarianzas.">1. Homogeneidad de covarianzas.</h6>
<p>Los estadísticos anova y permutes muestran un valor p &gt; 0.05, por lo que se cumple este supuesto.</p>
<p>Se trabaja con <code>biol1</code>, debido a que presenta una estructura de replicas por cada taxón.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancias de Bray-Curtis o Euclidianas si se requiere</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>distancias <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(biol1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar dispersión por grupo (Estación)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>grupo <span class="ot">&lt;-</span> biol1<span class="sc">$</span>Station</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>disper <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(distancias, <span class="at">group =</span> grupo)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación estadística</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disper)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df   Sum Sq  Mean Sq F value Pr(&gt;F)
Groups     5 0.061436 0.012287  0.7795 0.5773
Residuals 18 0.283745 0.015764               </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disper)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df   Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)
Groups     5 0.061436 0.012287 0.7795    999  0.602
Residuals 18 0.283745 0.015764                     </code></pre>
</div>
</div>
</section>
<section id="independencia-de-los-datos." class="level6">
<h6 class="anchored" data-anchor-id="independencia-de-los-datos.">2. Independencia de los datos.</h6>
<p>El estadístico de Durvin Watson muestra que se cumple la independencia de los datos, debido a que el valor p &gt; 0.05.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería necesaria</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una variable de suma total de abundancia por fila</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>biol1b <span class="ot">&lt;-</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(Qtgn<span class="sc">:</span>Otrs, <span class="sc">~</span> <span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(.), <span class="dv">0</span>)))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo lineal con esa suma</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(biol1b<span class="sc">$</span>Total <span class="sc">~</span> Station, <span class="at">data =</span> biol1b)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de independencia de residuos</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1      -0.1045605      2.034414   0.348
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="comparación-de-muestras-con-glms-y-permanovas" class="level4">
<h4 class="anchored" data-anchor-id="comparación-de-muestras-con-glms-y-permanovas">3.3 Comparación de muestras con GLMs y Permanovas</h4>
<section id="a.-prueba-con-distribución-poisson-y-binomial-negativo-para-un-taxón." class="level6">
<h6 class="anchored" data-anchor-id="a.-prueba-con-distribución-poisson-y-binomial-negativo-para-un-taxón.">a. Prueba con distribución poisson y binomial negativo para un taxón.</h6>
<p>Se escogió el taxón <strong>Qtgn</strong> como ejemplo, dado que domina en abundancia en la mayoría de las estaciones. Al ajustar un modelo <strong>Poisson</strong>, se observa que la devianza residual es extremadamente alta (76.459 con 18 g.l.) en relación con los grados de libertad, lo cual indica <strong>sobre-dispersión</strong>. Esta sobre-dispersión refleja la marcada heterogeneidad en las abundancias de Qtgn entre estaciones, resultado de su fuerte dominancia en algunos sitios y presencia reducida en otros.</p>
<p>Al emplear un modelo de <strong>regresión binomial negativa</strong>, se controla de forma explícita esta variabilidad extra. El ajuste mejora notablemente: la devianza residual desciende a 31.9 (con 18 g.l.), el parámetro de dispersión estimado es <code>theta</code> <strong>θ = 0.36 ± 0.08</strong>, y el <strong>AIC</strong> disminuye drásticamente de 76630 (Poisson) a 354.6 (Binomial Negativa). Estos resultados demuestran que la distribución binomial negativa ofrece un modelo más <strong>parsimonioso</strong> y adecuado para describir la abundancia de Qtgn, al capturar la estructura de dominancia y la heterogeneidad entre las estaciones.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste Poisson</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(Qtgn <span class="sc">~</span> Station, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"poisson"</span>, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> biol1b)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Qtgn ~ Station, family = "poisson", data = biol1b)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  8.109225   0.008671  935.21   &lt;2e-16 ***
Station4    -0.189323   0.012886  -14.69   &lt;2e-16 ***
Station7    -3.832559   0.059560  -64.35   &lt;2e-16 ***
Station9    -2.108429   0.026351  -80.01   &lt;2e-16 ***
Station13   -1.223971   0.018190  -67.29   &lt;2e-16 ***
Station15   -1.375228   0.019304  -71.24   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 102612  on 23  degrees of freedom
Residual deviance:  76459  on 18  degrees of freedom
AIC: 76630

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Para el caso del <strong>Binomial negativo</strong>, se observa un valor NA en la columna “Qtgn”, primero hay que eliminarlo.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste Binomial</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson inicial para dar valores de arranque</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>mod_p <span class="ot">&lt;-</span> <span class="fu">glm</span>(Qtgn <span class="sc">~</span> Station, <span class="at">data =</span> biol1b, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>mod_nb <span class="ot">&lt;-</span> <span class="fu">try</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm.nb</span>(Qtgn <span class="sc">~</span> Station,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> biol1b,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">coef</span>(mod_p),                 <span class="co"># arranque desde Poisson</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">control =</span> <span class="fu">glm.control</span>(<span class="at">maxit =</span> <span class="dv">200</span>)), <span class="co"># más iteraciones</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(mod_nb, <span class="st">"try-error"</span>)) {</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(mod_nb))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"glm.nb sigue fallando con start; probemos glmmTMB (más estable)."</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = Qtgn ~ Station, data = biol1b, start = coef(mod_p), 
    control = glm.control(maxit = 200), init.theta = 0.3566442978, 
    link = log)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   8.1092     0.8373   9.685  &lt; 2e-16 ***
Station4     -0.1893     1.1841  -0.160  0.87297    
Station7     -3.8326     1.1855  -3.233  0.00123 ** 
Station9     -2.1084     1.1843  -1.780  0.07503 .  
Station13    -1.2240     1.1842  -1.034  0.30132    
Station15    -1.3752     1.1842  -1.161  0.24551    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(0.3566) family taken to be 1)

    Null deviance: 41.946  on 23  degrees of freedom
Residual deviance: 31.915  on 18  degrees of freedom
AIC: 354.56

Number of Fisher Scoring iterations: 1

              Theta:  0.3566 
          Std. Err.:  0.0828 

 2 x log-likelihood:  -340.5630 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Otra opción de diagnóstico binomial</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo binomial negativo con efectos aleatorios - MUCHO más robusto</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>bin_neg <span class="ot">&lt;-</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(Qtgn <span class="sc">~</span> Station,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> nbinom2,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> biol1)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bin_neg)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          Qtgn ~ Station
Data: biol1

      AIC       BIC    logLik -2*log(L)  df.resid 
    354.6     362.8    -170.3     340.6        17 


Dispersion parameter for nbinom2 family (): 0.357 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   8.1092     0.8373   9.685  &lt; 2e-16 ***
Station4     -0.1893     1.1841  -0.160  0.87297    
Station7     -3.8326     1.1855  -3.233  0.00123 ** 
Station9     -2.1084     1.1843  -1.780  0.07503 .  
Station13    -1.2240     1.1842  -1.034  0.30132    
Station15    -1.3752     1.1842  -1.161  0.24551    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Si se quiere evaluar el <strong>efecto conjunto del Estación sobre todos los taxones</strong>, se puede realizar el siguiente procedimiento <strong>GLMs con Poisson y Binomial Negativa</strong>. El ajuste de modelos lineales generalizados multivariados (<strong>manyGLM</strong>) permite evaluar el efecto conjunto de la <strong>Estación</strong> sobre la composición y abundancia relativa de los taxones.</p>
<p>En el caso del <strong>modelo Poisson</strong>, se detecta un efecto altamente significativo del factor Estación sobre la comunidad de macrozooplancton estuarino (p = 0.001). Esto indica que las abundancias conjuntas de los taxones difieren de manera consistente entre estaciones, siendo la <strong>Estación 2</strong> el punto de referencia (intercepto). Todas las demás estaciones muestran diferencias significativas respecto a esta, lo que sugiere un fuerte gradiente espacial en la estructura comunitaria.</p>
<p>Sin embargo, los datos de abundancia de organismos planctónicos suelen presentar <strong>sobre-dispersión</strong> (varianza mucho mayor que la media), lo cual puede inflar las pruebas en el modelo Poisson y aumentar el riesgo de errores tipo I (detectar diferencias en exceso).</p>
<p>Por ello, se empleó también el <strong>modelo Binomial Negativa</strong>, que incorpora un parámetro de dispersión y se ajusta mejor a datos ecológicos con alta varianza y presencia de especies dominantes. Los resultados confirman el patrón detectado: el efecto de la Estación sigue siendo significativo (p = 0.001), validando que los cambios observados en la composición y abundancia de los taxones no son artefactos de la sobre-dispersión, sino un patrón ecológico robusto.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería requerida</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvabund)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Excluir la primera columna (Station)</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>taxones <span class="ot">&lt;-</span> <span class="fu">mvabund</span>(biol2[, <span class="sc">-</span><span class="dv">1</span>])  </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM multivariado Poisson</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>poisson <span class="ot">&lt;-</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">manyglm</span>(taxones <span class="sc">~</span> Station, </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> biol2, </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Test statistics:
            wald value Pr(&gt;wald)    
(Intercept)    1594.25     0.001 ***
Station4         50.09     0.001 ***
Station7         80.22     0.001 ***
Station9         89.64     0.001 ***
Station13        77.64     0.001 ***
Station15        78.41     0.001 ***
--- 
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Test statistic:  160.6, p-value: 0.001 
Arguments:
 Test statistics calculated assuming response assumed to be uncorrelated 
 P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo GLM multivariado con Binomial Negativa</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>bin_neg <span class="ot">&lt;-</span> <span class="fu">manyglm</span>(taxones <span class="sc">~</span> Station, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> biol2, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="st">"negative.binomial"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bin_neg)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Test statistics:
            wald value Pr(&gt;wald)    
(Intercept)    1594.25     0.001 ***
Station4         50.09     0.001 ***
Station7         80.22     0.001 ***
Station9         89.64     0.001 ***
Station13        77.64     0.001 ***
Station15        78.41     0.001 ***
--- 
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Test statistic:  160.6, p-value: 0.001 
Arguments:
 Test statistics calculated assuming response assumed to be uncorrelated 
 P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).</code></pre>
</div>
</div>
</section>
<section id="b.-comparación-de-muestras-con-pemanovas" class="level5">
<h5 class="anchored" data-anchor-id="b.-comparación-de-muestras-con-pemanovas">b. Comparación de muestras con Pemanovas</h5>
<p>La <strong>PERMANOVA</strong> (Permutational Multivariate Analysis of Variance) es otra opción para evaluar el efecto conjunto de la <strong>Estación</strong> sobre la composición y abundancia relativa de los taxones. A diferencia de los GLMs multivariados, este método trabaja directamente sobre una matriz de distancias (en este caso, índice de Bray-Curtis), lo que lo hace conceptualmente más sencillo de implementar.</p>
<p>En este análisis, el efecto de la Estación sobre la estructura comunitaria no resultó significativo (F = 1.08; p = 0.323), lo que indica que, bajo la métrica de disimilitud de Bray-Curtis, la variación entre estaciones no es suficientemente marcada para diferenciarse del azar en 999 permutaciones.</p>
<p>Sin embargo, un aspecto importante es que la PERMANOVA puede ser <strong>sensible a diferencias en la dispersión multivariada</strong> (es decir, a la heterogeneidad en la varianza-covarianza de las comunidades entre grupos). En situaciones de fuerte dispersión desigual, este método puede dar falsos positivos o perder potencia. Por ello, cuando existe sospecha de <strong>sobre-dispersión</strong> en los conteos de abundancia, resulta recomendable complementar este tipo de análisis con enfoques de GLMs multivariados (como el ajuste Binomial Negativo), que modelan de manera explícita la varianza y ofrecen inferencias más robustas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de abundancias (sin columnas Estación y microhábitat)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>bray.dis <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(biol1[, <span class="dv">5</span><span class="sc">:</span><span class="fu">ncol</span>(biol1)])</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># PERMANOVA por Estación</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>biol.permanova <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(bray.dis <span class="sc">~</span> Station, </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> biol1, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>biol.permanova</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = bray.dis ~ Station, data = biol1, permutations = 999)
         Df SumOfSqs     R2      F Pr(&gt;F)
Model     5   1.9158 0.2308 1.0802  0.342
Residual 18   6.3848 0.7692              
Total    23   8.3006 1.0000              </code></pre>
</div>
</div>
<section id="c.-efecto-de-los-taxones-sobre-la-diferencia-entre-estaciones" class="level6">
<h6 class="anchored" data-anchor-id="c.-efecto-de-los-taxones-sobre-la-diferencia-entre-estaciones">c.&nbsp;Efecto de los taxones sobre la diferencia entre Estaciones</h6>
<p>En este PERMANOVA se considera de forma explícita las abundancias de cada taxón (<strong>Qtgn a Otrs</strong>) explica un <strong>71 % de la variación</strong> en la estructura de ese ensamblaje plantónico (R² = 0.71). El efecto conjunto de los taxones es altamente significativo (F = 2.24; p = 0.001). Esto indica que las diferencias en este ensablaje estuarino pueden atribuirse principalmente a la contribución diferencial de los taxones en las estaciones evaluadas.</p>
<p>En comparación con el análisis anterior basado en el factor Estación (que no resultó significativo), aquí los <strong>taxones mismos son los predictores</strong> de la variación (similar a una regresión lineal múltiple). Esto refleja que la composición de estos organismos no se organiza únicamente por el sitio de muestreo, sino que son los <strong>taxones dominantes y subdominantes</strong> los que generan los patrones de disimilitud observados.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(biol1)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecutar PERMANOVA</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>permanova_taxones <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(bray.dis <span class="sc">~</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                             Qtgn<span class="sc">+</span>Srgs<span class="sc">+</span>Lcfr<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                             Clnd<span class="sc">+</span>Cycl<span class="sc">+</span>Hrpc<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                             Lrdp<span class="sc">+</span>Hvdp<span class="sc">+</span>LrvN<span class="sc">+</span>LrdC<span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                             LrvZ<span class="sc">+</span>Otrs, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver resultado</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>permanova_taxones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = bray.dis ~ Qtgn + Srgs + Lcfr + Clnd + Cycl + Hrpc + Lrdp + Hvdp + LrvN + LrdC + LrvZ + Otrs, permutations = 999)
         Df SumOfSqs      R2      F Pr(&gt;F)    
Model    12   5.8910 0.70971 2.2411  0.001 ***
Residual 11   2.4096 0.29029                  
Total    23   8.3006 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Versión automatizada:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear lista de nombres de taxones (todas las columnas de abundancia)</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>taxones <span class="ot">&lt;-</span> <span class="fu">names</span>(biol1)[<span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(biol1)]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear fórmula tipo Qtgn + ... + Otrs</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>formula_taxones <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"bray.dis ~"</span>, <span class="fu">paste</span>(taxones, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecutar PERMANOVA</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>permanova_taxones <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(formula_taxones, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> biol1, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver resultado</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>permanova_taxones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = formula_taxones, data = biol1, permutations = 999)
         Df SumOfSqs      R2      F Pr(&gt;F)    
Model    14   6.6168 0.79715 2.5262  0.001 ***
Residual  9   1.6838 0.20285                  
Total    23   8.3006 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="d.-prueba-de-comparaciones-múltiples-del-pemanova" class="level6">
<h6 class="anchored" data-anchor-id="d.-prueba-de-comparaciones-múltiples-del-pemanova">d.&nbsp;Prueba de comparaciones múltiples del Pemanova</h6>
<p>Los resultados refuerzan al primer permanova y muestran que entre las estaciones no se presentan diferencias significativas (valor p &gt; 0.05), lo cual indica que hay una gran similitud en la composición y abundancia de taxones.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería requerida</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba Post Hoc del PERMANOVA con el paquete "RVAideMemoire"</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.perm.manova</span>(bray.dis,Station, <span class="at">nperm=</span><span class="dv">1000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using permutation MANOVAs on a distance matrix 

data:  bray.dis by Station
1000 permutations 

   2    4    7    9    13  
4  0.89 -    -    -    -   
7  0.36 0.36 -    -    -   
9  0.36 0.60 0.76 -    -   
13 0.38 0.74 0.74 0.89 -   
15 0.36 0.74 0.82 0.89 0.89

P value adjustment method: fdr </code></pre>
</div>
</div>
</section>
<section id="f.-análisis-simper" class="level6">
<h6 class="anchored" data-anchor-id="f.-análisis-simper">f.&nbsp;Análisis SIMPER</h6>
<p>Adicional a los insumos que se obtienen (average, sd, ratio, cumsum), deberían aparecer otros (ava, avb y p), pero como no hay taxones que aporten a posibles diferencias entre Estaciones, los estadísticos faltantes serían similares a <strong>average</strong>, por lo cual omite presentarlos, así como las diferentes comparaciones entre Estaciones.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis SIMPER</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>simper <span class="ot">&lt;-</span> <span class="fu">simper</span>(biol1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">grupo =</span> Station, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simper)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Contrast: total 

     average     sd ratio cumsum
Qtgn  0.3662 0.3175 1.154  0.443
Cycl  0.2473 0.3536 0.700  0.742
Lrdp  0.0373 0.1094 0.341  0.787
LrdC  0.0359 0.0510 0.703  0.830
Srgs  0.0319 0.0329 0.969  0.869
LrvZ  0.0269 0.0370 0.726  0.901
Hrpc  0.0259 0.0550 0.470  0.933
Clnd  0.0192 0.0604 0.317  0.956
Otrs  0.0157 0.0276 0.570  0.975
LrvN  0.0119 0.0199 0.598  0.989
Lcfr  0.0054 0.0160 0.337  0.996
Hvdp  0.0035 0.0061 0.586  1.000</code></pre>
</div>
</div>
<p>Se puede probar el siguiente ejemplo de vegan, para visualizar y analizar los insumos faltantes.</p>
<p>`<code>sim &lt;- simper(dune, dune.env$Management, permutations = 99) summary(sim)</code></p>
<hr>
</section>
</section>
</section>
<section id="diversidad-alfa-en-4-pasos.-chao-et-al.-2020." class="level4">
<h4 class="anchored" data-anchor-id="diversidad-alfa-en-4-pasos.-chao-et-al.-2020.">3.4 Diversidad alfa en 4 Pasos. Chao <em>et al</em>. (2020).</h4>
<p>Este procedimiento permite calcular los siguientes cuatro pasos o insumos:&nbsp;<strong>(1) la completitud o integridad de la muestra</strong>,&nbsp;<strong>(2) la diversidad asintótica</strong>,&nbsp;<strong>(3) la diversidad no asintótica</strong>&nbsp;y&nbsp;<strong>(4) la uniformidad de las abundancias</strong>&nbsp;(<a href="https://esj-journals.onlinelibrary.wiley.com/doi/10.1111/1440-1703.12102">Chao et al.&nbsp;2020</a>).</p>
<hr>
<section id="patrón-general-de-diversidad-alfa-por-cada-estación." class="level5">
<h5 class="anchored" data-anchor-id="patrón-general-de-diversidad-alfa-por-cada-estación.">3.4.1 Patrón general de diversidad alfa por cada Estación.</h5>
<p>La <strong>Estación 2</strong> presentó la mayor abundancia total de individuos, acompañada de una riqueza relativamente alta de taxones, similar a la observada en las estaciones <strong>7</strong> y <strong>13</strong>. En términos de rareza, la cantidad de <em>singletons</em> (taxones representados por un solo individuo) fue prácticamente nula en todas las estaciones, con la única excepción de un caso en la Estación 7. De manera análoga, la frecuencia de <em>doubletons</em> (taxones representados por dos individuos) también fue muy baja, registrándose únicamente un dobleton en la Estación 15.</p>
<p>Este patrón de baja proporción de taxones raros (f1 y f2) sugiere que el esfuerzo de muestreo fue adecuado en la mayoría de estaciones. Así, se espera que los <strong>estimadores de completitud de la muestra (paso 1)</strong> y los <strong>perfiles de diversidad asintótica (paso 2)</strong>, desarrollados en los análisis siguientes, reflejen valores estables y confiables de diversidad alfa, sin una subestimación importante de la riqueza real.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería requerida</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>biol_sit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(biol_sit)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># iNEXT por Estaciones</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>result<span class="ot">=</span> <span class="fu">iNEXT</span>(biol_sit[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">q=</span><span class="dv">0</span>, <span class="at">datatype=</span><span class="st">"abundance"</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Algunos insumos de iNEXT para tabular</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> result<span class="sc">$</span>DataInfo[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Edición de los nombres de las columnas </span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Estación"</span>, <span class="st">"N"</span>, <span class="st">"Richness"</span>, <span class="st">"f1"</span>,<span class="st">"f2"</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los seis (6) primeros datos (filas)</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>result <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Tabla. Estimadores generales de diversidad alfa"</span>,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla. Estimadores generales de diversidad alfa</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Estación</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Richness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">f1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: right;">30371</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: right;">25582</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: right;">711</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: right;">2068</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: right;">4772</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: right;">4193</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>–</p>
</section>
<section id="cuatro-pasos-por-estaciones" class="level5">
<h5 class="anchored" data-anchor-id="cuatro-pasos-por-estaciones">3.4.2 Cuatro pasos por Estaciones</h5>
<p>El procedimiento de diversidad alfa en <strong>cuatro pasos</strong>, propuesto por Chao et al.&nbsp;(2020), se aplicó a los datos de abundancia de la base <em>biol2</em> mediante la función <code>iNEXT4steps</code>. Esta rutina integra en un solo flujo de trabajo los principales estimadores y gráficos que permiten evaluar la completitud del muestreo, el perfil de diversidad asintótica, la estandarización por cobertura y la comparación de diversidades entre comunidades.</p>
<p>Cabe señalar que en algunas versiones de la librería <strong>iNEXT</strong> los nombres de los insumos generados por <code>iNEXT4steps</code> pueden variar ligeramente. Por esta razón, se recomienda revisar los tutoriales disponibles en la ayuda (<code>help(iNEXT4steps)</code>), especialmente los ejemplos con datos de abundancia, para confirmar la forma correcta de invocar el comando y la interpretación de sus salidas.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de la base de datos </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>chao.sit <span class="ot">&lt;-</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  biol_sit[,<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span>  <span class="co"># Excluir la columna Taxas</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))   <span class="co"># Asegurar que todas sean numéricas  </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados de la prueba de diversidad alfa en 4 pasos</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">iNEXT4steps</span>(<span class="at">data =</span> chao.sit, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">datatype =</span> <span class="st">"abundance"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># result1$summary</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<section id="a.-paso-1.-perfil-de-completitud" class="level6">
<h6 class="anchored" data-anchor-id="a.-paso-1.-perfil-de-completitud">a. Paso 1. Perfil de completitud</h6>
<p>El perfil de completitud muestra que las seis estaciones alcanzaron un valor de <strong>1.0</strong> para los tres órdenes de diversidad considerados (q = 0, q = 1 y q = 2) <a href="#tbl-tbl42" class="quarto-xref">Tabla&nbsp;5</a>. Esto significa que, en todas las estaciones, el muestreo capturó de manera exhaustiva la riqueza de taxones, las abundancias ponderadas por equidad y las dominancias. En términos prácticos, <strong>no es necesario incrementar el esfuerzo de muestreo</strong>, ya que las muestras disponibles representan de manera adecuada la diversidad alfa presente en cada sitio.</p>
<p>Nota: en caso que el siguiente comando no se ejecute, se debe a que el paso 1 (perfil de completitud) presenta un nombre diferente, para lo cual se sugiere ejecutar el siguiente comando, que muestra los insumos de este ejercicio: names(<strong>result1$summary</strong>). Para este caso, los insumos son:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result1<span class="sc">$</span>summary)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "STEP 1. Sample completeness profiles"                                                                                        
[2] "STEP 2b. Observed diversity values and asymptotic estimates"                                                                 
[3] "STEP 3. Non-asymptotic coverage-based rarefaction and extrapolation analysis"                                                
[4] "STEP 4. Evenness among species abundances of orders q = 1 and 2 at Cmax based on the normalized slope of a diversity profile"</code></pre>
</div>
</div>
<p>Es así como el primer paso debe copiarse y pegarse tal como aparece en el resultado anterior. así:</p>
<p><strong>“STEP 1. Sample completeness profiles”</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 1. Perfil de completitud</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>summary<span class="sc">$</span><span class="st">"STEP 1. Sample completeness profiles"</span> <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl42" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl42-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;5: Perfil de completitud entre los Estaciones evaluados
</figcaption>
<div aria-describedby="tbl-tbl42-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Assemblage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="b.-paso-2.-perfil-asintótico" class="level6">
<h6 class="anchored" data-anchor-id="b.-paso-2.-perfil-asintótico">b. Paso 2. Perfil asintótico</h6>
<p>El perfil asintótico permite comparar la <strong>diversidad observada en campo</strong> con la <strong>diversidad estimada</strong> a partir de modelos de extrapolación. La diferencia entre ambos valores define a los <strong>taxones no detectados</strong> (<em>sin.det</em>), lo que proporciona un indicador de qué tan completa es la muestra.</p>
<p><strong>Nota</strong>: siguiendo con los insumos de names(result1$summary), el paso 2 se debe copiar y pegar en el siguiente fragmento de esta manera: <strong>“STEP 2b. Observed diversity values and asymptotic estimates”</strong></p>
<p><strong>asinto</strong> es la manera como se asignará la tabla resultado de este segundo paso, para luego incluirle una columna de taxones sin detectar, que mostrará que tan completa es cada muestra (Estación evaluado).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignación del paso 2 como "asinto"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>asinto <span class="ot">=</span> result1<span class="sc">$</span>summary<span class="sc">$</span><span class="st">"STEP 2b. Observed diversity values and asymptotic estimates"</span> </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A continuación se crea la columna de taxones sin detectar y se asigna como sin.det. Esta columna es el resultado de la diferencia entre la diversidad estimada (TD_asy) y la diversidad observada (TD_obs), lo cual permitirá conocer si las muestras son completas (sus pendientes se vuelven asintóticas o se estabilizan o por el contrario no son asintóticas por haber taxones sin detectar hasta en el doble de su proyección, ver <strong>?@fig-fig43</strong>). <strong>asinto$TD_asy</strong> es la diversidad asintótica estimada, <strong>asinto$TD_obs</strong> es la diversidad observada u obtenida en campo</p>
<p>Nota: En caso que los nombres de los insumos hayan cambiado, se requiere usar el comando <strong>names</strong>, para encontrarlos:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(asinto)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nueva columna de la tabla, titulada "sin.det"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>asinto <span class="ot">&lt;-</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>asinto <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sin.det =</span> <span class="fu">round</span>(TD_asy <span class="sc">-</span> TD_obs))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En este análisis, todas las estaciones presentan valores prácticamente idénticos entre la diversidad observada y la estimada, tanto para la <strong>riqueza de taxones (q = 0)</strong>, como para la <strong>diversidad de Shannon (q = 1)</strong> y la <strong>diversidad de Simpson (q = 2)</strong> <a href="#tbl-tbl43" class="quarto-xref">Tabla&nbsp;6</a>. Esto implica que no se proyectan taxones adicionales por detectar (sin.det = 0 en todos los casos).</p>
<p>Desde el punto de vista ecológico, este resultado respalda que el <strong>esfuerzo de muestreo fue suficiente</strong> en todas las estaciones, ya que las curvas de acumulación se estabilizaron y alcanzaron la asíntota. De esta manera, los patrones de diversidad alfa que se analizarán en los pasos siguientes pueden interpretarse con confianza, al no existir sesgos relevantes por submuestreo.</p>
<p><strong>Nota:</strong> En caso que se requiera realizar algún ajuste en el siguiente comando, habrá que volver a correr todo el paso 2.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>asinto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ensamblaje =</span> asinto<span class="sc">$</span>Assemblage, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimador  =</span> asinto<span class="sc">$</span>qTD, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">D.Observada=</span> asinto<span class="sc">$</span>TD_obs, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">D.Estimada =</span> asinto<span class="sc">$</span>TD_asy, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sin.Det    =</span> asinto<span class="sc">$</span>sin.det</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>asinto <span class="ot">&lt;-</span> asinto <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimador =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(<span class="fu">as.character</span>(Estimador), </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Species richness"</span>  <span class="ot">=</span> <span class="st">"q=0, Riqueza"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Shannon diversity"</span> <span class="ot">=</span> <span class="st">"q=1, Shannon"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Simpson diversity"</span> <span class="ot">=</span> <span class="st">"q=2, Simpson"</span>))</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>asinto <span class="sc">%&gt;%</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F, <span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Algunas versiones de iNEXT requieren este comando:</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate(sin.det = round(Taxonomic.Estimator - Taxonomic.Observed))</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl43" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl43-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;6: Perfil asintótico entre los Estaciones evaluados
</figcaption>
<div aria-describedby="tbl-tbl43-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Ensamblaje</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Estimador</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">D.Observada</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">D.Estimada</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sin.Det</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_13</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_15</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_2</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_4</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_7</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">6.59</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">4.52</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: left;">q=0, Riqueza</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_9</td>
<td style="text-align: left;">q=1, Shannon</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: left;">q=2, Simpson</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="c.-paso-3.-perfil-no-asintótico" class="level6">
<h6 class="anchored" data-anchor-id="c.-paso-3.-perfil-no-asintótico">c.&nbsp;Paso 3. Perfil no asintótico</h6>
<p>El <strong>perfil no asintótico</strong>, basado en rarefacción y extrapolación por cobertura, permite comparar las estaciones bajo una <strong>condición estandarizada de completitud (Cmax = 1)</strong>. Este enfoque corrige las diferencias en el esfuerzo de muestreo y asegura que todas las estaciones sean evaluadas en igualdad de condiciones.</p>
<p>Los resultados muestran que la <strong>Estación 7</strong> presenta la mayor diversidad en los tres órdenes de diversidad (q = 0, q = 1 y q = 2), seguida por la <strong>Estación 2</strong> y la <strong>Estación 4</strong> <a href="#tbl-tbl44" class="quarto-xref">Tabla&nbsp;7</a>. Las estaciones restantes (9, 13 y 15) exhiben valores más bajos y relativamente similares entre sí.</p>
<p>Desde una perspectiva ecológica, este patrón indica que la Estación 7 mantiene una comunidad más equilibrada y con mayor aporte de especies raras y comunes, mientras que en las demás estaciones la estructura comunitaria es más simple y dominada por pocos taxones. En conjunto, el análisis no asintótico confirma la existencia de un gradiente en la diversidad alfa, donde ciertos sitios (como la Estación 7) actúan como <strong>puntos de mayor heterogeneidad ecológica</strong> dentro del sistema.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 3. Perfil no asintótico basado en interpolación y extrapolación</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>summary<span class="sc">$</span><span class="st">"STEP 3. Non-asymptotic coverage-based rarefaction and extrapolation analysis"</span> <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl44" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl44-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;7: Perfil no asintótico para los tres Estaciones evaluados
</figcaption>
<div aria-describedby="tbl-tbl44-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Cmax = 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">1.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">2.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">2.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">6.54</td>
<td style="text-align: right;">4.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">1.62</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="d.-paso-4.-uniformidad" class="level6">
<h6 class="anchored" data-anchor-id="d.-paso-4.-uniformidad">d.&nbsp;Paso 4. Uniformidad</h6>
<p>El perfil de uniformidad evalúa el grado de <strong>equidad en la distribución de abundancias entre los taxones</strong> de cada estación, estandarizado al nivel máximo de cobertura (Cmax = 1). Se consideran tres indicadores: el índice de <strong>Pielou J’</strong> y las medidas de diversidad normalizada para los órdenes q = 1 (Shannon) y q = 2 (Simpson) <a href="#tbl-tbl45" class="quarto-xref">Tabla&nbsp;8</a>.</p>
<p>Los resultados muestran que la <strong>Estación 7</strong> presenta la mayor uniformidad, con valores de Pielou (0.76) y diversidades normalizadas (q1 = 0.50, q2 = 0.32) notablemente más altos que el resto de estaciones. Esto refleja una comunidad con abundancias más equilibradas, donde tanto especies comunes como raras aportan de manera significativa a la estructura del ensamble. En contraste, las estaciones restantes exhiben valores de uniformidad más bajos y relativamente similares entre sí, lo que indica comunidades más <strong>dominadas por pocos taxones</strong>.</p>
<p>Este patrón de uniformidad refuerza los resultados de los pasos anteriores: mientras que algunas estaciones mantienen comunidades simplificadas y con fuerte dominancia, la Estación 7 sobresale como un sitio con mayor equidad y diversidad, lo que sugiere condiciones ambientales más favorables o menor perturbación antrópica.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 4. Perfil de uniformidad</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 4. Perfil de uniformidad</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>summary<span class="sc">$</span><span class="st">"STEP 4. Evenness among species abundances of orders q = 1 and 2 at Cmax based on the normalized slope of a diversity profile"</span> <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl45" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl45-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;8: Perfil de uniformidad para los tres Estaciones evaluados
</figcaption>
<div aria-describedby="tbl-tbl45-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Cmax = 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pielou J'</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">q = 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Station_13</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_15</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_2</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_4</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Station_7</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">Station_9</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.06</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
</section>
<section id="figuras-de-diversidad-alfa" class="level5">
<h5 class="anchored" data-anchor-id="figuras-de-diversidad-alfa">3.4.2.1 Figuras de diversidad alfa</h5>
<section id="a.-figuras-del-perfil-asintótico-paso-1" class="level6">
<h6 class="anchored" data-anchor-id="a.-figuras-del-perfil-asintótico-paso-1">a. Figuras del perfil asintótico (paso 1)</h6>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del paso 1. Completitud de las muestras.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>figure[[<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># Rango del eje x</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Intervalos del eje</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Orden q"</span>, <span class="at">y=</span><span class="st">"Completitud de la muestra"</span>, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Paso 1. </span><span class="sc">\n</span><span class="st">Perfil de Completitud"</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="3_vis_diversidad_plancton_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Líneas verticales resaltando cada orden q (capa adicional)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_vline(xintercept = c(1,2), </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             color = "gray", linetype = "dotted")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="b.-figuras-del-perfil-asintótico-paso-2" class="level6">
<h6 class="anchored" data-anchor-id="b.-figuras-del-perfil-asintótico-paso-2">b. Figuras del perfil asintótico (paso 2)</h6>
<p>La <strong>curva de rarefacción y extrapolación</strong>, muestra que en pozo Azul se presenta mayor riqueza de taxones (q=0) y taxones abundantes (q=1) y muy abundantes o dominantes (q=2), pero las tres muestras no se estabilizan en q=0 ni proyectandose al doble de la abundancia observada (líneas punteadas), lo cual reafirma el requerimiento de un mayor esfuerzo de muestreo para poder detectar un mayor número de taxones en cada localidad (<strong>?@fig-fig43</strong>).</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 2.1. Figura del tamaño basado en rarefacción / extrapolación</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>figure[[<span class="dv">2</span>]]<span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Abundancia"</span>, <span class="at">y=</span><span class="st">"Diversidad - No. taxas"</span>, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Paso 2.1. </span><span class="sc">\n</span><span class="st">Tamaño basado en Rarefacción/Extrapolación"</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="st">""</span>,<span class="at">values =</span>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Rarefacción"</span>,<span class="st">"Extrapolación"</span>)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig143" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig143-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig143-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig143-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7: Perfil de rarefacción y extrapolación por Estaciones
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="c.-figuras-del-perfil-no-asintótico-paso-3" class="level6">
<h6 class="anchored" data-anchor-id="c.-figuras-del-perfil-no-asintótico-paso-3">c.&nbsp;Figuras del perfil no asintótico (paso 3)</h6>
<p>Estas curvas complementan al <strong>perfil no asintótico</strong> relacionado en la <a href="#tbl-tbl44" class="quarto-xref">Tabla&nbsp;7</a>. Se observa que todas alcanzan la cobertura máxima de 1 (eje x de <a href="#fig-fig44" class="quarto-xref">Figura&nbsp;8</a>) y que hay pocas diferencias apreciables entre la diversiad de cada Estación comparado.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 3. Figura del perfil no asintótico basado en rarefacción/extrapolación</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>figure[[<span class="dv">4</span>]]<span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Cobertura de los Estaciones"</span>, <span class="at">y=</span><span class="st">"Diversidad de taxones"</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Paso 3. </span><span class="sc">\n</span><span class="st">Perfil de cobertura basado en Rarefacción/Extrapolación"</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="st">""</span>,<span class="at">values =</span>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Rarefacción"</span>,<span class="st">"Extrapolación"</span>)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig44" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig44-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="3_vis_diversidad_plancton_files/figure-html/fig-fig44-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig44-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8: Perfil de diversidad no asintótico para los Estaciones evaluados
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="d.-figuras-del-perfil-de-uniformidad-paso-4" class="level6">
<h6 class="anchored" data-anchor-id="d.-figuras-del-perfil-de-uniformidad-paso-4">d.&nbsp;Figuras del perfil de uniformidad (paso 4)</h6>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 4. Figura del perfil de uniformidad</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>result1<span class="sc">$</span>figure[[<span class="dv">5</span>]] <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>),  <span class="co"># Rango del eje x</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Intervalos del eje</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Orden q"</span>, <span class="at">y=</span><span class="st">"Uniformidad"</span>, </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Paso 4. </span><span class="sc">\n</span><span class="st">Perfil de Uniformidad"</span>) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="3_vis_diversidad_plancton_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Líneas verticales resaltando cada orden q (capa adicional)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_vline(xintercept = c(1,2), </span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             color = "gray", linetype = "dotted")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
</section>
</section>
</section>
<section id="cuestionario" class="level2">
<h2 class="anchored" data-anchor-id="cuestionario">Cuestionario</h2>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Instrucciones</strong>: Responde cada pregunta usando el código y los resultados obtenidos en los ejercicios del ítem C.</p>
</div>
</div>
<p>Responda con base en los análisis realizados y los gráficos obtenidos:</p>
<ol type="1">
<li>¿Cuál Estación presentó mayor diversidad alfa total? ¿Y cuál presentó la menor?</li>
<li>En el Estación <strong>Pozo Azul</strong>, compare la diversidad entre los microhábitats <em>Arena</em>, <em>Grava</em> y <em>Hoja</em>. ¿Cuál presentó mayor diversidad? ¿A qué puede deberse?</li>
<li>¿Qué patrones se observan entre los microhábitats <em>Hoja</em> y <em>Grava</em> en los tres Estaciones? ¿Son consistentes los valores de diversidad?</li>
<li>¿En qué Estación la diferencia entre microhábitats es más marcada? Justifique usando evidencias gráficas o valores numéricos.</li>
<li>Interprete la relación entre diversidad y tipo de microhábitat. ¿Existen microhábitats que consistentemente favorecen una mayor diversidad?</li>
<li>¿Qué microhábitat muestra mayor variabilidad entre Estaciones? Fundamente su respuesta.</li>
<li>Si se considerara un solo tipo de microhábitat para evaluar diversidad en el río Gaira, ¿cuál elegiría y por qué?</li>
<li>¿Qué implicaciones ecológicas tiene encontrar alta diversidad en un microhábitat particular como <em>Hoja</em>?</li>
<li>¿Qué limitaciones tiene este tipo de análisis para comparar diversidad entre microhábitats?</li>
<li>Formule una hipótesis ecológica sobre la distribución de la diversidad en función de los microhábitats, y proponga cómo podría evaluarse estadísticamente.</li>
</ol>
<hr>
</section>
<section id="errores-comunes-e-interpretación-ecológica" class="level2">
<h2 class="anchored" data-anchor-id="errores-comunes-e-interpretación-ecológica">Errores comunes e interpretación ecológica</h2>
<p>Uno de los errores más frecuentes es asumir que la diversidad en un Estación o ecosistema es homogénea, sin considerar las variaciones espaciales internas como las que generan los microhábitats. También es común confundir los estimadores de diversidad: mientras que la riqueza (q=0) refleja el número total de taxa, la diversidad de Shannon ajustada (q=1) pondera la equidad en las abundancias, y la de Simpson ajustada (q=2) destaca los dominantes. Ignorar estas diferencias puede llevar a interpretaciones erróneas, por ejemplo, subestimando el aporte ecológico de microhábitats con pocos taxones pero muy equitativos. Finalmente, un uso inadecuado de escalas gráficas puede ocultar diferencias sutiles pero ecológicamente relevantes.</p>
<hr>
</section>
<section id="aplicaciones-ecológicas-y-ambientales" class="level2">
<h2 class="anchored" data-anchor-id="aplicaciones-ecológicas-y-ambientales">Aplicaciones ecológicas y ambientales</h2>
<p>La caracterización de la diversidad <strong>alfa</strong> por escalas de Estaciones y de microhábitat permite entender el rol funcional de cada tipo de sustrato dentro del ecosistema. Microhábitats como la hojarasca suelen albergar comunidades especializadas y contribuir de manera desproporcionada a la heterogeneidad del sistema. Estos hallazgos son esenciales para planes de monitoreo, restauración y conservación fluvial, pues orientan esfuerzos hacia el mantenimiento de la diversidad estructural y funcional del hábitat. Además, al comparar Estaciones dentro del mismo río, se pueden detectar alteraciones locales o gradientes de presión ambiental.</p>
<hr>
</section>
<section id="conclusiones" class="level2">
<h2 class="anchored" data-anchor-id="conclusiones">Conclusiones</h2>
<p>Este ejercicio ha demostrado que incluso dentro de un mismo río, la diversidad <strong>alfa</strong> varía considerablemente entre Estaciones y microhábitats. La inclusión del componente microestructural del hábitat en los análisis enriquece la interpretación ecológica y permite una evaluación más precisa del estado del ecosistema. La herramienta gráfica se consolida como un puente entre el dato y la comprensión ecológica, permitiendo visibilizar patrones que a menudo pasan desapercibidos. Se reafirma la importancia de abordar el análisis de diversidad con una perspectiva espacial fina y con criterios funcionales.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>