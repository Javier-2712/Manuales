<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es-ES" xml:lang="es-ES"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Repositorio de Talleres de Multivariados - 2024-I - Taller2.2 Intro_Matrices</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Taller3.1.exploratorios.html" rel="next">
<link href="./Taller2.1.Introducción.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Taller2.2.Introd.matrices.html">Taller2.2 Intro_Matrices</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Repositorio de Talleres de Multivariados - 2024-I</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Descargar" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descargar"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Manual.mv.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Descargar PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Manual.mv.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Descargar ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Compartir" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Compartir"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Videos_clases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Videos_clases</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller1.Introducción.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller1. Intro_multivariados</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller2.1.Introducción.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller2.1 Intro_RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller2.2.Introd.matrices.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Taller2.2 Intro_Matrices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller3.1.exploratorios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller3. Exploratorios_mv</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller4.1.pca.marino.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller4.1 PCA Bahías</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller4.2.pca.tayrona.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller4.2 PCA PNNTayrona</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller5.1.nmds.malezas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller5. NMDS Malezas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller6.1.cla.bahías.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller6.1 CLA Bahías</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller6.2.cla.peces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller6.2 CLA Peces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller7.1.lda.peces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller7. LDA Peces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller8.1.manova.peces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller8. MANOVA Peces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller9.1.permanova.peces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller9. PERMANOVAS Peces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pautas_Estudio_Caso.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pautas Estudios de Caso</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Anexos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anexos</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a></li>
  <li><a href="#resumen-de-las-actividades" id="toc-resumen-de-las-actividades" class="nav-link" data-scroll-target="#resumen-de-las-actividades">Resumen de las actividades</a></li>
  <li><a href="#objetivo-de-la-actividad" id="toc-objetivo-de-la-actividad" class="nav-link" data-scroll-target="#objetivo-de-la-actividad">Objetivo de la actividad</a></li>
  <li><a href="#talleres-a-realizar-en-clase" id="toc-talleres-a-realizar-en-clase" class="nav-link" data-scroll-target="#talleres-a-realizar-en-clase">Talleres a realizar en clase</a></li>
  <li><a href="#materiales-requeridos-para-los-talleres-en-clase" id="toc-materiales-requeridos-para-los-talleres-en-clase" class="nav-link" data-scroll-target="#materiales-requeridos-para-los-talleres-en-clase">Materiales requeridos para los talleres en clase</a>
  <ul class="collapse">
  <li><a href="#taller-2.2.-operaciones-matriciales-básicas" id="toc-taller-2.2.-operaciones-matriciales-básicas" class="nav-link" data-scroll-target="#taller-2.2.-operaciones-matriciales-básicas">Taller 2.2. Operaciones matriciales básicas</a></li>
  <li><a href="#taller-2.2a-aplicaciones-de-matrices-análisis-de-componentes-principales---pca" id="toc-taller-2.2a-aplicaciones-de-matrices-análisis-de-componentes-principales---pca" class="nav-link" data-scroll-target="#taller-2.2a-aplicaciones-de-matrices-análisis-de-componentes-principales---pca">Taller 2.2a Aplicaciones de matrices (Análisis de Componentes Principales - PCA)</a></li>
  <li><a href="#taller-2.2b-aplicaciones-de-matrices-análisis-discriminante-lineal---lda" id="toc-taller-2.2b-aplicaciones-de-matrices-análisis-discriminante-lineal---lda" class="nav-link" data-scroll-target="#taller-2.2b-aplicaciones-de-matrices-análisis-discriminante-lineal---lda">Taller 2.2b Aplicaciones de matrices (Análisis discriminante lineal - LDA)</a></li>
  <li><a href="#lda-con-tidyverse" id="toc-lda-con-tidyverse" class="nav-link" data-scroll-target="#lda-con-tidyverse">LDA con tidyverse</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller2.2 Intro_Matrices</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="resumen-de-las-actividades" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="resumen-de-las-actividades">Resumen de las actividades</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://t3.ftcdn.net/jpg/01/37/10/02/240_F_137100243_hkZ4Ogqttc2ScvjPEnMyELhPlhHv4pyc.jpg" class="img-fluid figure-img" style="width:63.0%"></p>
<figcaption>Imágen tomada de <a href="https://stock.adobe.com/co/contributor/204068816/babaroga?load_type=author&amp;prev_url=detail">Babaroga</a></figcaption>
</figure>
</div>
<p><b style="color:#33a02c;"></b></p><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b><section id="objetivo-de-la-actividad" class="level2"><b style="color:#33a02c;">
<h2 class="anchored" data-anchor-id="objetivo-de-la-actividad">Objetivo de la actividad</h2>
</b><p><b style="color:#33a02c;"></b></p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://as2.ftcdn.net/v2/jpg/01/24/98/63/1000_F_124986319_zPU5IkYOsDREFgQQPBnvmvBtYKEldopT.jpg" class="img-fluid figure-img" style="width:35.0%"></p>
<figcaption>Imágen tomada de <a href="https://stock.adobe.com/co/contributor/205958075/wittayayut?load_type=author&amp;prev_url=detail">wittayayut</a></figcaption>
</figure>
</div>
<div style="text-align: justify">

<p>El presente taller tiene como objetivo, realizar un entrenamiento básico sobre algebra lineal aplicada a datos multivariados. Iniciarémos con operaciones básicas (taller 2.2) y posteriormente se realizarán algunas aplicaciones estadísticas como el análisis de componentes principales (pca - taller 2.2a) y el análisis discriminante (lda - taller 2.2b).</p>
<hr>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></div></section><b style="color:#1f78b4;">
</b><section id="talleres-a-realizar-en-clase" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="talleres-a-realizar-en-clase">Talleres a realizar en clase</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p>Son tres los talleres a realizar:</p>
<ol type="1">
<li><p><strong>Taller 2.2 Operaciones matriciales básicas.</strong> El objetivo de esta actividad es adquirir destrezas en operaciones básicas con matrices que sirven de soporte para diferentes diseños multivariados.</p></li>
<li><p><strong>Taller 2.2a. Operaciones matriciales para análisis de componentes principales - pca</strong>. Se aplicarán operaciones matriciales, mediante un procedimiento paso a paso, para la realización de esta técnica de <strong><em>ordenación</em></strong> multivariada - pca.</p></li>
<li><p><strong>Taller 2.2b. Operaciones matriciales para el análisis discriminante lineal - lda</strong>. Se aplicarán operaciones matriciales, mediante un procedimiento paso a paso, para la realización de esta técnica de <strong><em>clasificación</em></strong> multivariada - lda.</p></li>
</ol>
<hr>
<p><b style="color:#1f78b4;"></b></p><b style="color:#1f78b4;">
</b></section><b style="color:#1f78b4;">
</b><section id="materiales-requeridos-para-los-talleres-en-clase" class="level2"><b style="color:#1f78b4;">
<h2 class="anchored" data-anchor-id="materiales-requeridos-para-los-talleres-en-clase">Materiales requeridos para los talleres en clase</h2>
</b><p><b style="color:#1f78b4;"></b></p>
<p><img src="https://t3.ftcdn.net/jpg/02/91/88/44/240_F_291884472_LL830dNaMH0qHAbbtlPICoS3Vsx4J3wU.jpg" class="img-fluid" style="width:43.0%"></p>
<p>[<n style="color:#1f78b4;"> Imágen tomada de <a href="https://stock.adobe.com/co/contributor/204684949/wachiwit?load_type=author&amp;prev_url=detail">wachiwit</a> </n>]</p>
<div style="text-align: justify">

<ol type="1">
<li><p><strong>Archivos requeridos.</strong> Descargar las plantillas o complementos para los diferentes talleres en <strong>Quarto</strong> de <strong>RStudio</strong>. Todos deben ubicarse en un directorio o carpeta titulado “<strong><em>Taller 2.2 Matrices en RStudio</em></strong>”</p>
<ul>
<li><p><a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/Taller2.2.matrices.rmd">Plantilla del taller 2.2 en quarto</a>: Estructura de RStudio para realizar el taller de <strong>algebra general</strong> en RStudio. Nombre del archivo: “<strong><em>taller2.2.matrices.Rmd</em></strong>”.</p></li>
<li><p><a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/taller.2.2a.pca.qmd">Plantilla del taller 2.2a en quarto</a>: Estructura de RStudio para realizar el taller de análisis de <strong>componentes principales (pca)</strong> en RStudio. Nombre del archivo: “<strong><em>taller.2.2a.pca.qmd</em></strong>”.</p></li>
<li><p><a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/taller.2.2b.lda.qmd">Plantilla del taller 2.2b en quarto</a>: Estructura de RStudio para realizar el taller de <strong>análisis discrimiante lineal (lda)</strong> en RStudio. Nombre del archivo: “<strong><em>taller.2.2b.lda.qmd</em></strong>”.</p></li>
<li><p><a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/yml.QMD.txt">Formato base del YML</a>: Estructura del encabezado de los talleres en RStudio. *Hacer clic derecho en el enlace y guardarlo en el directorio de trabajo.</p></li>
<li><p><a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/stile-justify.css">Formato para justificar el texto</a>: Complemento para justificar los documentos. *Hacer clic derecho en el enlace y guardarlo en el directorio de trabajo.</p></li>
<li><p><strong>Bases de datos csv y xlsx</strong>. La siguente base de datos corresponde a cuatro variables morfométricas tomadas a estudiantes de la asignatura en semestres anteriores, está en formato plano o csv (descargar: <a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/datos1.csv">datos1.csv</a>) y en formato general de excel (descargar: <a href="https://javier-2712.github.io/Manuales/8.Manual_mv_24/datos1.xlsx">datos1.xlsx</a>).</p></li>
</ul></li>
<li><p><strong>Diapositivas en vivo.</strong> Son diapositivas de apoyo que solo pueden ser usadas durante el horario de clase, ya que es el docente quien puede irlas presentando. Permiten agilizar el procedimiento de cargar los comandos en RStudio.</p>
<ul>
<li><a href="https://slides.com/d/Sr5PEvY/live">Enlace a las diapositivas en vivo del taller 2.2a</a> Corresponde a operaciones matriciales básicas y a su aplicación con un análisis de componentes principales (pca), cuyo objetivo es la visualización de gradientes u ordenación de datos en planos cartesianos.</li>
<li><a href="https://slides.com/d/6ZVmlwQ/live">Enlace a las diapositivas en vivo del taller 2.2b</a> Corresponde a la aplicación de matrices con un análisis discrimiante lineal (lda), cuyo objetivo es la generación de funciones lineales que evalúen la calidad de la clasificación de observaciones en grupos previamente asignados (ej. individuos por tipo de sexos).</li>
</ul></li>
<li><p><strong>Material complementario.</strong> Revisar los siguientes enlaces complementarios:</p></li>
</ol>
<ul>
<li>📰<a href="https://javier-2712.github.io/Libro_andea/3.Algebra_lineal/Cap%C3%ADtulo3.html">Scripts del Ejemplo 3, del capítulo 3 del libro (Rodríuez-Barrios, J. 2023)</a></li>
</ul>
<hr>
<p><b style="color:#33a02c;"></b></p><b style="color:#33a02c;">
</b><section id="taller-2.2.-operaciones-matriciales-básicas" class="level3"><b style="color:#33a02c;">
<h3 class="anchored" data-anchor-id="taller-2.2.-operaciones-matriciales-básicas">Taller 2.2. Operaciones matriciales básicas</h3>
</b><p><b style="color:#33a02c;"></b></p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b><section id="producto-matricial" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="producto-matricial">1. Producto matricial</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Este ejercicio incluye una demostración al final.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejercicio 1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A (2,1,1,3)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># B (1,4,2,5,0,3)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular: (1) B'.A' (2) (A.B)' (3) Demostrar que B'.A' = (A.B)'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R./</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span>  <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">2</span>,<span class="at">byrow =</span> T)          <span class="co"># Matriz A</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span>  <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dv">2</span>,<span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)     <span class="co"># Matriz B</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    1
[2,]    1    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>B</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    2
[2,]    5    0    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) B'.A'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(B)<span class="sc">%*%</span><span class="fu">t</span>(A)    <span class="co"># %*%  representa el producto matricial, </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    7   16
[2,]    8    4
[3,]    7   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>               <span class="co"># "t" corresponde a la transpuesta de una matriz</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) (A.B)'</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A <span class="sc">%*%</span> B)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    7   16
[2,]    8    4
[3,]    7   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) B'.A' = (A.B)'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(B)<span class="sc">%*%</span><span class="fu">t</span>(A) <span class="sc">==</span> <span class="fu">t</span>(A <span class="sc">%*%</span> B)   <span class="co"># Demostración</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] TRUE TRUE
[2,] TRUE TRUE
[3,] TRUE TRUE</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="determinantes" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="determinantes">2. Determinantes</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Se calculará la determinante de dos matrices cuadradas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejercicio 2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A (2,3,3,2)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># B (1,4,2,5,0,3)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cacular: Determinante de A y de B</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#R./</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dv">3</span>,<span class="dv">3</span>,<span class="at">byrow =</span> T)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>A     </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    3
[2,]    3    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>B</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    2
[2,]    5    0    3
[3,]    1    4    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determinantes</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(A)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(B)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matriz-inversa" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matriz-inversa">3. Matriz inversa</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Cálculo de una matriz inversa (A)-1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejercicio 3</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A (5,2,2,2)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular inversa de A</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># R./</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>,<span class="at">byrow=</span>T)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    5    2
[2,]    2    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz inversa (solve)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">solve</span>(A),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]
[1,]  0.33 -0.33
[2,] -0.33  0.83</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matriz-de-varianza---covarianza" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matriz-de-varianza---covarianza">4. Matriz de varianza - covarianza</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Calcular la covaianza para dos matrices rectangulares</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>),<span class="dv">3</span>,<span class="dv">2</span>, <span class="at">byrow=</span> T)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">5</span>,<span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    2
[2,]    4    3
[3,]    6    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>B</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    3
[2,]    4    5
[3,]    6    7
[4,]    8    9
[5,]   10    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Covarianzas de cada matriz (c/grupo)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cov.A <span class="ot">=</span> <span class="fu">cov</span>(A)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>cov.B <span class="ot">=</span> <span class="fu">cov</span>(B)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]     [,2]
[1,]    4  7.00000
[2,]    7 14.33333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cov.B</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   10  1.0
[2,]    1  8.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) covarianza generalizada (S)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cov.g <span class="ot">=</span> (<span class="dv">3</span><span class="sc">*</span>(cov.A)<span class="sc">+</span><span class="dv">5</span><span class="sc">*</span>(cov.B))<span class="sc">/</span><span class="dv">8</span>  <span class="co"># cov.g corresponde a la covarianza generalizada</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>cov.g</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]  [,2]
[1,] 7.75  3.25
[2,] 3.25 10.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) covarianza generalizada invertida (S-1)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cov.g.i <span class="ot">=</span> <span class="fu">solve</span>(cov.g)   <span class="co"># cov.g.i representa a la covarianza gralizada invertida</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>cov.g.i</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]
[1,]  0.14827891 -0.04589585
[2,] -0.04589585  0.10944395</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.g.i,<span class="dv">2</span>)   <span class="co"># round corresponde al redondeo de decimales</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]
[1,]  0.15 -0.05
[2,] -0.05  0.11</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="valores-y-vectores-própios" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="valores-y-vectores-própios">5. Valores y Vectores própios</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Valores propios, se relacionan a la varianza explicada y los vectores própios al peso, la carga o relación de las variables con los ejes construidos en algunas técnicas como el pca.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular los valores y vectores própios de matriz de varianza-covarianza de A</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>),<span class="dv">3</span>,<span class="dv">2</span>, <span class="at">byrow=</span> T)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    2
[2,]    4    3
[3,]    6    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de covarianza de A</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>cov.A <span class="ot">=</span> <span class="fu">var</span>(A)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]     [,2]
[1,]    4  7.00000
[2,]    7 14.33333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores y vectores propios (autovalores - λ y auvectores - µ)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="do">## |A*λ*I| = 0</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A*µ = λ*µ</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>vv.cov.A <span class="ot">=</span> <span class="fu">eigen</span>(cov.A)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>vv.cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 17.8669221  0.4664112

$vectors
          [,1]       [,2]
[1,] 0.4506372 -0.8927072
[2,] 0.8927072  0.4506372</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovalores λ</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>val.cov.A <span class="ot">=</span> vv.cov.A<span class="sc">$</span>values</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>val.cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.8669221  0.4664112</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovectores µ</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>vec.cov.A <span class="ot">=</span> vv.cov.A<span class="sc">$</span>vectors</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>vec.cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]       [,2]
[1,] 0.4506372 -0.8927072
[2,] 0.8927072  0.4506372</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autovectores µ de la primera fila</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>vec.f1.cov.A <span class="ot">=</span> vec.cov.A[<span class="dv">1</span>,]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>vec.f1.cov.A</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.4506372 -0.8927072</code></pre>
</div>
</div>
<hr>
<p><b style="color:#33a02c;"></b></p><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b><section id="taller-2.2a-aplicaciones-de-matrices-análisis-de-componentes-principales---pca" class="level3"><b style="color:#33a02c;">
<h3 class="anchored" data-anchor-id="taller-2.2a-aplicaciones-de-matrices-análisis-de-componentes-principales---pca">Taller 2.2a Aplicaciones de matrices (Análisis de Componentes Principales - PCA)</h3>
</b><p><b style="color:#33a02c;"></b></p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b><section id="librerías-requeridas" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="librerías-requeridas">1. Librerías requeridas</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías o paquetes requeridos</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)    <span class="co"># Componente gráfico</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)      <span class="co"># Para el pca de forma automatizada</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Para la edición de las tablas </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="cargar-base-de-datos-datos1.csv" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="cargar-base-de-datos-datos1.csv">2. Cargar base de datos (datos1.csv)</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.2 Cargar la base de datos de Excel *.csv</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">=</span> <span class="fu">read.csv2</span>(<span class="st">"datos1.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)  </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>datos[<span class="dv">13</span>,]            <span class="co"># Falta un dato al estudiante 13</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo Longitud.total Cintura Longitud.espalda Long.brazo
Alumno 13    F            150    85.5               45         NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos)            <span class="co"># Estructura de la base de datos (NA)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   25 obs. of  5 variables:
 $ Sexo            : chr  "F" "F" "F" "F" ...
 $ Longitud.total  : int  170 160 156 173 170 165 170 181 175 186 ...
 $ Cintura         : num  85 80 88 63 86 89 88 80 76 45 ...
 $ Longitud.espalda: int  43 41 35 53 47 45 56 60 55 60 ...
 $ Long.brazo      : int  57 54 48 59 56 61 59 55 54 86 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">=</span><span class="fu">na.omit</span>(datos)  <span class="co"># na.omit, para eliminar al estudiante 13</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sexo"</span>,<span class="st">"LTot"</span>,<span class="st">"Cint"</span>,<span class="st">"LEsp"</span>,<span class="st">"LBra"</span>)    <span class="co"># Rótulos de la base de datos</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Formato de tablas con el paquete kableExtra (head muestra solo 6 filas de la tabla)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sexo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LTot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEsp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LBra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alumno 1</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 2</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 3</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 4</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 5</td>
<td style="text-align: left;">M</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 6</td>
<td style="text-align: left;">M</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">61</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="cálculo-de-la-matriz-centrada-de-las-variables-morfométricas" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="cálculo-de-la-matriz-centrada-de-las-variables-morfométricas">3. Cálculo de la matriz centrada de las variables morfométricas</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">=</span> datos[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)]          <span class="co"># Variables morfométricas</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>promedio <span class="ot">=</span> <span class="fu">colMeans</span>(variables)      <span class="co"># Promedios de las variables</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>promedio</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     LTot      Cint      LEsp      LBra 
166.66667  76.83333  45.37500  60.79167 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>m.centrada <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(variables) <span class="sc">-</span> promedio) <span class="co"># Restar cada dato a los promedios</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Encabezado de la matriz centrada con las seis primeras filas</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(m.centrada,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LTot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cint</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LEsp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LBra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alumno 1</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">8.17</td>
<td style="text-align: right;">-2.38</td>
<td style="text-align: right;">-3.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 2</td>
<td style="text-align: right;">-6.67</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">-4.38</td>
<td style="text-align: right;">-6.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 3</td>
<td style="text-align: right;">-10.67</td>
<td style="text-align: right;">11.17</td>
<td style="text-align: right;">-10.38</td>
<td style="text-align: right;">-12.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 4</td>
<td style="text-align: right;">6.33</td>
<td style="text-align: right;">-13.83</td>
<td style="text-align: right;">7.62</td>
<td style="text-align: right;">-1.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 5</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">9.17</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">-4.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 6</td>
<td style="text-align: right;">-1.67</td>
<td style="text-align: right;">12.17</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.21</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="valores-y-vectores-própios-de-la-matriz-de-covarianzas-centradas" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="valores-y-vectores-própios-de-la-matriz-de-covarianzas-centradas">4. Valores y Vectores própios de la Matriz de covarianzas centradas</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Cálculo de valores y vectores propios</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(m.centrada),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           LTot   Cint   LEsp   LBra
Alumno 1   3.33   8.17  -2.38  -3.79
Alumno 2  -6.67   3.17  -4.38  -6.79
Alumno 3 -10.67  11.17 -10.38 -12.79
Alumno 4   6.33 -13.83   7.62  -1.79
Alumno 5   3.33   9.17   1.62  -4.79
Alumno 6  -1.67  12.17  -0.38   0.21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>S.centrada <span class="ot">=</span> <span class="fu">cov</span>(m.centrada)   <span class="co"># Matriz de varianza y covarianzas centrada</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(S.centrada,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      LTot   Cint  LEsp   LBra
LTot 68.41   4.38 56.35  32.75
Cint  4.38 221.19 -3.67 -45.99
LEsp 56.35  -3.67 67.20  11.26
LBra 32.75 -45.99 11.26 108.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>vv.propios<span class="ot">=</span> <span class="fu">eigen</span>(S.centrada)    <span class="co"># Vectores y valores propios de m.centrada</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>vv.propios</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 238.551229 141.646198  77.460019   8.092554

$vectors
            [,1]       [,2]       [,3]        [,4]
[1,] -0.06532082 -0.6446607  0.2348736  0.72455510
[2,]  0.93124818 -0.2601970 -0.2459119 -0.06783569
[3,] -0.06460934 -0.5458245  0.5144348 -0.65822342
[4,] -0.35261262 -0.4677453 -0.7872220 -0.19276967</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer los vectores propios (vec.propios)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>vec.propios<span class="ot">=</span>   vv.propios<span class="sc">$</span>vectors                </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vec.propios,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] -0.07 -0.64  0.23  0.72
[2,]  0.93 -0.26 -0.25 -0.07
[3,] -0.06 -0.55  0.51 -0.66
[4,] -0.35 -0.47 -0.79 -0.19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>vec.propios2 <span class="ot">=</span>   vv.propios<span class="sc">$</span>vectors[,<span class="dv">2</span>]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>vec.propios2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6446607 -0.2601970 -0.5458245 -0.4677453</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz centrada en formato matricial</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>m.centrada <span class="ot">=</span> <span class="fu">as.matrix</span> (m.centrada)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.centrada)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               LTot       Cint    LEsp        LBra
Alumno 1   3.333333   8.166667  -2.375  -3.7916667
Alumno 2  -6.666667   3.166667  -4.375  -6.7916667
Alumno 3 -10.666667  11.166667 -10.375 -12.7916667
Alumno 4   6.333333 -13.833333   7.625  -1.7916667
Alumno 5   3.333333   9.166667   1.625  -4.7916667
Alumno 6  -1.666667  12.166667  -0.375   0.2083333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pca = matriz rotada (m.rotada)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>m.rotada <span class="ot">=</span> m.centrada <span class="sc">%*%</span> vec.propios</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m.rotada) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CP1"</span>, <span class="st">"CP2"</span>, <span class="st">"CP3"</span>, <span class="st">"CP4"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Encabezado de la matriz centrada con las seis primeras filas</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(m.rotada,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CP1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CP2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CP3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CP4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alumno 1</td>
<td style="text-align: right;">8.88</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">4.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 2</td>
<td style="text-align: right;">6.06</td>
<td style="text-align: right;">9.04</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">-0.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 3</td>
<td style="text-align: right;">16.28</td>
<td style="text-align: right;">15.62</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 4</td>
<td style="text-align: right;">-13.16</td>
<td style="text-align: right;">-3.81</td>
<td style="text-align: right;">10.22</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 5</td>
<td style="text-align: right;">9.90</td>
<td style="text-align: right;">-3.18</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">1.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 6</td>
<td style="text-align: right;">11.39</td>
<td style="text-align: right;">-1.98</td>
<td style="text-align: right;">-3.74</td>
<td style="text-align: right;">-1.83</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="figuras-de-la-matriz-proyectada-m.rotada" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="figuras-de-la-matriz-proyectada-m.rotada">5. Figuras de la matriz proyectada “m.Rotada”</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura sin editar</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.rotada)  <span class="co"># m.Rotada es la matriz rotada</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2.2.Introd.matrices_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura editada </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.rotada, <span class="at">asp=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab=</span><span class="st">"CP1"</span>, <span class="at">ylab=</span><span class="st">"CP2"</span>)           <span class="co"># Rótulos de los ejes</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(m.rotada, <span class="at">labels =</span><span class="fu">row.names</span>(datos),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos=</span><span class="dv">3</span>, <span class="at">cex=</span><span class="fl">0.7</span>)                <span class="co"># cex() relaciona el tamaño del texto</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)           <span class="co"># abline (h=0) línea horizontal del plano cartesiano</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)           <span class="co"># abline (v=0) línea vertical del plano cartesiano</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()              <span class="co"># Grilla en la figura</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2.2.Introd.matrices_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Opción gráfica en ggplot</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(m.rotada, <span class="fu">aes</span>(<span class="at">x =</span> CP1, <span class="at">y =</span> CP2, <span class="at">label =</span> <span class="fu">rownames</span>(m.rotada))) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span>      <span class="co"># Puntos en el gráfico</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(m.rotada)), </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>       <span class="co"># Etiquetas con posición ajustada</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span> <span class="dv">0</span>,<span class="at">color=</span> <span class="st">"red"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Línea horizontal</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span> <span class="dv">0</span>,<span class="at">color=</span> <span class="st">"red"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Línea vertical</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"CP1"</span>, <span class="at">y =</span> <span class="st">"CP2"</span>) <span class="sc">+</span>              <span class="co"># Rótulos de los ejes</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>() <span class="sc">+</span>                            <span class="co"># Agregar una grilla</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()                                <span class="co"># Formato de la figura</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2.2.Introd.matrices_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="comparar-con-el-análisis-de-componentes-principales---pca" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="comparar-con-el-análisis-de-componentes-principales---pca">6. Comparar con el Análisis de Componentes Principales - pca</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos del procedimiento 2.1) Sumas y norma de los vectores</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])             <span class="co"># Variables y observaciones (estudiantes)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LTot Cint LEsp LBra
Alumno 1  170   85   43   57
Alumno 2  160   80   41   54
Alumno 3  156   88   35   48
Alumno 4  173   63   53   59
Alumno 5  170   86   47   56
Alumno 6  165   89   45   61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(datos[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])       <span class="co"># Realización del pca</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)            <span class="co"># Figura del pca</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"blue"</span>)         <span class="co"># abline (h=0) línea horizontal del plano cartesiano</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"blue"</span>)         <span class="co"># abline (v=0) línea vertical del plano cartesiano</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2.2.Introd.matrices_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><b style="color:#33a02c;"></b></p><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b><section id="taller-2.2b-aplicaciones-de-matrices-análisis-discriminante-lineal---lda" class="level3"><b style="color:#33a02c;">
<h3 class="anchored" data-anchor-id="taller-2.2b-aplicaciones-de-matrices-análisis-discriminante-lineal---lda">Taller 2.2b Aplicaciones de matrices (Análisis discriminante lineal - LDA)</h3>
</b><p><b style="color:#33a02c;"></b></p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b><section id="cargar-las-librerías-o-paquetes-de-r" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="cargar-las-librerías-o-paquetes-de-r">1. Cargar las librerías o paquetes de R</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías o paquetes requeridos </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)    <span class="co"># Componente gráfico </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)      <span class="co"># Para el pca de forma automatizada </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Para la edición de las tablas </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="cargar-base-de-datos-datos1.csv-1" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="cargar-base-de-datos-datos1.csv-1">2. Cargar base de datos (datos1.csv)</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la base de datos de Excel *.csv</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">=</span> <span class="fu">read.csv2</span>(<span class="st">"datos1.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)  </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos2)     <span class="co"># Falta un dato al estudiante 13</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Sexo Longitud.total Cintura Longitud.espalda Long.brazo
Alumno 1    F            170      85               43         57
Alumno 2    F            160      80               41         54
Alumno 3    F            156      88               35         48
Alumno 4    F            173      63               53         59
Alumno 5    M            170      86               47         56
Alumno 6    M            165      89               45         61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos2)      <span class="co"># Estructura de la base de datos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   25 obs. of  5 variables:
 $ Sexo            : chr  "F" "F" "F" "F" ...
 $ Longitud.total  : int  170 160 156 173 170 165 170 181 175 186 ...
 $ Cintura         : num  85 80 88 63 86 89 88 80 76 45 ...
 $ Longitud.espalda: int  43 41 35 53 47 45 56 60 55 60 ...
 $ Long.brazo      : int  57 54 48 59 56 61 59 55 54 86 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">=</span> <span class="fu">na.omit</span>(datos2)  <span class="co"># Eliminar estudiantes con datos faltantes (estud. 13)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Sexo"</span>, <span class="st">"LTot"</span>, <span class="st">"Cint"</span>, <span class="st">"LEsp"</span>, <span class="st">"LBra"</span>) <span class="co"># Abreviaturas de las variables</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos2) <span class="co"># Muestra las primeras seis filas de la base de datos (datos2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Sexo LTot Cint LEsp LBra
Alumno 1    F  170   85   43   57
Alumno 2    F  160   80   41   54
Alumno 3    F  156   88   35   48
Alumno 4    F  173   63   53   59
Alumno 5    M  170   86   47   56
Alumno 6    M  165   89   45   61</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matrices-por-cada-sexo" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matrices-por-cada-sexo">3. Matrices por cada sexo</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de variables para los hombres</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>hombres <span class="ot">=</span> datos2[datos2<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"M"</span>,]</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hombres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 5     M  170   86   47   56
Alumno 6     M  165   89   45   61
Alumno 7     M  170   88   56   59
Alumno 8     M  181   80   60   55
Alumno 9     M  175   76   55   54
Alumno 10    M  186   45   60   86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mujeres <span class="ot">=</span> datos2[datos2<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"F"</span>,]</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mujeres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 1     F  170   85   43   57
Alumno 2     F  160   80   41   54
Alumno 3     F  156   88   35   48
Alumno 4     F  173   63   53   59
Alumno 11    F  168   65   49   55
Alumno 12    F  155   70   36   50</code></pre>
</div>
</div>
<p><strong>Opción en Tidyverse</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de hombres (hombres)</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>hombres <span class="ot">=</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"M"</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hombres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 5     M  170   86   47   56
Alumno 6     M  165   89   45   61
Alumno 7     M  170   88   56   59
Alumno 8     M  181   80   60   55
Alumno 9     M  175   76   55   54
Alumno 10    M  186   45   60   86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de mujeres (mujeres)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mujeres <span class="ot">=</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"F"</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mujeres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 1     F  170   85   43   57
Alumno 2     F  160   80   41   54
Alumno 3     F  156   88   35   48
Alumno 4     F  173   63   53   59
Alumno 11    F  168   65   49   55
Alumno 12    F  155   70   36   50</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="vectores-de-medias-para-hombres-y-muejeres-m1-y-m2" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="vectores-de-medias-para-hombres-y-muejeres-m1-y-m2">4. Vectores de medias para hombres y muejeres (M1 y M2)</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comando colMeans para el cálculo de los vectores de media</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>promedio.h <span class="ot">=</span> <span class="fu">colMeans</span>(hombres[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)])</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>promedio.h</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> LTot  Cint  LEsp  LBra 
173.3  83.4  52.0  62.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>promedio.m <span class="ot">=</span> <span class="fu">colMeans</span>(mujeres[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)])</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>promedio.m</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     LTot      Cint      LEsp      LBra 
161.92857  72.14286  40.64286  59.57143 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la matriz centrada por cada sexo</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>m.centrada.h <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">t</span>(hombres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">-</span> promedio.h)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.centrada.h)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          LTot  Cint LEsp LBra
Alumno 5  -3.3   2.6   -5 -6.5
Alumno 6  -8.3   5.6   -7 -1.5
Alumno 7  -3.3   4.6    4 -3.5
Alumno 8   7.7  -3.4    8 -7.5
Alumno 9   1.7  -7.4    3 -8.5
Alumno 10 12.7 -38.4    8 23.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>m.centrada.m <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">t</span>(mujeres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">-</span> promedio.m)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m.centrada.m) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               LTot      Cint       LEsp        LBra
Alumno 1   8.071429 12.857143  2.3571429  -2.5714286
Alumno 2  -1.928571  7.857143  0.3571429  -5.5714286
Alumno 3  -5.928571 15.857143 -5.6428571 -11.5714286
Alumno 4  11.071429 -9.142857 12.3571429  -0.5714286
Alumno 11  6.071429 -7.142857  8.3571429  -4.5714286
Alumno 12 -6.928571 -2.142857 -4.6428571  -9.5714286</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="diferencia-y-suma-en-los-vectores-de-media-m1-m2-y-m1m2" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="diferencia-y-suma-en-los-vectores-de-media-m1-m2-y-m1m2">5. Diferencia y suma en los vectores de media (M1-M2 y M1+M2)</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferencia de medias (M1-M2)'</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>dif <span class="ot">=</span> <span class="fu">t</span>(promedio.h <span class="sc">-</span> promedio.m)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>dif</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LTot     Cint     LEsp     LBra
[1,] 11.37143 11.25714 11.35714 2.928571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suma de medias (M1 + M2)  </span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">=</span> promedio.h <span class="sc">+</span> promedio.m</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>sum</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     LTot      Cint      LEsp      LBra 
335.22857 155.54286  92.64286 122.07143 </code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matriz-de-varianza-covarianza-por-sexos-y-la-generalizada" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matriz-de-varianza-covarianza-por-sexos-y-la-generalizada">6. Matriz de varianza covarianza por sexos y la generalizada</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianzas - Covarianzas de hombres</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>cov.h <span class="ot">=</span> <span class="fu">var</span>(hombres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.h,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       LTot    Cint   LEsp    LBra
LTot  37.57  -79.02  27.11   30.17
Cint -79.02  347.16 -57.00 -116.89
LEsp  27.11  -57.00  37.11   -5.22
LBra  30.17 -116.89  -5.22  134.28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianzas - Covarianzas de mujeres</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>cov.m <span class="ot">=</span> <span class="fu">var</span>(mujeres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.m,<span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      LTot   Cint   LEsp   LBra
LTot 36.99   5.01  22.97  22.12
Cint  5.01  94.13 -24.41 -15.24
LEsp 22.97 -24.41  35.32   8.60
LBra 22.12 -15.24   8.60  95.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tamaño de muestra (n+umero de filas) por cada sexo</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>datos2<span class="sc">$</span>Sexo <span class="ot">=</span> <span class="fu">as.factor</span>(datos2<span class="sc">$</span>Sexo)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos2<span class="sc">$</span>Sexo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> F  M 
14 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianzas - covarianzas generalizadas (cov.g)</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cov.g = (n.h * cov.h + n.m * cov.m)/N</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>cov.g <span class="ot">=</span> (<span class="dv">10</span><span class="sc">*</span>cov.h <span class="sc">+</span> <span class="dv">14</span><span class="sc">*</span>cov.m)<span class="sc">/</span><span class="dv">24</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.g,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       LTot   Cint   LEsp   LBra
LTot  37.23 -30.00  24.70  25.47
Cint -30.00 199.56 -37.99 -57.59
LEsp  24.70 -37.99  36.07   2.84
LBra  25.47 -57.59   2.84 111.92</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># varianzas - covarianzas generalizadas e invertidas (S^-1)</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>cov.g.i <span class="ot">=</span> <span class="fu">solve</span>(cov.g)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.g.i,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      LTot Cint  LEsp  LBra
LTot  0.07 0.00 -0.05 -0.02
Cint  0.00 0.01  0.01  0.00
LEsp -0.05 0.01  0.07  0.01
LBra -0.02 0.00  0.01  0.01</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="función-discriminante-wi-wall-y-anderson" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="función-discriminante-wi-wall-y-anderson">7. Función discriminante Wi (Wall y Anderson)</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Wx = [(M1 - M1)’ * S^-1 * xi] - [1/2 * (M1 - M2)’ * S^-1 * (M1 + M2)]</p>
<p><b style="color:#8da0cb;"></b></p><b style="color:#8da0cb;">
</b><section id="selección-de-10-estudiantes." class="level5"><b style="color:#8da0cb;">
<h5 class="anchored" data-anchor-id="selección-de-10-estudiantes.">7.1 Selección de 10 estudiantes.</h5>
</b><p><b style="color:#8da0cb;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir datos2 a formato matricial como datos3</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>datos3 <span class="ot">=</span> <span class="fu">as.matrix</span> (datos2[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LTot Cint LEsp LBra
Alumno 1  170   85   43   57
Alumno 2  160   80   41   54
Alumno 3  156   88   35   48
Alumno 4  173   63   53   59
Alumno 5  170   86   47   56
Alumno 6  165   89   45   61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para el ejercicio, solo usarémos los 10 primeros estudiantes</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 primeros estudiantes como vectores (xi)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">1</span>,])   <span class="co"># x1 Estudiante 1 [1,] es fila 1</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">2</span>,])</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">3</span>,])</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">4</span>,])</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">5</span>,])</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">6</span>,])</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>x7 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">7</span>,])</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>x8 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">8</span>,])</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>x9 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">9</span>,])</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>x10 <span class="ot">=</span> <span class="fu">as.vector</span> (datos3[<span class="dv">10</span>,])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#8da0cb;"></b></p><b style="color:#8da0cb;">
</b></section><b style="color:#8da0cb;">
</b><section id="discriminante-de-los-10-primeros-estudiantes" class="level5"><b style="color:#8da0cb;">
<h5 class="anchored" data-anchor-id="discriminante-de-los-10-primeros-estudiantes">7.2 Discriminante de los 10 primeros estudiantes</h5>
</b><p><b style="color:#8da0cb;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wx = [(M1 - M1)' * S^-1 * xi] - [1/2 * (M1 - M2)' * S^-1 * (M1 + M2)]</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>W1 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x1) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>W2 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x2) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>W3 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x3) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>W4 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x4) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>W5 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x5) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>W6 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x6) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>W7 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x7) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>W8 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x8) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>W9 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x9) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>W10 <span class="ot">=</span> ((dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x10) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (dif <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#8da0cb;"></b></p><b style="color:#8da0cb;">
</b></section><b style="color:#8da0cb;">
</b><section id="crear-base-de-datos-con-los-discriminantes-da" class="level5"><b style="color:#8da0cb;">
<h5 class="anchored" data-anchor-id="crear-base-de-datos-con-los-discriminantes-da">7.3 Crear base de datos con los discriminantes (da)</h5>
</b><p><b style="color:#8da0cb;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupación de los 10 valores discriminados</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>da <span class="ot">=</span> <span class="fu">data.frame</span>(W1,W2,W3,W4,W5,W6,W7,W8,W9,W10)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>da <span class="ot">=</span> <span class="fu">t</span>(da)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>da</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
W1  -0.1271618
W2  -3.2658277
W3  -5.2816257
W4   0.6418749
W5   1.6137960
W6   1.1092793
W7   5.8997846
W8   7.1499551
W9   3.5922827
W10  4.0483574</code></pre>
</div>
</div>
<p><b style="color:#8da0cb;"></b></p><b style="color:#8da0cb;">
</b></section><b style="color:#8da0cb;">
</b><section id="base-de-datos-con-grupos-iniciales-y-los-discriminados" class="level5"><b style="color:#8da0cb;">
<h5 class="anchored" data-anchor-id="base-de-datos-con-grupos-iniciales-y-los-discriminados">7.4 Base de datos con grupos iniciales y los discriminados</h5>
</b><p><b style="color:#8da0cb;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>grupo.i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">6</span>],<span class="at">each=</span><span class="dv">4</span>),</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rep</span>(LETTERS[<span class="dv">13</span>],<span class="at">each=</span><span class="dv">6</span>))    <span class="co"># Grupos iniciales u originales</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>grupo.i</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "F" "F" "F" "F" "M" "M" "M" "M" "M" "M"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>grupo.d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">6</span>],<span class="at">each=</span><span class="dv">3</span>),</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rep</span>(LETTERS[<span class="dv">13</span>],<span class="at">each=</span><span class="dv">7</span>))    <span class="co"># Grupos discriminados con el modelo lineal</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>grupo.d</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "F" "F" "F" "M" "M" "M" "M" "M" "M" "M"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>datos.d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lda=</span> <span class="fu">round</span>(da,<span class="dv">2</span>), grupo.i, grupo.d)    <span class="co"># Dataframe con el comparativo de los grupos y de los valores discriminados</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Encabezado de la matriz centrada con las seis primeras filas</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>datos.d <span class="sc">%&gt;%</span> </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lda</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">grupo.i</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">grupo.d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">W1</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">W2</td>
<td style="text-align: right;">-3.27</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">W3</td>
<td style="text-align: right;">-5.28</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">W4</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">W5</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">W6</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">W7</td>
<td style="text-align: right;">5.90</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">W8</td>
<td style="text-align: right;">7.15</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="odd">
<td style="text-align: left;">W9</td>
<td style="text-align: right;">3.59</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">W10</td>
<td style="text-align: right;">4.05</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="análisis-de-contingencia" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="análisis-de-contingencia">8. Análisis de contingencia</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Validación cruzada que compara los aciertos de la clasificación inicial de los estudiantes en sus sexos, con la clasificación del lda. Como solo un estudiante femenino clasificó en el grupo masculino, el porcentaje de acierto fue del 90%, para los 10 estudiantes discriminados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de contingencia</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>tabla_contingencia <span class="ot">=</span> <span class="fu">table</span>(grupo.d,grupo.i)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>tabla_contingencia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       grupo.i
grupo.d F M
      F 3 0
      M 1 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aciertos</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>aciertos <span class="ot">=</span><span class="fu">sum</span>(<span class="fu">diag</span>(tabla_contingencia))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>aciertos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total de estudiantes</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">=</span> <span class="fu">sum</span>(tabla_contingencia)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de aciertos</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>aciertos2 <span class="ot">=</span> (aciertos<span class="sc">/</span>total)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>aciertos2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<hr>
<p><b style="color:#33a02c;"></b></p><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b></section><b style="color:#33a02c;">
</b><section id="lda-con-tidyverse" class="level3"><b style="color:#33a02c;">
<h3 class="anchored" data-anchor-id="lda-con-tidyverse">LDA con tidyverse</h3>
</b><p><b style="color:#33a02c;"></b></p>
<p>Se realizará el ejercicio anterios pero con algunos comandos de tidyverse los cuales permiten automatizar de una forma más intuitiva al proceso matricial para el análisis discriminante lineal - lda, de los estudiantes.</p>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b><section id="librerías-requeridas-1" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="librerías-requeridas-1">1. Librerías requeridas</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librerías para los cálculos y las figuras</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)    <span class="co"># Para figuras estadísticas (varios factores)</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)         <span class="co"># Para figuras estadísticas (varios factores)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="lectura-de-la-base-de-datos." class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="lectura-de-la-base-de-datos.">2. Lectura de la base de datos.</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Para este caso se utilizará la versión ajustada de <strong>datos2</strong>, del ejercicio anterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de la base de datos</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Sexo LTot Cint LEsp LBra
Alumno 1    F  170   85   43   57
Alumno 2    F  160   80   41   54
Alumno 3    F  156   88   35   48
Alumno 4    F  173   63   53   59
Alumno 5    M  170   86   47   56
Alumno 6    M  165   89   45   61</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="vectores-de-medias" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="vectores-de-medias">3. Vectores de medias</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupar por sexos y calculo de medias</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>medias <span class="ot">=</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,mean))</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>medias</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Sexo   LTot  Cint  LEsp  LBra
  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 F      162.  72.1  40.6  59.6
2 M      173.  83.4  52    62.5</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="vectores-de-diferencias-y-sumas-de-medias" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="vectores-de-diferencias-y-sumas-de-medias">4. Vectores de diferencias y sumas de medias</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>La diferencia para este caso, es que se transpone el vector de diferencias y el de suma de medias.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector de diferencia de medias (dif)</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>dif <span class="ot">=</span> <span class="fu">as.matrix</span>(medias[medias<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"M"</span>, <span class="sc">-</span><span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">as.matrix</span>(medias[medias<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"F"</span>, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>dif <span class="ot">=</span> <span class="fu">t</span>(dif)  <span class="co"># Vector de diferencia de me medias transpuesto</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">=</span> <span class="fu">as.matrix</span>(medias[medias<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"M"</span>, <span class="sc">-</span><span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">as.matrix</span>(medias[medias<span class="sc">$</span>Sexo <span class="sc">==</span> <span class="st">"F"</span>, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">=</span> <span class="fu">t</span>(sum)   <span class="co"># vector suma de medias transpuesto</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matriz-por-cada-sexo" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matriz-por-cada-sexo">5. Matriz por cada sexo</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de hombres (hombres)</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>hombres <span class="ot">=</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"M"</span>)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hombres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 5     M  170   86   47   56
Alumno 6     M  165   89   45   61
Alumno 7     M  170   88   56   59
Alumno 8     M  181   80   60   55
Alumno 9     M  175   76   55   54
Alumno 10    M  186   45   60   86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de mujeres (mujeres)</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>mujeres <span class="ot">=</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"F"</span>)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mujeres)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Sexo LTot Cint LEsp LBra
Alumno 1     F  170   85   43   57
Alumno 2     F  160   80   41   54
Alumno 3     F  156   88   35   48
Alumno 4     F  173   63   53   59
Alumno 11    F  168   65   49   55
Alumno 12    F  155   70   36   50</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="matriz-de-varianza-covarianza-generalizada-e-invertida-s-1" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="matriz-de-varianza-covarianza-generalizada-e-invertida-s-1">6. Matriz de varianza-covarianza generalizada e invertida S-1</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar los datos por sexo</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>hombres <span class="ot">&lt;-</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"M"</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>mujeres <span class="ot">&lt;-</span> </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sexo <span class="sc">==</span> <span class="st">"F"</span>)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Covarianza de hombres (cov.h)</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>cov.h <span class="ot">&lt;-</span> </span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>  hombres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>()</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Covarianza de mujeres (cov.m)</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>cov.m <span class="ot">&lt;-</span> </span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>  mujeres[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>()</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la columna Sexo en factor</span></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">&lt;-</span> </span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sexo =</span> <span class="fu">as.factor</span>(Sexo))</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Tamaño de la muestra (número de estudiantes por sexo)</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>n.h <span class="ot">&lt;-</span> <span class="fu">nrow</span>(hombres)</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>n.m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mujeres)</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de varianza-covarianza generalizada</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>cov.g <span class="ot">&lt;-</span> (n.h <span class="sc">*</span> cov.h <span class="sc">+</span> n.m <span class="sc">*</span> cov.m) <span class="sc">/</span> (n.h <span class="sc">+</span> n.m)</span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>cov.g.i <span class="ot">&lt;-</span> <span class="fu">solve</span>(cov.g)</span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov.g.i, <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       LTot   Cint   LEsp   LBra
LTot  0.067 -0.004 -0.049 -0.016
Cint -0.004  0.008  0.010  0.005
LEsp -0.049  0.010  0.071  0.015
LBra -0.016  0.005  0.015  0.015</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="función-para-automatizar-el-lda" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="función-para-automatizar-el-lda">7. Función para automatizar el lda</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>La siguiente función, permite ahorrar varios pasos, porque discrimina a todos los estudiantes (observaciones o filas de la base de datos), haya los vectores y la función discriminante de cada estudiante y realiza las tabla que compara a la clasificación inicial por sexos vs.&nbsp;la clasificación del modelo del discriminante lineal - lda. Esta función resume a todo el paso 7 del ejercicio anterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función discriminante para todos los estudiantes</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>lda <span class="ot">&lt;-</span> datos2[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)  <span class="co"># Convertir x a un vector columna (4x1)</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> (<span class="fu">t</span>(dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> x) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">t</span>(dif) <span class="sc">%*%</span> cov.g.i <span class="sc">%*%</span> sum)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(W)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(<span class="at">Alumnos =</span> <span class="fu">rownames</span>(datos2), <span class="at">resultados_W =</span> .) <span class="sc">%&gt;%</span>        <span class="co"># Redondear a 2 decimales</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sexo_discriminado =</span> <span class="fu">ifelse</span>(resultados_W <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"F"</span>, <span class="st">"M"</span>),  <span class="co"># Discriminante</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sexo_original =</span> datos2<span class="sc">$</span>Sexo)  <span class="co"># Añadir columna con el sexo original</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Encabezado de la matriz centrada con las seis primeras filas</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lda) <span class="sc">%&gt;%</span> </span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Alumnos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">resultados_W</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sexo_discriminado</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sexo_original</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alumno 1</td>
<td style="text-align: right;">-0.1271618</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 2</td>
<td style="text-align: right;">-3.2658277</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 3</td>
<td style="text-align: right;">-5.2816257</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 4</td>
<td style="text-align: right;">0.6418749</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alumno 5</td>
<td style="text-align: right;">1.6137960</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alumno 6</td>
<td style="text-align: right;">1.1092793</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">M</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="análisis-de-contingencia-1" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="análisis-de-contingencia-1">8. Análisis de contingencia</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<p>Validación cruzada que compara los aciertos de la clasificación inicial de los estudiantes en sus sexos, con la clasificación del lda. Como solo un estudiante femenino clasificó en el grupo masculino, el porcentaje de acierto fue del 95.8%, mucho mayor al del ejercicio anterior, debido a que se utilizan los 24 estudiantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(lda)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear tabla de contingencia</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>tabla_contingencia <span class="ot">=</span> <span class="fu">table</span>(Sexo_discriminado,Sexo_original)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>tabla_contingencia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Sexo_original
Sexo_discriminado  F  M
                F 13  0
                M  1 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aciertos</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>aciertos <span class="ot">=</span><span class="fu">sum</span>(<span class="fu">diag</span>(tabla_contingencia))</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>aciertos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total de estudiantes</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">=</span> <span class="fu">sum</span>(tabla_contingencia)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>total</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de aciertos</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>aciertos2 <span class="ot">=</span> (aciertos<span class="sc">/</span>total)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>aciertos2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95.83333</code></pre>
</div>
</div>
<p><b style="color:#fc8d62;"></b></p><b style="color:#fc8d62;">
</b></section><b style="color:#fc8d62;">
</b><section id="análisis-gráfico" class="level4"><b style="color:#fc8d62;">
<h4 class="anchored" data-anchor-id="análisis-gráfico">9. Análisis gráfico</h4>
</b><p><b style="color:#fc8d62;"></b></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico de cajas para clasificación inicial</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>fig_inicial <span class="ot">=</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(lda, <span class="fu">aes</span>(<span class="at">x=</span> Sexo_original, <span class="at">y=</span> resultados_W, <span class="at">fill=</span> Sexo_original)) <span class="sc">+</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"lda para clasificación inicial"</span>,</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Sexo Original"</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Grupos iniciales"</span>) <span class="sc">+</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico de cajas para clasificación con el lda</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>fig_discriminada <span class="ot">=</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(lda, <span class="fu">aes</span>(<span class="at">x=</span> Sexo_discriminado, <span class="at">y=</span> resultados_W, <span class="at">fill=</span> Sexo_discriminado)) <span class="sc">+</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"lda para clasificación con lda"</span>,</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Sexo Discriminado"</span>,</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Grupos discriminados (lda)"</span>) <span class="sc">+</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar las dos figuras en un solo panel</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(fig_inicial, fig_discriminada, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2.2.Introd.matrices_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</div></section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/Javier-2712\/Manuales\/tree\/main\/7\.Manual_mv");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Taller2.1.Introducción.html" class="pagination-link" aria-label="Taller2.1 Intro_RStudio">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Taller2.1 Intro_RStudio</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Taller3.1.exploratorios.html" class="pagination-link" aria-label="Taller3. Exploratorios_mv">
        <span class="nav-page-text">Taller3. Exploratorios_mv</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>