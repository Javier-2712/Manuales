[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Repositorio de Talleres de Multivariados - 2024-I",
    "section": "",
    "text": "Resumen\n\nRepositorio de Talleres de Multivariados - 2024-I\n\n\nJavier Rodr√≠guez-Barrios\n\n\nPrograma de Biolog√≠a\n\n\n‚ÄúActualizado: 2024-02-14‚Äù\n\n\n\nEl siguiente documento es un compendio de temas vistos en el componente pr√°ctico de la asignatura Estad√≠stica Multivariada del programa de Biolog√≠a. Se fundamenta en cinco grandes m√≥dulos:\n\nIntroducci√≥n al RStudio y al algebra lineal aplicada a multivariados. \nExloraci√≥n y visualizaci√≥n gr√°fica de datos univariados y multivariados. \nT√©cnicas de ordenaci√≥n multivariada (PCA y NMDS). \nT√©cnicas de clasificaci√≥n multivariada (CLA y LDA) \nPruebas de hip√≥tesis (MANOVAS y PERMANOVAS). \n\nPara un mejor entendimiento de este manual, se sugiere complementar la informaci√≥n con las referencias bibliogr√°ficas sugeridas en cada capitulo, especialmente el libro **An√°lisis de datos ecol√≥gicos y ambientales - aplicaciones en el programa R‚Äù de Rodr√≠guez-Barrios (2023) enlace_libro.\n\n\n\nLibro Gu√≠a de la asignatura\n\n\nEnlace de los archivos complementarios, para los ejercicios del libro"
  },
  {
    "objectID": "Videos_clases.html#section",
    "href": "Videos_clases.html#section",
    "title": "Videos_clases",
    "section": "",
    "text": "Video\n[ Im√°gen tomada de Iokanan Pro ]\n\n\nLos siguientes videos en su mayor√≠a fueron realizados en el 2021, pero a√∫n presentan vigencia, con relaci√≥n a lo que venimos revisando en las clases. Sugiero que este material sea complementado con el resto de documentos que he entregado.\nDe igual forma, los videos que se presentan a continuaci√≥n, pueden complementarse con el libro gu√≠a del docente, cuya versi√≥n impresa se encuentra en la biblioteca de la Universidad. Pr√≥ximamente les enviar√© el link a la versi√≥n digital.\nRodr√≠guez-Barrios, J. (2023). An√°lisis de datos ecol√≥gicos y ambientales: aplicaciones con programa R. Ediciones D√≠az de Santos. üìñEnlace_Libro\n\n\nüìàEnlace de los archivos complementarios, para los ejercicios del libro"
  },
  {
    "objectID": "Videos_clases.html#section-1",
    "href": "Videos_clases.html#section-1",
    "title": "1¬† Videos_clases",
    "section": "1.2 ",
    "text": "1.2"
  },
  {
    "objectID": "Videos_clases.html#introducci√≥n-a-la-asignatura",
    "href": "Videos_clases.html#introducci√≥n-a-la-asignatura",
    "title": "Videos_clases",
    "section": " 1. Introducci√≥n a la asignatura ",
    "text": "1. Introducci√≥n a la asignatura \n\n[ Im√°gen tomada de Lukas ]\n\nüé•1.1 Pautas de la asignatura\nüé•1.2 Pautas - parte 2\nüé•1.3 Contexto Introductorio"
  },
  {
    "objectID": "Videos_clases.html#section-2",
    "href": "Videos_clases.html#section-2",
    "title": "1¬† Videos_clases",
    "section": "2.2 ",
    "text": "2.2"
  },
  {
    "objectID": "Videos_clases.html#introducci√≥n-a-r-y-algebra",
    "href": "Videos_clases.html#introducci√≥n-a-r-y-algebra",
    "title": "Videos_clases",
    "section": " 2. Introducci√≥n a R y Algebra ",
    "text": "2. Introducci√≥n a R y Algebra \n\n[ Im√°gen tomada de benjaminec ]\n\n Teor√≠a y ejemplos \n\nüé•2.1 Introducci√≥n a RStudio Parte 1\nüé•2.2 ¬øQu√© es RStudio?\nüé•2.3 Matrices generales en RStuio\nüé•2.4 Ejercicio en clase 2023-II. Intro a RStudio\n\n\n\n Ejercicios en Clase \n\nüé•2.5 Ejercicio en clase 2023-II. Intro a Matrices y aplicaciones (pca) (parte 1)\nüé•2.6 Ejercicio en clase 2023-II. Aplicaciones de matrices (lda) (parte 2)\n\n\n\n Pautas en html para el taller intro a RStudio y a Matrices \n\nüé•Taller 2.1 Introducci√≥n al RStudio\nüé•Taller 2.2 Introducci√≥n a Matrices en RStudio"
  },
  {
    "objectID": "Videos_clases.html#exploraci√≥n-gr√°fica",
    "href": "Videos_clases.html#exploraci√≥n-gr√°fica",
    "title": "Videos_clases",
    "section": " 3. Exploraci√≥n Gr√°fica ",
    "text": "3. Exploraci√≥n Gr√°fica \n\n\n Teor√≠a y ejemplos de exploraci√≥n gr√°fica \n\nüé•Exploraci√≥n en Excel - Parte 1\nüé•Exploraci√≥n en Excel - Parte 2\nüé•Exploraci√≥n en Excel - Parte 3\nüé•Exploraci√≥n en Excel - Parte 4\nüé•RStudio - Cargar la base de datos\nüé•Figuras de Pares y Elipses\nüé•RStudio - Cargar la base de datos\nüé•Figuras de Pares y Elipses\nüé•Otras figuras de pares\nüé•Figuras Coplots\nüé•Histogramas\n\n\n\n Pautas en html para el taller en clase \n\nüé•Taller 3.1 Exploraci√≥n multivariada en RStudio (resumen)\nüé•Taller 3.1 Exploraci√≥n multivariada en RStudio\n\n\n\n Ejercicios en clase de exploraci√≥n gr√°fica \n\nüé•Ejercicio en clase 2023-II. Exploratrios Multivariados en Rstudio (parte 1)\nüé•Ejercicio en clase 2023-II. Exploratrios Multivariados en Rstudio (parte 2)\n\n\n\n Ejemplo de exploraci√≥n gr√°fica con bases para estudio de caso \n\nüé•Ejemplo con base de datos de Briofitos para el informe semestral"
  },
  {
    "objectID": "Videos_clases.html#section-3",
    "href": "Videos_clases.html#section-3",
    "title": "1¬† Videos_clases",
    "section": "4.2 ",
    "text": "4.2"
  },
  {
    "objectID": "Videos_clases.html#ordenaci√≥n-multivariada---pca",
    "href": "Videos_clases.html#ordenaci√≥n-multivariada---pca",
    "title": "Videos_clases",
    "section": " 3. Ordenaci√≥n multivariada - PCA ",
    "text": "3. Ordenaci√≥n multivariada - PCA \n\n\n Teor√≠a y ejemplos de PCA \n\nOrdenaci√≥n - Generalidades\nComponentes principales - PCA\nEstudios de caso de PCA\n\n\n\n Pautas en html para el taller en clase PCA \n\nTaller 4.1 An√°lisis de Componentes Principales - PCA - Bah√≠as\nTaller 4.2 An√°lisis de Componentes Principales - PCA - Tayrona\n\n Ejercicios en clase PCA \n\nEjercicio con Bah√≠as - PCA (versi√≥n anterior)\nSemana 8. Ejercicio en clase 2023-II. PCA ejercicio 4.1. Bah√≠as\nSemana 9. Ejercicio en clase 2023-II. PCA ejercicio 4.2. Tayrona\n\n\n\n Ejemplo de PCA con bases para estudio de caso \n\nSemana 9. Ejercicio en clase 2023-II. PCA Para estudios de caso (Base Briofitos)"
  },
  {
    "objectID": "Videos_clases.html#section-4",
    "href": "Videos_clases.html#section-4",
    "title": "1¬† Videos_clases",
    "section": "5.2 ",
    "text": "5.2"
  },
  {
    "objectID": "Videos_clases.html#ordenaci√≥n-multivariada---nmds",
    "href": "Videos_clases.html#ordenaci√≥n-multivariada---nmds",
    "title": "Videos_clases",
    "section": " 4. Ordenaci√≥n multivariada - NMDS ",
    "text": "4. Ordenaci√≥n multivariada - NMDS \n\n\n Teor√≠a y ejemplos de NMDS \n\nEscalamiento multidimensional\n\n\n\n Pautas en html para el taller en clase NMDS \n\nTaller 5.1 An√°lisis de Escalamiento Multidimensional - NMDS - Malezas\n\n\n\n Ejercicios en clase NMDS \n\nEjercicios en R con la base de insectos en quebradas. Parte 1\nEjerciciosen R con la base de insectos en quebradas. Parte2\nSemana 11. Ejercicio en clase 2023-II. NMDS (Base Malezas Magdalena) Pendiente\n\n\n\n Ejemplo de NMDS con bases para estudio de caso \n\nSemana 11. Ejercicio en clase 2023-II. NMDS Para estudios de caso (Base Briofitos) Pendiente"
  },
  {
    "objectID": "Videos_clases.html#section-5",
    "href": "Videos_clases.html#section-5",
    "title": "1¬† Videos_clases",
    "section": "6.2 ",
    "text": "6.2"
  },
  {
    "objectID": "Videos_clases.html#clasificaci√≥n-multivariada---cla",
    "href": "Videos_clases.html#clasificaci√≥n-multivariada---cla",
    "title": "Videos_clases",
    "section": " 5. Clasificaci√≥n Multivariada - CLA ",
    "text": "5. Clasificaci√≥n Multivariada - CLA \n\n\n Teor√≠a y ejemplos de CLA \n\nSemana 12. Teor√≠a CLA\n\n\n\n Pautas en html para el taller en clase CLA \n\nTaller 6.1 An√°lisis de Cl√∫ster - CLA - Bah√≠as\n\n\n\n Ejercicios en clase CLA \n\nSemana 13. Ejercicio en clase CLA (Peces de la India)\nSemana 13. Ejercicio en clase 2023-II. CLA (Base Malezas Magdalena) Pendiente\n\n\n\n Ejemplo de CLA con bases para estudio de caso \n\nSemana 13. Ejemplo de CLA con estudio de caso de briofitos Pendiente"
  },
  {
    "objectID": "Videos_clases.html#section-6",
    "href": "Videos_clases.html#section-6",
    "title": "1¬† Videos_clases",
    "section": "7.2 ",
    "text": "7.2"
  },
  {
    "objectID": "Videos_clases.html#clasificaci√≥n-multivariada---lda-manova-y-permanova",
    "href": "Videos_clases.html#clasificaci√≥n-multivariada---lda-manova-y-permanova",
    "title": "Videos_clases",
    "section": " 7 - 9. Clasificaci√≥n Multivariada - LDA, MANOVA Y PERMANOVA ",
    "text": "7 - 9. Clasificaci√≥n Multivariada - LDA, MANOVA Y PERMANOVA \n\n Teor√≠a y ejemplos de LDA \n\nTeor√≠a LDA\nEjemplo (parte 1). Lirios. LDA\nEjemplo (parte 2). Lirios. LDA\nTeor√≠a MANOVA\nEjemplo (parte 1). Lirios. MANOVA\nEjemplo (parte 2). Lirios. MANOVA\nTeor√≠a PERMANOVA\nEjemplo (parte 1). Liquenes. PERMANOVA\nEjemplo (parte 2). Liquenes. PERMANOVA\n\n\n\n Pautas en html para el taller en clase LDA \n\nTaller 7.1 An√°lisis Discriminante - LDA - Peces\nTaller 8.1 An√°lisis de Varianza Multivariado - MANOVA - Peces\nTaller 9.1 An√°lisis de Varianza Multivariado - PERMANOVA - Peces\n\n\n\n Ejercicios en clase LDA, MANOVA y PERMANOVA \n\nSemana 14. Intro - Ejercicio en clase de LDA y MANOVAS (Peces de la India) 2023-II\nSemana 14. Ejercicio en clase de LDA y MANOVAS (Peces de la India) 2023-II\nSemana 15. Ejercicio en clase MANOVAS y PERMANOVAS (Peces de la India) 2023-II\n\n\n\n Ejemplo de LDA con bases para estudio de caso \n\nSemana 15. Ejemplo de LDA con estudio de caso de briofitos Pendiente"
  },
  {
    "objectID": "Taller3.1.exploratorios.html",
    "href": "Taller3.1.exploratorios.html",
    "title": "Taller3. Exploratorios_mv",
    "section": "",
    "text": "Se utilizar√° como referente al capitulo 4 del libro An√°lisis de datos ecol√≥gicos y ambientales (Rodr√≠guez-Barrios, J. 2023), alojado en el siguiente enlace Enlace_Libro\n1.1 Enlace a las pautas del taller\n1.2 Enlace a diapositivas del taller\n1.3 Sript del ejercicio en RMD\nEn caso de que el encabezado del ejercicio no aparezca, se requiere copiar el siguiente c√≥digo: Script del encabezado\n1.4 Bases de datos csv\nSe requiere descargar los siguientes archivos e identificar observaciones, factores y variables.\n1.4.1 Base de datos Insectos.csv\n1.4.2 Base de datos Insectos2.csv"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#resumen-de-las-actividades",
    "href": "Taller3.1.exploratorios.html#resumen-de-las-actividades",
    "title": "Taller3. Exploratorios_mv",
    "section": "Resumen de las actividades",
    "text": "Resumen de las actividades\n\n\n\n\nEl presente taller tiene como objetivo, realizar un entrenamiento b√°sico, sobre exploraci√≥n multivariada en RStudio. Es importante tener en cuenta que la exploraci√≥n multivariada es un paso obligado, previo a un an√°lisis multivariado, devido a que permitir√° identificar patrones tanto en la respuesta de cada variable, como en la interacci√≥n entre ellas."
  },
  {
    "objectID": "Taller3.1.exploratorios.html#section-2",
    "href": "Taller3.1.exploratorios.html#section-2",
    "title": "Taller3. Exploratorios_mv",
    "section": "",
    "text": "Diapositivas de la secci√≥n\n\n\n\n\nEs necesario abrir el siguiente enlace, las diapositivas solo avanzar√°n en la sesi√≥n de clases, por estar programadas para ser presentadas en vivo.\nDiapositivas_exploratorios multivariados"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#section-3",
    "href": "Taller3.1.exploratorios.html#section-3",
    "title": "Taller3. Exploratorios_mv",
    "section": "",
    "text": "Taller en clase\n\nSe requiere descargar todos los archivos en la capeta Taller 3.1. Exploratorios multivariados"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#section-10",
    "href": "Taller3.1.exploratorios.html#section-10",
    "title": "Taller3. Exploratorios_mv",
    "section": "",
    "text": "Ejercicio de estudio\n\n\n\nObjetivo: Poner en pr√°ctica los conceptos vistos en el m√≥dulo de exploratorios, realizando las siguientes opciones gr√°ficas en las bases de datos de lirios data(iris):\n\nFiguras de elipses\nFiguras de Dispersi√≥n por pares de variables (pairs)\nHistogramas\nDispersi√≥n X-Y\nCajas y Bigotes\nCoplot\nFiguras con estad√≠sticos (promedios, errores, ‚Ä¶)"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#paso-1.-cargar-librer√≠as-para-la-exporaci√≥n-multivariada",
    "href": "Taller3.1.exploratorios.html#paso-1.-cargar-librer√≠as-para-la-exporaci√≥n-multivariada",
    "title": "Taller3. Exploratorios_mv",
    "section": "Paso 1. Cargar librer√≠as para la exporaci√≥n multivariada",
    "text": "Paso 1. Cargar librer√≠as para la exporaci√≥n multivariada\n\n\n\n\n# Cargar librer√≠as\nlibrary(tidyverse)\nlibrary(xtable)       # Importar y exportar\nlibrary(openxlsx)     # exportar \"*.xlsx\" \nlibrary(readxl)       # Importar y exportar\n\nlibrary(lattice)      # No se requiere instalar\nlibrary(ggplot2)      # gr√°fica en ggplot2\nlibrary(ggrepel)      # insertar r√≥tulos a los puntos\nrequire(SciViews)     # Fig. dispersi√≥n con coef. de pearson\nlibrary(plotrix)      # Figuras de cajas con m√∫ltiples variables\nlibrary(reshape)      # Figuras de cajas con m√∫ltiples variables\nlibrary(corrplot)     # Figuras de elipses"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#cargar-la-base-de-datos",
    "href": "Taller3.1.exploratorios.html#cargar-la-base-de-datos",
    "title": "Taller3. Exploratorios_mv",
    "section": "Cargar la base de datos",
    "text": "Cargar la base de datos\n\ndir()  # Visualizar los archivos del escritorio de trabajo\n\n [1] \"_quarto.yml\"                       \"cover.png\"                        \n [3] \"datos.h.csv\"                       \"datos1..csv\"                      \n [5] \"datos1.csv\"                        \"datos2.csv\"                       \n [7] \"Figuras\"                           \"index.qmd\"                        \n [9] \"Insectos.csv\"                      \"Insectos2.csv\"                    \n[11] \"intro.qmd\"                         \"Logo_GIEN1.jpeg\"                  \n[13] \"Logo_GIEN1.png\"                    \"Manual.mv.Rproj\"                  \n[15] \"pdf, html\"                         \"references.bib\"                   \n[17] \"references.qmd\"                    \"summary.qmd\"                      \n[19] \"Taller1.Introducci√≥n.qmd\"          \"Taller2.1.Introducci√≥n.qmd\"       \n[21] \"Taller2.2.Introd.matrices.qmd\"     \"Taller3.1.exploratorios.qmd\"      \n[23] \"Taller3.1.exploratorios.rmarkdown\" \"Videos_clases.qmd\"                \n\n\n\ndatos = read.csv2(\"Insectos.csv\", row.names = 1)\ndatos        # Muestra la base de datos completa\n\n   cuenca  pH temp Efem Plec Tric Dipt Cole  Ab\n1   cuen1 6.8 17.4   26    4    9   30    3  72\n4   cuen1 7.3 16.8   17    6    9   25    1  58\n11  cuen1 5.6 16.0    9    3   28   24    3  67\n13  cuen1 6.3 17.8    2    3   25   21    6  57\n19  cuen1 5.6 18.2    6    4   24   12   13  59\n3   cuen2 6.3 17.0    7    2   25   10    1  45\n10  cuen2 7.5 16.8   19    3   12   12    3  49\n15  cuen2 7.0 18.2   12    5   23    9    4  53\n16  cuen2 7.0 19.8   13    6    9    0   15  43\n17  cuen2 5.7 15.3    5    0   32   11    8  56\n2   cuen3 5.5 17.1   17    1   23   16   17  74\n5   cuen3 7.2 18.9   27    3   16   25    2  73\n7   cuen3 7.0 16.3   19    4   21   19   13  76\n8   cuen3 6.1 15.0    6    4   21   30   12  73\n20  cuen3 5.6 15.0    3    4   23   39    4  73\n6   cuen4 7.0 18.1   28    6   19   30   21 104\n9   cuen4 6.2 15.8    9    5   37   26    5  82\n12  cuen4 6.1 17.8    4    1   35   36    9  85\n14  cuen4 6.7 15.3   19    8    7   36    8  78\n18  cuen4 7.1 17.2   27    5   21   32    6  91\n\nhead(datos)  # Encabezado de la base \"datos\" (muestra las primeras 6 filas)\n\n   cuenca  pH temp Efem Plec Tric Dipt Cole Ab\n1   cuen1 6.8 17.4   26    4    9   30    3 72\n4   cuen1 7.3 16.8   17    6    9   25    1 58\n11  cuen1 5.6 16.0    9    3   28   24    3 67\n13  cuen1 6.3 17.8    2    3   25   21    6 57\n19  cuen1 5.6 18.2    6    4   24   12   13 59\n3   cuen2 6.3 17.0    7    2   25   10    1 45\n\nstr(datos)   # estructura de la base \"datos\"\n\n'data.frame':   20 obs. of  9 variables:\n $ cuenca: chr  \"cuen1\" \"cuen1\" \"cuen1\" \"cuen1\" ...\n $ pH    : num  6.8 7.3 5.6 6.3 5.6 6.3 7.5 7 7 5.7 ...\n $ temp  : num  17.4 16.8 16 17.8 18.2 17 16.8 18.2 19.8 15.3 ...\n $ Efem  : int  26 17 9 2 6 7 19 12 13 5 ...\n $ Plec  : int  4 6 3 3 4 2 3 5 6 0 ...\n $ Tric  : int  9 9 28 25 24 25 12 23 9 32 ...\n $ Dipt  : int  30 25 24 21 12 10 12 9 0 11 ...\n $ Cole  : int  3 1 3 6 13 1 3 4 15 8 ...\n $ Ab    : int  72 58 67 57 59 45 49 53 43 56 ...\n\n# datos = read.csv2(file.choose(new = FALSE),row.names=1)\nView(datos)  # Vista preliminar de la base de datos"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#figuras-exploratorias-multivariadas",
    "href": "Taller3.1.exploratorios.html#figuras-exploratorias-multivariadas",
    "title": "Taller3. Exploratorios_mv",
    "section": "Figuras exploratorias multivariadas",
    "text": "Figuras exploratorias multivariadas\n\nRelaciones o correlaciones entre variables\n\n1. Figuras de elipses\nDocumetar importancia de las elipses en la exploraci√≥n gr√°fica.\n\n# Elipses con colores\nM <- cor(datos[,2:9])            # Matriz de Correlaci√≥n (M)\nround(M,2)\n\n        pH  temp  Efem  Plec  Tric  Dipt  Cole    Ab\npH    1.00  0.40  0.69  0.51 -0.63 -0.07 -0.17 -0.01\ntemp  0.40  1.00  0.30  0.07 -0.23 -0.44  0.20 -0.17\nEfem  0.69  0.30  1.00  0.39 -0.59  0.16  0.10  0.42\nPlec  0.51  0.07  0.39  1.00 -0.58  0.22  0.09  0.20\nTric -0.63 -0.23 -0.59 -0.58  1.00  0.04  0.02  0.18\nDipt -0.07 -0.44  0.16  0.22  0.04  1.00 -0.11  0.77\nCole -0.17  0.20  0.10  0.09  0.02 -0.11  1.00  0.37\nAb   -0.01 -0.17  0.42  0.20  0.18  0.77  0.37  1.00\n\n\nLa Figura¬†8.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses, en la cual aquellas de un color azul intenso indican relaciones lineales positivas y las de un rojo intenso se asocian a relaciones lineales negativas.\n\n# Elipses con colores\n# X11()       # panel gr√°fico adicional\ncorrplot(M, method = \"ellipse\")  # Figura de correlaciones con elipses\n\n\n\n\nFigura¬†8.1: Relaci√≥n de las dos variables fisicoqu√≠micas y la abundancia de los taxones en las veinte quebradas estudiadas.\n\n\n\n\n\n# Elipses con colores\n# X11()\ncorrplot(M, method = \"circle\")   # Figura de correlaciones con circulos\n\n\n\n\nLa Figura¬†8.2 muestra la asociaci√≥n entre las variables, a partir de figuras de elipses como elementos encima de la diagonal principal, pero adem√°s, incluye a los coeficientes de correlaci√≥n de Pearson con valores positivos para las relaciones directas y negativos para las relaciones inversas. Esta grafica es complementaria a la Figura¬†8.1.\n\n# Elipses con colores\n# X11()\ncorrplot.mixed(M, upper=\"ellipse\")\n\n\n\n\nFigura¬†8.2: Relaci√≥n de las dos variables fisicoqu√≠micas y la abundancia de los taxones demacrinvertebrados acu√°ticos en las veinte quebradas estudiadas, junto a sus coeficientes de correlaci√≥n de Pearson.\n\n\n\n\n\n# Figura de elipses con coeficientes de correlaci√≥n\ncorrplot(M,  method = \"circle\",            # Correlaciones con circulos\n         type = \"lower\", insig=\"blank\",    # Forma del panel\n         order = \"AOE\", diag = FALSE,      # Ordenar por nivel de correlaci√≥n\n         addCoef.col =\"black\",             # Color de los coeficientes\n         number.cex = 0.8,                 # Tama√±o del texto\n         col = COL2(\"RdYlBu\", 200))        # Transparencia de los circulos\n\n\n\n\n\n\nFiguras de pares\nEstas figuras incluyen dos curvas, una de color verde que muestra la relaci√≥n lineal (abline(lsfit)) y la relaci√≥n no lineal (loess o lowess).\n\n# 4. Figuras de pares\n# **Ejercicio**: incluir las variables 2 a la 8\npairs (datos[,c(2:8)],panel=function(x,y)\n  {abline(lsfit(x,y)$coef,lwd=2,col=3)    # lwd = Ancho de la l√≠nea\n  lines(lowess(x,y),lty=1,lwd=3,col=2)    # col= Color de la l√≠nea\n  points(x,y,cex=1)}) \n\n\n\n\n\n# Volver cuenca como un factor\ndatos$cuenca = as.factor(datos$cuenca)\nstr(datos)\n\n'data.frame':   20 obs. of  9 variables:\n $ cuenca: Factor w/ 4 levels \"cuen1\",\"cuen2\",..: 1 1 1 1 1 2 2 2 2 2 ...\n $ pH    : num  6.8 7.3 5.6 6.3 5.6 6.3 7.5 7 7 5.7 ...\n $ temp  : num  17.4 16.8 16 17.8 18.2 17 16.8 18.2 19.8 15.3 ...\n $ Efem  : int  26 17 9 2 6 7 19 12 13 5 ...\n $ Plec  : int  4 6 3 3 4 2 3 5 6 0 ...\n $ Tric  : int  9 9 28 25 24 25 12 23 9 32 ...\n $ Dipt  : int  30 25 24 21 12 10 12 9 0 11 ...\n $ Cole  : int  3 1 3 6 13 1 3 4 15 8 ...\n $ Ab    : int  72 58 67 57 59 45 49 53 43 56 ...\n\n\n\n# Incluir el factor (cuenca)\n# ***Ejercicio***: Incluir las variables 2,6,7,9. Graficar la **cuenca**\npairs (datos[,c(2,6,7,9)],panel=function(x,y)\n  {abline(lsfit(x,y)$coef,lwd=2,col=3)\n  lines(lowess(x,y),lty=2,lwd=2,col=2)\n  points(x,y,col=datos$cuenca, cex=1.4,pch=19)})\n\n\n\n\n\n# Correlaciones de Pearson\n# x11()\npairs(datos[,c(2,6,7,9)], diag.panel = panel.hist, \n  upper.panel = panel.cor, lower.panel = panel.smooth,\n  method =\"spearman\")"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#evaluar-la-simetr√≠a-y-distribuci√≥n-de-frecuencias-de-las-variables",
    "href": "Taller3.1.exploratorios.html#evaluar-la-simetr√≠a-y-distribuci√≥n-de-frecuencias-de-las-variables",
    "title": "Taller3. Exploratorios_mv",
    "section": "Evaluar la simetr√≠a y distribuci√≥n de frecuencias de las variables",
    "text": "Evaluar la simetr√≠a y distribuci√≥n de frecuencias de las variables\n\n# Frecuencias de abundancias \n# ***Ejercicio***= Rotular el eje Y con \"Porcentaje del Total\", \n# El eje X con \"Abundancia de insectos\"\nhistogram (~Ab,data=datos, \n           ylab = \"Porcentaje del Total\",\n           xlab = \"Abundancia de insectos\",\n           main = \"Histograma de frecuencias\")\n\n\n\n\n\n# Frecuencias de abundancias por cuencas\nhistogram (~Ab|cuenca,data=datos, ylab=\"Porcentaje del Total\",\n   xlab=\"Abundancia de insectos\")\n\n\n\n\n\n# Frecuencias por densidad\ndensityplot(~Ab,data=datos, ylab=\"Porcentaje del Total\",\nxlab=\"Abundancia de insectos\")  \n\n\n\ndensityplot(~Ab|cuenca,data=datos, ylab=\"Porcentaje del Total\",\nxlab=\"Abundancia de insectos\")\n\n\n\n\n\n# Frecuencias de abundancias por densidad\nggplot(data = datos, aes(x = Ab, color = cuenca)) +\n  geom_density(aes(fill = cuenca), alpha = 0.5) +\n  labs( y=\"Frecuencia\", x=\"Abundancia\")\n\n\n\n\n\n# Otra opci√≥n\nggplot(data = datos, aes(x = Ab, color = cuenca)) +\n  geom_density(aes(fill = cuenca)) + \n  facet_wrap(~ cuenca) +\n  theme_bw()\n\n\n\n\n\nRelaci√≥n por parejas de variables\n\n# Otra opci√≥n\n# Regresi√≥n lineal (esquema b√°sico) \nplot(Efem~Plec,col=as.integer(cuenca),data=datos, pch=19) \nlegend(0,25,legend=levels(datos$cuenca),pch=19,col=1:4,cex=0.8)\nlines(abline(lm(datos$Efem~datos$Plec),lwd=2,col=2, lty=2))\n\n\n\n\n\n# Regresiones lineales (Esquema ggplot2) \n# ***Ejercicio*** Graficar la relaci√≥n entre el pH y los efemer√≥pteros\nggplot(datos, aes(x= Plec, y = Efem)  ) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth(method= \"lm\") +\n  theme_bw() \n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n# Regresiones suavizadas - Loess o Lowess (Esquema ggplot2) \nggplot(datos,aes(x = pH, y = Efem)) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth()\n\n\n\n\n\n# Regresiones suavizadas - Loess o Lowess (Esquema ggplot2) \nggplot(datos,aes(x = pH, y = Efem)) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth() +\n  theme_bw() +\n  facet_wrap(~cuenca)"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#diferencias-entre-grupos-de-cuencas",
    "href": "Taller3.1.exploratorios.html#diferencias-entre-grupos-de-cuencas",
    "title": "Taller3. Exploratorios_mv",
    "section": "Diferencias entre grupos (de cuencas)",
    "text": "Diferencias entre grupos (de cuencas)\n\nFiguras de cajas y bigotes\n\n# Cajas y Bigotes con muescas\n# *** Ejercicio*** Graficar La abundancia (Ab) por tipos de cuencas.\nboxplot( Ab ~ cuenca, data = datos,\nxlab=\"Cuencas\",ylab=\"Abundancia\",\ncol=\"lightgray\", cex.lab=1.1)\n\n\n\n\n\n# Buscar en google: colorbrewer2\n# Resultado: ColorBrewer: Color Advice for Maps\nggplot(datos, aes(x= cuenca, y= Ab)) + \n  geom_boxplot(aes(fill = cuenca)) +\n  scale_fill_manual(values = c('#fc8d59','#ffffbf',\n                               '#99d594','#2b8cbe'))+\n  theme_classic()\n\n\n\n\n\n\nFiguras multivariadas con cajas y bigotes\n\n# Figuras de Cajas y bigotes (ggplot2)\nggplot(melt(datos[,c(1,4:9)]), \n       aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=cuenca)) +   # Capa del grafico de cajas\n  labs(x=\"Ordenes de macroinvertebrados\",\n       y=\"Abundancia\") +         # Rotulos de los ejes\n  facet_wrap(~variable, scales=\"free\") + # Faceta que separa los p√°neles por c/grupo taxon√≥mico\n  theme_bw()\n\nUsing cuenca as id variables\n\n\n\n\n\n\n# Figuras de Cajas y bigotes (ggplot2)\nggplot(melt(datos[,c(1,4:9)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=cuenca)) + \n  labs(x=\"\",y=\"Abundancia\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\nUsing cuenca as id variables"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#figuras-con-insumos-estad√≠sticos",
    "href": "Taller3.1.exploratorios.html#figuras-con-insumos-estad√≠sticos",
    "title": "Taller3. Exploratorios_mv",
    "section": "Figuras con insumos estad√≠sticos",
    "text": "Figuras con insumos estad√≠sticos\n\nPaso 1. Cargar la base de datos\n\ndatos1 = read.csv2(\"Insectos2.csv\", row.names=1)\nhead(datos1)\n\n  Muestreo  GF Lluvia  Ab  Biom\n1       M1 C-F     P1  98 56.05\n2       M2 C-F     P1 198 52.66\n3       M3 C-F     P2  45 11.37\n4       M4 C-F     P2  51 25.26\n5       M5 C-F     P2   3  0.36\n6       M6 C-F     P2  69 23.59\n\nView(datos1)\n\n\n\nPaso 2. Tabla de valores estad√≠sticos\n\n# Continuamos con la base de datos \"datos\"\n# Resumen estad√≠stico \"datos_resum\"\ndatos_resum <- datos %>% # Base de datos resumida\n  group_by(cuenca) %>%   # Factor o variable agrupadora\n  summarise(datos.m = mean(Ab),  # Media de cada grupo del factor\n            datos.de  = sd(Ab), # Desviacioes est?ndar de cada grupo\n            datos.var = var(Ab), # Varianzas de cada grupo\n            n.Ab = n(),  # Tama√±o de cada grupo\n            datos.ee = sd(Ab)/sqrt(n())) # Error est?ndar de cada grupo\ndatos_resum\n\n# A tibble: 4 √ó 6\n  cuenca datos.m datos.de datos.var  n.Ab datos.ee\n  <fct>    <dbl>    <dbl>     <dbl> <int>    <dbl>\n1 cuen1     62.6     6.58      43.3     5    2.94 \n2 cuen2     49.2     5.40      29.2     5    2.42 \n3 cuen3     73.8     1.30       1.7     5    0.583\n4 cuen4     88      10.1      102.      5    4.53 \n\n\n\n\nPaso 3. Realizar la figura de promedios y desviaciones est√°ndar\n\n# Figura de promedios y errores est√°ndar\nDatosPlot<-\n  ggplot(datos_resum,                                        # Base de datos\n         aes(cuenca, datos.m, dev.off())) +                  # ejes de la figura\n  geom_bar(stat=\"identity\", col=\"blue\", fill=\"lightblue\") +  # Columnas o barras de la figura \n  geom_errorbar(aes(ymin=datos.m-datos.ee,                   # Desviaciones est√°ndar\n                    ymax=datos.m+datos.ee),width=0.2) \nDatosPlot\n\n\n\n# Imprimir la figura\nprint(DatosPlot + \n        labs(y=\"Abundancia ¬± e.e.\", x = \"cuenca\") + \n        theme_classic())\n\n\n\n\n\n\nFigura bifactorial\nSe trabajar√° con la base de datos (datos1)\n\nPaso 1. base de datos con insumos estad√≠sticos por periodo de lluvia y grupos funcionales (GF)\n\n# Resumen estad√≠stico \"datos_resum\"\ndatos_resum <- datos1 %>%        # Base de datos resumida\n  group_by(Lluvia,GF) %>%          # Factor o variable agrupadora\n  summarise(datos.m = mean(Biom),   # Media de cada grupo del factor\n            datos.de  = sd(Biom),   # Desviacioes est√°ndar de cada grupo\n            datos.var = var(Biom),  # Varianzas de cada grupo\n            n.Biom = n(),           # Tama√±o de cada grupo\n            datos.ee = sd(Biom)/sqrt(n()))   # Error est√°ndar de cada grupo\n\n`summarise()` has grouped output by 'Lluvia'. You can override using the\n`.groups` argument.\n\ndatos_resum\n\n# A tibble: 10 √ó 7\n# Groups:   Lluvia [2]\n   Lluvia GF    datos.m datos.de datos.var n.Biom datos.ee\n   <chr>  <chr>   <dbl>    <dbl>     <dbl>  <int>    <dbl>\n 1 P1     C-F      37.0     30.0      902.      3    17.3 \n 2 P1     C-R      31.7     32.1     1029.      3    18.5 \n 3 P1     D       361.     120.     14411.      3    69.3 \n 4 P1     R        53.5     69.8     4873.      3    40.3 \n 5 P1     T       190.     296.     87533.      3   171.  \n 6 P2     C-F      14.4     10.2      105.      5     4.58\n 7 P2     C-R      88.5    115.     13273.      5    51.5 \n 8 P2     D       176.      94.9     9010.      5    42.4 \n 9 P2     R        21.9     12.9      165.      5     5.75\n10 P2     T       151.     223.     49655.      5    99.7 \n\n\n\n\nFigura bifactorial\n\n# Promedios y errores con colores autom√°ticos (Figura p1)\np1<-\n  ggplot(datos_resum, aes(x=GF, y=datos.m, fill=Lluvia)) + \n  geom_bar(stat=\"identity\", col=\"black\", position=position_dodge()) +  \n  geom_errorbar(aes(ymin=datos.m, ymax=datos.m+datos.ee),width=0.2,\n                position=position_dodge(.9)) +\n  labs(x=\"Grupos Funcionales-GF\", y =\"Biomasa\")\np1\n\n\n\n\n\n# Figura con definici√≥n de colores por periodo (figura p2)\np2 <-\n  p1 +\n  labs(title=\"Biomasa por GF\",x=\"Grupos Funcionales-GF\",y =\"Biomasa\") +\n  theme_classic() +\n  scale_fill_manual(values=c('#E69F00','#999999'))\np2\n\n\n\n\n\n# Impresi√≥n de un panel con las dos figuras (p1 y p2)\nlibrary(gridExtra)\n\n\nAttaching package: 'gridExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\ngrid.arrange (p1, p2, ncol=2)\n\n\n\n\n\n# Inserci√≥n de las figuras en columna (figuras p1 y p2)\nlibrary(gtable)\nlibrary(grid)\ng2 <- ggplotGrob(p1)\ng3 <- ggplotGrob(p2)\ng <- rbind(g2, g3, size=\"first\")\ng$widths <- unit.pmax(g2$widths, g3$widths)\ngrid.newpage()\ngrid.draw(g)"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html",
    "href": "Taller2.1.Introducci√≥n.html",
    "title": "Taller2.1 Intro_RStudio",
    "section": "",
    "text": "Filtrado en orden ascendente"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#resumen-de-las-actividades",
    "href": "Taller2.1.Introducci√≥n.html#resumen-de-las-actividades",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Resumen de las actividades",
    "text": "Resumen de las actividades\n\n\n\n\nIm√°gen tomada de sommersby\n\n\n\n\nEl presente taller tiene como objetivo, realizar un entrenamiento b√°sico, sobre los aspectos m√°s relevantes en el manejo del programa RStudio, el cual se encuentra alojado en el siguiente üìàenlace.\n\nSe utilizar√° como referente al capitulo 2 del libro An√°lisis de datos ecol√≥gicos y ambientales (Rodr√≠guez-Barrios, J. 2023), alojado en el siguiente enlace üìñEnlace_Libro"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#actividad-1.-operaciones-b√°sicas-en-rstudio",
    "href": "Taller2.1.Introducci√≥n.html#actividad-1.-operaciones-b√°sicas-en-rstudio",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Actividad 1. Operaciones b√°sicas en RStudio",
    "text": "Actividad 1. Operaciones b√°sicas en RStudio\n\n\n\n\n\nDescargar el script de RMarkDown (rmd) titulado ‚ÄúTaller2.1.Rmd‚Äù en el siguiente enlace üìàTaller2.1.Rmd.\nCrear una carpeta en su computador titulada ‚ÄúTaller2.1_IntroRStudio‚Äù y guardar el archivo descargado junto con el resto de materiales que se describen a continuaci√≥n.\nAbrir el archivo ‚ÄúTaller2.1.Rmd‚Äù y abrir el siguiente enlace, correspondiente al ejercicio a realizar üìàTaller1.IntroRStudio.\nRevisar los siguientes enlaces complementarios:\n\n\nüì∞Operaciones b√°sicas en RStudio\nüì∞Scripts del cap√≠tulo 2 del libro (Rodr√≠uez-Barrios, J. 2023)\nüì∞Diapositivas Intro a R\nüì∞Diapositivas Operaciones en R\nüì∞Trucos en R\nüì∞RPubs-Intro\nüì∞RPubs-Intermed"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#actividad-2.-importaci√≥n-y-exportaci√≥n-de-datos",
    "href": "Taller2.1.Introducci√≥n.html#actividad-2.-importaci√≥n-y-exportaci√≥n-de-datos",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Actividad 2. Importaci√≥n y Exportaci√≥n de datos",
    "text": "Actividad 2. Importaci√≥n y Exportaci√≥n de datos\n\n\n[ Im√°gen tomada de BillionPhotos.com ]\n\n\n\nContinuar en el el archivo ‚ÄúTaller1.Rmd‚Äù y en las diapositivas Taller1.IntroRStudio.\nRealizar los siguientes procedimientos\n\n\nüì∞Importaci√≥n de datos1\nüì∞Importaci√≥n de datos2\n\n\nRevisar os siguientes enlaces\n\n\nüì∞Diapositivas\nüì∞Res√∫menes con psych"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#actividad-3.-lenguaje-tidyyverse",
    "href": "Taller2.1.Introducci√≥n.html#actividad-3.-lenguaje-tidyyverse",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Actividad 3. Lenguaje Tidyyverse",
    "text": "Actividad 3. Lenguaje Tidyyverse\n\n\n\n\n\nContinuar en el el archivo ‚ÄúTaller1.Rmd‚Äù y en las diapositivas Taller1.IntroRStudio.\nRevisar los siguientes enlaces\n\n\nüé•Videos de Tidyverse\nüì∞Introducci√≥n al Tidyverse\nüì∞Introducci√≥n al Tidyverse\nüì∞Introducci√≥n al Tidyverse\nüì∞El Tidyverso y tidyr\nüì∞Curso de Tidyverse\nüì∞10 funciones de Tidyverse\nüì∞Manipulaci√≥n de datos\nüì∞Estandarizaci√≥n de variables\nüì∞Transformaciones de variables"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#resultado-del-taller",
    "href": "Taller2.1.Introducci√≥n.html#resultado-del-taller",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Resultado del taller",
    "text": "Resultado del taller\n\nCargar la Bases de datos (data.frames)\n\n# Librer√≠as requeridas\n# install.packages(\"xlsx\")\n\n\nlibrary(tidyverse)\nlibrary(xtable)       # Importar y exportar\nlibrary(openxlsx)     # exportar \"*.xlsx\" \nlibrary(readxl)       # Importar y exportar\n# library(xlsx)         # Importar y exportar \"*.xlsx\""
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#ejercicio",
    "href": "Taller2.1.Introducci√≥n.html#ejercicio",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Ejercicio",
    "text": "Ejercicio\n\nRealizar varios ajustes a bases de datos elaboradas manualmente en tidyverse\n\n# Base de datos (datos)\ndatos = data.frame (Meses = c(\"Enero\", \"Junio\", \"Octubre\"),\n                    periodos = c(\"Sequ√≠a\",\"Lluvias1\",\"Lluvias2\"),\n                    Tax√≥n1 = c(1:3),\n                    Tax√≥n2 = c(20, 25,30),\n                    Tax√≥n3 = c(4,4,4))\ndatos\n\n    Meses periodos Tax√≥n1 Tax√≥n2 Tax√≥n3\n1   Enero   Sequ√≠a      1     20      4\n2   Junio Lluvias1      2     25      4\n3 Octubre Lluvias2      3     30      4\n\n\n\nstr(datos)    # Estructura de la base de datos\n\n'data.frame':   3 obs. of  5 variables:\n $ Meses   : chr  \"Enero\" \"Junio\" \"Octubre\"\n $ periodos: chr  \"Sequ√≠a\" \"Lluvias1\" \"Lluvias2\"\n $ Tax√≥n1  : int  1 2 3\n $ Tax√≥n2  : num  20 25 30\n $ Tax√≥n3  : num  4 4 4\n\n\n\n\nDatos en formato alargado (gather)\n\ndatos.l = datos %>% gather(Columnas, Valores)\ndatos.l\n\n   Columnas  Valores\n1     Meses    Enero\n2     Meses    Junio\n3     Meses  Octubre\n4  periodos   Sequ√≠a\n5  periodos Lluvias1\n6  periodos Lluvias2\n7    Tax√≥n1        1\n8    Tax√≥n1        2\n9    Tax√≥n1        3\n10   Tax√≥n2       20\n11   Tax√≥n2       25\n12   Tax√≥n2       30\n13   Tax√≥n3        4\n14   Tax√≥n3        4\n15   Tax√≥n3        4\n\n\nInsertar los valores de **periodos** de la base de datos\n\ndatos.l = datos %>%\n          gather(Columnas, Valores, -periodos)\ndatos.l\n\n   periodos Columnas Valores\n1    Sequ√≠a    Meses   Enero\n2  Lluvias1    Meses   Junio\n3  Lluvias2    Meses Octubre\n4    Sequ√≠a   Tax√≥n1       1\n5  Lluvias1   Tax√≥n1       2\n6  Lluvias2   Tax√≥n1       3\n7    Sequ√≠a   Tax√≥n2      20\n8  Lluvias1   Tax√≥n2      25\n9  Lluvias2   Tax√≥n2      30\n10   Sequ√≠a   Tax√≥n3       4\n11 Lluvias1   Tax√≥n3       4\n12 Lluvias2   Tax√≥n3       4\n\n\n\n\nDatos en formato horizontal (spread)\n\ndatos.h = datos.l %>%\n  spread(Columnas, Valores)\ndatos.h\n\n  periodos   Meses Tax√≥n1 Tax√≥n2 Tax√≥n3\n1 Lluvias1   Junio      2     25      4\n2 Lluvias2 Octubre      3     30      4\n3   Sequ√≠a   Enero      1     20      4\n\ndatos\n\n    Meses periodos Tax√≥n1 Tax√≥n2 Tax√≥n3\n1   Enero   Sequ√≠a      1     20      4\n2   Junio Lluvias1      2     25      4\n3 Octubre Lluvias2      3     30      4\n\nView(datos.h)\nView(datos.l)\n\n\n\nGuardar las bases de datos\n\nwrite.csv2(datos.h, \"datos.h.csv\")"
  },
  {
    "objectID": "Taller2.1.Introducci√≥n.html#base-de-datos-de-un-censo-hipot√©tico",
    "href": "Taller2.1.Introducci√≥n.html#base-de-datos-de-un-censo-hipot√©tico",
    "title": "Taller2.1 Intro_RStudio",
    "section": "Base de datos de un censo hipot√©tico",
    "text": "Base de datos de un censo hipot√©tico\n\n# install.packages(\"kableExtra\")\n# library(kableExtra)\n\nA continuaci√≥n se genera la base de datos de un censo hipot√©tico de estudiantes universitarios.\n\ndatos = data.frame (n = 1:16,   # Consecutivo (16 filas)\n                    Estudiante = c(\"a\",\"a\",\"a\",\"a\",\"b\",\"b\",\"b\",\"b\",\n                                   \"c\",\"c\",\"c\",\"c\",\"d\",\"d\",\"d\",\"d\"),\n                    Sexo =   c(\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\"f\",\n                             \"m\",\"m\",\"m\",\"m\",\"m\",\"m\",\"m\",\"m\"),\n                    Variable_1 = c(1.2, 3.4, 4.5, 5.6, 1.2, 3.4, 4.5, 5.6,\n                                   0.8, 2.4, 1.8, 1.5, 1.6, 2.1, 1.2, 0.8),\n                    Variable_2 = c(2.4, 4.8, 9, 11.2, 2.4, 4.8, 9, 11.2,\n                                   1.6, 4.8, 3.6, 3, 3.2, 4.2, 2.4, 1.6))\ndatos\n\n    n Estudiante Sexo Variable_1 Variable_2\n1   1          a    f        1.2        2.4\n2   2          a    f        3.4        4.8\n3   3          a    f        4.5        9.0\n4   4          a    f        5.6       11.2\n5   5          b    f        1.2        2.4\n6   6          b    f        3.4        4.8\n7   7          b    f        4.5        9.0\n8   8          b    f        5.6       11.2\n9   9          c    m        0.8        1.6\n10 10          c    m        2.4        4.8\n11 11          c    m        1.8        3.6\n12 12          c    m        1.5        3.0\n13 13          d    m        1.6        3.2\n14 14          d    m        2.1        4.2\n15 15          d    m        1.2        2.4\n16 16          d    m        0.8        1.6\n\n\n\nFiltrar por sexos\n\ndatos.f = datos[datos$Sexo == \"f\",]\ndatos.f\n\n  n Estudiante Sexo Variable_1 Variable_2\n1 1          a    f        1.2        2.4\n2 2          a    f        3.4        4.8\n3 3          a    f        4.5        9.0\n4 4          a    f        5.6       11.2\n5 5          b    f        1.2        2.4\n6 6          b    f        3.4        4.8\n7 7          b    f        4.5        9.0\n8 8          b    f        5.6       11.2\n\n\n\n\nVector de medias de las dos variables para las muejeres\n\npromedios.f = colMeans(datos.f[,4:5])\npromedios.f\n\nVariable_1 Variable_2 \n     3.675      6.850 \n\n\n\n\nVector de medias de las dos variables para los hombres\n\ndatos.h = datos[datos$Sexo == \"m\",]\npromedios.h = colMeans(datos.h[,4:5])\npromedios.h\n\nVariable_1 Variable_2 \n     1.525      3.050 \n\npromedios = data.frame(promedios.f, promedios.h)\npromedios\n\n           promedios.f promedios.h\nVariable_1       3.675       1.525\nVariable_2       6.850       3.050\n\n\n\n\nEjercicio: Filtrar a los estudiantes b, de la base de datos de muejeres (datos.f)\n\ndatos.f\n\n  n Estudiante Sexo Variable_1 Variable_2\n1 1          a    f        1.2        2.4\n2 2          a    f        3.4        4.8\n3 3          a    f        4.5        9.0\n4 4          a    f        5.6       11.2\n5 5          b    f        1.2        2.4\n6 6          b    f        3.4        4.8\n7 7          b    f        4.5        9.0\n8 8          b    f        5.6       11.2\n\n\nGuardar la base de datos\n\nwrite.csv2(datos,\"datos2.csv\")\n\n\n\nFiltrar en orden descendente (arrange y desc)\n\ndatos.des = datos %>%\n  arrange(desc(Variable_1))\n\ndatos.des\n\n    n Estudiante Sexo Variable_1 Variable_2\n1   4          a    f        5.6       11.2\n2   8          b    f        5.6       11.2\n3   3          a    f        4.5        9.0\n4   7          b    f        4.5        9.0\n5   2          a    f        3.4        4.8\n6   6          b    f        3.4        4.8\n7  10          c    m        2.4        4.8\n8  14          d    m        2.1        4.2\n9  11          c    m        1.8        3.6\n10 13          d    m        1.6        3.2\n11 12          c    m        1.5        3.0\n12  1          a    f        1.2        2.4\n13  5          b    f        1.2        2.4\n14 15          d    m        1.2        2.4\n15  9          c    m        0.8        1.6\n16 16          d    m        0.8        1.6"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#resumen-de-las-actividades",
    "href": "Taller2.2.Introd.matrices.html#resumen-de-las-actividades",
    "title": "Taller2.2 Intro_Matrices",
    "section": "Resumen de las actividades",
    "text": "Resumen de las actividades\n\n\n\n\nIm√°gen tomada de Babaroga"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#actividad-1.-operaciones-b√°sicas-de-matrices",
    "href": "Taller2.2.Introd.matrices.html#actividad-1.-operaciones-b√°sicas-de-matrices",
    "title": "Taller2.2 Intro_Matrices",
    "section": "Actividad 1. Operaciones b√°sicas de matrices",
    "text": "Actividad 1. Operaciones b√°sicas de matrices\n\n\n[ Im√°gen tomada de wachiwit ]\n\n\n\nDescargar el script de RMarkDown (rmd) titulado ‚ÄúTaller2.2.matrices.Rmd‚Äù en el siguiente enlace üìàTaller2.2.matrices.Rmd.\nDescargar la base de datos con mediciones de cuatro variables morfom√©tricas a estudiantes de biolog√≠a (csv) titulado ‚Äúdatos1.csv‚Äù en el siguiente enlace üìàdatos1.csv.\nCrear una carpeta en su computador titulada ‚ÄúTaller2.2_Matrices.RStudio‚Äù y guardar el archivo descargado junto con archivo datos1.csv.\nCerrar el RStudio y Abrir el archivo ‚ÄúTaller2.2.matrices.Rmd y abrir el siguiente enlace, correspondiente al ejercicio a realizar üì∞Taller1.IntroRStudio.\nRevisar los siguientes enlaces complementarios:\n\n\nüì∞Scripts del Ejemplo 3, del cap√≠tulo 3 del libro (Rodr√≠uez-Barrios, J. 2023)"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#operaciones-matriciales-b√°sicas",
    "href": "Taller2.2.Introd.matrices.html#operaciones-matriciales-b√°sicas",
    "title": "Taller2.2 Intro_Matrices",
    "section": "1. Operaciones matriciales b√°sicas",
    "text": "1. Operaciones matriciales b√°sicas\n\n1.1 Producto matricial\nEste ejercicio incluye una demostraci√≥n al final.\n\n# Ejercicio 1\n# A (2,1,1,3)\n# B (1,4,2,5,0,3)\n# Calcular: (1) B'.A' (2) (A.B)' (3) Demostrar que B'.A' = (A.B)'\n\n# R./\nA =  matrix (c(2,1,1,3),2,2,byrow = T)          # Matriz A\nB =  matrix (c(1,4,2,5,0,3),2,3,byrow=TRUE)     # Matriz B\n\nA\n\n     [,1] [,2]\n[1,]    2    1\n[2,]    1    3\n\nB\n\n     [,1] [,2] [,3]\n[1,]    1    4    2\n[2,]    5    0    3\n\n# (1) B'.A'\nt(B)%*%t(A)    # %*%  representa el producto matricial, \n\n     [,1] [,2]\n[1,]    7   16\n[2,]    8    4\n[3,]    7   11\n\n               # \"t\" corresponde a la transpuesta de una matriz\n\n# (2) (A.B)'\nt(A %*% B)\n\n     [,1] [,2]\n[1,]    7   16\n[2,]    8    4\n[3,]    7   11\n\n# (3) B'.A' = (A.B)'\nt(B)%*%t(A) == t(A %*% B)   # Demostraci√≥n\n\n     [,1] [,2]\n[1,] TRUE TRUE\n[2,] TRUE TRUE\n[3,] TRUE TRUE\n\n\n\n\n1.2 Determinantes\nSe calcular√° la determinante de dos matrices cuadradas\n\n#-------------\n# Ejercicio 2\n# A (2,3,3,2)\n# B (1,4,2,5,0,3)\n# Cacular: Determinante de A y de B\n\n#R./\nA = matrix (c(2,3,3,2),2,2,byrow = T)\nB = matrix (c(1,4,2,5,0,3),3,3,byrow = T)\n\nA     \n\n     [,1] [,2]\n[1,]    2    3\n[2,]    3    2\n\nB\n\n     [,1] [,2] [,3]\n[1,]    1    4    2\n[2,]    5    0    3\n[3,]    1    4    2\n\n# Determinantes\n\ndet(A)\n\n[1] -5\n\ndet(B)\n\n[1] 0\n\n\n\n\n1.3 Matriz inversa\nC√°lculo de una matriz inversa (A)-1\n\n#------------\n# Ejercicio 3\n# A (5,2,2,2)\n# Calcular inversa de A\n\n# R./\nA = matrix(c(5,2,2,2),2,2,byrow=T)\nA\n\n     [,1] [,2]\n[1,]    5    2\n[2,]    2    2\n\n# Matriz inversa (solve)\n\nround(solve(A),2)\n\n      [,1]  [,2]\n[1,]  0.33 -0.33\n[2,] -0.33  0.83"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#operaciones-matriciales-b√°sicas-1",
    "href": "Taller2.2.Introd.matrices.html#operaciones-matriciales-b√°sicas-1",
    "title": "Taller2.2 Intro_Matrices",
    "section": "1. Operaciones matriciales b√°sicas",
    "text": "1. Operaciones matriciales b√°sicas\n\n1.4 Matriz de varianza - covarianza\nCalcular la covaianza para dos matrices rectangulares\n\nA = matrix(c(2,2,4,3,6,9),3,2, byrow= T)\nB = matrix(c(2:10), 5,2, byrow=T)\n\nA\n\n     [,1] [,2]\n[1,]    2    2\n[2,]    4    3\n[3,]    6    9\n\nB\n\n     [,1] [,2]\n[1,]    2    3\n[2,]    4    5\n[3,]    6    7\n[4,]    8    9\n[5,]   10    2\n\n# (1) Covarianzas de cada matriz (c/grupo)\ncov.A = cov(A)\ncov.B = cov(B)\n\ncov.A\n\n     [,1]     [,2]\n[1,]    4  7.00000\n[2,]    7 14.33333\n\ncov.B\n\n     [,1] [,2]\n[1,]   10  1.0\n[2,]    1  8.2\n\n# (2) covarianza generalizada (S)\ncov.g = (3*(cov.A)+5*(cov.B))/8  # cov.g corresponde a la covarianza generalizada\ncov.g\n\n     [,1]  [,2]\n[1,] 7.75  3.25\n[2,] 3.25 10.50\n\n# (3) covarianza generalizada invertida (S-1)\ncov.g.i = solve(cov.g)   # cov.g.i representa a la covarianza gralizada invertida\ncov.g.i\n\n            [,1]        [,2]\n[1,]  0.14827891 -0.04589585\n[2,] -0.04589585  0.10944395\n\nround(cov.g.i,2)   # round corresponde al redondeo de decimales\n\n      [,1]  [,2]\n[1,]  0.15 -0.05\n[2,] -0.05  0.11"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#aplicaciones-de-matrices-an√°lisis-de-componentes-principales---pca",
    "href": "Taller2.2.Introd.matrices.html#aplicaciones-de-matrices-an√°lisis-de-componentes-principales---pca",
    "title": "Taller2.2 Intro_Matrices",
    "section": "2. Aplicaciones de matrices (An√°lisis de Componentes Principales - PCA)",
    "text": "2. Aplicaciones de matrices (An√°lisis de Componentes Principales - PCA)\n\n2.1 Librer√≠as requeridas\n\n# Librer√≠as o paquetes requeridos\n\n# install.packages(\"ggplot2\")\n# install.packages(\"vegan\")\n\nlibrary(ggplot2)\nlibrary(vegan)\n\n\n\n2.2 Cargar base de datos (datos1.csv)\n\n# 2.2 Cargar la base de datos de Excel *.csv\n\ndatos= read.csv2(\"datos1.csv\",row.names=1)  \ndatos           # Falta un dato al estudiante 13\n\n          Sexo Longitud.total Cintura Longitud.espalda Long.brazo\nAlumno 1     F            170    85.0               43         57\nAlumno 2     F            160    80.0               41         54\nAlumno 3     F            156    88.0               35         48\nAlumno 4     F            173    63.0               53         59\nAlumno 5     M            170    86.0               47         56\nAlumno 6     M            165    89.0               45         61\nAlumno 7     M            170    88.0               56         59\nAlumno 8     M            181    80.0               60         55\nAlumno 9     M            175    76.0               55         54\nAlumno 10    M            186    45.0               60         86\nAlumno 11    F            168    65.0               49         55\nAlumno 12    F            155    70.0               36         50\nAlumno 13    F            150    85.5               45         NA\nAlumno 14    F            158    72.0               40         55\nAlumno 15    M            172    79.0               43         82\nAlumno 16    F            155    68.0               39         50\nAlumno 17    F            163    68.0               38         70\nAlumno 18    M            170   122.0               48         60\nAlumno 19    F            157    60.0               36         69\nAlumno 20    F            162    60.0               50         76\nAlumno 21    M            170    82.0               55         56\nAlumno 22    F            158    75.0               35         60\nAlumno 23    M            174    87.0               51         56\nAlumno 24    F            170    88.0               37         78\nAlumno 25    F            162    68.0               37         53\n\nstr(datos)      # Estructura de la base de datos\n\n'data.frame':   25 obs. of  5 variables:\n $ Sexo            : chr  \"F\" \"F\" \"F\" \"F\" ...\n $ Longitud.total  : int  170 160 156 173 170 165 170 181 175 186 ...\n $ Cintura         : num  85 80 88 63 86 89 88 80 76 45 ...\n $ Longitud.espalda: int  43 41 35 53 47 45 56 60 55 60 ...\n $ Long.brazo      : int  57 54 48 59 56 61 59 55 54 86 ...\n\ndatos=na.omit(datos)      # na.omit, para eliminar al estudiante 13\ndatos\n\n          Sexo Longitud.total Cintura Longitud.espalda Long.brazo\nAlumno 1     F            170      85               43         57\nAlumno 2     F            160      80               41         54\nAlumno 3     F            156      88               35         48\nAlumno 4     F            173      63               53         59\nAlumno 5     M            170      86               47         56\nAlumno 6     M            165      89               45         61\nAlumno 7     M            170      88               56         59\nAlumno 8     M            181      80               60         55\nAlumno 9     M            175      76               55         54\nAlumno 10    M            186      45               60         86\nAlumno 11    F            168      65               49         55\nAlumno 12    F            155      70               36         50\nAlumno 14    F            158      72               40         55\nAlumno 15    M            172      79               43         82\nAlumno 16    F            155      68               39         50\nAlumno 17    F            163      68               38         70\nAlumno 18    M            170     122               48         60\nAlumno 19    F            157      60               36         69\nAlumno 20    F            162      60               50         76\nAlumno 21    M            170      82               55         56\nAlumno 22    F            158      75               35         60\nAlumno 23    M            174      87               51         56\nAlumno 24    F            170      88               37         78\nAlumno 25    F            162      68               37         53\n\ncolnames(datos) <- c(\"Sexo\",\"LTot\",\"Cint\",\"LEsp\",\"LBra\")    # R√≥tulos de la base de datos\nhead(datos)          # Base de datos abreviada\n\n         Sexo LTot Cint LEsp LBra\nAlumno 1    F  170   85   43   57\nAlumno 2    F  160   80   41   54\nAlumno 3    F  156   88   35   48\nAlumno 4    F  173   63   53   59\nAlumno 5    M  170   86   47   56\nAlumno 6    M  165   89   45   61\n\n\n\n\n2.3 C√°lculo de la matriz centrada de las variables morfom√©tricas\n\n#---------------\nvar = datos[,c(2:5)]          # Variables morfom√©tricas\npromedio = colMeans(var)      # Promedios de las variables\npromedio\n\n     LTot      Cint      LEsp      LBra \n166.66667  76.83333  45.37500  60.79167 \n\nm.centrada <- t(t(var) - promedio) # Restar cada dato a los promedios\nm.centrada\n\n                LTot        Cint    LEsp        LBra\nAlumno 1    3.333333   8.1666667  -2.375  -3.7916667\nAlumno 2   -6.666667   3.1666667  -4.375  -6.7916667\nAlumno 3  -10.666667  11.1666667 -10.375 -12.7916667\nAlumno 4    6.333333 -13.8333333   7.625  -1.7916667\nAlumno 5    3.333333   9.1666667   1.625  -4.7916667\nAlumno 6   -1.666667  12.1666667  -0.375   0.2083333\nAlumno 7    3.333333  11.1666667  10.625  -1.7916667\nAlumno 8   14.333333   3.1666667  14.625  -5.7916667\nAlumno 9    8.333333  -0.8333333   9.625  -6.7916667\nAlumno 10  19.333333 -31.8333333  14.625  25.2083333\nAlumno 11   1.333333 -11.8333333   3.625  -5.7916667\nAlumno 12 -11.666667  -6.8333333  -9.375 -10.7916667\nAlumno 14  -8.666667  -4.8333333  -5.375  -5.7916667\nAlumno 15   5.333333   2.1666667  -2.375  21.2083333\nAlumno 16 -11.666667  -8.8333333  -6.375 -10.7916667\nAlumno 17  -3.666667  -8.8333333  -7.375   9.2083333\nAlumno 18   3.333333  45.1666667   2.625  -0.7916667\nAlumno 19  -9.666667 -16.8333333  -9.375   8.2083333\nAlumno 20  -4.666667 -16.8333333   4.625  15.2083333\nAlumno 21   3.333333   5.1666667   9.625  -4.7916667\nAlumno 22  -8.666667  -1.8333333 -10.375  -0.7916667\nAlumno 23   7.333333  10.1666667   5.625  -4.7916667\nAlumno 24   3.333333  11.1666667  -8.375  17.2083333\nAlumno 25  -4.666667  -8.8333333  -8.375  -7.7916667\n\n\n\n\n2.4 Valores y Vectores pr√≥pios de la Matriz de covarianzas centradas\n\n# 1. C√°lculo de valores y vectores propios\nround(head(m.centrada),2)\n\n           LTot   Cint   LEsp   LBra\nAlumno 1   3.33   8.17  -2.38  -3.79\nAlumno 2  -6.67   3.17  -4.38  -6.79\nAlumno 3 -10.67  11.17 -10.38 -12.79\nAlumno 4   6.33 -13.83   7.62  -1.79\nAlumno 5   3.33   9.17   1.62  -4.79\nAlumno 6  -1.67  12.17  -0.38   0.21\n\nS.centrada = cov(m.centrada)   # Matriz de varianza y covarianzas centrada\nround(S.centrada,2)\n\n      LTot   Cint  LEsp   LBra\nLTot 68.41   4.38 56.35  32.75\nCint  4.38 221.19 -3.67 -45.99\nLEsp 56.35  -3.67 67.20  11.26\nLBra 32.75 -45.99 11.26 108.95\n\nvv.propios= eigen(S.centrada)    # Vectores y valores propios de m.centrada\nvv.propios\n\neigen() decomposition\n$values\n[1] 238.551229 141.646198  77.460019   8.092554\n\n$vectors\n            [,1]       [,2]       [,3]        [,4]\n[1,] -0.06532082 -0.6446607  0.2348736  0.72455510\n[2,]  0.93124818 -0.2601970 -0.2459119 -0.06783569\n[3,] -0.06460934 -0.5458245  0.5144348 -0.65822342\n[4,] -0.35261262 -0.4677453 -0.7872220 -0.19276967\n\n\n\n# Extraer los vectores propios (vec.propios)\nvec.propios=   vv.propios$vectors                \nround(vec.propios,2)\n\n      [,1]  [,2]  [,3]  [,4]\n[1,] -0.07 -0.64  0.23  0.72\n[2,]  0.93 -0.26 -0.25 -0.07\n[3,] -0.06 -0.55  0.51 -0.66\n[4,] -0.35 -0.47 -0.79 -0.19\n\nvec.propios2 =   vv.propios$vectors[,2]\nvec.propios2\n\n[1] -0.6446607 -0.2601970 -0.5458245 -0.4677453\n\n\n\n# 2. Proyecci√≥n matricial (matriz rotada), usando a los vectores propios\nm.centrada= as.matrix(m.centrada)      # Variables centradas como matriz\n#round(head(m.centrada),2)\n\n# Matriz rotada\nround((m.Rotada <- m.centrada%*%vec.propios),2)   # Matriz centrada x vectores pr√≥pios\n\n            [,1]   [,2]   [,3]  [,4]\nAlumno 1    8.88  -1.20   0.54  4.16\nAlumno 2    6.06   9.04   0.75 -0.86\nAlumno 3   16.28  15.62  -0.52  0.81\nAlumno 4  -13.16  -3.81  10.22  0.85\nAlumno 5    9.90  -3.18   3.14  1.65\nAlumno 6   11.39  -1.98  -3.74 -1.83\nAlumno 7   10.13 -10.02   4.91 -4.99\nAlumno 8    3.11 -15.34  14.67  1.66\nAlumno 9    0.45  -7.23  12.46  1.07\nAlumno 10 -40.74 -23.95   0.05  1.68\nAlumno 11  -9.30   2.95   9.65  0.50\nAlumno 12  -1.19  19.46   2.61  0.26\nAlumno 14  -1.55  12.49   0.95 -1.30\nAlumno 15  -5.66 -12.63 -17.20  1.19\nAlumno 16  -3.25  18.35   4.65 -1.58\nAlumno 17 -10.76   4.38  -9.73  1.02\nAlumno 18  41.95 -14.96  -8.35 -2.22\nAlumno 19 -17.33  11.89  -9.42 -1.27\nAlumno 20 -21.03  -2.25  -6.55 -8.22\nAlumno 21   5.66  -6.51   8.24 -3.35\nAlumno 22  -0.19  12.10  -6.30  0.83\nAlumno 23  10.31  -8.20   5.89  1.84\nAlumno 24   4.65  -8.53 -19.82  3.85\nAlumno 25  -4.63  13.52   2.90  4.23\n\n\n\n\n2.4 Figuras de la matriz proyectada ‚Äúm.Rotada‚Äù\n\n# Figura sin editar\nplot(m.Rotada)  # m.Rotada es la matriz rotada\n\n\n\n\n\n# Figura editada \nplot(m.Rotada, asp=2, pch=19, xlab=\"CP1\", ylab=\"CP2\")           # R√≥tulos de los ejes\ntext(m.Rotada, labels =row.names(datos),\n     pos=3, cex=0.7)                # cex() relaciona el tama√±o del texto\nabline(h=0, col=\"red\", lty=2)           # abline (h=0) l√≠nea horizontal del plano cartesiano\nabline(v=0, col=\"red\", lty=2)           # abline (v=0) l√≠nea vertical del plano cartesiano\ngrid()              # Grilla en la figura\n\n\n\n\n\n\n2.5 Comparar con el An√°lisis de Componentes Principales - pca\n\nlibrary(vegan)          # Librer√≠a requerida\n\n# Datos del procedimiento 2.1) Sumas y norma de los vectores\nhead(datos[,2:5])             # Variables y observaciones (estudiantes)\n\n         LTot Cint LEsp LBra\nAlumno 1  170   85   43   57\nAlumno 2  160   80   41   54\nAlumno 3  156   88   35   48\nAlumno 4  173   63   53   59\nAlumno 5  170   86   47   56\nAlumno 6  165   89   45   61\n\npca <- rda(datos[,2:5])             # Realizaci√≥n del pca\n\nbiplot(pca)            # Figura del pca\nabline(h=0, col=\"blue\")         # abline (h=0) l√≠nea horizontal del plano cartesiano\nabline(v=0, col=\"blue\")         # abline (v=0) l√≠nea vertical del plano cartesiano\ngrid()"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#ejemplo-2.-an√°lisis-discriminante-lineal-lda",
    "href": "Taller2.2.Introd.matrices.html#ejemplo-2.-an√°lisis-discriminante-lineal-lda",
    "title": "Taller2.2 Intro_Matrices",
    "section": "Ejemplo 2. An√°lisis discriminante lineal (lda)",
    "text": "Ejemplo 2. An√°lisis discriminante lineal (lda)\n\n2.1 Cargar las librer√≠as o paquetes de R\n\n# librer√≠as\nlibrary(MASS)\nlibrary(lattice)\n\n\n\n2.2 Cargar base de datos (datos1.csv)\n\n# 2.2 Cargar la base de datos de Excel *.csv\n\ndatos2 = read.csv2(\"datos1.csv\",row.names=1)  \ndatos2           # Falta un dato al estudiante 13\n\n          Sexo Longitud.total Cintura Longitud.espalda Long.brazo\nAlumno 1     F            170    85.0               43         57\nAlumno 2     F            160    80.0               41         54\nAlumno 3     F            156    88.0               35         48\nAlumno 4     F            173    63.0               53         59\nAlumno 5     M            170    86.0               47         56\nAlumno 6     M            165    89.0               45         61\nAlumno 7     M            170    88.0               56         59\nAlumno 8     M            181    80.0               60         55\nAlumno 9     M            175    76.0               55         54\nAlumno 10    M            186    45.0               60         86\nAlumno 11    F            168    65.0               49         55\nAlumno 12    F            155    70.0               36         50\nAlumno 13    F            150    85.5               45         NA\nAlumno 14    F            158    72.0               40         55\nAlumno 15    M            172    79.0               43         82\nAlumno 16    F            155    68.0               39         50\nAlumno 17    F            163    68.0               38         70\nAlumno 18    M            170   122.0               48         60\nAlumno 19    F            157    60.0               36         69\nAlumno 20    F            162    60.0               50         76\nAlumno 21    M            170    82.0               55         56\nAlumno 22    F            158    75.0               35         60\nAlumno 23    M            174    87.0               51         56\nAlumno 24    F            170    88.0               37         78\nAlumno 25    F            162    68.0               37         53\n\nstr(datos2)      # Estructura de la base de datos\n\n'data.frame':   25 obs. of  5 variables:\n $ Sexo            : chr  \"F\" \"F\" \"F\" \"F\" ...\n $ Longitud.total  : int  170 160 156 173 170 165 170 181 175 186 ...\n $ Cintura         : num  85 80 88 63 86 89 88 80 76 45 ...\n $ Longitud.espalda: int  43 41 35 53 47 45 56 60 55 60 ...\n $ Long.brazo      : int  57 54 48 59 56 61 59 55 54 86 ...\n\n\n\ndatos2=na.omit(datos2)      # na.omit, para eliminar al estudiante 13\ndatos2\n\n          Sexo Longitud.total Cintura Longitud.espalda Long.brazo\nAlumno 1     F            170      85               43         57\nAlumno 2     F            160      80               41         54\nAlumno 3     F            156      88               35         48\nAlumno 4     F            173      63               53         59\nAlumno 5     M            170      86               47         56\nAlumno 6     M            165      89               45         61\nAlumno 7     M            170      88               56         59\nAlumno 8     M            181      80               60         55\nAlumno 9     M            175      76               55         54\nAlumno 10    M            186      45               60         86\nAlumno 11    F            168      65               49         55\nAlumno 12    F            155      70               36         50\nAlumno 14    F            158      72               40         55\nAlumno 15    M            172      79               43         82\nAlumno 16    F            155      68               39         50\nAlumno 17    F            163      68               38         70\nAlumno 18    M            170     122               48         60\nAlumno 19    F            157      60               36         69\nAlumno 20    F            162      60               50         76\nAlumno 21    M            170      82               55         56\nAlumno 22    F            158      75               35         60\nAlumno 23    M            174      87               51         56\nAlumno 24    F            170      88               37         78\nAlumno 25    F            162      68               37         53\n\ncolnames(datos2) <- c(\"Sexo\",\"LTot\",\"Cint\",\"LEsp\",\"LBra\")       # R√≥tulos de la base de datos\nhead(datos2)          # Base de datos abreviada\n\n         Sexo LTot Cint LEsp LBra\nAlumno 1    F  170   85   43   57\nAlumno 2    F  160   80   41   54\nAlumno 3    F  156   88   35   48\nAlumno 4    F  173   63   53   59\nAlumno 5    M  170   86   47   56\nAlumno 6    M  165   89   45   61\n\n\n\ndatos2$Sexo = as.factor(datos2$Sexo)\nstr(datos2)     # Estructura de la base de datos (datos2)\n\n'data.frame':   24 obs. of  5 variables:\n $ Sexo: Factor w/ 2 levels \"F\",\"M\": 1 1 1 1 2 2 2 2 2 2 ...\n $ LTot: int  170 160 156 173 170 165 170 181 175 186 ...\n $ Cint: num  85 80 88 63 86 89 88 80 76 45 ...\n $ LEsp: int  43 41 35 53 47 45 56 60 55 60 ...\n $ LBra: int  57 54 48 59 56 61 59 55 54 86 ...\n - attr(*, \"na.action\")= 'omit' Named int 13\n  ..- attr(*, \"names\")= chr \"Alumno 13\"\n\nsummary(datos2) # Resumen estad√≠stico de datos2\n\n Sexo        LTot            Cint             LEsp            LBra      \n F:14   Min.   :155.0   Min.   : 45.00   Min.   :35.00   Min.   :48.00  \n M:10   1st Qu.:159.5   1st Qu.: 68.00   1st Qu.:37.75   1st Qu.:54.75  \n        Median :169.0   Median : 77.50   Median :44.00   Median :56.50  \n        Mean   :166.7   Mean   : 76.83   Mean   :45.38   Mean   :60.79  \n        3rd Qu.:170.5   3rd Qu.: 86.25   3rd Qu.:51.50   3rd Qu.:63.00  \n        Max.   :186.0   Max.   :122.00   Max.   :60.00   Max.   :86.00  \n\n\n\n# Matriz de variables para los hombres\nhombres = datos2[datos2$Sexo == \"M\",]\nhombres\n\n          Sexo LTot Cint LEsp LBra\nAlumno 5     M  170   86   47   56\nAlumno 6     M  165   89   45   61\nAlumno 7     M  170   88   56   59\nAlumno 8     M  181   80   60   55\nAlumno 9     M  175   76   55   54\nAlumno 10    M  186   45   60   86\nAlumno 15    M  172   79   43   82\nAlumno 18    M  170  122   48   60\nAlumno 21    M  170   82   55   56\nAlumno 23    M  174   87   51   56\n\nmujeres = datos2[datos2$Sexo == \"F\",]\nmujeres\n\n          Sexo LTot Cint LEsp LBra\nAlumno 1     F  170   85   43   57\nAlumno 2     F  160   80   41   54\nAlumno 3     F  156   88   35   48\nAlumno 4     F  173   63   53   59\nAlumno 11    F  168   65   49   55\nAlumno 12    F  155   70   36   50\nAlumno 14    F  158   72   40   55\nAlumno 16    F  155   68   39   50\nAlumno 17    F  163   68   38   70\nAlumno 19    F  157   60   36   69\nAlumno 20    F  162   60   50   76\nAlumno 22    F  158   75   35   60\nAlumno 24    F  170   88   37   78\nAlumno 25    F  162   68   37   53\n\n\n\nPaso 1. Vectores de mesdias para hombres y muejeres (M1 y M2)\n\n# Comando colMeans para el c√°lculo de los vectores de media\n\npromedio.h = colMeans(hombres[,c(2:5)])\npromedio.h\n\n LTot  Cint  LEsp  LBra \n173.3  83.4  52.0  62.5 \n\npromedio.m = colMeans(mujeres[,c(2:5)])\npromedio.m\n\n     LTot      Cint      LEsp      LBra \n161.92857  72.14286  40.64286  59.57143 \n\n\n\n# C√°lculo de la matriz centrada por cada sexo\n\nm.centrada.h = t(t(hombres[,2:5]) - promedio.h)\nm.centrada.h  \n\n          LTot  Cint LEsp LBra\nAlumno 5  -3.3   2.6   -5 -6.5\nAlumno 6  -8.3   5.6   -7 -1.5\nAlumno 7  -3.3   4.6    4 -3.5\nAlumno 8   7.7  -3.4    8 -7.5\nAlumno 9   1.7  -7.4    3 -8.5\nAlumno 10 12.7 -38.4    8 23.5\nAlumno 15 -1.3  -4.4   -9 19.5\nAlumno 18 -3.3  38.6   -4 -2.5\nAlumno 21 -3.3  -1.4    3 -6.5\nAlumno 23  0.7   3.6   -1 -6.5\n\nm.centrada.m = t(t(mujeres[,2:5]) - promedio.m)\nm.centrada.m \n\n                 LTot        Cint       LEsp        LBra\nAlumno 1   8.07142857  12.8571429  2.3571429  -2.5714286\nAlumno 2  -1.92857143   7.8571429  0.3571429  -5.5714286\nAlumno 3  -5.92857143  15.8571429 -5.6428571 -11.5714286\nAlumno 4  11.07142857  -9.1428571 12.3571429  -0.5714286\nAlumno 11  6.07142857  -7.1428571  8.3571429  -4.5714286\nAlumno 12 -6.92857143  -2.1428571 -4.6428571  -9.5714286\nAlumno 14 -3.92857143  -0.1428571 -0.6428571  -4.5714286\nAlumno 16 -6.92857143  -4.1428571 -1.6428571  -9.5714286\nAlumno 17  1.07142857  -4.1428571 -2.6428571  10.4285714\nAlumno 19 -4.92857143 -12.1428571 -4.6428571   9.4285714\nAlumno 20  0.07142857 -12.1428571  9.3571429  16.4285714\nAlumno 22 -3.92857143   2.8571429 -5.6428571   0.4285714\nAlumno 24  8.07142857  15.8571429 -3.6428571  18.4285714\nAlumno 25  0.07142857  -4.1428571 -3.6428571  -6.5714286\n\n\n\n\nPaso 2. diferencia y suma en los vectores de media (M1-M2 y M1+M2)\n\n# Diferencia de medias (M1-M2)'\ndif = t(promedio.h - promedio.m)\ndif\n\n         LTot     Cint     LEsp     LBra\n[1,] 11.37143 11.25714 11.35714 2.928571\n\n# Suma de medias (M1 + M2)  \nsum = promedio.h + promedio.m\nsum\n\n     LTot      Cint      LEsp      LBra \n335.22857 155.54286  92.64286 122.07143 \n\n\n\n\nPaso 3. matriz de varianza covarianza por sexos y la generalizada\n\n# Varianzas - Covarianzas de hombres\ncov.h = var(hombres[,2:5])\nround(cov.h,2)\n\n       LTot    Cint   LEsp    LBra\nLTot  37.57  -79.02  27.11   30.17\nCint -79.02  347.16 -57.00 -116.89\nLEsp  27.11  -57.00  37.11   -5.22\nLBra  30.17 -116.89  -5.22  134.28\n\n# Varianzas - Covarianzas de mujeres\ncov.m = var(mujeres[,2:5])\nround(cov.m,2) \n\n      LTot   Cint   LEsp   LBra\nLTot 36.99   5.01  22.97  22.12\nCint  5.01  94.13 -24.41 -15.24\nLEsp 22.97 -24.41  35.32   8.60\nLBra 22.12 -15.24   8.60  95.96\n\n# Varianzas - covarianzas generalizadas (cov.g)\n# cov.g = (n.h * cov.h + n.m * cov.m)/N\nsummary(datos2$Sexo)\n\n F  M \n14 10 \n\ncov.g = (10*cov.h + 14*cov.m)/24\nround(cov.g,2)\n\n       LTot   Cint   LEsp   LBra\nLTot  37.23 -30.00  24.70  25.47\nCint -30.00 199.56 -37.99 -57.59\nLEsp  24.70 -37.99  36.07   2.84\nLBra  25.47 -57.59   2.84 111.92\n\n# varianzas - covarianzas generalizadas e invertidas (S^-1)\n\ncov.g.i = solve(cov.g)\nround(cov.g.i,2)\n\n      LTot Cint  LEsp  LBra\nLTot  0.07 0.00 -0.05 -0.02\nCint  0.00 0.01  0.01  0.00\nLEsp -0.05 0.01  0.07  0.01\nLBra -0.02 0.00  0.01  0.01\n\n\n\n\nPaso 4. Funci√≥n discriminante Wx (Wall y Anderson)\nWx = [(M1 - M1)‚Äô * S^-1 * xi] - [1/2 * (M1 - M2)‚Äô * S^-1 * (M1 + M2)]\n\n# Convertir datos2 a formato matricial como datos3\n\ndatos3 = as.matrix (datos2[,2:5])\ndatos3\n\n          LTot Cint LEsp LBra\nAlumno 1   170   85   43   57\nAlumno 2   160   80   41   54\nAlumno 3   156   88   35   48\nAlumno 4   173   63   53   59\nAlumno 5   170   86   47   56\nAlumno 6   165   89   45   61\nAlumno 7   170   88   56   59\nAlumno 8   181   80   60   55\nAlumno 9   175   76   55   54\nAlumno 10  186   45   60   86\nAlumno 11  168   65   49   55\nAlumno 12  155   70   36   50\nAlumno 14  158   72   40   55\nAlumno 15  172   79   43   82\nAlumno 16  155   68   39   50\nAlumno 17  163   68   38   70\nAlumno 18  170  122   48   60\nAlumno 19  157   60   36   69\nAlumno 20  162   60   50   76\nAlumno 21  170   82   55   56\nAlumno 22  158   75   35   60\nAlumno 23  174   87   51   56\nAlumno 24  170   88   37   78\nAlumno 25  162   68   37   53\n\n# Para el ejercicio, solo usar√©mos los 10 primeros estudiantes\n\n\n# 10 primeros estudiantes como vectores (xi)\n\nx1 = as.vector (datos3[1,])   # x1 Estudiante 1 [1,] es fila 1\nx2 = as.vector (datos3[2,])\nx3 = as.vector (datos3[3,])\nx4 = as.vector (datos3[4,])\nx5 = as.vector (datos3[5,])\nx6 = as.vector (datos3[6,])\nx7 = as.vector (datos3[7,])\nx8 = as.vector (datos3[8,])\nx9 = as.vector (datos3[9,])\nx10 = as.vector (datos3[10,])\n\n\n\nDiscriminante de los 10 primeros estudiantes\n\n# Wx = [(M1 - M1)' * S^-1 * xi] - [1/2 * (M1 - M2)' * S^-1 * (M1 + M2)]\n\nView(datos2)\n\nW1 = ((dif) %*% cov.g.i %*% x1) - (1/2 * (dif %*% cov.g.i %*% sum))  # Discrim para estudiante 1\n\nW2 = ((dif) %*% cov.g.i %*% x2) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW3 = ((dif) %*% cov.g.i %*% x3) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW4 = ((dif) %*% cov.g.i %*% x4) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW5 = ((dif) %*% cov.g.i %*% x5) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW6 = ((dif) %*% cov.g.i %*% x6) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW7 = ((dif) %*% cov.g.i %*% x7) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW8 = ((dif) %*% cov.g.i %*% x8) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW9 = ((dif) %*% cov.g.i %*% x9) - (1/2 * (dif %*% cov.g.i %*% sum)) \nW10 = ((dif) %*% cov.g.i %*% x10) - (1/2 * (dif %*% cov.g.i %*% sum)) \n\n\n\nCrear base de datos con los discriminantes (da)\n\nda = data.frame(W1,W2,W3,W4,W5,W6,W7,W8,W9,W10)\nda\n\n          W1        W2        W3        W4       W5       W6       W7       W8\n1 -0.1271618 -3.265828 -5.281626 0.6418749 1.613796 1.109279 5.899785 7.149955\n        W9      W10\n1 3.592283 4.048357\n\nda = t(da)\nda\n\n          [,1]\nW1  -0.1271618\nW2  -3.2658277\nW3  -5.2816257\nW4   0.6418749\nW5   1.6137960\nW6   1.1092793\nW7   5.8997846\nW8   7.1499551\nW9   3.5922827\nW10  4.0483574\n\n\n\n\nBase de datos con discriminados vs clasificaci√≥n inicial\n\ngrupo.i = datos2[1:10,1]\ngrupo.i\n\n [1] F F F F M M M M M M\nLevels: F M\n\ngrupo.d.m = sample(\"F\", size=3, replace =TRUE)  # grupo.d.m = muestra de muejeres discriminadas\ngrupo.d.m\n\n[1] \"F\" \"F\" \"F\"\n\ngrupo.d.h = sample(\"M\", size=7, replace =TRUE)  # grupo.d.m = muestra de hombres discriminados\ngrupo.d.h\n\n[1] \"M\" \"M\" \"M\" \"M\" \"M\" \"M\" \"M\"\n\ngrupo.d = data.frame(c(grupo.d.m, grupo.d.h))  # grupo.d = Columna con grupos discriminados\n\ndatos.d = data.frame(da, grupo.i, grupo.d)   \ndatos.d\n\n            da grupo.i c.grupo.d.m..grupo.d.h.\nW1  -0.1271618       F                       F\nW2  -3.2658277       F                       F\nW3  -5.2816257       F                       F\nW4   0.6418749       F                       M\nW5   1.6137960       M                       M\nW6   1.1092793       M                       M\nW7   5.8997846       M                       M\nW8   7.1499551       M                       M\nW9   3.5922827       M                       M\nW10  4.0483574       M                       M\n\n# write.csv2(datos.d, \"discriminados.csv\")"
  },
  {
    "objectID": "Taller5.1.nmds.malezas.html#procedimiento-de-la-exploraci√≥n",
    "href": "Taller5.1.nmds.malezas.html#procedimiento-de-la-exploraci√≥n",
    "title": "Taller5. NMDS Malezas",
    "section": "Procedimiento de la exploraci√≥n",
    "text": "Procedimiento de la exploraci√≥n\n\n\nCargar librer√≠as requeridas\nCargar la base malezas.csv\nCorrer el NMDS con una distancia binaria (Jaccard)\nRealizar las opciones gr√°ficas con las librer√≠as \"vegan\" y \"ggplot2\".\n\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary (ade4)\nrequire(vegan)\nlibrary(analogue)\nlibrary(magrittr)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(vegan)\nlibrary(ggplot2)\nlibrary(ggrepel)\n\n\n\n\nCargar o importar la base de datos\n\n\n# Base de datos\ndatos<-read.csv2(\"malezas.csv\",row.names=1)  \n\n\n\n\n1) Ordenaci√≥n de las localidades y las especies de malezas.\n\nSe prsenta un estr√©s de 0.13 (13%) con la distancia binaria de Jaccard.\n\n# 1. 1) Ordenaci√≥n con el nmds\ndatos.nmds <- metaMDS(datos[,3:52],trace = FALSE,distance = \"jaccard\")\ndatos.nmds\n\n\nCall:\nmetaMDS(comm = datos[, 3:52], distance = \"jaccard\", trace = FALSE) \n\nglobal Multidimensional Scaling using monoMDS\n\nData:     datos[, 3:52] \nDistance: jaccard \n\nDimensions: 2 \nStress:     0.1362424 \nStress type 1, weak ties\nBest solution was repeated 1 time in 20 tries\nThe best solution was from try 17 (random start)\nScaling: centring, PC rotation, halfchange scaling \nSpecies: expanded scores based on 'datos[, 3:52]' \n\n\n\n\n\n2) Figuras del nmds con el paquete ‚Äúvegan‚Äù\n\n2.1 nMDS con solapamiento de taxones\n\n\n\nLa figura muestra la ordenaci√≥n de las especies de malezas con las localidades evaluadas. Muchas de las especies quedan solapadas enn la figura, en la siguiente figura se aplicar√° un comando para eliminar el solapamiento.\n\n# datos y datos.nmds est√°n en los fragmentos de arriba\ndatos<-read.csv2(\"malezas.csv\",row.names=1)\ndatos.nmds <- metaMDS(datos[,3:52],trace = FALSE,distance = \"jaccard\")\n\n# figura del nmds\nfig=plot(datos.nmds, type = \"t\",display = c(\"n\", \"species\"),\n         ylab=\"Dim 2\", xlab=\"Dim 1\", cex=0.7,shrink = FALSE)\n# Texto\ntext(datos.nmds, display=\"sites\", labels = as.character(datos$Finca), \n     cex=0.7, col=\"blue\", lwd=1.5, pos=3)\n# Puntos *opcionales\npoints(datos.nmds, display = \"sites\",cex = 0.8, \n       col = \"lightblue\", lwd=1.5)\n# plano cartesiano\nabline(h=0,lty=2)\nabline(v=0,lty=2)\n\n\n\n\n\n\n\n2.2 Ordenaci√≥n con el comando ‚Äúorditorp‚Äù\n\nLa figura elimina el solapamiento de las especies con el comando orditorp. Las especies de malezas son graficadas en rojo y las fincas en color azul.\n\nfig=plot(datos.nmds, type = \"n\",display = c(\"n\", \"species\"),\n         ylab=\"Dim 2\", xlab=\"Dim 1\", ex=0.7,shrink = FALSE)\n#\ntext(datos.nmds, display=\"sites\", labels = as.character(datos$Finca), \n     cex=0.7, col=\"blue\", lwd=1.5, pos=3)\n#\nordi=orditorp(datos.nmds, display = \"species\", \n              shrink = FALSE, col = \"red\", type=\"n\") \n#\npoints(datos.nmds, display = \"sites\",cex = 0.7, \n       col = \"lightblue\", lwd=1.5)\nabline(h=0,lty=2)\nabline(v=0,lty=2)\n\n\n\n\n#‚Äî-\n\n\n\n\n3) NMDS con paquete ggplot2\n\n\n\nA continuaci√≥n se utilizar√°n las coordenadas de las regiones, las fincas y las especies de malazas, para graficarlas con el paquete ggplot2, debido a que muestra unas im√°genes m√°s did√°cticas y compactas. El siguiente comando - names(datos.nmds), permite visualizar los insumos del escalamiento multidimensional realizado.\n\n# Correr nuevamente el nMDS\nnames(datos.nmds)\n\n [1] \"nobj\"       \"nfix\"       \"ndim\"       \"ndis\"       \"ngrp\"      \n [6] \"diss\"       \"iidx\"       \"jidx\"       \"xinit\"      \"istart\"    \n[11] \"isform\"     \"ities\"      \"iregn\"      \"iscal\"      \"maxits\"    \n[16] \"sratmx\"     \"strmin\"     \"sfgrmn\"     \"dist\"       \"dhat\"      \n[21] \"points\"     \"stress\"     \"grstress\"   \"iters\"      \"icause\"    \n[26] \"call\"       \"model\"      \"distmethod\" \"distcall\"   \"data\"      \n[31] \"distance\"   \"converged\"  \"tries\"      \"bestry\"     \"engine\"    \n[36] \"species\"   \n\n\n\n\n3.1 Coordenadas de los sitios y el factor ‚Äúcoord.sit‚Äù\n\nCon el siguiente comando - datos.nmds$points, se extraen las coordenadas de los sitios y con el comando datos$Regi√≥n se obtienen la columna del factor regi√≥n.\n\n# 1) Coordenadas de los sitios y el factor (coord.sit)\ncoord.sit <- as.data.frame(datos.nmds$points)   # Coordenadas de los sitios\ncoord.sit$sitio <- rownames(coord.sit)          # Crear una columna con nombres de los sitios\ncoord.sit$grp <- datos$Regi√≥n                   # Adicionar columna de grupos por regi√≥n\nhead(coord.sit)                                 # vista resumida de las coordenadas de stios\n\n            MDS1       MDS2 sitio  grp\nACa -0.368862767 -0.2302099   ACa Alta\nACr  0.400349771 -0.1960941   ACr Alta\nALa -0.583049989  0.3700389   ALa Alta\nBBu  0.885277142  0.1463791   BBu Baja\nBLa -0.094234967  0.2144676   BLa Baja\nBMa  0.001413936  0.5159284   BMa Baja\n\n\n\n\n3.2 Coordenadas de los taxones ‚Äúcoord.tax‚Äù\n\nCon el comando datos.nmds$species, se extraen las coordenadas de las especies.\n\n# 2) Coordenadasde las especies (coord.tax) \ncoord.tax <- as.data.frame(datos.nmds$species)  # Dos primeros ejes\ncoord.tax$especies <- rownames(coord.tax)       # Insertar columna con nombres de las especies\nhead(coord.tax) \n\n             MDS1       MDS2 especies\nAcal  -0.26775239  0.1591864     Acal\nAchas -0.22678596  0.3661156    Achas\nAcsc   0.00670345  0.8749320     Acsc\nAdein  0.62990712 -0.3486035    Adein\nAdite -0.09939973 -0.1925403    Adite\nAlal  -0.01647583 -0.5190513     Alal\n\n\n\n\n\n\n3.3 Figura con de elipses\n\nLa siguiente figura presenta los comandos que se organizan por sitios, especies y el factor Regi√≥n.\n\nggplot() +\n# Sitios\n  geom_text_repel(data = coord.sit,aes(MDS1,MDS2,label = as.character(datos$Finca)),\n                  size=4)+   # Muestra el cuadro de la figura\n  geom_point(data = coord.sit,aes(MDS1,MDS2,colour=grp),size=4)+\n  scale_shape_manual(values = c(21:25))+\n\n# Especies  \n  geom_segment(data = coord.tax,aes(x = 0, y = 0, xend = MDS1, yend = MDS2), \n               arrow = arrow(angle=0,length = unit(0,\"cm\"),\n                             type = \"closed\"),linetype=0, size=0,colour = \"red\")+\n  geom_text_repel(data = coord.tax,aes(MDS1,MDS2,label=especies),colour = \"red\")+\n\n#Factor\n  geom_polygon(data=coord.sit,aes(x=MDS1,y=MDS2,fill=grp,group=grp),alpha=0.30) +\n  geom_hline(yintercept=0,linetype=3,size=1) + \n  geom_vline(xintercept=0,linetype=3,size=1)+\n  guides(shape=guide_legend(title=NULL,color=\"black\"),\n         fill=guide_legend(title=NULL))+\n  theme_bw()+\n  theme(panel.grid=element_blank())"
  },
  {
    "objectID": "Taller5.1.nmds.malezas.html#taller-de-entrenamiento",
    "href": "Taller5.1.nmds.malezas.html#taller-de-entrenamiento",
    "title": "Taller5. NMDS Malezas",
    "section": "Taller de entrenamiento",
    "text": "Taller de entrenamiento\n\n\n\nObjetivo: Poner en pr√°ctica los conceptos vistos en este taller, realizando las siguientes opciones realizando un NMDS con las variables biol√≥gicas del estudio de caso (taxones). Enviar los resultados al Teams del profesor."
  },
  {
    "objectID": "Taller6.1.cla.bah√≠as.html#referencias-bibliogr√°ficas-de-apoyo.",
    "href": "Taller6.1.cla.bah√≠as.html#referencias-bibliogr√°ficas-de-apoyo.",
    "title": "Taller6.1 CLA Bah√≠as",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\n\n\nCl√∫ster Jer√°rquicos\n\n\n\n\nLibro: An√°lisis de datos ecol√≥gicos y ambientales - Rodr√≠guez-Barrios Javier 2023 Se detallan todos los procedimientos descritos en el presente ejercicio.\nMicroalgas de la CGSM - Vidal et al.¬†(2018). Implementaci√≥n de un cluster no jer√°rquico para valorar paleoambientes con microalgas de la Ci√©naga Grande de Santa Marta.\nCluster Brinda informaci√≥n complementaria para los diferentes pasos que requiere un an√°lisis de cl√∫ster.\nClustering y heatmaps Similar al anterior enlace, brinda informaci√≥n detallada sobre el an√°lisis de cl√∫ster.\nAn√°lisis de conglomerados Otro enlace con informaci√≥n general sobre los cl√∫ster.\nClustering y heatmaps: aprendizaje no supervisado Aplicaci√≥n de cl√∫ster en diferentes disciplinas.\nHierarchical Cluster Analysis Enlace en el que se encuentra informaci√≥n sobre cluster jer√°rquicos y t√©cnicas detalladas para seleccionar el n√∫mero de k - cl√∫ster o grupos formados.\nDetermining The Optimal Number Of Clusters Informaci√≥n relevante para el paso 3 de este ejercicio, relacionado a la definici√≥n de los k-cl√∫ster o el n√∫mero de grupos formados.\n\n\nCl√∫ster no Jer√°rquicos\n\n\nK-means Cluster Analysis Brinda informaci√≥n sobre la construcci√≥n de cl√∫ster no jer√°rquicos.\n\n\nOtros\n\n\n\n\nIntroduction to dendextend El paquete dendextend brinda opciones para comparar y visualizar dendogramas. Esto complementa al paso 3 del presente ejercicio, relacionado a la definici√≥n de los k-cl√∫ster formados.\nHierarchical Clustering on Principal Components Articulaci√≥n de los cl√∫ster en los an√°lisis de componentes principales.\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(ellipse)\nrequire(gclus)\nrequire(SciViews)\nrequire(ade4)\nrequire(vegan)\nlibrary(corrplot)\nlibrary(ggplot2)\nlibrary(pheatmap)\nlibrary(\"gplots\")\nlibrary(gridExtra)\nlibrary(factoextra)\nlibrary(reshape)\n\n\n\n\nCargar o importar la base de datos\n\n\n# Base de datos\ndatos = read.csv2(\"FQmarino1.csv\",row.names=1)\n\ncolnames(datos) = c(\"Sitio\",\"pH\",\"Cond\",\"Turb\",\"Temp\",\"Sali\",\"CFot\",\"Oxig\")\n\n\n\n\nExploraci√≥n de los datos\n\n\n\nPara este ejemplo se urtilizar√°n figuras que relacionan a dos o m√°s variables. En casos en los que se tengan diferentes grupos definidos, se pueden incluir figuras de cajas que permitan visualizar diferencias entre dichos grupos definidos por alg√∫n factor.\n\n# Elipses con colores\nM <- cor(datos[,2:8])            # Matriz de Correlaci√≥n (M)\n\nLa Figura¬†1.1 permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlaci√≥n de Pearson.\n\ncorrplot(M,  method = \"circle\",            # Correlaciones con circulos\n         type = \"lower\", insig=\"blank\",    # Forma del panel\n         order = \"AOE\", diag = FALSE,      # Ordenar por nivel de correlaci√≥n\n         addCoef.col =\"black\",             # Color de los coeficientes\n         number.cex = 0.8,                 # Tama√±o del texto\n         col = COL2(\"RdYlBu\", 200))        # Transparencia de los circulos\n\n\n\n\nFigura¬†1.1: Correlaciones y coeficientes de correlaci√≥n.\n\n\n\n\nLa Figura¬†1.2 es otra posigilidad para visualizar la relaci√≥n entre las parejas de variables, pero adem√°s incluye p√°neles que visualizan la dispersi√≥n de los datos.\n\nlibrary(GGally)\n\nggpairs(data=datos[,c(2:8)], \n        diag = list(continuous = \"densityDiag\"), \n        upper = list(combo = \"box\"), \n        lower = list(combo = \"dot\", aes(fill = Sitio))) +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))\n\n\n\n\nFigura¬†1.2: Correlaciones, dispersi√≥n y coeficientes de correlaci√≥n.\n\n\n\n\nLa Figura¬†2.2 a diferencia de la anterior, clasifica a los grupos por colores y adem√°s incluye a sus coeficientes de correlaci√≥n y el patr√≥n de distribuci√≥n de cada variable mediante histogramas de densidad.\n\nlibrary(GGally)\n\nggpairs(datos[,c(2:8)], aes(color=datos$Sitio),\n        diag = list(continuous = \"densityDiag\"), \n        upper = list(combo = \"box\"), \n        lower = list(combo = \"dot\")) +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))\n\n\n\n\nFigura¬†1.3: Correlaciones, dispersi√≥n y coeficientes de correlaci√≥n, por cada grupo en comparaci√≥n.\n\n\n\n\nLa Figura¬†1.4 permite visualizar a una de las relaciones relevantes, diferenciando por tipos de sitios (S1 y S2).\n\n# Relaci√≥n trivariada - Lineal\npanel.lm = function(x, y, ...) {\n  tmp<-lm(y~x,na.action=na.omit)\n  abline(tmp, lwd = 1.5, col= 2)\n  points(x,y, ...)}\n\ncoplot(Temp ~ CFot | Sitio, pch=19,\n       panel = panel.smooth, data=datos)\n\n\n\n\nFigura¬†1.4: Relaci√≥n bivariada en cada grupo asignado (Sitios).\n\n\n\n\nLa Figura¬†1.5 es otra forma de visualizar la relaci√≥n anterior, pero con el paquete ‚Äúggplot2‚Äù\n\nggplot(datos, aes(x = CFot, y = Temp)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~Sitio) + \n  theme_bw() + \n  theme(panel.grid=element_blank())\n\n\n\n\nFigura¬†1.5: Relaci√≥n bivariada en cada grupo asignado (Sitios).\n\n\n\n\nFinalmente, la Figura¬†2.1 permite visualizar una relaci√≥n m√°s detallada entre dos variables seleccionadas y cuyos puntos caracterizan a cada uno de los sitios evaluados.\n\n# Selecci√≥n de una relaci√≥n bivariada\nnames(datos)\n\n[1] \"Sitio\" \"pH\"    \"Cond\"  \"Turb\"  \"Temp\"  \"Sali\"  \"CFot\"  \"Oxig\" \n\nggplot(datos, aes(x=CFot, y= Temp)) + \n  geom_point(aes(color = Sitio), size=3) + \n  geom_smooth(method= \"lm\") + \n  theme_bw() +\n  theme(panel.grid=element_blank())\n\n\n\n\nFigura¬†1.6: Relaci√≥n bivariada en cada grupo asignado (Sitios).\n\n\n\n\nLa Figura¬†2.2 permite visualizar las diferencias entre los dos grupos de localidades (bah√≠as), en t√©rminos de cada variable fisicoqu√≠mica.\n\n# Selecci√≥n de una relaci√≥n bivariada\n\nggplot(melt(datos[,c(1, 2:8)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=Sitio)) + \n  scale_fill_manual(values = c('#fc8d59','#99d594')) +\n  labs(x=\"\",y=\"Fisicoqu√≠micos\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†1.7: Diferencias entre cada grupo asignado (Sitios), con base en las variables fisicoqu√≠micas."
  },
  {
    "objectID": "Taller6.1.cla.bah√≠as.html#paso-1.-distancia-entre-observaciones",
    "href": "Taller6.1.cla.bah√≠as.html#paso-1.-distancia-entre-observaciones",
    "title": "Taller6.1 CLA Bah√≠as",
    "section": "PASO 1. Distancia entre observaciones",
    "text": "PASO 1. Distancia entre observaciones\n\nSon muchas las distancias que pueden emplearse, pero cada una se ajusta al tipo de datos que se requieran trabajar. Para este caso se usar√° la distancia eucl√≠dea, debido a que se ajusta de manera apropiada a datos ambientales, incorporando adem√°s al comando scale, debido a que permite estandarizar a este tipo de variables que presentan escalas dis√≠miles.\n\n# Matriz de distancia\nd.euclid <- dist(scale(datos[,c(2:8)]))\nround(d.euclid,2)\n\n      BTag PBet Mono Gran PGran  Rod\nPBet  2.59                          \nMono  2.94 3.14                     \nGran  3.16 4.09 3.84                \nPGran 3.94 3.75 4.82 2.13           \nRod   3.41 4.12 4.53 2.72  3.17     \nAero  4.47 4.54 5.22 3.47  3.30 3.55"
  },
  {
    "objectID": "Taller6.1.cla.bah√≠as.html#paso-2.-elecci√≥n-del-m√©todo-de-agrupaci√≥n-de-mayor-ajuste",
    "href": "Taller6.1.cla.bah√≠as.html#paso-2.-elecci√≥n-del-m√©todo-de-agrupaci√≥n-de-mayor-ajuste",
    "title": "Taller6.1 CLA Bah√≠as",
    "section": "PASO 2. Elecci√≥n del m√©todo de agrupaci√≥n de mayor ajuste",
    "text": "PASO 2. Elecci√≥n del m√©todo de agrupaci√≥n de mayor ajuste\n\nSon siete las opciones de dendogramas, de las cuales solo una ser√° la que mejor se ajusta a los datos trabajados. Para ello, primero se realizar√°n los dendogramas y posteriormente se escoger√° l de mejor ajuste con la correlaci√≥n cofen√©tica.\n\n\n2.1 Siete m√©todos de agrupamiento\n\n\n# M√©todo 1. Vecino m√°s cercano \"Cl.single\", funci√≥n \"hclust\" y m√©todo \"single\"\nCl.single <- hclust(d.euclid,method=\"single\")\n\n\n# M√©todo 2. Vecino m√°s lejano \"Cl.complete\", funci√≥n \"complete\"  \nCl.complete<-hclust(d.euclid,method=\"complete\")\n\n\n# M√©todo 3. UPGMA funci√≥n \"average\" Uni√≥n Promedio no Ponderado\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n# M√©todo 4. UPGMC funci√≥n \"mcquitty\" Uni√≥n Promedio Ponderado\nCl.upgmc<-hclust(d.euclid,method=\"mcquitty\")\n\n\n# M√©todo 5. WPGMA funci√≥n \"centroid\"\nCl.wpgma<-hclust(d.euclid,method=\"centroid\")\n\n\n# M√©todo 6. WPGMC funci√≥n \"median\"\nCl.wpgmc<-hclust(d.euclid,method=\"median\")\n\n\n# M√©todo 7. WARD, funci√≥n \"ward\"\nCl.ward<-hclust(d.euclid,method=\"ward.D\")\n\n\n\n\n2.2 Figuras de los dendogramas con los siete m√©todos de agrupamiento\n\n\n\nA continuaci√≥n se realizar√° un panel que contenga hasta 4 figuras de dendogramas (Figura¬†2.5 y Figura¬†2.6), lo cual permite resumir al n√∫mero de gr√°ficas generadas, el comando que se emplear√° para incluir a varias figuras en un mismo panel grafico es grid.arrange() del paquete gridextra.\n\nf1 <- fviz_dend(Cl.single, k = 2,        # k grupos (opcionales)\n          cex = 0.7,               # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Vecino m√°s Cercano - Single\")  # Rotulo de t√≠tulo\n\nf2 <- fviz_dend(Cl.complete, k = 2,        # k grupos (opcionales)\n          cex = 0.7,               # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Vecino m√°s Lejano - Complete\")  # Rotulo de t√≠tulo\n\n\nf3 <- fviz_dend(Cl.upgma, k = 2,           # k grupos (opcionales)\n          cex = 0.7,                 # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Uni√≥n Promedio no Ponderado - upgmc\")  # Rotulo de t√≠tulo\n\n\nf4 <- fviz_dend(Cl.upgmc, k = 2,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Promedio Ponderado - upgmc\") \n\n\ngrid.arrange(f1,f2,f3,f4, ncol = 2)\n\n\n\n\nFigura¬†2.1: Cuatro dendogramas jer√°rquicos con la distancia eucl√≠dea.\n\n\n\n\n\nf5 <- fviz_dend(Cl.wpgma, k = 2,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Centroide no Ponderado - wpgma\") \n\nf6 <- fviz_dend(Cl.wpgmc, k = 2,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Centroide Ponderado - wpgmc\") \n\nf7 <- fviz_dend(Cl.ward, k = 2,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"M√©todo de Ward\") \n\ngrid.arrange(f5,f6,f7, ncol = 2)\n\n\n\n\nFigura¬†2.2: Tres dendogramas jer√°rquicos restantes, con la distancia eucl√≠dea.\n\n\n\n\n\n\n\n2.3 Selecci√≥n del mejor m√©todo de agrupamiento - Correlaci√≥n Cofen√©tica\n\n2.3.1 C√°lculo de las correlaciones cofen√©ticas\n\n\nEl m√©todo que presente la mayor correlaci√≥n cofen√©tica ser√° el seleccionado. Para este caso se escoger√° el dendograma con el m√©todo upgma, el cu√°l presenta un cofen√©tico de 0.8234.\n\n# (1) Correlaci√≥n cofenpetica  para \"single\"\ncofenet1 <- cophenetic(Cl.single)\nsimple = cor(d.euclid,cofenet1)\nsimple\n\n[1] 0.7358594\n\n# (2) Correlaci√≥n cofen√©tica  para \"complete\"\ncofenet2<-cophenetic(Cl.complete)\ncompl = cor(d.euclid,cofenet2)\ncompl\n\n[1] 0.8113013\n\n# (3) Correlaci√≥n cofen√©tica  para \"average\"\ncofenet3<-cophenetic(Cl.upgma)\nupgma = cor(d.euclid,cofenet3)\nupgma\n\n[1] 0.8233726\n\n# (4) CCorrelaci√≥n cofen√©tica  para \"mcquitty\"\ncofenet4<-cophenetic(Cl.upgmc)\nupgmc = cor(d.euclid,cofenet4)\nupgmc\n\n[1] 0.8209463\n\n# (5) Correlaci√≥n cofen√©tica  para \"centroid\"\ncofenet5<-cophenetic(Cl.wpgma)\nwpgma = cor(d.euclid,cofenet5)\nwpgma\n\n[1] 0.02444114\n\n# (6) Correlaci√≥n cofen√©tica  para \"median\"\ncofenet6<-cophenetic(Cl.wpgmc)\nwpgmc = cor(d.euclid,cofenet6)\nwpgmc\n\n[1] 0.3397504\n\n# (7) Correlaci√≥n cofen√©tica  para \"ward\"\ncofenet7<-cophenetic(Cl.ward)\nward = cor(d.euclid,cofenet7)\nward\n\n[1] 0.79712\n\n\n\n\n2.3.2 Tabulaci√≥n de las correlaciones cofen√©ticas\n\n\nLos siguientes comandos permitir√°n organizar a los siete m√©todos de agrupamiento, de acuerdo a su nivel de correlaci√≥n cofen√©tica.\n\n# data frame con cofen√©ticos\ncofeneticos = data.frame(simple,compl,upgma,upgmc,\n                         wpgma,wpgmc,ward)\n\n# cofen√©ticos por cada m√©todos (Met)\ncofenet=data.frame(Met = 1:7,Cofen=t(round(cofeneticos,3)))\n\n# tabla con orden descendente de cofen√©ticos\ncof_ordenado = cofenet[order(cofenet$Cofen, decreasing = TRUE), ]\ncof_ordenado\n\n       Met Cofen\nupgma    3 0.823\nupgmc    4 0.821\ncompl    2 0.811\nward     7 0.797\nsimple   1 0.736\nwpgmc    6 0.340\nwpgma    5 0.024\n\n\nCon este comando se puede exportar la tabla de cofen√©ticos como un archivo plano de csv.\n\n# guardar tabla como csv\n# write.csv2(cof_ordenado,\"cofenet.csv\")\n\n\n\n2.3.3 Figuras de algunas correlaciones cofen√©ticas vs.¬†matriz de distancia\n\n\n\n\nA continuaci√≥n se presenta una muestra de la relaci√≥n entre las matrices de distancia cofen√©tica y de distancia eucl√≠nea, que permiti√≥ seleccionar al mejor m√©todo de agrupamiento (Figura¬†2.7).\n\n# convertir matricesde distancia a vectores\nd.euclid <- as.vector(d.euclid)\nd.cofenet1 <- as.vector(cofenet1)\nd.cofenet2 <- as.vector(cofenet2)\nd.cofenet3 <- as.vector(cofenet3)\nd.cofenet4 <- as.vector(cofenet4)\n\n\n# crear un data frame con los vectores y agregar una columna de etiquetas\nsimple1 <- data.frame(d.euclid, d.cofenet1, d.cofenet2, d.cofenet3, d.cofenet4)\nhead(simple1)\n\n  d.euclid d.cofenet1 d.cofenet2 d.cofenet3 d.cofenet4\n1 2.592758   2.592758   2.592758   2.592758   2.592758\n2 2.935826   2.935826   3.138967   3.037397   3.037397\n3 3.157893   3.157893   5.222324   4.157454   4.476721\n4 3.936806   3.157893   5.222324   4.157454   4.476721\n5 3.412345   3.157893   5.222324   4.157454   4.476721\n6 4.469605   3.300609   5.222324   4.157454   4.476721\n\n\n\n# Figuras correlaciones cofen√©ticas\n\n# (1) distancia cofen√©tica  para \"uni√≥n simple\" \nf1<-ggplot(simple1, aes(d.euclid,d.cofenet1))+\n  geom_point(size=3, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n Simple\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet1),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n# (2) distancia cofen√©tica  para \"uni√≥n completa\" \nf2<-ggplot(simple1, aes(d.euclid,d.cofenet2))+\n  geom_point(size=3, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n Completa\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet2),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n# (3) distancia cofen√©tica  para \"uni√≥n upgma\" \nf3<-ggplot(simple1, aes(d.euclid,d.cofenet3))+\n  geom_point(size=3, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n promedio no ponderado - upgma\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet3),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n\n# (4) distancia cofen√©tica  para \"uni√≥n upgmc\" \nf4<-ggplot(simple1, aes(d.euclid,d.cofenet4))+\n  geom_point(size=3, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n promedio ponderado - upgmc\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet4),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\ngrid.arrange(f1,f2,f3,f4, ncol = 2)\n\n\n\n\nFigura¬†2.3: Cuatro regresiones entre la distancia eucl√≠dea empleada y las distancias cofen√©ticas de cada m√©todo de agrupamiento definido."
  },
  {
    "objectID": "Taller6.1.cla.bah√≠as.html#paso-3.-n√∫mero-de-grupos-formados",
    "href": "Taller6.1.cla.bah√≠as.html#paso-3.-n√∫mero-de-grupos-formados",
    "title": "Taller6.1 CLA Bah√≠as",
    "section": "PASO 3. N√∫mero de grupos formados",
    "text": "PASO 3. N√∫mero de grupos formados\n\n\n\nLa definici√≥n de los grupos formados, representan un insumo importante de informaci√≥n, debido a que permiten generar los k cluster en los que se agrupan las observaciones, basado en las variables que las caracterizan. Este insumo es relevante adem√°s, como paso previo a otras t√©cnicas que requieren los grupos definidos a priori, como los an√°lisis discriminantes lineales (lda) o los an√°lisis de varianza multivariados (manovas), de igual forma, a partir de los grupos se pueden responder hip√≥tesis enfocadas en las variaciones que pueden presentar las variables a lo largo de gradientes discretos o en cluster.\n\n\nOpci√≥n 1. Niveles de Fusi√≥n.\n\nLa figura de niveles de fusi√≥n es una de las m√°s utilizadas para la generaci√≥n de grupos o de cluster, debido a la sencillez del componente gr√°fico, en el cual se definen los cluster o grupos (eje Y), dependiendo del escal√≥n de mayor amplitud o distancia horizontal (eje X). En la Figura¬†2.8 se observa que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma seleccionado en el paso anterior se puede clasificar en dos grupos de observaciones.\n\n# Base de variables a relacionar (amb)\namb <- datos[,c(2:8)]\n\n\n# Crear un data.frame con los datos de altura, k y n√∫mero de cluster\nf1 <- data.frame(h = Cl.upgma$height, k = nrow(amb):2, cluster = nrow(amb):2)\n\n\n# Crear el gr√°fico de dispersi√≥n y agregar etiquetas de texto\nggplot(f1, aes(x = h, y = k, label = cluster)) +\n  geom_point(color = \"grey\") +\n  geom_text(color = \"red\", size = 3, vjust = -0.5) +\n  geom_step(color = \"grey\", direction = \"vh\") +\n\n# Personalizar el gr√°fico con t√≠tulos, etiquetas de ejes y paleta de colores\n  ggtitle(\"Niveles de Fusi√≥n - Distancia Eucl√≠dea - UPGMA\") +\n  ylab(\"k (N√∫mero de Cluster)\") +\n  xlab(\"h (Altura del Nodo)\") +\n  scale_color_manual(values = c(\"grey\", \"red\")) +\n  theme(axis.title = element_text(size = 16)) +\n  theme_classic()\n\n\n\n\nFigura¬†2.4: Cuatro regresiones entre la distancia eucl√≠dea empleada y las distancias cofen√©ticas de cada m√©todo de agrupamiento definido.\n\n\n\n\n\n\n\nOpci√≥n 2. N√∫mero optimo de clusters de acuerdo al Ancho de silueta. √çndice de calidad de Rousseeuw\n\n\n\nLa amplitud de silueta es de las opciones m√°s usadas para definir al n√∫mero de k cluster o grupos del dendograma realizado. En este ejercicio tambi√©n se define a dos grupos. En caso que los resultados de esta t√©cnica sean diferentes a la anterior, se suele decidir por esta, debido a su mayor grado de precisi√≥n.\n\n# Base de datos (amb)\namb <- datos[,c(2:8)]\n# Distancia utilizada (d.euclid)\nd.euclid <- dist(scale(datos[,c(2:8)]))\n# M√©todo de agrupamiento seleccionado (cl.upgma)\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n# 1. Crear un vector vac√≠o (amb.vacio) con asw valores\namb.vacio <- numeric(nrow(amb))\n\n# 2. Silueta \"sil\" \nfor(k in 2: (nrow(amb)-1)){\n    sil <- silhouette(cutree(Cl.upgma,k=k),d.euclid)\n    amb.vacio[k]<-summary(sil)$avg.width} \n\n# 3. Mejor o mayor amplitud de silueta (2 particiones)\nk.mejor <- which.max(amb.vacio)\nk.mejor \n\n[1] 2\n\n\n\n# Grafica de silueta\n\nplot(1:nrow(amb),amb.vacio,type=\"h\",\n     main=\"Silueta-N√∫mero √ìptimo de Clusters\", xlab=\"(N√∫mero de grupos)\",\n     ylab=\"Amplitud promedio de  silueta\")\n     \naxis(1,k.mejor,paste(\"optimum\",k.mejor,sep=\"\\n\"),col=\"red\",\n     font=2,col.axis=\"red\")\n     \npoints(k.mejor,max(amb.vacio),pch=16,col=\"red\",cex=1.5)\n\n\n\ncat(\"\",\"Silueta-N√∫mero √≥ptimo de Clusters k=\",k.mejor,\n    \"\\n\",\"Con una aplitud promedio de silueta\",max(amb.vacio),\"\\n\")\n\n Silueta-N√∫mero √≥ptimo de Clusters k= 2 \n Con una aplitud promedio de silueta 0.2800367 \n\n\n\n\n\n3.1 Figura del dendograma jer√°rquico final\n\nLa Figura¬†2.5 muestra la manera en la que se organizan las observaciones en los dos grupos formados (ramas rojas y azules) devido a la naturaleza de las variables fisicoqu√≠micas que las caracterizar.\n\n# Dendograma final \n\nfviz_dend(Cl.upgma, k = 2,        # k grupos\n          cex = 0.9,              # tama√±o del texto de las observaciones\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Uni√≥n Promedio no Ponderada (UPGMA)\", # Rotulo de t√≠tulo\n          lower_rect = 0,           # Inicio de los rect√°ngulos en cero\n          k_colors = c(\"#00AFBB\",\"#FC4E07\"),\n          color_labels_by_k = TRUE,    # Colores para cada grupo\n          rect = TRUE)                 # Rect√°ngulos de cada grupo\n\n\n\n\nFigura¬†2.5: Dendograma jer√°rquico final con los dos grupos asignados.\n\n\n\n\n\n\nVale la pena mencionar que estos an√°lisis son importantes cuando se cuenta con pocas observaciones (ramas del dendograma), en el caso contrario, es preferible utilizar dendogramas no jerarquicos como el k-meas, el cual fue descrito en uno de los complementos del PCA y se retoma a continuaci√≥n.\n\n\n\n3.2 Figura del dendograma no jer√°rquico final\n\n\n\nAgrupamiento elegido en el paso 2 (upgma)\n\n\n\n# Matriz de distancia\nd.euclid <- dist(scale(datos[,c(2:8)]))\n\n# M√©todo 3. UPGMA funci√≥n \"average\" Uni√≥n Promedio no Ponderado\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n\nGeneraci√≥n de la variable agrupadora (gr)\n\n\n\n# Variable agrupadora con k=2 cl√∫ster\ngrp <- cutree(Cl.upgma, k = 2)    # Grupos generados \"grp\"  \ngrl <- levels(factor(grp))        # Rotulos de los grupos formados\n\nEste es un paso opcional en caso que se requiera insertar la nueva variable agrupadora a la base de datos en revisi√≥n.\n\n# Incluir la variable agrupadora en la base de datos\ndatos.1=data.frame(grp,datos)       # Nuevo dataframe con la variable agrupadora (gr)\nhead (datos.1)\n\n      grp Sitio    pH   Cond  Turb   Temp  Sali  CFot  Oxig\nBTag    1    S1 8.421 37.982 1.364 29.500 2.422 19.72 0.097\nPBet    1    S1 8.490 38.073 0.545 29.545 2.431 22.10 0.147\nMono    1    S1 8.505 37.836 1.273 29.600 2.416 22.10 0.331\nGran    2    S1 8.562 37.336 1.273 29.255 2.382 10.80 0.170\nPGran   2    S2 8.608 37.255 0.636 29.291 2.375  9.00 0.098\nRod     2    S2 8.808 38.063 1.273 29.310 2.380  8.80 0.098\n\n\n\n\nGeneraci√≥n del cl√∫ster No Jer√°rquico (K-Means)\n\n\nLa Figura¬†2.9 es la forma no jer√°rquica de presentar los resultados del cluster definido por el m√©todo de agrupamiento upgma.\n\nfviz_cluster(list(data = amb, cluster = grp),\n             palette = c(\"#2E9FDF\", \"#FC4E07\"),  # Colores para cada grupo\n             ellipse.type = \"confidence\",        # Elipses\n             repel = TRUE,                 # Elimina solapamiento de observaciones\n             show.clust.cent = FALSE,      # Muestra a los cl√∫ster centrados\n             ggtheme = theme_bw())     # Tipo de fondo tomado de ggplot2\n\n\n\n\nFigura¬†2.6: Dendograma no jer√°rquico final con los dos grupos asignados.\n\n\n\n\n\n\nUna pregunta interesante que se podr√≠a resolver, ser√≠a valorar si las diferencias entre los dos grupos de observaciones formadas es estad√≠sticamente significativa, para lo cual se debe aplicar un an√°lisis de varianza multivariado (manova)."
  },
  {
    "objectID": "Taller6.1.cla.bah√≠as.html#paso-4.-variables-de-mayor-contrinuci√≥n-a-la-clasificaci√≥n",
    "href": "Taller6.1.cla.bah√≠as.html#paso-4.-variables-de-mayor-contrinuci√≥n-a-la-clasificaci√≥n",
    "title": "Taller6.1 CLA Bah√≠as",
    "section": "Paso 4. Variables de mayor contrinuci√≥n a la clasificaci√≥n",
    "text": "Paso 4. Variables de mayor contrinuci√≥n a la clasificaci√≥n\n\nA continuaci√≥n se realizan diferentes opciones de mapas de calor (Figura¬†2.10, Figura¬†2.8), para identifiar a las variables con mayor relevancia en la clasificaci√≥n realizada anteriormente en el dendograma seleccionado. Este paso es relevante cuando se quiere ponderar o seleecionar a las variables que aportan al an√°lisis, resumiento de esta forma, la dimensionalidad del problema (n√∫mero de variables).\n\namb1 <- as.matrix(amb)\n\n\n# Opci√≥n 1. Mapa de calor con paquete \"stats\"\n\nhv <- heatmap(amb1, margins=c(7,6), \n              distfun = dist,\n              xlab =\"Variables fisico-qu√≠micas\",\n              ylab= \"Bah√≠as\", \n              main = \"Clasificaci√≥n de Bah√≠as\",\n              scale = \"row\")   # Estandariza variables diferentes.\n\n\n\n\nFigura¬†2.7: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificaci√≥n realizada.\n\n\n\n\nEl siguiente mapa de calor (Figura¬†2.8) incorpora a la distancia eucl√≠dea utilizada y el m√©todo de agrupamiento seleccionado (upgma).\n\n# Opci√≥n 2. Mapa de calor con paquete \"stats\"\nhclust.fq <- function(amb1) hclust(amb1, method=\"average\")   # Inserci√≥n de agrupaci√≥n UPGMA\n\n\nheatmap.2(amb1,               # Base de datos en formato matricial\n          margins=c(7,7),     # Margenes de la figura\n          scale = \"row\",      # Estandariza variables diferentes.\n          col = bluered(100),                 # Colores del mapa de calor\n          xlab =\"Variables fisico-qu√≠micas\",\n          ylab= \"Bah√≠as\", \n          main = \"Clasificaci√≥n de Bah√≠as\",\n          trace = \"none\", \n          density.info = \"none\",\n          distfun = dist,          # Se puede usar vegdist de \"vegan\" \n          hclustfun=hclust.fq)     # Agrupamiento UPGMA\n\n\n\n\nFigura¬†2.8: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificaci√≥n realizada.\n\n\n\n\n\n\nEl siguiente mapa de calor (?fig-figura16) permite visualizar a la resoluci√≥n de las variables fisicoqu√≠micas para diferenciar a los grupos de localidades, las cuales representan a los grupos en comparaci√≥n. Con los siguientes comandos se calcular√° una tabla que resume a los promedios de las 7 variables ambientales para cada grupo evaluado.\n\n# Extracci√≥n de los promedios de las variables para cada sitio\nlibrary(tidyverse)\npromedios <- datos %>%      \n  subset(select = c(\"Sitio\",\"pH\",\"Cond\",\"Turb\",\"Temp\",\"Sali\",\"CFot\",\"Oxig\")) %>%\n  na.omit() %>%\n  group_by(Sitio) %>%\n  summarize(across(everything(), mean))\n  \npromedios  <- data.frame(promedios) # Guardar promedios como dataframe\n# promedios\n\nA continuaci√≥n se comvierte el dataframe a formato matricial - promedios2, para poder ser graficado en el mapa de calor.\n\n# Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz\npromedios2 <- promedios %>% \n              subset(select = c(2:8)) %>% \n              as.matrix()\nround(promedios2,2)\n\n    pH  Cond Turb  Temp Sali  CFot Oxig\n1 8.49 37.81 1.11 29.48 2.41 18.68 0.19\n2 8.74 37.56 0.95 29.30 2.44  9.43 0.10\n\n\nAhora se incluyen los nombres de los grupos (S1 y S2) a la matriz promedios2.\n\n# Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2\nrownames(promedios2) <- promedios[,1]\n\nLa Figura¬†2.9 permite visualizar a las variables que mejor discriminan a los grupos de localidades (variables de tonalidad rojiza).\n\n# Figura del primer mapa de calor\n\nhv <- heatmap(promedios2, \n              margins = c(6,6), \n              distfun = dist,\n              xlab =\"Variables fisicoqu√≠micas\", \n              ylab= \"Grupos de Localidades\", \n              main = \"Clasificaci√≥n de Bah√≠as\") \n\n\n\n\nFigura¬†2.9: Mapa de calor que relaciona a las variables fisicoqu√≠micas y a los grupos de localidades.\n\n\n\n\nLa Figura¬†2.10 incorpora elementos adicionales como al m√©todo de agrupamiento upgma, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.\n\n# Opci√≥n 2. Mapa de calor con paquete \"stats\"\nhclust.fq <- function(promedios2) \n             hclust(promedios2, method=\"average\")   # Inserci√≥n de UPGMA\n\n\nlibrary(\"gplots\")\n\nheatmap.2(promedios2,         # Base de datos en formato matricial\n          margins=c(6,6),    # Margenes de la figura\n          scale = \"row\",      # Estandariza variables diferentes.\n          col = bluered(100),                 # Colores del mapa de calor\n          xlab =\"Variables fisicoqu√≠micas\", \n          ylab= \"Grupos de Localidades\", \n          main = \"Clasificaci√≥n de Bah√≠as\",   \n          trace = \"none\", \n          density.info = \"none\",\n          distfun = dist,          # Se puede usar vegdist de \"vegan\" \n          hclustfun=hclust.fq)     # Agrupamiento UPGMA\n\n\n\n\nFigura¬†2.10: Mapa de calor que relaciona a las variables fisicoqu√≠micas y a los grupos de localidades."
  },
  {
    "objectID": "Taller7.1.lda.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "href": "Taller7.1.lda.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "title": "Taller7. LDA Peces",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\nLibro: Repositorio de archivos y del ‚ÄúAn√°lisis de datos ecol√≥gicos y ambientales‚Äù - Rodr√≠guez-Barrios Javier (2022) Ver el cap√≠tulo de este libro 7.3 An√°lisis discriminante LDA en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio.\nSigatoka en cultivos de banano - Aguirre et al.¬†(2015). An√°lisis de discriminante can√≥nico y algunas t√©cnicas multivariadas complementarias.\nLinear Discriminant Analysis in R Se brinda informaci√≥n sobre las generalidades de los lda y su aplicaci√≥n en R.\nComputing and visualizing LDA in R En este documento se brinda informaci√≥n sobre el an√°lisis y la visualizaci√≥n gr√°fica del lda.\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(tidyverse)\nlibrary(lattice)\nlibrary(corrplot)\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(reshape2)\nlibrary(ggforce)\n\nlibrary(ade4)\nrequire(vegan)\nlibrary(car)\nlibrary(MASS)\nlibrary(candisc)\nlibrary(mvnormtest)\n\n\n\n\nCargar o importar la base de datos\n\n\n\nLa presente base de datos se encuentra en formato plano de csv, presenta una columna Especie que agrupa a las 5 especies de peces, otra columna Grupo, que asigna un n√∫mero a cada especie y posteriormente a las 19 variables morfom√©tricas y 10 variables meristicas, de las cuales se selecionar√°n las 19 morfom√©tricas para este ejercicio M.1 a M.19.\n\n# Base de datos\npeces<-read.csv2(\"peces.csv\",row.names=1)\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\n\n\n\n\nExploraci√≥n de los datos\n\n\n\nPara este ejemplo se urtilizar√°n figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las especies de peces de acuerdo a su morfometr√≠a. *Para facilidad del ejercicio se seleccionar√°n algunas variables morfom√©tricas - peces1, debido a que son las que presentan mejores patrones lineales.\n\n# Elipses con colores con variables morfom√©tricas\npeces1 <- peces[,c(3:9,15,17,20)]\nM <- cor(peces1)            # Matriz de Correlaci√≥n (M)\n\nLa Figura¬†1.1 permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlaci√≥n de Pearson.\n\ncorrplot(M,  method = \"circle\",            # Correlaciones con circulos\n         type = \"lower\", insig=\"blank\",    # Forma del panel\n         order = \"AOE\", diag = FALSE,      # Ordenar por nivel de correlaci√≥n\n         addCoef.col =\"black\",             # Color de los coeficientes\n         number.cex = 0.6,                 # Tama√±o del texto\n         col = COL2(\"RdYlBu\", 200))        # Transparencia de los circulos\n\n\n\n\nFigura¬†1.1: Correlaciones y coeficientes de correlaci√≥n.\n\n\n\n\nLa Figura¬†1.2 a diferencia de la anterior, clasifica a los grupos por colores y adem√°s incluye a sus coeficientes de correlaci√≥n y el patr√≥n de distribuci√≥n de cada variable mediante histogramas de densidad.\n\npeces1 <- peces[,c(3:9,15,17,20)]\npeces$Especie <- as.factor(peces$Especie)\n\n\npairs ((peces1),panel=function(x,y)\n{abline(lsfit(x,y)$coef,lwd=2,col=3)\n  lines(lowess(x,y),lty=2,lwd=2,col=2)\n  points(x,y,col=peces$Especie, cex=1.4,pch=19,lwd=0.6)})\n\n\n\n\nFigura¬†1.2: Relaci√≥n entre parejas de variables, por cada grupo en comparaci√≥n (colores).\n\n\n\n\nLa Figura¬†2.2 permite visualizar la resoluci√≥n de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminaci√≥n de las especies.\n\n# Figuras multivariadas de Cajas y bigotes\nlibrary(reshape)\n\n\nggplot(melt(peces[,c(1,3:9,15,17,20)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=Especie)) + \n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8','#33a02c')) +\n  labs(x=\"\",y=\"Morfometr√≠a\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†1.3: Variaci√≥n en la morfometr√≠a de los peces, de acuerdo a cada una de las variables seleccionadas.\n\n\n\n\n\n\nMapa de Calor\n\n\n\nEl siguiente mapa de calor tambi√©n permite visualizar a la resoluci√≥n de las variables morfom√©tricas para diferenciar a las especies de peces, las cuales representan a los grupos en comparaci√≥n. Con los siguientes comandos se calcular√° una tabla que resume a los promedios de las 10 variables morfom√©tricas para cada especie evaluada.\n\n# Extracci√≥n de los promedios de las variables para cada especie\nlibrary(tidyverse)\npromedios <- peces %>%      \n  subset(select = c(\"Especie\",\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%\n  na.omit() %>%\n  group_by(Especie) %>%\n  summarize(across(everything(), mean))\n  \npromedios  <- data.frame(promedios) # Guardar promedios como dataframe\n# promedios\n\nA continuaci√≥n se comvierte el dataframe a formato matricial - promedios2, para poder ser graficado en el mapa de calor.\n\n# Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz\npromedios2 <- promedios %>% \n              subset(select = c(2:11)) %>% \n              as.matrix()\nround(promedios2,2)\n\n   M.1  M.2  M.3  M.4  M.5  M.6  M.7 M.13 M.15 M.18\n1 0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.59 0.35 0.35\n2 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.52 0.34 0.33\n3 0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.56 0.29 0.31\n4 0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.45 0.39 0.40\n5 0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.62 0.28 0.18\n\n\nAhora se incluyen los nombres de las especies a la matriz promedios2.\n\n# Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2\nrownames(promedios2) <- promedios[,1]\n\nLa Figura¬†1.4 permite visualizar a las variables que mejor discriminan a las especies de peces (variables de tonalidad rojiza).\n\n# Figura del primer mapa de calor\n\nhv <- heatmap(promedios2, \n              margins=c(5,12), \n              distfun = dist,\n              xlab =\"Variables morfom√©tricas\", \n              ylab= \"Especie de Peces\", \n              main = \"Clasificaci√≥n de Peces\") \n\n\n\n\nFigura¬†1.4: Mapa de calor que relaciona a las variables morfom√©tricas y a las especies de peces.\n\n\n\n\nLa Figura¬†1.5 incorpora elementos adicionales como al m√©todo de agrupamiento upgma, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.\n\n# Opci√≥n 2. Mapa de calor con paquete \"stats\"\nhclust.fq <- function(promedios2) \n             hclust(promedios2, method=\"average\")   # Inserci√≥n de UPGMA\n\n\nlibrary(\"gplots\")\n\nheatmap.2(promedios2,         # Base de datos en formato matricial\n          margins=c(5,12),    # Margenes de la figura\n          scale = \"row\",      # Estandariza variables diferentes.\n          col = bluered(100),                 # Colores del mapa de calor\n          xlab =\"Variables morfom√©tricas\", \n          ylab= \"Especies de Peces\", \n          main = \"Clasificaci√≥n de Peces\",   \n          trace = \"none\", \n          density.info = \"none\",\n          distfun = dist,          # Se puede usar vegdist de \"vegan\" \n          hclustfun=hclust.fq)     # Agrupamiento UPGMA\n\n\n\n\nFigura¬†1.5: Mapa de calor que relaciona a las variables morfom√©tricas y a las especies de peces."
  },
  {
    "objectID": "Taller7.1.lda.peces.html#paso-1.-pruebas-de-supuestos",
    "href": "Taller7.1.lda.peces.html#paso-1.-pruebas-de-supuestos",
    "title": "Taller7. LDA Peces",
    "section": "Paso 1. Pruebas de supuestos",
    "text": "Paso 1. Pruebas de supuestos\n\n\n\nPara que el an√°lisis discriminante lineal sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada y de homogeneidad de covarianzas. Para el caso del presente ejercicio, dichos supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p > 0.05), motivo por el cual, el lda de este ejercicio ser√° tomado como una t√©cnica de exploraci√≥n moltivariada para saber que tan bien discriminados quedan los individuos de cada especie, basado en las 10 variables morfom√©tricas seleccionadas.\n\n\n1.1 Supuesto de normalidad\n\nEl supuesto de normalidad multivariada ser√° evaluado con el paquete mvnormtest, el cual utiliza el estad√≠stico de Shapiro Wilks Multivariado. Para ello se realizar√° esta prueba en cada uno de los grupos o especies en comparaci√≥n.\n\n# Diagn√≥stico de normalidad por cada tipo de Especie\nlibrary(mvnormtest)\n\nLos siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola adem√°s en formato matricial.\n\n# Dataframe por cada especie\n\n# datos de P. chola.\nP.chola   <- peces %>% \n             filter(Especie == \"P. chola\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()\n\n# datos de P. conchonious.\nP.concho  <- peces %>% \n             filter(Especie == \"P. conchonious\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix() \n\n# datos de P. sophore.\nP.sophore <- peces %>% \n             filter(Especie == \"P. sophore\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()     \n\n# datos de P. ticto.\nP.ticto   <- peces %>% \n             filter(Especie == \"P. ticto\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()       \n\n# datos de P. ticto.\nS.sarana  <- peces %>% \n             filter(Especie == \"S. sarana\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()  \n\n\n\nVale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en menci√≥n, ser√°n desactivadas con #.\n\n# Prueba de normalidad para cada especie\n\n# norm1 <- mshapiro.test(t(P.chola))   # Matriz singular\nnorm2   <- mshapiro.test(t(P.concho))\n# norm3 <- mshapiro.test(t(P.sophore)) # Matriz singular\nnorm4   <- mshapiro.test(t(P.ticto))\nnorm5   <- mshapiro.test(t(S.sarana))\n\nA continuaci√≥n se resume el resultado de los tres diagn√≥sticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estad√≠stico (valores p < 0.05), aunque existe la posibilidad de probar con alguna transformaci√≥n.\n\n# Resumen de el diagn√≥stico de normalidad\n(normalidad = data.frame(Norm.P.concho = norm2$p.value,\n                         Norm.ticto    = norm4$p.value,\n                         Norm.sarana   = norm5$p.value))\n\n  Norm.P.concho   Norm.ticto  Norm.sarana\n1   0.001050723 2.629679e-08 5.169222e-07\n\n\n\n\n\n1.2 Supuesto de homogeneidad de covarianzas\n\nLa prueba de homogeneidad de covarianza o esfericidad, corresponde al segundo supuesto del an√°lisis discriminante lineal, se utilizar√° la funci√≥n betadisper, la cual es complementada por dos an√°lisis de varianza, los cuales definir√°n si el supuesto logra ser cumplido.\n\n# Pruebas de Homogeneidad de covarianzas paquete \"vegan\"\npeces.d <- dist(peces[,c(3:9,15,17,20)])                # Matriz de distancias\npeces.homoge <- betadisper(peces.d, peces$Especie)      # Permutest\n\nCon la siguiente anova se obtiene un valor p de 0.016*, lo cual indica que NO se cumple el supuesto de homogeneidad de covarianzas (valor p < 0.05).\n\n# 1) Prueba con anova permutacional\nanova(peces.homoge)  \n\nAnalysis of Variance Table\n\nResponse: Distances\n          Df   Sum Sq   Mean Sq F value  Pr(>F)  \nGroups     4 0.019804 0.0049509   3.281 0.01638 *\nResiduals 65 0.098082 0.0015090                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCon el permutest se obtiene un valor p de 0.016*, lo cual indica que tampoco se cumple el supuesto de homogeneidad de covarianzas (valor p < 0.05).\n\n# 2) Prueba permutacional\npermutest(peces.homoge)   # Se cumple el supuesto de homogeneidad \n\n\nPermutation test for homogeneity of multivariate dispersions\nPermutation: free\nNumber of permutations: 999\n\nResponse: Distances\n          Df   Sum Sq   Mean Sq     F N.Perm Pr(>F)  \nGroups     4 0.019804 0.0049509 3.281    999  0.014 *\nResiduals 65 0.098082 0.0015090                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Taller7.1.lda.peces.html#paso-2.-an√°lisis-discriminante-lineal-de-fisher---lda",
    "href": "Taller7.1.lda.peces.html#paso-2.-an√°lisis-discriminante-lineal-de-fisher---lda",
    "title": "Taller7. LDA Peces",
    "section": "Paso 2. An√°lisis Discriminante Lineal de Fisher - LDA",
    "text": "Paso 2. An√°lisis Discriminante Lineal de Fisher - LDA\n\nA continuaci√≥n, se realizar√° el lda, que permitir√° generar definir al nivel de discriminaci√≥n de cada grupo o especie de pez. Se presentan algunas opciones gr√°ficas con el procedimiento general y con el an√°lisis discriminate can√≥nico (dca)\n\n# C√°lculo del LDA\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\ndis<-lda (Especie ~ M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18,\n         data = peces)\nround(dis$prior,2)\n\n      P. chola P. conchonious     P. sophore       P. ticto      S. sarana \n          0.17           0.11           0.09           0.29           0.34 \n\n\n\n\n‚ÄúPrior probabilities of groups‚Äù corresponde a la probabilidad de clasificaci√≥n para cada grupo que depender√° del n√∫mero de peces que lo conforman, aquellas especies con mayor n√∫mero de individuos censados, presentar√°n mayor probabilidad de discriminaci√≥n.\nPrbabilidad de clasificar indv. de los cinco grupos: P. chola P. conchonious P. sophore P. ticto S. sarana 0.17 0.11 0.09 0.29 0.34\n\n# Insumos del AD \n# summary(dis)\n\nA continuaci√≥n se presentan los promedios de cada especie por cada variable morfom√©trica seleccionada para el an√°lisis.\n\n#Grupos de medias para las 4 variables \nround(dis$means,2)\n\n                M.1  M.2  M.3  M.4  M.5  M.6  M.7 M.13 M.15 M.18\nP. chola       0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.59 0.35 0.35\nP. conchonious 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.52 0.34 0.33\nP. sophore     0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.56 0.29 0.31\nP. ticto       0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.45 0.39 0.40\nS. sarana      0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.62 0.28 0.18\n\n\nLos autovalores son los que permiten definir las coordenadas de las variables para cada funci√≥n can√≥nica (eje o dimensi√≥n del lda), para la grafica del discriminante, se utilizar√°n las funciones LD1 y LD2, como ejes x y y respectivamente (ver (fi-figura6?)).\n\n# Autovalores estandarizados (pesos de las variables en cada eje)\nround((Cs <- dis$scaling),2)\n\n        LD1    LD2    LD3    LD4\nM.1   39.34 -16.59  26.35  21.80\nM.2  -13.21   7.17  12.49 -11.29\nM.3   -6.94  -6.34  13.47  -0.45\nM.4   18.73  51.95  25.65  -9.48\nM.5  -17.12 -13.39 -35.00  44.46\nM.6  -13.94 -45.46  -9.77 -52.02\nM.7    6.98  -9.75  -4.18  -5.66\nM.13  10.55  12.26  -5.03   5.43\nM.15  -9.08  -8.91   9.32  21.28\nM.18  -3.50  -4.82   2.14   4.19\n\n\nEn el siguiente insumo se relacionan las coordenadas de las 6 primeras observaciones, las cuales tambi√©n ser√°n graficadas en la (fi-figura6?).\n\n# Coordenadas de las seis primeras observaciones en cada eje can√≥nico\nround(head(Fp <- predict(dis)$x),2)\n\n    LD1  LD2  LD3   LD4\n1 -1.19 3.63 0.21 -0.41\n2 -0.69 1.72 0.03  0.62\n3 -2.64 3.04 1.36  3.00\n4 -2.09 1.18 0.97  0.42\n5 -1.45 2.47 1.56 -0.07\n6 -1.31 2.95 2.77 -0.86\n\n\nLa siguiente tabla es conocida como tabla de contingencia la cual realiza una validaci√≥n cruzada entre las especies (filas) y los grupos discriminados por el lda (columnas). De acuerdo a esta tabla solo P. sophore no discrimina a todos sus individuos en su grupo, debido a que hay dos peces que presentan una morfometr√≠a m√°s similar a P. chola.\n\n# Evaluaci√≥n de desempe√±o del AD (m√©todo 1)\nattach(peces)\ngroup<-predict(dis,method=\"plug-in\")$class\n(tabla<-table(Especie,group))\n\n                group\nEspecie          P. chola P. conchonious P. sophore P. ticto S. sarana\n  P. chola             12              0          0        0         0\n  P. conchonious        0              8          0        0         0\n  P. sophore            2              0          4        0         0\n  P. ticto              0              0          0       20         0\n  S. sarana             0              0          0        0        24\n\n\nLa siguiente tabla realiza una validaci√≥n en t√©rminos porcentuales, definiendo que en el caso de P. sophore el 64% de sus individuos discriminan correctamente en su especie. El resto de especies presentan una discriminaci√≥n completa en su grupo.\n\n# Porcentaje de clasificaci√≥n correcta \nround(diag(prop.table(tabla, 1)),2)*100\n\n      P. chola P. conchonious     P. sophore       P. ticto      S. sarana \n           100            100             67            100            100 \n\n\nLa siguiente validaci√≥n realizada por el m√©todo de Jacknife, presenta menos resoluci√≥n de discriminaci√≥n que la anterior, por lo cual no ser√° tenida en cuenta en este ejercicio.\n\n# M?todo 2: con clasifiaci√≥n basada en jacknife (validaci√≥n cruzada dejando uno afuera)\ndis.jac <- lda(Especie ~ M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18,\n               data=peces, CV=TRUE)\n\n\n# N√∫mero y proporciones de clasificaci√≥n correcta\nclases.jac <- dis.jac$class\ntabla.jac <- table(Especie, clases.jac)\ntabla.jac\n\n                clases.jac\nEspecie          P. chola P. conchonious P. sophore P. ticto S. sarana\n  P. chola             10              0          2        0         0\n  P. conchonious        0              7          0        1         0\n  P. sophore            4              0          2        0         0\n  P. ticto              0              0          0       20         0\n  S. sarana             0              0          0        0        24\n\n\n\n# Validaci√≥n cruzada\nround(diag(prop.table(tabla.jac, 1)),2)*100\n\n      P. chola P. conchonious     P. sophore       P. ticto      S. sarana \n            83             88             33            100            100"
  },
  {
    "objectID": "Taller7.1.lda.peces.html#paso-3.-visualizaci√≥n-grafica-del-lda",
    "href": "Taller7.1.lda.peces.html#paso-3.-visualizaci√≥n-grafica-del-lda",
    "title": "Taller7. LDA Peces",
    "section": "Paso 3. Visualizaci√≥n grafica del LDA",
    "text": "Paso 3. Visualizaci√≥n grafica del LDA\n\n** 3.1 Gr√°fico de elipses.**\n\n\n\n\nA continuaci√≥n se realizar√° el componente grafico del lda, el cual inicia con una figura que definir√° unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definir√° el nivel de relaci√≥n entre estas.\n\n# Escores o coordenadas de las observaciones en cada eje can?nico\nFp <- predict(dis)$x\n\n\n# Grupos asignados por el AD\ngroup<-predict(dis,method=\"plug-in\")$class\n\n\n# Coordenadas y grupos asignados\npeces.coord=data.frame(Especie=group,Fp)\n\nLa Figura¬†2.1 demuestra que si bien de presenta una buena discriminaci√≥n de las especies de peces, 4 de las 5 evaluadas presentan cierta relaci√≥n, definida por el solapamiento de sus elipses.\n\n# Figura del LDA\nattach(peces)\n\nscatterplot(LD2~LD1 | Especie, data=peces.coord,reg.line=FALSE, \n            smooth=F, spread=F,span= 1,grid=F,\n            legend=list(coords=\"bottom\"), \n            ellipse=T,font.lab=2, pch=c(15,16,17,18,19),\n            col=c('#fc8d59','#e41a1c','#984ea3','#377eb8','#33a02c'),\n            main=\"An√°lisis discriminante\",\n            font.main=2,cex.main=2,cex.lab=1.5,\n            xlab=\"Eje1\", ylab=\"Eje2\")\n\n\n\n\nFigura¬†2.1: Mapa de calor que relaciona a las variables morfom√©tricas y a las especies de peces.\n\n\n\n\n\n\n** 3.2 Gr√°fico del discriminante can√≥nico - cda**\n\n\n\n\nEl siguiente an√°lisis permite visualizar la influencia de cada variable morfom√©trica en la separaci√≥n de los grupos de especies y selecciona a las variables que presentan m√°s influencia en la discriminaci√≥n de los peces.\n\nattach(peces)\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\n\nLo primero que se realiza es el modelo lineal mod indicando las variables y los grupos a discriminar.\n\n# Modelo Lineal multivariado con las variables morfom?tricas de peces\nmod <- lm(cbind(M.1,M.2,M.3,M.4,M.5,M.6,M.7,M.13,M.15,M.18) ~ Especie,peces)\n\n\n# Resumen del modelo multivariado\n# summary(mod)\n\nPosteriormente realiza el discriminante can√≥nico can que permite realizar la discriminaci√≥n de los grupos en los ejes can√≥nicos.\n\n# An√°lisis discriminante can√≥nico - ADC\ncan <- candisc(mod, term=\"Especie\",data=peces,ndim=1)\n\n\n\nA continuaci√≥n se presenta la figura que define a la discriminaci√≥n de las especies con un solo eje can√≥nico el cual explica el 81.8% de la variaci√≥n de los datos. La orientaci√≥n de los vectores (variables morfom√©tricas), en relaci√≥n a las cajas, indica su importancia para discriminar a cada especie o grupo en comparaci√≥n.\n\nplot(can,titles.1d = c(\"Puntuaci√≥n can√≥nica\", \"Estructura\"))\n\n\n\n\nFigura¬†2.2: Discriminante de las especies de peces con un eje can√≥nico.\n\n\n\n\nEn el siguiente enlace se puede obtener un caso aplicado con este tipo de an√°lisis multivariados: Aguirre et al.¬†(2015). Ver la figura 2 del manuscrito en menci√≥n."
  },
  {
    "objectID": "Taller8.1.manova.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "href": "Taller8.1.manova.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "title": "Taller8. MANOVA Peces",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\nLibro: Repositorio de archivos y del ‚ÄúAn√°lisis de datos ecol√≥gicos y ambientales‚Äù - Rodr√≠guez-Barrios Javier (2022) Ver el cap√≠tulo de este libro 7.5 An√°lisis de VArianza Multivariado - MANOVA en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio.\nLibro: An√°lisis de datos ecol√≥gicos y ambientales - Rodr√≠guez-Barrios Javier 2023 Ver el cap√≠tulo de MANOVA, en donde se detallan los procedimientos descritos en el presente ejercicio.\nMANOVA(Multivariate Analysis of Variance) Este documento presenta informaci√≥n relevante sobre la fundamentaci√≥n de los MANOVAs y su an√°lisis en R\nHow to perform the MANOVA test in R Este documento brinda informaci√≥n sobre los supuestos del MANOVA y la forma de realizar esta prueba multivariada en R.\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggforce)\n\nlibrary(vegan)          # Para el permutes en homogeneidad de covarianzas\nlibrary(mvnormtest)     # Prueba de normalidad \"mshapiro.test\"\nsource(\"funciones.r\")   # Figuras de normalidad multivariada\nlibrary(ade4)\nlibrary(car)              # Para ejecutar el diagn√≥stico de independencia\nlibrary(MASS)\n\n\n\n\nCargar o importar la base de datos\n\n\n\nLa presente base de datos se encuentra en formato plano de csv, presenta una columna Especie que agrupa a las 5 Especie de peces, otra columna Grupo, que asigna un n√∫mero a cada especie y posteriormente a las 19 variables morfom√©tricas y 10 variables meristicas, de las cuales se selecionar√°n las 19 morfom√©tricas para este ejercicio M.1 a M.19.\n\n# Base de datos\npeces<-read.csv2(\"peces.csv\",row.names=1)\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\n\n\n\n\nExploraci√≥n de los datos\n\n\n\nPara este ejemplo se urtilizar√°n figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las Especie de peces de acuerdo a su morfometr√≠a. *Para facilidad del ejercicio se seleccionar√°n algunas variables morfom√©tricas - peces1, debido a que son las que presentan mejores patrones lineales.\n\n# Elipses con colores con variables morfom√©tricas\npeces1 <- peces[,c(3:9,15,17,20)]\nM <- cor(peces1)            # Matriz de Correlaci√≥n (M)\n\nLa Figura¬†1.1 permite visualizar la resoluci√≥n de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminaci√≥n de las especies.\n\n# Figuras multivariadas de Cajas y bigotes\nlibrary(reshape)\n\n\nggplot(melt(peces[,c(1,3:9,15,17,20)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=Especie)) + \n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8','#33a02c')) +\n  labs(x=\"\",y=\"Morfometr√≠a\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†1.1: Variaci√≥n en la morfometr√≠a de los peces, de acuerdo a cada una de las variables seleccionadas."
  },
  {
    "objectID": "Taller8.1.manova.peces.html#paso-1.-pruebas-de-supuestos",
    "href": "Taller8.1.manova.peces.html#paso-1.-pruebas-de-supuestos",
    "title": "Taller8. MANOVA Peces",
    "section": "Paso 1. Pruebas de supuestos",
    "text": "Paso 1. Pruebas de supuestos\n\n\n\nPara que el an√°lisis de varianza multivariado - manova sea considerado como un modelo lineal, debe cumplir con los supuestos de normalidad multivariada, de homogeneidad de covarianzas y de independencia. Para el caso del presente ejercicio, los dos primeros supuestos no alcanzan a cumplirse con los diagnosticos utilizados (valor p < 0.05), motivo por el cual, el manova de este ejercicio ser√° tomado como una t√©cnica de exploraci√≥n multivariada para evaluar las diferencias en las 5 especies, basado en las 10 variables morfom√®tricas seleccionadas.En el siguiente ejercicio se realizar√°n an√°lisis de varianza no param√©tricos pemanovas, que permiten probar hip√≥tesis sin el cumplimiento de ls dos primeros supuestos, por lo cual ser√°n los dise√±os multivariados m√°s apropiados para esta base de datos.\n\n\n1.1 Supuesto de normalidad\n\nEl supuesto de normalidad multivariada ser√° evaluado con el paquete mvnormtest, el cual utiliza el estad√¨stico de Shapiro Wilks Multivariado. Para ello se realizar√† esta prueba en cada uno de los grupos o especies en comparaci√≥n. NOTA: Este supuesto tambi√©n ser√° evaluado con los residuales del manova, posterior a su ejecuci√≥n.\n\n# Diagn√≥stico de normalidad por cada tipo de Especie\nlibrary(mvnormtest)\n\nLos siguientes generan los dataframes de cada especie con las 10 variables seleccionadas, convirtiendola adem√†s en formato matricial.\n\n# Dataframe por cada especie\n\n# datos de P. chola.\nP.chola   <- peces %>% \n             filter(Especie == \"P. chola\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()\n\n# datos de P. conchonious.\nP.concho  <- peces %>% \n             filter(Especie == \"P. conchonious\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix() \n\n# datos de P. sophore.\nP.sophore <- peces %>% \n             filter(Especie == \"P. sophore\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()     \n\n# datos de P. ticto.\nP.ticto   <- peces %>% \n             filter(Especie == \"P. ticto\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()       \n\n# datos de P. ticto.\nS.sarana  <- peces %>% \n             filter(Especie == \"S. sarana\") %>%       \n             subset(select = c(\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.13\",\"M.15\",\"M.18\")) %>%              as.matrix()  \n\n\n\nVale la pena resaltar que los datos de las especies P. chola y P. sophore, son singulares, por lo cual no puede calcularse su supuesto de normalidad multivariada. Con el objeto de continuar en el ejercicio, las matrices que representan a las especies en menci√≤n, ser√†n desactivadas con #.\n\n# Prueba de normalidad para cada especie\nlibrary(mvnormtest)\n\n# norm1 <- mshapiro.test(t(P.chola))   # Matriz singular\nnorm2   <- mshapiro.test(t(P.concho))\n# norm3 <- mshapiro.test(t(P.sophore)) # Matriz singular\nnorm4   <- mshapiro.test(t(P.ticto))\nnorm5   <- mshapiro.test(t(S.sarana))\n\n\n\nA continuaci√≥n se resume el resultado de los tres diagn√≥sticos de normalidad multivariada realizados. Vale la pena mencionar que ninguna especie cumple con dicho supuesto estad√≥stico (valores p < 0.05), aunque existe la posibilidad de probar con alguna transformaci√≥n.\n\n# Resumen de el diagn√≥stico de normalidad\n(normalidad = data.frame(Norm.P.concho = norm2$p.value,\n                         Norm.ticto    = norm4$p.value,\n                         Norm.sarana   = norm5$p.value))\n\n  Norm.P.concho   Norm.ticto  Norm.sarana\n1   0.001050723 2.629679e-08 5.169222e-07\n\n\n\n\n\n1.2 Supuesto de homogeneidad de covarianzas\n\n\n\nLa prueba de homogeneidad de covarianza o esfericidad, corresponde al segundo supuesto del an√°lisis discriminante lineal, se utilizar√° la funci√≥n betadisper, la cual es complementada por dos an√°lisis de varianza, los cuales definir√°n si el supuesto logra ser cumplido.\n\n# Pruebas de Homogeneidad de covarianzas paquete \"vegan\"\nlibrary(vegan)\n\npeces.d <- dist(peces[,c(3:9,15,17,20)])                # Matriz de distancias\npeces.homoge <- betadisper(peces.d, peces$Especie)      # Permutest\n\nCon la siguiente anova se obtiene un valor p de 0.016*, lo cual indica que no se cumple el supuesto de homogeneidad de covarianzas (valor p < 0.05).\n\n# 1) Prueba con anova permutacional\nanova(peces.homoge)  \n\nAnalysis of Variance Table\n\nResponse: Distances\n          Df   Sum Sq   Mean Sq F value  Pr(>F)  \nGroups     4 0.019804 0.0049509   3.281 0.01638 *\nResiduals 65 0.098082 0.0015090                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCon el permutest se obtiene un valor p de 0.015*, lo cual indica que tampoco se cumple el supuesto de homogeneidad de covarianzas (valor p < 0.05).\n\n# 2) Prueba permutacional\npermutest(peces.homoge)   # Se cumple el supuesto de homogeneidad \n\n\nPermutation test for homogeneity of multivariate dispersions\nPermutation: free\nNumber of permutations: 999\n\nResponse: Distances\n          Df   Sum Sq   Mean Sq     F N.Perm Pr(>F)  \nGroups     4 0.019804 0.0049509 3.281    999   0.02 *\nResiduals 65 0.098082 0.0015090                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Taller8.1.manova.peces.html#paso-2.-an√°lisis-de-varinaza-multivariado---manova",
    "href": "Taller8.1.manova.peces.html#paso-2.-an√°lisis-de-varinaza-multivariado---manova",
    "title": "Taller8. MANOVA Peces",
    "section": "Paso 2. An√°lisis de Varinaza Multivariado - MANOVA",
    "text": "Paso 2. An√°lisis de Varinaza Multivariado - MANOVA\n\n\n\nEl manova, por ser un modelo lineal especial, requiere que se indiquen las variables continuas (variables Xi) y la variable cualitativa o categ√≥rica (variable Yi), que para este caso es la Especie.\n\n# Manova (variables efecto: 10 morfol√≥gicas y la respuesta: Especie)\nattach(peces)\npeces.manova<-manova(cbind(M.1,M.2,M.3,M.4,M.5,M.6,M.7,M.13,M.15,M.18)~Especie)\n\n\n\nA continuaci√≥n se presentar√° la tabla del manova para las tres primeras variables morfom√©tricas. Para visualizar todos los resultados de este insumo, es necesario colocar solo: summary.aov(peces.manova). Para este caso se observa que todas las variables efecto o morfol√≥gicas, tienen un efecto muy significativo (valor p <<0.01) en la diferenciaciaci√≥n de los 5 grupos o especies de peces.\n\n# respuesta de la variable M.1\nsummary.aov(peces.manova)$\" Response M.1\"\n\n            Df   Sum Sq  Mean Sq F value    Pr(>F)    \nEspecie      4 0.221052 0.055263  127.36 < 2.2e-16 ***\nResiduals   65 0.028205 0.000434                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# respuesta de la variable M.2\nsummary.aov(peces.manova)$\" Response M.2\"\n\n            Df  Sum Sq  Mean Sq F value    Pr(>F)    \nEspecie      4 0.28343 0.070857   34.76 1.654e-15 ***\nResiduals   65 0.13250 0.002038                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# respuesta de la variable M.3\nsummary.aov(peces.manova)$\" Response M.3\"\n\n            Df   Sum Sq    Mean Sq F value   Pr(>F)    \nEspecie      4 0.010738 0.00268443  10.486 1.29e-06 ***\nResiduals   65 0.016641 0.00025601                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nA continuaci√≥n se presentan los cuatro tipos de MANOVAS, con la diferencia de que Hotelling puede utilizarse sin el cumplimiento del supuesto de normalidad multivariada (pero deben cumplirse los otros supuestos como el de la homogeneidad y el de la independencia). Para este caso los 4 estad√≠sticos muestran altas diferencias entre algunos de los grupos representados por las cinco especies, posiblemente por el efecto de P. sarana, que al ser de un g√©nero diferente, presenta marcadas diferencias morfol√≥gicas (ver Figura¬†2.2).\n\n# Tipos de MANOVA para evaluar si hay diferencias en los promedios de cada Especie \nsummary(peces.manova,test=\"Pillai\")\n\n          Df Pillai approx F num Df den Df    Pr(>F)    \nEspecie    4  2.513   9.9711     40    236 < 2.2e-16 ***\nResiduals 65                                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(peces.manova,test=\"Wilks\")\n\n          Df     Wilks approx F num Df den Df    Pr(>F)    \nEspecie    4 0.0028912   19.667     40  214.2 < 2.2e-16 ***\nResiduals 65                                               \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(peces.manova,test=\"Hotelling\")\n\n          Df Hotelling-Lawley approx F num Df den Df    Pr(>F)    \nEspecie    4           29.052   39.584     40    218 < 2.2e-16 ***\nResiduals 65                                                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(peces.manova,test=\"Roy\")\n\n          Df    Roy approx F num Df den Df    Pr(>F)    \nEspecie    4 23.757   140.17     10     59 < 2.2e-16 ***\nResiduals 65                                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Taller8.1.manova.peces.html#paso-3.-supuestos-del-manova",
    "href": "Taller8.1.manova.peces.html#paso-3.-supuestos-del-manova",
    "title": "Taller8. MANOVA Peces",
    "section": "Paso 3. Supuestos del MANOVA",
    "text": "Paso 3. Supuestos del MANOVA\n\n\n\nSon tres los supuestos que a continuaci√≥n se probar√°n: (1) Normalidad en los residuales, (2) homogeneidad de las covarianzas y (3) Independiencia en los datos. Vale la pena resaltar la importancia del cumplimiento de la independiencia, debido a que presenta un efecto sobre dise√±os que requieran ser aleatorios. La homogeneidad fue diagnosticada al inicio de este ejercicio no se cumple."
  },
  {
    "objectID": "Taller8.1.manova.peces.html#supuesto-de-normalidad-de-los-residuales-del-manova",
    "href": "Taller8.1.manova.peces.html#supuesto-de-normalidad-de-los-residuales-del-manova",
    "title": "Taller8. MANOVA Peces",
    "section": "3.1. Supuesto de normalidad de los residuales del MANOVA",
    "text": "3.1. Supuesto de normalidad de los residuales del MANOVA\n\nA continuaci√≥n se probar√° el supuesto de (1) normalidad en los residuales del manova, de forma num√©rica y gr√°fica. El estad√≠stico de Shapiro Wilks Multivariado es el que se utiliza, demostrando que los residuales est√°n muy alejados del patr√≥n normal (valor p << 0.01 o p = 3.043e-07).\n\n# 1) Prueba de multinormalidad de los residuales del manova (mshapiro.test)\nlibrary(mvnormtest)\nx <- as.matrix(t(residuals(peces.manova)))\nmshapiro.test(x)\n\n\n    Shapiro-Wilk normality test\n\ndata:  Z\nW = 0.83893, p-value = 3.043e-07\n\n# No se cumple este supuesto\n\nA continuaci√≥n se har√° uso del c√≥digo fuente ‚Äúfunciones.r‚Äù el cual presenta los comandos requeridos para la figura que diagnostica la normalidad multivariada (Figura¬†1.2 qqplot).\n\n# Figura de multinormalidad\n# Funciones para la figura\nsource(\"funciones.r\")\n\nEn la Figura¬†1.2 se observa que algunos residuales (puntos circulares) se alejan considerablemente del patr√≥n de normalidad, definido por la recta roja.\n\n# Grafica QQ-PLot para visualizar la normalidad\nx <- as.matrix(residuals(peces.manova)) \n# centroide\ncenter <- colMeans(x) \nn <- nrow(x); p <- ncol(x); cov <- cov(x); \nd <- mahalanobis(x,center,cov) \n\n\nqqplot(qchisq(ppoints(n),df=p),d,\n       main=\"Normalidad multivariada\",\n       ylab=\"Cuantil Chi-Cuadrado\", xlab= \"Distancia Mahalanobish\")\nabline(a=0,b=1,col=2) \n\n\n\n\nFigura¬†2.1: Figura qqplot entre los residuales observados (Distancia Mahalanobish) y los cuantiles chi cuadrado (estimados)."
  },
  {
    "objectID": "Taller8.1.manova.peces.html#supuesto-de-independencia",
    "href": "Taller8.1.manova.peces.html#supuesto-de-independencia",
    "title": "Taller8. MANOVA Peces",
    "section": "3.2. Supuesto de independencia",
    "text": "3.2. Supuesto de independencia\n\nSe utilizar√° el estad√≠stico Durbin Watson (DW) el cual demuestra que se cumple la independencia (valor p > 0.05).\n\n# Prueba de Independencia - Estadistico Durbin Watson\nattach(peces)\nmodelo<-lm(M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18~Especie)\ndurbinWatsonTest(modelo)\n\n lag Autocorrelation D-W Statistic p-value\n   1      0.08444408       1.80425   0.224\n Alternative hypothesis: rho != 0"
  },
  {
    "objectID": "Taller8.1.manova.peces.html#paso-4.-prueba-a-postriori-del-manova",
    "href": "Taller8.1.manova.peces.html#paso-4.-prueba-a-postriori-del-manova",
    "title": "Taller8. MANOVA Peces",
    "section": "Paso 4. Prueba a postriori del MANOVA",
    "text": "Paso 4. Prueba a postriori del MANOVA\n\n\n\nA continuaci√≥n, se realizar√° una figura del an√°lisis discriminante - lda, que permitir√° generar definir al nivel de discriminaci√≥n de cada grupo o especie de pez. Se presentan algunas opciones gr√°ficas con el procedimiento general y con el an√°lisis discriminate can√≥nico (dca)\n\n# C√°lculo del LDA\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\ndis<-lda (Especie ~ M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18,\n         data = peces)\n\nA continuaci√≥n se realizar√° el componente grafico del lda, el cual inicia con una figura que definir√° unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definir√° el nivel de relaci√≥n entre estas.\n\n# Escores o coordenadas de las observaciones en cada eje can?nico\nFp <- predict(dis)$x\n\n\n# Grupos asignados por el AD\ngroup<-predict(dis,method=\"plug-in\")$class\n\n\n# Coordenadas y grupos asignados\npeces.coord=data.frame(Especie=group,Fp)\n\nLa Figura¬†2.2 demuestra que si bien de presenta una buena discriminaci√≥n de las especies de peces, 4 de las 5 evaluadas presentan cierta relaci√≥n, definida por el solapamiento de sus elipses.\n\n# Figura del LDA\nattach(peces)\n\nscatterplot(LD2~LD1 | Especie, data=peces.coord,reg.line=FALSE, \n            smooth=F, spread=F,span= 1,grid=F,\n            legend=list(coords=\"bottom\"), \n            ellipse=T,font.lab=2, pch=c(15,16,17,18,19),\n            col=c('#fc8d59','#e41a1c','#984ea3','#377eb8','#33a02c'),\n            main=\"An√°lisis discriminante\",\n            font.main=2,cex.main=2,cex.lab=1.5,\n            xlab=\"Eje1\", ylab=\"Eje2\")\n\n\n\n\nFigura¬†2.2: Mapa de calor que relaciona a las variables morfom√©tricas y a las especies de peces."
  },
  {
    "objectID": "Taller9.1.permanova.peces.html",
    "href": "Taller9.1.permanova.peces.html",
    "title": "Taller9. PERMANOVAS Peces",
    "section": "",
    "text": "Este es el an√°lisis m√°s similar al MANOVA o an√°lisis de varianza multivariado, pero la construcci√≥n de la tabla del MANOVA la hace mediante permutaciones, comparando a la matriz de distancias de los datos observados con otra matriz de distancia estimada por permutaciones."
  },
  {
    "objectID": "Taller9.1.permanova.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "href": "Taller9.1.permanova.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "title": "Taller9. PERMANOVAS Peces",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\nLibro: Repositorio de archivos y del ‚ÄúAn√°lisis de datos ecol√≥gicos y ambientales‚Äù - Rodr√≠guez-Barrios Javier (2022) Ver el cap√≠tulo de este libro 8 Dise√±os Multivariados no Param√©tricos - MANOVA en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio.\nLibro: An√°lisis de datos ecol√≥gicos y ambientales - Rodr√≠guez-Barrios Javier 2023 Ver el cap√≠tulo de MANOVA, en donde se detallan los procedimientos descritos en el presente ejercicio.\nPerifiton de un r√≠o de Monta√±a - Osorio et al.¬†2014 Valoraci√≥n del proceso sucesional de microalgas perif√≠ticas el tramo medio del r√≠o Gaira - Santa Marta.\nInvertebrados de un r√≠o de Monta√±a - Rodr√≠guez-Barrios et al.¬†2011 Estudio de diferentes atributos comunitarios en invertebados acu√°ticos del r√≠o Gaira - Santa Marta.\nDescomposici√≥n de Hojar√°sca en R√≠os - Eyes et al.¬†2011 Trabajo realizado en el bosque de ribera del r√≠o Gaira - Santa Marta.\nNutrientes de la hojar√°sca - Fuentes y Rodr√≠guez. 2011 Otro trabajo realizado en el bosque de ribera del r√≠o Gaira - Santa Marta.\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(tidyverse)\n\nlibrary(vegan)          # Para el permutes en homogeneidad de covarianzas\nlibrary(ade4)\nlibrary(car)              # Para ejecutar el diagn√≥stico de independencia\nlibrary(MASS)\n\n\n\n\nCargar o importar la base de datos\n\n\n\nLa presente base de datos se encuentra en formato plano de csv, presenta una columna Especie que agrupa a las 5 Especie de peces, otra columna Grupo, que asigna un n√∫mero a cada especie y posteriormente a las 19 variables morfom√©tricas y 10 variables meristicas, de las cuales se selecionar√°n las 10 morfom√©tricas para este ejercicio M.1 a M.7, M.13 a M.15 y M.18.\n\n# Base de datos\npeces<-read.csv2(\"peces.csv\",row.names=1)\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\n\n\n\n\nExploraci√≥n de los datos\n\n\n\nFigura de cajas por cada variable morfom√©trica\n\n\n\nLa Figura¬†1.1 permite visualizar la resoluci√≥n de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminaci√≥n de las especies.\n\n# Figuras multivariadas de Cajas y bigotes\nlibrary(reshape)\n\n\nggplot(melt(peces[,c(1,3:9,15,17,20)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=Especie)) + \n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8','#33a02c')) +\n  labs(x=\"\",y=\"Morfometr√≠a\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†1.1: Variaci√≥n en la morfometr√≠a de los peces, de acuerdo a cada una de las variables seleccionadas.\n\n\n\n\n\n\n\nFigura del lda para comparar a las especies de peces\n\n\n\nA continuaci√≥n, se realizar√° una figura del an√°lisis discriminante - lda, que permitir√° generar definir al nivel de discriminaci√≥n de cada grupo o especie de pez. Se presentan algunas opciones gr√°ficas con el procedimiento general y con el an√°lisis discriminate can√≥nico (dca)\n\n# C√°lculo del LDA\nnames(peces)\n\n [1] \"Especie\" \"Grupo\"   \"M.1\"     \"M.2\"     \"M.3\"     \"M.4\"     \"M.5\"    \n [8] \"M.6\"     \"M.7\"     \"M.8\"     \"M.9\"     \"M.10\"    \"M.11\"    \"M.12\"   \n[15] \"M.13\"    \"M.14\"    \"M.15\"    \"M.16\"    \"M.17\"    \"M.18\"    \"M.19\"   \n[22] \"M.20\"    \"M.21\"    \"M.22\"    \"M.23\"    \"M.24\"    \"M.25\"    \"M.26\"   \n[29] \"M.27\"    \"M.28\"    \"M.29\"   \n\ndis<-lda (Especie ~ M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18,\n         data = peces)\n\nA continuaci√≥n se realizar√° el componente grafico del lda, el cual inicia con una figura que definir√° unas elipses, las cuales relacionan a los individuos de cada especie y cuyo solapamiento definir√° el nivel de relaci√≥n entre estas.\n\n# Escores o coordenadas de las observaciones en cada eje can?nico\nFp <- predict(dis)$x\n\n\n# Grupos asignados por el AD\ngroup<-predict(dis,method=\"plug-in\")$class\n\n\n# Coordenadas y grupos asignados\npeces.coord=data.frame(Especie=group,Fp)\n\nLa Figura¬†1.2 demuestra que si bien de presenta una buena discriminaci√≥n de las especies de peces, 4 de las 5 evaluadas presentan cierta relaci√≥n, definida por el solapamiento de sus elipses.\n\n# Figura del LDA\nattach(peces)\n\nscatterplot(LD2~LD1 | Especie, data=peces.coord,reg.line=FALSE, \n            smooth=F, spread=F,span= 1,grid=F,\n            legend=list(coords=\"bottom\"), \n            ellipse=T,font.lab=2, pch=c(15,16,17,18,19),\n            col=c('#fc8d59','#e41a1c','#984ea3','#377eb8','#33a02c'),\n            main=\"An√°lisis discriminante\",\n            font.main=2,cex.main=2,cex.lab=1.5,\n            xlab=\"Eje1\", ylab=\"Eje2\")\n\n\n\n\nFigura¬†1.2: Mapa de calor que relaciona a las variables morfom√©tricas y a las especies de peces."
  },
  {
    "objectID": "Taller9.1.permanova.peces.html#paso-1.-distancia-entre-las-observaciones-2",
    "href": "Taller9.1.permanova.peces.html#paso-1.-distancia-entre-las-observaciones-2",
    "title": "Taller9. PERMANOVAS Peces",
    "section": "Paso 1. Distancia entre las observaciones",
    "text": "Paso 1. Distancia entre las observaciones\n\nSe utilizar√° la distancia eucl√≠dea calculada para el anterior ANOSIM y el MRPP, pero transformando las variables con logaritmo base 10, para mejorar su linealizaci√≥n de los datos.\n\n# Distancia Eucl√≠dea con las 10 variables seleccionadas\npeces.dist1 <-dist (log10(peces[,c(3:9,15,17,20)+1]),\"euclid\")\n# round(peces.dist, 2)"
  },
  {
    "objectID": "Taller9.1.permanova.peces.html#paso-2.-prueba-de-hip√≥tesis-multivariada-con-el-permanova",
    "href": "Taller9.1.permanova.peces.html#paso-2.-prueba-de-hip√≥tesis-multivariada-con-el-permanova",
    "title": "Taller9. PERMANOVAS Peces",
    "section": "Paso 2. Prueba de hip√≥tesis multivariada con el PERMANOVA",
    "text": "Paso 2. Prueba de hip√≥tesis multivariada con el PERMANOVA\n\n\n\nSimilar a las pruebas anteriores, este PERMANOVA permite probar que existen diferencias marcadas en la morfometr√≠a de los individuos que se agrupan en las cinco especies de peces (valor p < 0.05). De esta manera se reportan los resultados del estad√≠stico MRPP: (Seudo F= 12.5, g.l= 4 y 65, p = 0.00099***).\n\n# PERMANOVA\nlibrary(vegan)\npeces.dist1 <-dist (log10(peces[,c(3:9,15,17,20)+1]),\"euclid\")\npeces.permanova <- adonis2(peces.dist1 ~ peces$Especie, perm=1000)\npeces.permanova\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 1000\n\nadonis2(formula = peces.dist1 ~ peces$Especie, permutations = 1000)\n              Df SumOfSqs      R2      F   Pr(>F)    \npeces$Especie  4   1.3784 0.43566 12.545 0.000999 ***\nResidual      65   1.7855 0.56434                    \nTotal         69   3.1639 1.00000                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Taller9.1.permanova.peces.html#paso-3.-efecto-de-las-variables-morfom√©tricas-en-la-diferenciaci√≥n-de-los-grupos",
    "href": "Taller9.1.permanova.peces.html#paso-3.-efecto-de-las-variables-morfom√©tricas-en-la-diferenciaci√≥n-de-los-grupos",
    "title": "Taller9. PERMANOVAS Peces",
    "section": "Paso 3. Efecto de las variables morfom√©tricas en la diferenciaci√≥n de los grupos",
    "text": "Paso 3. Efecto de las variables morfom√©tricas en la diferenciaci√≥n de los grupos\n\nLos resultados de este an√°lisis, permiten definir, que con excepci√≥n de las variables M.13 y M.18, todas presentan un efecto significativo en la diferenciaci√≥n de las especies de peces.\n\nattach(peces)\npeces.permanova1<-adonis(peces.dist1 ~ M.1+M.2+M.3+M.4+M.5+M.6+M.7+M.13+M.15+M.18, \n                         perm=1000)\n\npeces.permanova1$\"aov.tab\"\n\nPermutation: free\nNumber of permutations: 1000\n\nTerms added sequentially (first to last)\n\n          Df SumsOfSqs MeanSqs F.Model      R2   Pr(>F)    \nM.1        1    0.5285 0.52852  28.666 0.16705 0.000999 ***\nM.2        1    0.1529 0.15286   8.290 0.04831 0.000999 ***\nM.3        1    0.0563 0.05634   3.056 0.01781 0.023976 *  \nM.4        1    0.2165 0.21651  11.743 0.06843 0.000999 ***\nM.5        1    0.7716 0.77162  41.851 0.24388 0.000999 ***\nM.6        1    0.0830 0.08303   4.503 0.02624 0.011988 *  \nM.7        1    0.0644 0.06441   3.493 0.02036 0.016983 *  \nM.13       1    0.0478 0.04776   2.590 0.01510 0.048951 *  \nM.15       1    0.1114 0.11142   6.043 0.03521 0.001998 ** \nM.18       1    0.0437 0.04366   2.368 0.01380 0.059940 .  \nResiduals 59    1.0878 0.01844         0.34382             \nTotal     69    3.1639                 1.00000             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#resumen-de-las-actividades",
    "href": "Taller1.Introducci√≥n.html#resumen-de-las-actividades",
    "title": "Taller1. Intro_multivariados",
    "section": "Resumen de las actividades",
    "text": "Resumen de las actividades\n\n\n\n\nImagen tomada de Koplexs-Stock\n\n\n\n\nEl presente documento es el resultado de ajustes que de manera peri√≥dica se han venido realizando, para optimizar el tiempo de trabajo en las primeras semanas del curso, que corresponden a los m√≥dulos de Introducci√≥n a Multivariados y el Estudio semestral de caso. En este sentido, a continuaci√≥n se presentar√°n las pautas de tres actividades, relacionadas a continuaci√≥n:\n 1. Conducta de entrada. . Orientada a valorar los conocimientos previos, requeridos para empalmar con los primeros temas de la asignatura. Esto brindar√° orientaciones generales al docente, para saber en que aspectos se debe enfatizar el trabajo grupal e individual.\n 2. Taller introductorio.  Se utilizar√° el libro gu√≠a del docente, para que los estudiantes realicen una reflexi√≥n general sobre los principales elementos de la estad√≠stica multivariada y de su papel en las ciencias biol√≥gicas, plasmando la informaci√≥n en un mapa conceptual.\n 3. Informe semestral.  Este ejercicio se realizar√° por seguimientos y para el primero se requiere que los estudiantes se organicen en grupos de hasta tres (3) integrantes, seleccionar el tema de trabajo y realizar una organizaci√≥n general de la informaci√≥n (con la ayuda de tablas din√°micas y exploraci√≥n general en Excel y en R)."
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#actividad-1.-conducta-de-entrada",
    "href": "Taller1.Introducci√≥n.html#actividad-1.-conducta-de-entrada",
    "title": "Taller1. Intro_multivariados",
    "section": "Actividad 1. Conducta de entrada",
    "text": "Actividad 1. Conducta de entrada\n\n\n[ Im√°gen tomada de Designpics ]\n\n\nEl objetivo de esta actividad consiste en que los estudiantes realicen un ejercicio reflexivo en donde brinden informaci√≥n sobre su percepci√≥n en cuanto a la importancia del an√°lisis multivariado. Para ello es necesario ingresar al siguiente üìÉEnlace"
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#actividad-2.-taller-introductorio-asignaci√≥n-1",
    "href": "Taller1.Introducci√≥n.html#actividad-2.-taller-introductorio-asignaci√≥n-1",
    "title": "Taller1. Intro_multivariados",
    "section": "Actividad 2. Taller Introductorio (Asignaci√≥n 1)",
    "text": "Actividad 2. Taller Introductorio (Asignaci√≥n 1)\n\n\n[ Im√°gen tomada de Polarpx ]\n\n\nEsta actividad debe ser realizada y cargada en la plataforma de Brightspace (Asignaci√≥n 1), la cual servir√° de soporte para una valoraci√≥n individual que ser√° realizada en una de las sesiones de clase (valoraci√≥n de 10 puntos).\nApoy√°ndose en la lectura introductoria de Rodr√≠guez-Barrios, J. (2023) üìñEnlace del cap√≠tulo y revisi√≥n de literatura, referenciada al final de este taller, realice un mapa conceptual en una p√°gina de Power Point, Word, o una imagen bien elaborada a mano, en donde identifique una problem√°tica biol√≥gica local (en la Universidad, en la ciudad o en alg√∫n lugar del el departamento), que sirva para relacionar las etapas, los requisitos y los objetivos del an√°lisis multivariado enfocado al an√°lisis de los datos obtenidos de ese trabajo identificado."
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#actividad-3.-estudio-de-caso-asignaci√≥n-2",
    "href": "Taller1.Introducci√≥n.html#actividad-3.-estudio-de-caso-asignaci√≥n-2",
    "title": "Taller1. Intro_multivariados",
    "section": "Actividad 3. Estudio de caso (Asignaci√≥n 2)",
    "text": "Actividad 3. Estudio de caso (Asignaci√≥n 2)\n\n\n[ Im√°gen tomada de Cagkan ]\n\n\nEl presente ejercicio, pretende ofrecer un entrenamiento en el uso de herramientas estad√≠sticas, para el an√°lisis de preguntas biol√≥gicas en el contexto multivariado. Adicionalmente se busca aplicar los conceptos vistos en las clases, a trav√©s de un estudio de caso que se ir√° construyendo a lo largo de las semanas restantes. Se realizar√° un trabajo en grupos de tres estudiantes, enfatizado en el enfoque estad√≠stico. Se realizar√°n encuentros semanales en donde cada grupo deber√° Informar al docente sobre sus avances en los siguientes aspectos:\n\nSeleccionar una base de datos de las relacionadas en el siguiente üìàenlace.\nPara los encuentros semanales con el docente, es necesario iniciar con la elaboraci√≥n de una introducci√≥n, que contextualice a la base de datos escogida, plantear objetivos y la pregunta de an√°lisis a realizar.\nSe deber√° avanzar en la elaboraci√≥n de un diagrama de flujo que defina en un paso a paso del dise√±o experimental para la evaluaci√≥n multivariada del grupo biol√≥gico o tema ambiental de la base seleccionada (artr√≥podos, vertebrados, vegetaci√≥n y ambiente asociado), identificar las variables, observaciones y factores de sus datos. En caso de que haya variables ambientales, incluirlas en el diagrama.\nEntregar documento con el an√°lisis realizado - Exploratorio multivariado en RMarkdown o Quarto. Los an√°lisis deben estar relacionados con los objetivos.\nAl final del primer seguimiento, se debe entregar los siguientes archivos: (1) informe en RMarkdown (m√°ximo 7 p√°ginas), (2) c√°lculos realizados en Excel, (3) Comandos en RStudio con su base de datos csv.\nEste informe debe ser sustentado por grupos de 2, m√°ximo 3 estudiantes. Los avances ser√°n revisados semanalmente por el docente."
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#videos-de-la-asignatura",
    "href": "Taller1.Introducci√≥n.html#videos-de-la-asignatura",
    "title": "Taller1. Intro_multivariados",
    "section": "Videos de la asignatura",
    "text": "Videos de la asignatura\n\n\n[ Im√°gen tomada de Vegefox.Com ]\n\nVIDEOS DEL DOCENTE: Videos realizados hasta el 2023-I. Revisar los de la semana 1. De: Rodr√≠guez-Barrios, J. (2023). Asignatura Estad√≠stica Multivariada. üé•Enlace_videos"
  },
  {
    "objectID": "Taller1.Introducci√≥n.html#referencias-bibliogr√°ficas-para-el-m√≥dulo-introductorio",
    "href": "Taller1.Introducci√≥n.html#referencias-bibliogr√°ficas-para-el-m√≥dulo-introductorio",
    "title": "Taller1. Intro_multivariados",
    "section": "Referencias bibliogr√°ficas para el m√≥dulo introductorio",
    "text": "Referencias bibliogr√°ficas para el m√≥dulo introductorio\n\n\n[ Im√°gen tomada de momius ]\n\n\n\nCAP√çTULO: 1. Conceptos b√°sicos para el an√°lisis de datos ecol√≥gicos y ambientales. De: Rodr√≠guez-Barrios, J. (2023). An√°lisis de datos ecol√≥gicos y ambientales: aplicaciones con programa R. Ediciones D√≠az de Santos. üìñEnlace_cap√≠tulo_intro.\n\n\n\nCAP√çTULO: Introduction. De: Legendre, P., and Loic F J Legendre. Numerical Ecology. Vol. V.Volume 24. Amsterdam: Elsevier Science & Technology, 1998. Developments in Environmental Modelling (20). Web. üìñEnlace_cap√≠tulo\n\n\n\nCAP√çTULO: Introduction. De: Borcard, D., Gillet, F., Legendre, P. (2018). Introduction. In: Numerical Ecology with R. Use R!. Springer, Cham. https://doi-org.biblioteca.unimagdalena.edu.co/10.1007/978-3-319-71404-2_1. üìñEnlace_cap√≠tulo\n\n\n\nCAP√çTULO: Introducci√≥n: pasos elementales de las t√©cnicas multivariadas. De: Palacio, Facundo & Apodaca, Mar√≠a & Crisci, Jorge. (2020). AN√ÅLISIS MULTIVARIADO PARA DATOS BIOL√ìGICOS Teor√≠a y su aplicaci√≥n utilizando el lenguaje R. üìñEnlace_cap√≠tulo"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#procedimiento-de-la-exploraci√≥n",
    "href": "Taller3.1.exploratorios.html#procedimiento-de-la-exploraci√≥n",
    "title": "Taller3. Exploratorios_mv",
    "section": "Procedimiento de la exploraci√≥n",
    "text": "Procedimiento de la exploraci√≥n\n\n\n\n\nCargar librer√≠as requeridas\nCargar la base Insectos (usar diferentes opciones para practicar)\nExplorar al objetivo 1 (figuras de elipses, pares, dispersi√≥n y coplot).\nExplorar al objetivo 2 (figuras de elipses, pares, dispersi√≥n y coplot).\nRealizar las opciones gr√°ficas relacionadas a los objetivos.\nRealizar transformaciones de los datos, para mejorar la visualizaci√≥n de patrones.\nPracticar con leyendas y resultados de la visualizaci√≥n realizada.\n\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(tidyverse)\nlibrary(xtable)       # Importar y exportar\nlibrary(openxlsx)     # exportar \"*.xlsx\" \nlibrary(readxl)       # Importar y exportar\nlibrary(gtable)       # Importar y exportar\n\nrequire(stats)        # No se requiere instalar\nlibrary(lattice)      # No se requiere instalar\nlibrary(ggrepel)      # insertar r√≥tulos a los puntos\nrequire(SciViews)     # Fig. dispersi√≥n con coef. de pearson\nlibrary(plotrix)      # Figuras de cajas con m√∫ltiples variables\nlibrary(corrplot)     # Figuras de elipses\nlibrary(psych)        # Matrices de correlaci√≥n para figuras de elipses\nlibrary(GGally)       # Requerido para figura de pares con ggpairs\nlibrary(gganimate)    # Para figuras animadas de dispersi√≥n\nlibrary(reshape)      # Figuras de cajas con m√∫ltiples variables\nlibrary(gridExtra)    # Para figuras estad√≠sticas (varios factores)\nlibrary(grid)         # Para figuras estad√≠sticas (varios factores)\n\n\n\n\nCargar o importar la base de datos\n\n\n\nA continuaci√≥n se presentan tres formas diferentes de importar o cargar bases de dato, tanto en el formato original de Excel (xlsx) como en el formato plano (csv). Se utilizar√° la tercera opci√≥n para el resto del ejrcicio.\n\n#------------\ndatos <- read_excel(\"Insectos.xlsx\")    # paquete \"readxl\" \nhead(datos)\n\n# A tibble: 6 √ó 10\n  quebrada cuenca    pH  temp  Efem  Plec  Tric  Dipt  Cole    Ab\n     <dbl> <chr>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1        1 cuen1    6.8  17.4    26     4     9    30     3    72\n2        4 cuen1    7.3  16.8    17     6     9    25     1    58\n3       11 cuen1    5.6  16       9     3    28    24     3    67\n4       13 cuen1    6.3  17.8     2     3    25    21     6    57\n5       19 cuen1    5.6  18.2     6     4    24    12    13    59\n6        3 cuen2    6.3  17       7     2    25    10     1    45\n\ndatos <- read_csv2(\"Insectos.csv\")      # paquete \"readxl\"\nhead(datos)\n\n# A tibble: 6 √ó 10\n  quebrada cuenca    pH  temp  Efem  Plec  Tric  Dipt  Cole    Ab\n     <dbl> <chr>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1        1 cuen1    6.8  17.4    26     4     9    30     3    72\n2        4 cuen1    7.3  16.8    17     6     9    25     1    58\n3       11 cuen1    5.6  16       9     3    28    24     3    67\n4       13 cuen1    6.3  17.8     2     3    25    21     6    57\n5       19 cuen1    5.6  18.2     6     4    24    12    13    59\n6        3 cuen2    6.3  17       7     2    25    10     1    45\n\ndatos <- read.csv2(\"Insectos.csv\")      # paquete \"utils\"\nhead(datos)\n\n  quebrada cuenca  pH temp Efem Plec Tric Dipt Cole Ab\n1        1  cuen1 6.8 17.4   26    4    9   30    3 72\n2        4  cuen1 7.3 16.8   17    6    9   25    1 58\n3       11  cuen1 5.6 16.0    9    3   28   24    3 67\n4       13  cuen1 6.3 17.8    2    3   25   21    6 57\n5       19  cuen1 5.6 18.2    6    4   24   12   13 59\n6        3  cuen2 6.3 17.0    7    2   25   10    1 45\n\n\n\n\n\n1. Figuras de elipses\n\n\n\nEl Paquete corrplot es el que permite realizar las opciones gr√°ficas de elipses a color, ingresar a este enlace:\ncorrplot\nOtro enlace a corrplot:\ncorrplot\nLas figuras de correlaci√≥n realizadas con el paquete corrplot, son una buena opci√≥n para evaluar los patrones generales de relaciones positivas (azul) y/o negativas (rojo), entre parejas de variables. Funcionan para objetivos orientados en la relaciones de (1) variables biol√≥gicas, (2) variables ambientales y (3) variables biol√≥gicas con las ambientales.\n\n# Elipses con colores\nM <- cor(datos[,3:10])            # Matriz de Correlaci√≥n (M)\n\nLa Figura¬†1.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses y de circulos.\n\n# Elipses con colores\nx11()\npar(mfrow = c(1,2), mar = c(3, 3, 2, 1))\n\ncorrplot(M, method = \"ellipse\")  # Figura de correlaciones con elipses\n\n# Elipses con colores\ncorrplot(M, method = \"circle\")   # Figura de correlaciones con circulos\n\npar(mfrow = c(1,1))\n\n\n\n\nFigura¬†8.1: Relaci√≥n de variables ambientales y los taxones en las veinte quebradas estudiadas.\n\n\n\n\n\n\nLa Figura¬†2.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses, adem√°s incorpora al nivel de correlaci√≥n entre las parejas de variables con los coeficientes de Pearson.\n\n# Elipses con colores\nX11()\ncorrplot.mixed(M, upper=\"ellipse\")\n\n\n\n\nFigura¬†8.2: Relaci√≥n de variables ambientales y los taxones en las veinte quebradas estudiadas.\n\n\n\n\n\n\nLa siguiente opci√≥n de correlaci√≥n (Figura¬†3.1), presenta un c√≥digo m√°s compejo que las anteriores, pero permite generar una visualizaci√≥n m√°s completa de las relaciones entre parejas de variables y sus coeficientes de correlaci√≥n de Pearson (tambi√©n se pueden probar otros coeficientes como Spearman o Kendall).\n\nx11()\ncorrplot(M,  method = \"circle\",            # Correlaciones con circulos\n         type = \"lower\", insig=\"blank\",    # Forma del panel\n         order = \"AOE\", diag = FALSE,      # Ordenar por nivel de correlaci√≥n\n         addCoef.col =\"black\",             # Color de los coeficientes\n         number.cex = 0.8,                 # Tama√±o del texto\n         col = COL2(\"RdYlBu\", 200))        # Transparencia de los circulos\n\n\n\n\nFigura¬†8.3: Relaci√≥n de variables ambientales y los taxones en las veinte quebradas estudiadas.\n\n\n\n\n\n\nLa siguiente figura de correlaciones (Figura¬†3.2) es apropiada para casos en los que tenemos muchas variables biol√≥gicas (ej. tipos de taxones) e interesa evaluar su relaci√≥n con las variables ambientales.\n\n# Elipses con colores\nM1 <- cor(datos[,3:4], datos[,5:10])            # Matriz de Correlaci√≥n (M)\n\n# Elipses con colores\nX11(6,8)\ncorrplot(M1, method = \"ellipse\", type=\"upper\")\n\n\n\n\nFigura¬†8.4: Relaci√≥n de variables ambientales y los taxones en las veinte quebradas estudiadas.\n\n\n\n\n\n\n\n3. Figuras de Dispersi√≥n por pares de variables (pairs)\n\nEl Paquete pairs es el que permite realizar las opciones gr√°ficas de dispersi√≥n por parejas de variables, ingresar a este enlace:\npairs\nOtro enlace a pairs:\npairs\n\n\nLos gr√°ficos de pares son complementarios a los de correlaci√≥n, pero permiten conocer otros detalles en las relaciones entre parejas de variables (ej. relaciones lineaes vs.¬†suavizadas o loess). En la siguiente figura (Figura¬†3.3), adem√°s de visualizar si la dispersi√≥n de los puntos se orienta hacia una relaci√≥n positiva o negativa, entre m√°s se ajuste la l√≠nea verde (tendencia lineal), con la negativa (tendencia no lineal, suavizada o loess), se puede precisar mejor, si hay una verdadera relaci√≥n lineal entre las parejas de variables en comparaci√≥n.\n\n# Figuras de pares\npairs ((datos[,c(3:9)]),panel=function(x,y)\n{abline(lsfit(x,y)$coef,lwd=2,col=3)    # lwd = Ancho de la l√≠nea\n  lines(lowess(x,y),lty=1,lwd=3,col=2)    # col= Color de la l√≠nea\n  points(x,y,cex=1)}) \n\n\n\n\nFigura¬†8.5: Relaci√≥n de variables ambientales y los taxones en las veinte quebradas estudiadas, con regresiones lineales y suavizadas.\n\n\n\n\n\n\nPara la siguiente figura es primordial que lo que consideremos un factor, lo sea como tal. Si se observa la estructura de la base de datos de este ejemplo (str(datos)), se encontrar√° que R no asume a la columna ‚Äúcuenca‚Äù como un factor (la asume como un caracter chr). En este sentdo, a continuaci√≥n se convertir√° en un factor, con el comando as.factor.\n\n# Ajustar el factor cuenca\ndatos$cuenca <- as.factor (datos$cuenca)\n\n\n\nEs importante mencionar que estas figuras no son apropiadas para casos en los que se manejen demasiadas variables, para lo cual las elipses anteriores ser√°n una mejor opci√≥n. En la siguiente figura (Figura¬†4.1) se seleccionan las cinco variables m√°s correlacionadas y al final de la l√≠nea de c√≥digo, se define al factor a graficar (col=datos$cuenca), que permitir√° colocar colores a los puntos, de acurdo al tipo de cuenca al que pertenezcan.\n\n# Incluir el factor (cuenca)\nx11()\npairs ((datos[,c(3,5,7,8,10)]),panel=function(x,y)\n{abline(lsfit(x,y)$coef,lwd=2,col=3)\n  lines(lowess(x,y),lty=2,lwd=2,col=2)\n  points(x,y,col=datos$cuenca, cex=1.4,pch=19)})\n\n\n\n\nFigura¬†8.6: Relaci√≥n de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones lineales y suavizadas, definiendo con colores a los grupos de cuencas.\n\n\n\n\n\n\nA continuaci√≥n se presenta una variante a las figuras de pares (Figura¬†4.2), que por medio de la funci√≥n panel, permite incorporar otros elementos en la matriz gr√°fica, como histogramas para visualizar el patr√≥n de simetr√≠a de cada variable y el valor de correlaci√≥n con coeficientes como el de Pearson. Las l√≠neas rojas definen la relaci√≥n no lineal o suavizada (loess o lowess) entre las parejas de variables.\n\n# Correlaciones de Pearson\nlibrary(SciViews)\nx11()\npairs(datos[,c(3,5,7,8,10)], diag.panel = panel.hist, \n      upper.panel = panel.cor, lower.panel = panel.smooth)\n\n\n\n\nFigura¬†8.7: Relaci√≥n de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones suavizadas, coeficientes de correlaci√≥n de Pearson e histogramas de frecuencia para cada variable.\n\n\n\n\n\n\nFiguras de pares en ggplot2\n\n\n\nEl Paquete ggpairs es el que permite realizar las opciones gr√°ficas de dispersi√≥n por parejas de variables, ingresar a los siguientes enlaces:\nggpairs\nggpairs\nggpairs\nLa siguiente figura (Figura¬†4.3), es apropiado para pocos grupos de muestras (ej. < 4 cuencas) y para pocas variables como las que se definen a continuaci√≥n. Tambi√©n es recomendable realizarlas con muestras que presenten un n√∫mero considerable de observaciones, lo cual permita tener una nube de puntos m√°s definida.\n\n# Figura de pares con cuatro variables seleccionadas\nggpairs(datos,                             # Data frame\n        columns = c(3,7,8,10),             # Columnas o variables\n        aes(color = cuenca, alpha = 0.5),  # Color por cuenca\n        upper = list(continuous=\"points\")) \n\n\n\n\nFigura¬†8.8: Relaci√≥n de variables ambientales y pocos taxones en las veinte quebradas estudiadas, con colores para definir a las los lugares de cada cuenca evaluada.\n\n\n\n\n\n\nEn la siguiente figura (Figura¬†5.1) se incorporan dos elementos adicionales, correspondientes a los coeficientes de correlaci√≥n de Pearson y regresiones lineales, para cada grupo analizado (cuencas).\n\n# Figura de pares incorporando coeficientes de correlaci√≥n y regresiones lineales\nggpairs(datos, columns = c(3,7,8,10), \n        aes(color=cuenca, alpha = 0.5),\n        lower=list(continuous=\"smooth\"))\n\n\n\n\nFigura¬†8.9: Relaci√≥n de variables ambientales y algunos taxones en las veinte quebradas estudiadas, con regresiones lineales, coeficientes de correlaci√≥n de Pearson e histogramas de frecuencia para cada variable.\n\n\n\n\n\n\n\n\n3. Histogramas\n\n\n\nLos presentes histogramas valoran el patron de distribuci√≥n en la frecuencia de los datos de la abundancia de los insectos (variable Ab), en t√©rminos generales (Figura¬†5.2) y para cada cuenca estudiada (Figura¬†7.2).\n\n# Frecuencias de abundancias \nhistogram (~Ab,data=datos, ylab=\"Porcentaje del Total\",\n           xlab=\"Abundancia de insectos\")\n\n\n\n\nFigura¬†8.10: Patr√≥n de distribuci√≥n de la abundancia de insectos en las veinte quebradas evaluadas.\n\n\n\n\n\n\nEl siguiente histograma (Figura¬†7.2), permite evaluar el patr√≥n de abundancia de los insectos en cada cuenca evaluada.\n\n# Frecuencias de abundancias por cuencas\nhistogram (~Ab|cuenca,data=datos, ylab=\"Porcentaje del Total\",\n           xlab=\"Abundancia de insectos\")\n\n\n\n\nFigura¬†8.11: Patr√≥n de distribuci√≥n de la abundancia de insectos en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\nLas figuras de densidad (Figura¬†7.3) son otra forma de valorar la distribuci√≥n de las frecuencias de las variables en estudio, pero suavizando o generando un gradiente cont√≠nuo de frecuencia.\n\n# Frecuencias de abundancias \ndensityplot(~Ab,data=datos, ylab=\"Porcentaje del Total\",\n            xlab=\"Abundancia de insectos\")  \n\n\n\n\nFigura¬†8.12: Patr√≥n de distribuci√≥n de la abundancia de insectos en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\nA continuaci√≥n se muestra un histograma de frecuencias en la abundancia de los insectos (Figura¬†8.13), para cada cuenca evaluada, generando un patr√≥n marcado que difiere para cada lugar evaluado.\n\n# Frecuencias de abundancias por cuencas\ndensityplot(~Ab|cuenca,data=datos, ylab=\"Porcentaje del Total\",\n            xlab=\"Abundancia de insectos\")\n\n\n\n\nFigura¬†8.13: Patr√≥n de distribuci√≥n cont√≠nuo de la abundancia de insectos en las veinte quebradas evaluadas.\n\n\n\n\n\n\nLas dos figuras que siguen (Figura¬†8.14 y Figura¬†8.15), utilizan comandos del paquete ggplot2 para visualizar de una forma m√°s compacta a la distribuci√≥n de frecuencias de la variable abundancia de insectos (AB) en las cuatro cuencas evaluadas.\n\n# Frecuencias de abundancias por densidad\nggplot(data = datos, aes(x = Ab, color = cuenca)) +\n  geom_density(aes(fill = cuenca), alpha = 0.5) +\n  labs( y=\"Frecuencia\", x=\"Abundancia\")\n\n\n\n\nFigura¬†8.14: Patr√≥n de distribuci√≥n cont√≠nuo de la abundancia de insectos en las veinte quebradas evaluadas.\n\n\n\n\n\n# Otra opci√≥n\nggplot(data = datos, aes(x = Ab, color = cuenca)) +\n  geom_density(aes(fill = cuenca)) + \n  facet_wrap(~ cuenca)\n\n\n\n\nFigura¬†8.15: Patr√≥n de distribuci√≥n cont√≠nuo de la abundancia de insectos en las veinte quebradas y cuatro cuencas evaluadas.\n\n\n\n\n\n\n\n4. Dispersi√≥n X-Y\n\n\n\nEl Paquete lattice es uno de los que permite realizar las opciones gr√°ficas de dispersi√≥n, ingresar a este enlace:\nlattice\nA continuaci√≥n se presenta una figura de dispersi√≥n (Figura¬†8.16), que relaciona a la abundancia de Efemer√≥pteros con los niveles de pH, adicionalmente, se muestra el patr√≥n de dispersi√≥n de los datos, en los que los colores representan a las diferentes cuencas evaluadas.\n\n# Regresi√≥n lineal (esquema b√°sico) \nlibrary(lattice)\ndatos$cuenca <- as.factor (datos$cuenca)  # cuenca como factor\n\nx11(8,6)\nplot(Efem~pH,                         # Relaci√≥n pH vs. Efem\n     col=as.integer(cuenca),          # Colores por tipo de cuencas\n     data=datos, pch=19)              # Base de datos\nlegend(5.5,25,                        # Coordenadas de la leyenda\n       legend=levels(datos$cuenca),   # Grupos de la leyenda\n       pch=19,col=1:4,cex=1.2)\nlines(abline(lm(datos$Efem~datos$pH), # regresi√≥n lineal\n             lwd=2,col=2, lty=2))\n\n\n\n\nFigura¬†8.16: Relaci√≥n entre el pH y la abundancia de Efemer√≥pteros en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\nDispersi√≥n X-Y con ggplot2\n\n\n\nEl Paquete ggplot2 es el que permite realizar las opciones gr√°ficas de dispersi√≥n bivariados, ingresar a este enlace:\nRPubs.\nOtro enlace a ggplot2:\nggplot2\nLas tres figuras que siguen, muestran opciones m√°s compactas que la grafica anterior, para visualizar relaciones bivariadas en los descriptores en estudio, permitiendo tambi√©n analizar el patr√≥n de dispersi√≥n de los datos para cada cuenca evaluada (colores). La Figura¬†8.17 permite visualizar la relaci√≥n lineal incluyendo bandas grises que representan los l√≠mites de confianza de la proyecci√≥n realizada.\n\n# Regresiones lineales (Esquema ggplot2) \nggplot(datos,aes(x = pH,y = Efem)) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth(method= \"lm\") +\n  theme_classic()\n\n\n\n\nFigura¬†8.17: Relaci√≥n Lineal entre el pH y la abundancia de Efemer√≥pteros en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\nLa Figura¬†8.18, a diferencia de la anterior, permite visualizar una relaci√≥n suavizada en la pareja de variables en comparaci√≥n. Esta relaci√≥n no lineal es conocida como Loess o Lowess.\n\n# Regresiones suavizadas - Loess o Lowess (Esquema ggplot2) \nggplot(datos,aes(x = pH, y = Efem)) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth()\n\n\n\n\nFigura¬†8.18: Relaci√≥n Suavizada (Loess) entre el pH y la abundancia de Efemer√≥pteros en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\nEn la Figura¬†8.19 se eliminan los intervalos de confianza (bandas grises) y aumenta el suavizamiento con el comando span = 0.4.\n\n# Regresiones suavizadas (Loess)\nggplot(datos,aes(x = pH, y = Efem)) +   \n  geom_point(aes(color = cuenca), size = 3) +  \n  geom_smooth(se = FALSE, span = 0.4)\n\n\n\n\nFigura¬†8.19: Relaci√≥n Suavizada (Loess) entre el pH y la abundancia de Efemer√≥pteros en las veinte quebradas y las cuatro cuencas evaluadas.\n\n\n\n\n\n\n\n\n5. Cajas y Bigotes\n\n\n\nEl Paquete lattice es uno de los que permite realizar las opciones gr√°ficas de cajas, ingresar a este enlace:\nHow to make a boxplot in R\nEl Paquete ggplot2 presenta opciones m√°s est√©ticas y robustas para estas y muchas m√°s figuras, ingresar a este enlace:\nEnlace1\nEnlace2\nLas figuras de cajas y bigotes, permiten visualizar medidas de tendencia central como las medianas (segundo cuartil) y el rango intercuart√≠lico (l√≠mites de las cajas), es este caso, para el patr√≥n de abundancia de los insectos en las cuatro cuencas evaluadas (Figura¬†8.20).\n\n# Figuras de Cajas y bigotes\ndatos$cuenca<-factor(datos$cuenca, \n                     levels=c(\"cuen1\",\"cuen2\",\"cuen3\",\"cuen4\"))\n\n# Cajas y Bigotes con muescas\nboxplot(Ab~cuenca,data=datos,notch=TRUE,\n        xlab=\"Cuencas\",ylab=\"Abundancia\",\n        col=\"lightgray\", cex.lab=1.3)     # Probar con otros colores\n\n\n\n\nFigura¬†8.20: Variaci√≥n en la abundancia de insectos para las cuatro cuencas evaluadas.\n\n\n\n\nEnlaces de paletas de colores para la edici√≥n de las figuras:\ncolorbrewer\ncoolors\nA continuaci√≥n se visualiza el patr√≥n de variaci√≥n en la abundancia de los insectos (Figura¬†8.21), para las cuatro cuencas evaluadas, adicionando colores especificos, tomados de los enlaces anteriores.\n\n# Buscar en google: colorbrewer2\nggplot(datos, aes(x=cuenca, y=Ab)) + \n  geom_boxplot(aes(fill = cuenca)) +\n  labs(x=\"Cuencas\", y= \"Abundancia de Insectos\") +\n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8'))\n\n\n\n\nFigura¬†8.21: Variaci√≥n en la abundancia de insectos para las cuatro cuencas evaluadas.\n\n\n\n\n\n\nEn la Figura¬†8.22 se incluyen muescas a las cajas, para permitir hacer una comparaci√≥n m√°s precisa de las abundancias de los insectos en las cuencas evaluadas.\n\n# Organizaci√≥n por nivel de magnitud\nggplot(datos, aes(x = fct_reorder(cuenca, Ab),y=Ab)) + \n  geom_boxplot(notch = T, aes(fill = cuenca)) +\n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8'))\n\n\n\n\nFigura¬†8.22: Variaci√≥n en la abundancia de insectos para las cuatro cuencas evaluadas, incluyendo muescas en las cajas.\n\n\n\n\n\n\nPar√©ntesis Base de datos de lirios (iris) para figura de viol√≠n (Figura¬†8.23). Estas figuras permiten visualizar la simetr√≠a en la distribuci√≥n de las frecuencias de las variables.\n\n# violin: como histograma acostado\nggplot(iris, aes(x = Species, y = Sepal.Length)) + \n  geom_violin(aes(fill = Species)) + \n  geom_jitter() +\n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594')) +\n  theme_bw()\n\n\n\n\nFigura¬†8.23: Variaci√≥n en la abundancia de insectos para las cuatro cuencas evaluadas, mediante figuras de violines.\n\n\n\n\n\n\nLa Figura¬†8.24 muestra su versatilidad en que permite incorporar diferentes variables por cada panel presentado. Las cajas de colores representan a los grupos en comparaci√≥n (cuencas).\n\n# Figuras multivariadas de Cajas y bigotes\nx11()\nggplot(melt(datos[,c(2,c(3,7,8,10))]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=cuenca)) + \n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8')) +\n  labs(x=\"\",y=\"Abundancia\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†8.24: Variaci√≥n en la abundancia de diferentes taxones de insectos para las cuatro cuencas evaluadas.\n\n\n\n\n\n\n\n6. Coplot\n\n\n\nLas figuras de coplot, permiten relacionar a tres variables, en donde una de ellas puede ser continua o discreta, mediante segmentaciones.En la Figura¬†8.25 se incorporan regresiones suavizadas (loess). Seis p√°neles en la relaci√≥n pH y Efemer√≥pteros se asocian a seis barras de temperatura, en donde el primer panel de la parte inferior se correlaciona con la primera barra de temperatura, ubicada a la izquierda y as√≠ sucesivamnte.\n\n# Coplot con l√≠neas de ajuste suavizado (loess)\nwith(datos, {\n  coplot(Efem~pH|temp,\n         panel = panel.smooth)})\n\n\n\n\nFigura¬†8.25: Figura trivariada, en la que se intenta categorizar a la temperatura.\n\n\n\n\n\n\nPara este caso (?fig-fig27), se realiza una categorizaci√≥n de dos variables cont√≠nuas, que permitir√°n construir el coplot sin solapamiento de las barras de la tercera variable. Las relaciones se proyectan de forma lineal y el la siguiente ifura ser√°n de forma suavizada.\n\n# Categorizaci√≥n de dos variables cont√≠nuas (pH y Temp)\nsummary(datos[,3:9])\n\n       pH            temp            Efem            Plec           Tric      \n Min.   :5.50   Min.   :15.00   Min.   : 2.00   Min.   :0.00   Min.   : 7.00  \n 1st Qu.:6.00   1st Qu.:15.95   1st Qu.: 6.00   1st Qu.:3.00   1st Qu.:15.00  \n Median :6.50   Median :17.05   Median :12.50   Median :4.00   Median :22.00  \n Mean   :6.48   Mean   :16.99   Mean   :13.75   Mean   :3.85   Mean   :20.95  \n 3rd Qu.:7.00   3rd Qu.:17.88   3rd Qu.:19.00   3rd Qu.:5.00   3rd Qu.:25.00  \n Max.   :7.50   Max.   :19.80   Max.   :28.00   Max.   :8.00   Max.   :37.00  \n      Dipt            Cole      \n Min.   : 0.00   Min.   : 1.00  \n 1st Qu.:12.00   1st Qu.: 3.00  \n Median :24.50   Median : 6.00  \n Mean   :22.15   Mean   : 7.70  \n 3rd Qu.:30.00   3rd Qu.:12.25  \n Max.   :39.00   Max.   :21.00  \n\nclasetemp <- cut(datos$temp,seq(15,20,1.2),include.lowest=T,\n                 labels = c(\"t.baja\", \"t.media1\",\"t.media2\", \"t.alta\"))\n\nclasepH <- cut(datos$pH,seq(5,8,1),include.lowest=T,\n               labels = c(\"pH.bajo\", \"pH.medio\",\"pH.alto\"))\n\n\n# Funci√≥n para el coplot \npanel.lm = function(x, y, ...) {\n  tmp<-lm(y~x,na.action=na.omit)\n  abline(tmp, lwd = 1.5, col= 2)\n  points(x,y, ...)}\n\n\n# Relaci√≥n trivariada - Lineal\ncoplot(Efem~pH | clasetemp, pch=19,\n       panel = panel.lm, data=datos)\n\ncoplot(Efem~pH | clasetemp, pch=19,\n       panel = panel.smooth, data=datos)\n\n\n\n\nFigura¬†8.26: Figura trivariada, Con la variable temperatura categorizada y relaciones suavizadas entre el pH y los Efemer√≥pteros.\n\n\n\n\n\n\n\nFigura¬†8.27: Figura trivariada, Con la variable temperatura categorizada y relaciones suavizadas entre el pH y los Efemer√≥pteros.\n\n\n\n\n\n\n\n7. Figuras con estad√≠sticos (promedios, errores, ‚Ä¶)\n\n\n\nEl Paquete ggplot2 es uno de los que permite realizar las opciones gr√°ficas de barras con estad√≠sticos, ingresar a este enlace:\nExploratory Data Analysis with ggplot\nExisten otros enlaces en los que se puede encontrar informaci√≥n complementaria para figuras de barras, como los siguientes\nggplot2 barplots\nStunning Bar Charts\nA continuaci√≥n se muestra el procedimiento con lenguaje Tidyverse, para realizar una tabla con el resumen de diferentes insumos estad√≠sticos, para cada grupo (cuencas) de la base de datos.\n\n# Resumen estad√≠stico \"datos_resum\"\ndatos_resum <- datos %>%        # Base de datos resumida\n  group_by(cuenca) %>%          # Factor o variable agrupadora\n  summarise(datos.m = mean(Ab),   # Media de cada grupo del factor\n            datos.de  = sd(Ab),   # Desviacioes est√°ndar de cada grupo\n            datos.var = var(Ab),  # Varianzas de cada grupo\n            n.Ab = n(),           # Tama√±o de cada grupo\n            datos.ee = sd(Ab)/sqrt(n()))   # Error est√°ndar de cada grupo\ndatos_resum\n\n# A tibble: 4 √ó 6\n  cuenca datos.m datos.de datos.var  n.Ab datos.ee\n  <fct>    <dbl>    <dbl>     <dbl> <int>    <dbl>\n1 cuen1     62.6     6.58      43.3     5    2.94 \n2 cuen2     49.2     5.40      29.2     5    2.42 \n3 cuen3     73.8     1.30       1.7     5    0.583\n4 cuen4     88      10.1      102.      5    4.53 \n\n\n\n\nLa siguiente asignaci√≥n (DatosPlot), incorpora las capas requeridas para realizar una figura de columnas y de l√≠eas acotadas, que representan a los promedios y a los errores est√°ndar respectivamente.\n\n# Figura de promedios y errores est√°ndar\nDatosPlot<-\n  ggplot(datos_resum, aes(cuenca, datos.m, dev.off())) + \n  geom_bar(stat=\"identity\", col=\"black\", fill=\"#377eb8\") +  \n  geom_errorbar(aes(ymin=datos.m-datos.ee, \n                    ymax=datos.m+datos.ee),width=0.2) \n\n\n\nLa asignaci√≥n (DatosPlot), es tgraficada con el siguiente comando, en el que se incluyen elementos como los r√≥tulos de los ejes (labs) y el tema de fondo (theme_classic()) (Figura¬†8.28).\n\n# Imprimir la figura de promedios con errores est√°ndar\nprint (DatosPlot + \n       labs(y=\"Abundancia ¬± e.e.\", \n            x = \"cuenca\") + \n        scale_fill_manual(values= c(\"#A1D5D5\")) +\n        theme_classic())\n\n\n\n\nFigura¬†8.28: Differencias en los promedios y errores est√°ndar de la abundancia de insectos, para las cuatro cuencas.\n\n\n\n\n\n\nPara la siguiente figura de Cajas y Bigotes, el comando stat_boxplot(geom = \"errorbar\",...) permite realizar gr√°ficas sin necesidad de extraer algunos estad√≠sticos previamente.\n\n# Opci√≥n de cajas y bigotes con errores est√°ndar\nggplot(datos, aes(x=cuenca, y= Ab, fill= cuenca)) +\n  stat_boxplot(geom = \"errorbar\",width = 0.05) + \n  geom_boxplot(width = 0.4, \n        notchwidth = 0.9, outlier.colour=\"red\",\n        outlier.fill=\"red\",\n        outlier.size=3, outlier.alpha = 0.2) + \n  theme_classic() + \n  scale_fill_manual(values=c('#fc8d59','#ffffbf','#99d594','#377eb8')) + \n  labs(x = \"Cuencas\", y = \"Abundancia ¬± e.e.\")+ \n  scale_y_continuous(limits = c(40,90))\n\n\n\n\nFigura¬†8.29: Differencias en la abundancia de insectos, para las cuatro cuencas.\n\n\n\n\n\n\nBase de datos con m√∫ltiples factores\n\n\n\nLo que diferencia a esta base de datos (insectos1.csv) de la anterior (insectos.csv), es que presenta a diferentes variables agrupadoras o factores, como periodos de lluvia, Gruos Funcionales Alimenticios (GF) y Muestreos. Para el siguiente ejercicio se realizar√° el resumen estad√≠stico de los dos primeros factores.\n\n# Base de datos multifactorial (insectos1)\ndatos1<-read_csv2(\"Insectos2.csv\")    # Formato *xlsx\nhead(datos1)  # Encabezado\n\n# A tibble: 6 √ó 6\n     No Muestreo GF    Lluvia    Ab  Biom\n  <dbl> <chr>    <chr> <chr>  <dbl> <dbl>\n1     1 M1       C-F   P1        98 56.0 \n2     2 M2       C-F   P1       198 52.7 \n3     3 M3       C-F   P2        45 11.4 \n4     4 M4       C-F   P2        51 25.3 \n5     5 M5       C-F   P2         3  0.36\n6     6 M6       C-F   P2        69 23.6 \n\n\n\n# Resumen estad√≠stico \"datos_resum\"\ndatos_resum <- datos1 %>%        # Base de datos resumida\n  group_by(Lluvia,GF) %>%          # Factor o variable agrupadora\n  summarise(datos.m = mean(Biom),   # Media de cada grupo del factor\n            datos.de  = sd(Biom),   # Desviacioes est√°ndar de cada grupo\n            datos.var = var(Biom),  # Varianzas de cada grupo\n            n.Biom = n(),           # Tama√±o de cada grupo\n            datos.ee = sd(Biom)/sqrt(n()))   # Error est√°ndar de cada grupo\ndatos_resum\n\n# A tibble: 10 √ó 7\n# Groups:   Lluvia [2]\n   Lluvia GF    datos.m datos.de datos.var n.Biom datos.ee\n   <chr>  <chr>   <dbl>    <dbl>     <dbl>  <int>    <dbl>\n 1 P1     C-F      37.0     30.0      902.      3    17.3 \n 2 P1     C-R      31.7     32.1     1029.      3    18.5 \n 3 P1     D       361.     120.     14411.      3    69.3 \n 4 P1     R        53.5     69.8     4873.      3    40.3 \n 5 P1     T       190.     296.     87533.      3   171.  \n 6 P2     C-F      14.4     10.2      105.      5     4.58\n 7 P2     C-R      88.5    115.     13273.      5    51.5 \n 8 P2     D       176.      94.9     9010.      5    42.4 \n 9 P2     R        21.9     12.9      165.      5     5.75\n10 P2     T       151.     223.     49655.      5    99.7 \n\n\n\n\nLas asignaciones f1 y f2, corresponden a las mismas figuras bifactoriales, en donde la primera se muestra con pocos ajustes de sus ejes y fondo, comparada a la segunda que presenta una mayor edici√≥n. Finalmente el comando grid.arrange permite graficar a las dos figuras en un mismo panel.\n\n# Figura 1 (f1)\nf1 = ggplot(datos_resum, aes(x=GF, y=datos.m, fill=Lluvia)) + \n     geom_bar(stat=\"identity\", color=\"black\", \n              position=position_dodge()) +\n     geom_errorbar(aes(ymin=datos.m, ymax=datos.m+datos.de), width=.2,\n              position=position_dodge(.9)) \n\n# f2: Otro formato de figura bifactorial - theme_classic\nf2 = f1+labs(title=\"Biomasa por GF\", \n             x=\"Grupos Funcionales - GF\", \n             y = \"Biomasa\")+\n     theme_classic() +\n     scale_fill_manual(values=c('#E69F00','#999999'))\n\n# Impresi√≥n de un panel con las dos figuras de forma horizontal (f1 y f2)\ngrid.arrange (f1, f2, ncol=2)\n\n\n\n\nFigura¬†8.30: Differencias en la abundancia de insectos, los periodos de lluvia y para los grupos funcionales (GF).\n\n\n\n\n\n\nCambiando la ubicaci√≥n por columnas ncol por la de filas nrow, se cambia la posici√≥n de las figuras anteriores en el mismo panel.\n\n# Impresi√≥n de un panel con las dos figuras de forma vertical (p1 y p2)\nx11()\ngrid.arrange (f1, f2, nrow=2)\n\n\n\n\nFigura¬†8.31: Differencias en la abundancia de insectos, los periodos de lluvia y para los grupos funcionales (GF).\n\n\n\n\n\n\n\nparentesis Figuras de dispersi√≥n animadas\n\n\n\nEnlace\nNota: ¬°No estresarse en caso de que no se logre ejecutar esta figura!\n\nlibrary(ggplot2)\nlibrary(gganimate)\ntheme_set(theme_bw())   # Tema o fondo de la figura por default\n\n\n# Demo\nlibrary(gapminder)\n\np <- ggplot(\n  gapminder, \n  aes(x = gdpPercap, y=lifeExp, size = pop, colour = country)\n  ) +\n  geom_point(show.legend = FALSE, alpha = 0.7) +\n  scale_color_viridis_d() +\n  scale_size(range = c(2, 12)) +\n  scale_x_log10() +\n  labs(x = \"GDP per capita\", y = \"Life expectancy\")\np\n\n\np + transition_time(year) +\n  labs(title = \"Year: {frame_time}\")"
  },
  {
    "objectID": "Taller3.1.exploratorios.html#taller-de-entrenamiento",
    "href": "Taller3.1.exploratorios.html#taller-de-entrenamiento",
    "title": "Taller3. Exploratorios_mv",
    "section": "Taller de entrenamiento",
    "text": "Taller de entrenamiento\n\n\n\nObjetivo: Poner en pr√°ctica los conceptos vistos en el m√≥dulo de exploratorios, realizando las siguientes opciones gr√°ficas en las bases de datos de lirios data(iris):\n\nFiguras de elipses\nFiguras de Dispersi√≥n por pares de variables (pairs)\nHistogramas\nDispersi√≥n X-Y\nCajas y Bigotes\nCoplot\nFiguras con estad√≠sticos (promedios, errores, ‚Ä¶)"
  },
  {
    "objectID": "Taller4.1.pca.marino.html",
    "href": "Taller4.1.pca.marino.html",
    "title": "Taller4.1 PCA Bah√≠as",
    "section": "",
    "text": "La Figura¬†1.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses.\nLa Figura¬†2.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses y coeficientes de correlaci√≥n de Pearson.\nLa Figura¬†3.1 otra forma de mostrar la relaci√≥n entre las variables, a partir de figuras de elipses y coeficientes de correlaci√≥n de Pearson.\n1.1) Valores propios - autovalores para medir el ajuste del PCA\n1.2) Insumos del pca (names)\n1.3) Valores propios - autovectores y escores\n1.4) Contribuci√≥n de los ejes del pca\nLa Figura¬†3.2 muestra la manera de graficar a la varinza que captura cada componente principal.\n1.5) Opciones de biplot, por combinaciones de ejes.\nLa Figura¬†3.3 muestra la ordenaci√≥n de las locaidades y las variables ambientales en las 7 bah√≠as evaluadas (gr√°fico de biplot).\n2.1) Inserci√≥n de las variables al PCA\n2.1) PCA con escalamiento de las variables (similar a la matriz de correlaci√≥n)\n2.2) Figura del PCA\nLa Figura¬†4.1 muestra la ordenaci√≥n de las locaidades en las 7 bah√≠as evaluadas (gr√°fico de biplot).\n2.3) Circulo de contribuciones de las variables\nLa Figura¬†4.2 muestra el circulo de contribuciones para identificar a las variables con mayor aporte por cada componente principal del an√°lisis.\n2.4) Selecci√≥n de variables a partir del PCA\n3.1) Insumos del an√°lisis\n3.2) Autovalores\n3.3) Figura del PCA\nLa Figura¬†4.3 muestra dos opciones de visualizar los resultados del pca ‚Äúscaling 1‚Äù y ‚Äúscaling 2‚Äù.\n#‚Äî\n5.1) Figuras del pca por tipo de grupo\nLa Figura¬†5.2 muestra el agrupamiento por elipses en el pca.\nLa Figura¬†7.2 muestra el agrupamiento por l√≠neas en el pca.\nLa Figura¬†7.3 muestra el agrupamiento por triangulos en el pca."
  },
  {
    "objectID": "Taller4.1.pca.marino.html#ejemplo-de-bah√≠as-de-santa-marta",
    "href": "Taller4.1.pca.marino.html#ejemplo-de-bah√≠as-de-santa-marta",
    "title": "Taller4.1 PCA Bah√≠as",
    "section": "Ejemplo de bah√≠as de Santa Marta",
    "text": "Ejemplo de bah√≠as de Santa Marta\n\n\n\nEl siguiente ejemplo relaciona a 7 lugares en playas de de Santa Marta (observaciones) y en cada una de ellas se midieron 7 variables ambientales (descriptores). En este an√°lisis de comonentes principales - PCA, se intenta saber cu√°l es la relaci√≥n entre variables ambientales y c√≥mo estas estructuran o caracterizan a las localidades estudiadas. La base de datos a trabajar es FQmarino.csv.\nEjercicio tomado de: Rodr√≠guez-Barrios (2023) Enlace del libro\nEnlace de los archivos del libro\nFuentes bibliogr√°ficas sobre el an√°lisis de componentes principales:\n\nM√©todos de componentes principales en R - STHDA\nArt√≠culos - M√©todos de componentes principales - STHDA\nPCA en factoextra - datanovia\nGu√≠a pr√°ctica sonre el PCA - datanovia\nPCA para variables categ√≥ricas - R-bloggers\nCap√≠tulo PCA - Libro Numerical Ecology with R - Borcard et al.¬†2018\n\n\n# LIBRER√çAS REQUERIDAS\nlibrary(factoextra)   # Para el PCA\nlibrary(rlang)        # \nlibrary(FactoMineR)   # Para el PCA\nlibrary(vegan)        # Para el PCA\nlibrary(ade4)         # Para el PCA\nlibrary(corrplot)     # Figuras de elipses\nlibrary(ggplot2)      # Figuras de dispersi√≥n\n\n\n# Lectura de la base de datos \"FQmarino\"\ndatos <-read.csv2(\"FQmarino.csv\",row.names=1) # file.choose()\nView(datos)\nstr(datos)\n\n'data.frame':   7 obs. of  7 variables:\n $ pH        : num  8.42 8.49 8.51 8.56 8.61 ...\n $ Cond      : num  38 38.1 37.8 37.3 37.3 ...\n $ Turbidez  : num  1.364 0.545 1.273 1.273 0.636 ...\n $ Temp      : num  29.5 29.5 29.6 29.3 29.3 ...\n $ Salinidad : num  2.42 2.43 2.42 2.38 2.38 ...\n $ CapaFotica: num  19.7 22.1 22.1 10.8 9 ...\n $ Oxigeno   : num  0.097 0.147 0.331 0.17 0.098 0.098 0.098"
  },
  {
    "objectID": "Taller4.2.pca.tayrona.html",
    "href": "Taller4.2.pca.tayrona.html",
    "title": "Taller4.2 PCA PNNTayrona",
    "section": "",
    "text": "La Figura¬†1.1 muestra la relaci√≥n entre las variables, a partir de figuras de elipses.\nLa Figura¬†2.1 muestra la relaci√≥n entre las variables, con las transformaciones realizadas."
  },
  {
    "objectID": "Taller4.2.pca.tayrona.html#ejemplo-de-bah√≠as-de-santa-marta",
    "href": "Taller4.2.pca.tayrona.html#ejemplo-de-bah√≠as-de-santa-marta",
    "title": "Taller4.2 PCA PNNTayrona",
    "section": "Ejemplo de bah√≠as de Santa Marta",
    "text": "Ejemplo de bah√≠as de Santa Marta\n\n\n\nEl siguiente ejemplo tiene en cuenta a la propuesta de Legendre & Gallagher (2001), en el cual se realiza una linealizaci√≥n de datos de abundancias de taxones, mediante la transformaci√≥n de Hellinger, para poderlas ordenar en un PCA. Adicionalmente se incorporan las variables ambientales, con el objeto de analizar como estas caracterizan a las biol√≥gicas en gradientes espaciales y/o temporales. La base de datos que se utilizar√° es Tayrona.csv y el archivo de R es Tayrona.pca.r. Estos datos corresponden a un estudio realizado en el 2015, en el Parque Nacional Natural Tayrona (PNNT), valorando la fauna de invertebrados acu√°ticos y variables fisicoqu√≠micas asociadas en diferentes quebradas de ese lugar. Estos datos hacen parte del trabajo realizado por Bruges Emilio (2022).\nEjercicio tomado de: Rodr√≠guez-Barrios (2023) Enlace del libro\nEnlace de los archivos del libro\nFuentes bibliogr√°ficas sobre el an√°lisis de componentes principales:\n\nM√©todos de componentes principales en R - STHDA\nArt√≠culos - M√©todos de componentes principales - STHDA\nPCA en factoextra - datanovia\nGu√≠a pr√°ctica sonre el PCA - datanovia\nPCA para variables categ√≥ricas - R-bloggers\nCap√≠tulo PCA - Libro Numerical Ecology with R - Borcard et al.¬†2018\n\n\n# Librer√≠as requeridas\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(ggrepel)\nlibrary(vegan)\nlibrary(factoextra)\nlibrary(ggsci)\nlibrary(ggforce)\nlibrary(concaveman)\nlibrary(corrplot)\n\n\n# Lectura de la base de datos \"FQmarino\"\ndatos <-read.csv2(\"Tayrona.csv\",row.names=1) # file.choose()\nView(datos)\n# str(datos)"
  },
  {
    "objectID": "Taller4.2.pca.tayrona.html#taller-de-entrenamiento",
    "href": "Taller4.2.pca.tayrona.html#taller-de-entrenamiento",
    "title": "Taller4.2 PCA PNNTayrona",
    "section": "Taller de entrenamiento",
    "text": "Taller de entrenamiento\n\n\n\nObjetivo: Poner en pr√°ctica los conceptos vistos en este taller, realizando las siguientes opciones realizando un PCA que integgre a las variables biol√≥gicas (taxones) y a las ambiental√±es de la base seleccionada. Enviar los resultados al Teams del profesor."
  },
  {
    "objectID": "Taller6.2.cla.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "href": "Taller6.2.cla.peces.html#referencias-bibliogr√°ficas-de-apoyo.",
    "title": "Taller6.2 CLA Peces",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\nLibro: Repositorio de archivos y del ‚ÄúAn√°lisis de datos ecol√≥gicos y ambientales‚Äù - Rodr√≠guez-Barrios Javier (2022) Ver el cap√≠tulo de este libro Ejemplo 4. CL√öSTER PARA DATOS DE ABUNDANCIA en donde se detallan los procedimientos que pueden servir de apoyo al presente ejercicio."
  },
  {
    "objectID": "Taller6.2.cla.peces.html#referencias-bibliogr√°ficas-de-apoyo.-1",
    "href": "Taller6.2.cla.peces.html#referencias-bibliogr√°ficas-de-apoyo.-1",
    "title": "Taller6.2 CLA Peces",
    "section": "Referencias bibliogr√°ficas de apoyo.",
    "text": "Referencias bibliogr√°ficas de apoyo.\n\nMicroalgas de la CGSM - Vidal et al.¬†(2018). Implementaci√≥n de un cluster no jer√°rquico para valorar paleoambientes con microalgas de la Ci√©naga Grande de Santa Marta.\nCluster Brinda informaci√≥n complementaria para los diferentes pasos que requiere un an√°lisis de cl√∫ster.\nClustering y heatmaps Similar al anterior enlace, brinda informaci√≥n detallada sobre el an√°lisis de cl√∫ster.\nAn√°lisis de conglomerados Otro enlace con informaci√≥n general sobre los cl√∫ster.\nClustering y heatmaps: aprendizaje no supervisado Aplicaci√≥n de cl√∫ster en diferentes disciplinas.\nHierarchical Cluster Analysis Enlace en el que se encuentra informaci√≥n sobre cluster jer√°rquicos y t√©cnicas detalladas para seleccionar el n√∫mero de k - cl√∫ster o grupos formados.\nDetermining The Optimal Number Of Clusters Informaci√≥n relevante para el paso 3 de este ejercicio, relacionado a la definici√≥n de los k-cl√∫ster o el n√∫mero de grupos formados.\n\n\nCl√∫ster no Jer√°rquicos\n\n\nK-means Cluster Analysis Brinda informaci√≥n sobre la construcci√≥n de cl√∫ster no jer√°rquicos.\n\n\nOtros\n\n\nIntroduction to dendextend El paquete dendextend brinda opciones para comparar y visualizar dendogramas. Esto complementa al paso 3 del presente ejercicio, relacionado a la definici√≥n de los k-cl√∫ster formados.\nHierarchical Clustering on Principal Components Articulaci√≥n de los cl√∫ster en los an√°lisis de componentes principales.\n\n\nCargar las librer√≠as requeridas\n\n\n# Librer√≠as requeridas\nlibrary(ellipse)\nrequire(gclus)\nrequire(SciViews)\nrequire(ade4)\nrequire(vegan)\nlibrary(corrplot)\nlibrary(ggplot2)\nlibrary(pheatmap)\nlibrary(\"gplots\")\nlibrary(gridExtra)\nlibrary(factoextra)\nlibrary(reshape)\n\n\n\n\nCargar o importar la base de datos\n\n\n\nLa presente base de datos se encuentra en formato plano de csv, presenta una columna Especie que agrupa a las 5 especies de peces, otra columna Grupo, que asigna un n√∫mero a cada especie y posteriormente a las 19 variables morfom√©tricas y 10 variables meristicas, de las cuales se selecionar√°n las 19 morfom√©tricas para este ejercicio M.1 a M.19.\n\n# Base de datos\npeces<-read.csv2(\"datos.csv\",row.names=1)  \n\n\n\n\nExploraci√≥n de los datos\n\n\n\nPara este ejemplo se urtilizar√°n figuras que relacionan parejas de variables y figuras de cajas que permitan visualizar diferencias entre las especies de peces de acuerdo a su morfometr√≠a. *Para facilidad del ejercicio se seleccionar√°n algunas variables morfom√©tricas - peces1, debido a que son las que presentan mejores patrones lineales.\n\n# Elipses con colores con variables morfom√©tricas\npeces1 <- peces[,c(3:9,15,17,20)]\nM <- cor(peces1)            # Matriz de Correlaci√≥n (M)\n\nLa Figura¬†1.1 permite visualizar las relaciones lineales entre todas las parejas de variables, incluyendo a los coeficientes de correlaci√≥n de Pearson.\n\ncorrplot(M,  method = \"circle\",            # Correlaciones con circulos\n         type = \"lower\", insig=\"blank\",    # Forma del panel\n         order = \"AOE\", diag = FALSE,      # Ordenar por nivel de correlaci√≥n\n         addCoef.col =\"black\",             # Color de los coeficientes\n         number.cex = 0.6,                 # Tama√±o del texto\n         col = COL2(\"RdYlBu\", 200))        # Transparencia de los circulos\n\n\n\n\nFigura¬†1.1: Correlaciones y coeficientes de correlaci√≥n.\n\n\n\n\nLa Figura¬†1.2 a diferencia de la anterior, clasifica a los grupos por colores y adem√°s incluye a sus coeficientes de correlaci√≥n y el patr√≥n de distribuci√≥n de cada variable mediante histogramas de densidad.\n\npeces1 <- peces[,c(3:9,15,17,20)]\npeces$Especie <- as.factor(peces$Especie)\n\npairs ((peces1),panel=function(x,y)\n{abline(lsfit(x,y)$coef,lwd=2,col=3)\n  lines(lowess(x,y),lty=2,lwd=2,col=2)\n  points(x,y,col=peces$Especie, cex=1.4,pch=19,lwd=0.6)})\n\n\n\n\nFigura¬†1.2: Relaci√≥n entre parejas de variables, por cada grupo en comparaci√≥n (colores).\n\n\n\n\n\n\nLa Figura¬†2.2 permite visualizar la resoluci√≥n de cada variable para diferenciar o discriminar a las diferentes especies de peces. Esta figura sirve de insumo para descartar aquellas variables con poco potencial de discriminaci√≥n de las especies.\n\n# Figuras multivariadas de Cajas y bigotes\nlibrary(reshape)\n\nggplot(melt(peces[,c(1,3:9,15,17,20)]), aes(x=variable, y=value)) + \n  geom_boxplot(aes(fill=Especie)) + \n  scale_fill_manual(values = c('#fc8d59','#ffffbf','#99d594','#377eb8','#33a02c')) +\n  labs(x=\"\",y=\"Morfometr√≠a\") + \n  facet_wrap(~ variable,scales=\"free\") + \n  theme_bw()\n\n\n\n\nFigura¬†1.3: Variaci√≥n en la morfometr√≠a de los peces, de acuerdo a cada una de las variables seleccionadas."
  },
  {
    "objectID": "Taller6.2.cla.peces.html#paso-1.-distancia-entre-observaciones",
    "href": "Taller6.2.cla.peces.html#paso-1.-distancia-entre-observaciones",
    "title": "Taller6.2 CLA Peces",
    "section": "PASO 1. Distancia entre observaciones",
    "text": "PASO 1. Distancia entre observaciones\n\nSon muchas las distancias que pueden emplearse, pero cada una se ajusta al tipo de datos que se requieran trabajar. Para este caso se usar√° la distancia eucl√≠dea, debido a que se ajusta de manera apropiada a datos ambientales, incorporando adem√°s al comando scale, debido a que permite estandarizar a este tipo de variables que presentan escalas dis√≠miles.\n\n# Matriz de distancia\nd.euclid <- dist(peces[,c(3:21)])\n# round(d.euclid,1)"
  },
  {
    "objectID": "Taller6.2.cla.peces.html#paso-2.-elecci√≥n-del-m√©todo-de-agrupaci√≥n-de-mayor-ajuste",
    "href": "Taller6.2.cla.peces.html#paso-2.-elecci√≥n-del-m√©todo-de-agrupaci√≥n-de-mayor-ajuste",
    "title": "Taller6.2 CLA Peces",
    "section": "PASO 2. Elecci√≥n del m√©todo de agrupaci√≥n de mayor ajuste",
    "text": "PASO 2. Elecci√≥n del m√©todo de agrupaci√≥n de mayor ajuste\n\n\n\nSon siete las opciones de dendogramas, de las cuales solo una ser√° la que mejor se ajusta a los datos trabajados. Para ello, primero se realizar√°n los dendogramas y posteriormente se escoger√° l de mejor ajuste con la correlaci√≥n cofen√©tica.\n\n\n2.1 Siete m√©todos de agrupamiento\n\n\n# M√©todo 1. Vecino m√°s cercano \"Cl.single\", funci√≥n \"hclust\" y m√©todo \"single\"\nCl.single <- hclust(d.euclid,method=\"single\")\n\n\n# M√©todo 2. Vecino m√°s lejano \"Cl.complete\", funci√≥n \"complete\"  \nCl.complete<-hclust(d.euclid,method=\"complete\")\n\n\n# M√©todo 3. UPGMA funci√≥n \"average\" Uni√≥n Promedio no Ponderado\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n# M√©todo 4. UPGMC funci√≥n \"mcquitty\" Uni√≥n Promedio Ponderado\nCl.upgmc<-hclust(d.euclid,method=\"mcquitty\")\n\n\n# M√©todo 5. WPGMA funci√≥n \"centroid\"\nCl.wpgma<-hclust(d.euclid,method=\"centroid\")\n\n\n# M√©todo 6. WPGMC funci√≥n \"median\"\nCl.wpgmc<-hclust(d.euclid,method=\"median\")\n\n\n# M√©todo 7. WARD, funci√≥n \"ward\"\nCl.ward<-hclust(d.euclid,method=\"ward.D\")\n\n\n\n\n2.2 Figuras de los dendogramas con los siete m√©todos de agrupamiento\n\n\n\nA continuaci√≥n se realizar√° un panel que contenga hasta 4 figuras de dendogramas (Figura¬†1.4, Figura¬†1.5), lo cual permite resumir al n√∫mero de gr√°ficas generadas, el comando que se emplear√° para incluir a varias figuras en un mismo panel grafico es grid.arrange() del paquete gridextra.\n\nf1 <- fviz_dend(Cl.single, k = 5,        # k grupos (opcionales)\n          cex = 0.7,               # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Vecino m√°s Cercano - Single\")  # Rotulo de t√≠tulo\n\nf2 <- fviz_dend(Cl.complete, k = 5,        # k grupos (opcionales)\n          cex = 0.7,               # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Vecino m√°s Lejano - Complete\")  # Rotulo de t√≠tulo\n\n\nf3 <- fviz_dend(Cl.upgma, k = 5,           # k grupos (opcionales)\n          cex = 0.7,                 # tama√±o del texto de las ramas\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Uni√≥n Promedio no Ponderado - upgmc\")  # Rotulo de t√≠tulo\n\n\nf4 <- fviz_dend(Cl.upgmc, k = 5,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Promedio Ponderado - upgmc\") \n\n\ngrid.arrange(f1,f2,f3,f4, ncol = 2)\n\n\n\n\nFigura¬†2.1: Cuatro dendogramas jer√°rquicos con la distancia eucl√≠dea.\n\n\n\n\n\nf5 <- fviz_dend(Cl.wpgma, k = 5,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Centroide no Ponderado - wpgma\") \n\nf6 <- fviz_dend(Cl.wpgmc, k = 5,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"Uni√≥n Centroide Ponderado - wpgmc\") \n\nf7 <- fviz_dend(Cl.ward, k = 5,          \n          cex = 0.7,                 \n          ylab = \"Distancia Eucl√≠dea\",  \n          main = \"M√©todo de Ward\") \n\ngrid.arrange(f5,f6,f7, ncol = 2)\n\n\n\n\nFigura¬†2.2: Tres dendogramas jer√°rquicos restantes, con la distancia eucl√≠dea.\n\n\n\n\n\n\n\n2.3 Selecci√≥n del mejor m√©todo de agrupamiento - Correlaci√≥n Cofen√©tica\n\n2.3.1 C√°lculo de las correlaciones cofen√©ticas\n\n\n\n\nEl m√©todo que presente la mayor correlaci√≥n cofen√©tica ser√° el seleccionado. Para este caso se escoger√° el dendograma con el m√©todo upgma, el cu√°l presenta un cofen√©tico de 0.8494.\n\n# (1) Correlaci√≥n cofenpetica  para \"single\"\ncofenet1 <- cophenetic(Cl.single)\nsimple = cor(d.euclid,cofenet1)\nsimple\n\n[1] 0.8226571\n\n# (2) Correlaci√≥n cofen√©tica  para \"complete\"\ncofenet2<-cophenetic(Cl.complete)\ncompl = cor(d.euclid,cofenet2)\ncompl\n\n[1] 0.7754882\n\n# (3) Correlaci√≥n cofen√©tica  para \"average\"\ncofenet3<-cophenetic(Cl.upgma)\nupgma = cor(d.euclid,cofenet3)\nupgma\n\n[1] 0.8494435\n\n# (4) CCorrelaci√≥n cofen√©tica  para \"mcquitty\"\ncofenet4<-cophenetic(Cl.upgmc)\nupgmc = cor(d.euclid,cofenet4)\nupgmc\n\n[1] 0.8009618\n\n# (5) Correlaci√≥n cofen√©tica  para \"centroid\"\ncofenet5<-cophenetic(Cl.wpgma)\nwpgma = cor(d.euclid,cofenet5)\nwpgma\n\n[1] 0.6888659\n\n# (6) Correlaci√≥n cofen√©tica  para \"median\"\ncofenet6<-cophenetic(Cl.wpgmc)\nwpgmc = cor(d.euclid,cofenet6)\nwpgmc\n\n[1] 0.7997027\n\n# (7) Correlaci√≥n cofen√©tica  para \"ward\"\ncofenet7<-cophenetic(Cl.ward)\nward = cor(d.euclid,cofenet7)\nward\n\n[1] 0.618674\n\n\n\n\n2.3.2 Tabulaci√≥n de las correlaciones cofen√©ticas\n\n\nLos siguientes comandos permitir√°n organizar a los siete m√©todos de agrupamiento, de acuerdo a su nivel de correlaci√≥n cofen√©tica.\n\n# data frame con cofen√©ticos\ncofeneticos = data.frame(simple,compl,upgma,upgmc,\n                         wpgma,wpgmc,ward)\n\n# cofen√©ticos por cada m√©todos (Met)\ncofenet=data.frame(Met = 1:7,Cofen=t(round(cofeneticos,3)))\n\n# tabla con orden descendente de cofen√©ticos\ncof_ordenado = cofenet[order(cofenet$Cofen, decreasing = TRUE), ]\ncof_ordenado\n\n       Met Cofen\nupgma    3 0.849\nsimple   1 0.823\nupgmc    4 0.801\nwpgmc    6 0.800\ncompl    2 0.775\nwpgma    5 0.689\nward     7 0.619\n\n\nCon este comando se puede exportar la tabla de cofen√©ticos como un archivo plano de csv.\n\n# guardar tabla como csv\n# write.csv2(cof_ordenado,\"cofenet.csv\")\n\n\n\n2.3.3 Figuras de algunas correlaciones cofen√©ticas vs.¬†matriz de distancia\n\n\n\n\nA continuaci√≥n se presenta una muestra de la relaci√≥n entre las matrices de distancia cofen√©tica y de distancia eucl√≠nea, que permiti√≥ seleccionar al mejor m√©todo de agrupamiento (Figura¬†2.1).\n\n# convertir matricesde distancia a vectores\nd.euclid <- as.vector(d.euclid)\nd.cofenet1 <- as.vector(cofenet1)\nd.cofenet2 <- as.vector(cofenet2)\nd.cofenet3 <- as.vector(cofenet3)\nd.cofenet4 <- as.vector(cofenet4)\n\n\n# crear un data frame con los vectores y agregar una columna de etiquetas\nsimple1 <- data.frame(d.euclid, d.cofenet1, d.cofenet2, d.cofenet3, d.cofenet4)\nhead(simple1)\n\n   d.euclid d.cofenet1 d.cofenet2 d.cofenet3 d.cofenet4\n1 0.5737595   0.349285  0.6743145  0.5756145  0.5788911\n2 0.5601785   0.349285  0.6743145  0.5756145  0.5788911\n3 0.6151423   0.349285  0.6743145  0.5756145  0.5788911\n4 0.5746303   0.349285  0.6743145  0.5756145  0.5788911\n5 0.5673623   0.349285  0.6743145  0.5756145  0.5788911\n6 0.5413871   0.349285  0.6743145  0.5756145  0.5788911\n\n\n\n# Figuras correlaciones cofen√©ticas\n# (1) distancia cofen√©tica  para \"uni√≥n simple\" \nf1<-ggplot(simple1, aes(d.euclid,d.cofenet1))+\n  geom_point(size=1.5, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n Simple\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet1),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n# (2) distancia cofen√©tica  para \"uni√≥n completa\" \nf2<-ggplot(simple1, aes(d.euclid,d.cofenet2))+\n  geom_point(size=1.5, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n Completa\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet2),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n# (3) distancia cofen√©tica  para \"uni√≥n upgma\" \nf3<-ggplot(simple1, aes(d.euclid,d.cofenet3))+\n  geom_point(size=1.5, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n promedio no ponderado - upgma\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet3),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\n\n# (4) distancia cofen√©tica  para \"uni√≥n upgmc\" \nf4<-ggplot(simple1, aes(d.euclid,d.cofenet4))+\n  geom_point(size=1.5, color=\"#4daf4a\") + \n  geom_smooth(method=\"lm\",se=FALSE,color=\"#377eb8\") +\n  geom_smooth(method=\"loess\",se=FALSE,color =\"#e41a1c\",lty=2,size=1.3) +\n  labs(title= \"Uni√≥n promedio ponderado - upgmc\",\n       subtitle= paste(\"Correlaci√≥n cofen√©tica\",\n                 round(cor(d.euclid,cofenet4),4)),\n       x=\"Distancia Euclidea\",\n       y=\"Distancia cofen√©tica\") +\n  theme_bw()\n\ngrid.arrange(f1,f2,f3,f4, ncol = 2)\n\n\n\n\nFigura¬†2.3: Cuatro regresiones entre la distancia eucl√≠dea empleada y las distancias cofen√©ticas de cada m√©todo de agrupamiento definido."
  },
  {
    "objectID": "Taller6.2.cla.peces.html#paso-3.-n√∫mero-de-grupos-formados",
    "href": "Taller6.2.cla.peces.html#paso-3.-n√∫mero-de-grupos-formados",
    "title": "Taller6.2 CLA Peces",
    "section": "PASO 3. N√∫mero de grupos formados",
    "text": "PASO 3. N√∫mero de grupos formados\n\n\n\nLa definici√≥n de los grupos formados, representan un insumo importante de informaci√≥n, debido a que permiten generar los k cluster en los que se agrupan las observaciones, basado en las variables que las caracterizan. Este insumo es relevante adem√°s, como paso previo a otras t√©cnicas que requieren los grupos definidos a priori, como los an√°lisis discriminantes lineales (lda) o los an√°lisis de varianza multivariados (manovas), de igual forma, a partir de los grupos se pueden responder hip√≥tesis enfocadas en las variaciones que pueden presentar las variables a lo largo de gradientes discretos o en cluster.\n\n\nOpci√≥n 1. Niveles de Fusi√≥n.\n\nLa figura de niveles de fusi√≥n es una de las m√°s utilizadas para la generaci√≥n de grupos o de cluster, debido a la sencillez del componente gr√°fico, en el cual se definen los cluster o grupos (eje Y), dependiendo del escal√≥n de mayor amplitud o distancia horizontal (eje X). En la Figura¬†2.2 se observa que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma seleccionado en el paso anterior se puede clasificar en dos grupos de observaciones.\n\n# Base de variables a relacionar (amb)\namb <- peces[,c(3:9,15,17,20)]\n\n\n# Crear un data.frame con los datos de altura, k y n√∫mero de cluster\nf1 <- data.frame(h = Cl.upgma$height, k = nrow(amb):2, cluster = nrow(amb):2)\n\n\n# Crear el gr√°fico de dispersi√≥n y agregar etiquetas de texto\nggplot(f1, aes(x = h, y = k, label = cluster)) +\n  geom_point(color = \"grey\") +\n  geom_text(color = \"red\", size = 3, vjust = -0.5) +\n  geom_step(color = \"grey\", direction = \"vh\") +\n\n# Personalizar el gr√°fico con t√≠tulos, etiquetas de ejes y paleta de colores\n  ggtitle(\"Niveles de Fusi√≥n - Distancia Eucl√≠dea - UPGMA\") +\n  ylab(\"k (N√∫mero de Cluster)\") +\n  xlab(\"h (Altura del Nodo)\") +\n  scale_color_manual(values = c(\"grey\", \"red\")) +\n  theme(axis.title = element_text(size = 16)) +\n  theme_classic()\n\n\n\n\nFigura¬†2.4: Cuatro regresiones entre la distancia eucl√≠dea empleada y las distancias cofen√©ticas de cada m√©todo de agrupamiento definido.\n\n\n\n\n\n\n\nOpci√≥n 2. N√∫mero optimo de clusters de acuerdo al Ancho de silueta. √çndice de calidad de Rousseeuw\n\nLa amplitud de silueta es de las opciones m√°s usadas para definir al n√∫mero de k cluster o grupos del dendograma realizado. En este ejercicio tambi√©n se define a dos grupos. En caso que los resultados de esta t√©cnica sean diferentes a la anterior, se suele decidir por esta, debido a su mayor grado de precisi√≥n.\n\n# Base de datos (amb)\namb <- peces[,c(3:9,15,17,20)]\n# Distancia utilizada (d.euclid)\nd.euclid <- dist(peces[,c(3:21)])\n# M√©todo de agrupamiento seleccionado (cl.upgma)\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n# 1. Crear un vector vac√≠o (amb.vacio) con asw valores\namb.vacio <- numeric(nrow(amb))\n\n# 2. Silueta \"sil\" \nfor(k in 2: (nrow(amb)-1)){\n    sil <- silhouette(cutree(Cl.upgma,k=k),d.euclid)\n    amb.vacio[k]<-summary(sil)$avg.width} \n\n# 3. Mejor o mayor amplitud de silueta (2 particiones)\nk.mejor <- which.max(amb.vacio)\nk.mejor \n\n[1] 3\n\n\n\n# Grafica de silueta\nplot(1:nrow(amb),amb.vacio,type=\"h\",\n     main=\"Silueta-N√∫mero √ìptimo de Clusters\", xlab=\"(N√∫mero de grupos)\",\n     ylab=\"Amplitud promedio de  silueta\")\n     \naxis(1,k.mejor,paste(\"optimum\",k.mejor,sep=\"\\n\"),col=\"red\",\n     font=2,col.axis=\"red\")\n     \npoints(k.mejor,max(amb.vacio),pch=16,col=\"red\",cex=1.5)\n\n\n\ncat(\"\",\"Silueta-N√∫mero √≥ptimo de Clusters k=\",k.mejor,\n    \"\\n\",\"Con una aplitud promedio de silueta\",max(amb.vacio),\"\\n\")\n\n Silueta-N√∫mero √≥ptimo de Clusters k= 3 \n Con una aplitud promedio de silueta 0.3662872 \n\n\n\n\n\n3.1 Figura del dendograma jer√°rquico final\n\n\n\nLa Figura¬†2.5 muestra la manera en la que se organizan las observaciones en los dos grupos formados (ramas rojas y azules) devido a la naturaleza de las variables morfom√©tricas que las caracterizar.\n\n# Dendograma final \nfviz_dend(Cl.upgma, k = 3,        # k grupos\n          cex = 0.6,              # tama√±o del texto de las observaciones\n          ylab = \"Distancia Eucl√≠dea\",  # Rotulo de la distancia\n          main = \"Uni√≥n Promedio no Ponderada (UPGMA)\", # Rotulo de t√≠tulo\n          lower_rect = 0,           # Inicio de los rect√°ngulos en cero\n          k_colors = c(\"#00AFBB\",\"#FC4E07\"),\n          color_labels_by_k = TRUE,    # Colores para cada grupo\n          rect = TRUE)                 # Rect√°ngulos de cada grupo\n\n\n\n\nFigura¬†2.5: Dendograma jer√°rquico final con los dos grupos asignados.\n\n\n\n\n\n\nVale la pena mencionar que estos an√°lisis son importantes cuando se cuenta con pocas observaciones (ramas del dendograma), en el caso contrario, es preferible utilizar dendogramas no jerarquicos como el k-meas, el cual fue descrito en uno de los complementos del PCA y se retoma a continuaci√≥n.\n\n\n\n3.2 Figura del dendograma no jer√°rquico final\n\n\n\nAgrupamiento elegido en el paso 2 (upgma)\n\n\n\n# Matriz de distancia\nd.euclid <- dist(peces[,c(3:21)])\n\n# M√©todo 3. UPGMA funci√≥n \"average\" Uni√≥n Promedio no Ponderado\nCl.upgma<-hclust(d.euclid,method=\"average\")\n\n\n\nGeneraci√≥n de la variable agrupadora (gr)\n\n\n\n# Variable agrupadora con k=3 cl√∫ster\ngrp <- cutree(Cl.upgma, k = 3)    # Grupos generados \"grp\"  \ngrl <- levels(factor(grp))        # Rotulos de los grupos formados\n\nEste es un paso opcional en caso que se requiera insertar la nueva variable agrupadora a la base de datos en revisi√≥n.\n\n# Incluir la variable agrupadora en la base de datos\npeces.1=data.frame(grp,peces)       # Nuevo dataframe con la variable agrupadora (gr)\nhead (peces.1[,1:8])  # Visualizaci√≥n de las 5 primeras variables morfom√©tricas\n\n  grp  Especie Grupo  M.1  M.2  M.3  M.4  M.5\n1   1 P. chola     1 0.36 0.87 0.25 0.29 0.10\n2   2 P. chola     1 0.39 0.88 0.27 0.26 0.11\n3   2 P. chola     1 0.36 0.87 0.25 0.28 0.10\n4   2 P. chola     1 0.38 0.89 0.27 0.32 0.14\n5   2 P. chola     1 0.39 0.88 0.27 0.31 0.12\n6   2 P. chola     1 0.40 0.93 0.29 0.32 0.12\n\n\n\n\nGeneraci√≥n del cl√∫ster No Jer√°rquico (K-Means)\n\n\nLa Figura¬†2.6 es la forma no jer√°rquica de presentar los resultados del cluster definido por el m√©todo de agrupamiento upgma.\n\nfviz_cluster(list(data = amb, cluster = grp),\n             palette = c('#fc8d59','#377eb8','#99d594'),  # Colores para cada grupo\n             ellipse.type = \"confidence\",        # Elipses\n             repel = TRUE,                 # Elimina solapamiento de observaciones\n             show.clust.cent = FALSE,      # Muestra a los cl√∫ster centrados\n             ggtheme = theme_bw())     # Tipo de fondo tomado de ggplot2\n\n\n\n\nFigura¬†2.6: Dendograma no jer√°rquico final con los tres grupos asignados.\n\n\n\n\n\n\nUna pregunta interesante que se podr√≠a resolver, ser√≠a valorar si las diferencias entre los dos grupos de observaciones formadas es estad√≠sticamente significativa, para lo cual se debe aplicar un an√°lisis de varianza multivariado (manova)."
  },
  {
    "objectID": "Taller6.2.cla.peces.html#paso-4.-variables-de-mayor-contrinuci√≥n-a-la-clasificaci√≥n",
    "href": "Taller6.2.cla.peces.html#paso-4.-variables-de-mayor-contrinuci√≥n-a-la-clasificaci√≥n",
    "title": "Taller6.2 CLA Peces",
    "section": "Paso 4. Variables de mayor contrinuci√≥n a la clasificaci√≥n",
    "text": "Paso 4. Variables de mayor contrinuci√≥n a la clasificaci√≥n\n\nA continuaci√≥n se realizan diferentes opciones de mapas de calor (Figura¬†2.7, Figura¬†2.8), para identifiar a las variables con mayor relevancia en la clasificaci√≥n realizada anteriormente en el dendograma seleccionado. Este paso es relevante cuando se quiere ponderar o seleecionar a las variables que aportan al an√°lisis, resumiento de esta forma, la dimensionalidad del problema (n√∫mero de variables).\n\namb1 <- as.matrix(amb)\n\n\n# Opci√≥n 1. Mapa de calor con paquete \"stats\"\nhv <- heatmap(amb1, margins=c(7,6), \n              distfun = dist,\n              xlab =\"Variables Morfom√©tricas\",\n              ylab= \"Peces\", \n              main = \"Clasificaci√≥n de Peces\",\n              scale = \"row\")   # Estandariza variables diferentes.\n\n\n\n\nFigura¬†2.7: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificaci√≥n realizada.\n\n\n\n\nEl siguiente mapa de calor (Figura¬†2.8) incorpora a la distancia eucl√≠dea utilizada y el m√©todo de agrupamiento seleccionado (upgma).\n\n# Opci√≥n 2. Mapa de calor con paquete \"stats\"\nhclust.fq <- function(amb1) hclust(amb1, method=\"average\")   # Inserci√≥n de agrupaci√≥n UPGMA\n\nheatmap.2(amb1,               # Base de datos en formato matricial\n          margins=c(7,7),     # Margenes de la figura\n          scale = \"row\",      # Estandariza variables diferentes.\n          col = bluered(100),                 # Colores del mapa de calor\n          xlab =\"Variables Morfom√©tricas\",\n          ylab= \"Peces\", \n          main = \"Clasificaci√≥n de Peces\",\n          trace = \"none\", \n          density.info = \"none\",\n          distfun = dist,          # Se puede usar vegdist de \"vegan\" \n          hclustfun=hclust.fq)     # Agrupamiento UPGMA\n\n\n\n\nFigura¬†2.8: Mapa de calor que define en color rojo a las variables de mayor aporte a la clasificaci√≥n realizada.\n\n\n\n\n\n\nEl siguiente mapa de calor (Figura¬†2.5) permite visualizar a la resoluci√≥n de las variables morfom√©tricas para diferenciar a los grupos de especies, las cuales representan a los grupos en comparaci√≥n. Con los siguientes comandos se calcular√° una tabla que resume a los promedios de las 7 variables ambientales para cada grupo evaluado.\n\n# Extracci√≥n de los promedios de las variables para cada sitio\nlibrary(tidyverse)\npromedios <- peces %>%      \n  subset(select = c(\"Especie\",\"M.1\",\"M.2\",\"M.3\",\"M.4\",\"M.5\",\"M.6\",\"M.7\",\"M.8\",\"M.9\",\"M.10\",\"M.11\",\"M.12\", \n         \"M.13\",\"M.14\",\"M.15\",\"M.16\",\"M.17\",\"M.18\",\"M.19\")) %>%\n  na.omit() %>%\n  group_by(Especie) %>%\n  summarize(across(everything(), mean))\n  \npromedios  <- data.frame(promedios) # Guardar promedios como dataframe\n# promedios\n\nA continuaci√≥n se comvierte el dataframe a formato matricial - promedios2, para poder ser graficado en el mapa de calor.\n\n# Seleccionar columnas de 2 a 10 del data frame peces1 y convertirlas en matriz\npromedios2 <- promedios %>% \n              subset(select = c(2:19)) %>% \n              as.matrix()\nround(promedios2[,1:10],2) # Visualizaci√≥n de las 10 primeras variables\n\n   M.1  M.2  M.3  M.4  M.5  M.6  M.7  M.8  M.9 M.10\n1 0.38 0.87 0.27 0.30 0.11 0.12 0.69 0.65 0.72 0.78\n2 0.32 0.76 0.25 0.25 0.11 0.13 0.66 0.71 0.72 0.85\n3 0.36 0.85 0.26 0.29 0.11 0.13 0.68 0.63 0.72 0.84\n4 0.37 0.90 0.26 0.28 0.13 0.15 0.70 0.72 0.70 0.84\n5 0.48 0.76 0.28 0.31 0.13 0.16 0.88 0.63 0.77 0.84\n\n\nAhora se incluyen los nombres de los grupos (S1 y S2) a la matriz promedios2.\n\n# Asignar los valores de la primera columna de peces1 como nombres de fila en la matriz peces2\nrownames(promedios2) <- promedios[,1]\n\nLa Figura¬†2.9 permite visualizar a las variables que mejor discriminan a los grupos de especies (variables de tonalidad rojiza).\n\n# Figura del primer mapa de calor\nhv <- heatmap(promedios2, \n              margins = c(5,12), \n              distfun = dist,\n              xlab =\"Variables Morfom√©tricas\", \n              ylab= \"Grupos de especies de peces\", \n              main = \"Clasificaci√≥n de Peces\") \n\n\n\n\nFigura¬†2.9: Mapa de calor que relaciona a las variables morfom√©tricas y a los grupos de cada especie.\n\n\n\n\nLa Figura¬†2.10 incorpora elementos adicionales como al m√©todo de agrupamiento upgma, asumiendo que puede ser el que mejor se ajusta a los datos de este ejercicio.\n\n# Opci√≥n 2. Mapa de calor con paquete \"stats\"\nhclust.fq <- function(promedios2) \n             hclust(promedios2, method=\"average\")   # Inserci√≥n de UPGMA\n\n\nlibrary(\"gplots\")\nheatmap.2(promedios2,         # Base de datos en formato matricial\n          margins=c(5,12),    # Margenes de la figura\n          scale = \"row\",      # Estandariza variables diferentes.\n          col = bluered(100),                 # Colores del mapa de calor\n          xlab =\"Variables morfom√©tricas\", \n          ylab= \"Grupos de Especies\", \n          main = \"Clasificaci√≥n de Peces\",   \n          trace = \"none\", \n          density.info = \"none\",\n          distfun = dist,          # Se puede usar vegdist de \"vegan\" \n          hclustfun=hclust.fq)     # Agrupamiento UPGMA\n\n\n\n\nFigura¬†2.10: Mapa de calor que relaciona a las variables morfom√©tricas y a los grupos de especies."
  },
  {
    "objectID": "Anexos.html#bases-de-datos-requeridas-en-algunos-talleres",
    "href": "Anexos.html#bases-de-datos-requeridas-en-algunos-talleres",
    "title": "Anexos",
    "section": "Bases de datos requeridas en algunos talleres",
    "text": "Bases de datos requeridas en algunos talleres\n\nNota: Para descargar estos archivos hay que hacer clic derecho sobre este y Guardar enlace como"
  },
  {
    "objectID": "Anexos.html#section-1",
    "href": "Anexos.html#section-1",
    "title": "Anexos",
    "section": "",
    "text": "Nota: Para descargar estos archivos hay que hacer clic derecho sobre este y Guardar enlace como"
  },
  {
    "objectID": "Anexos.html#taller-2-introducci√≥n-al-rstudio-y-a-matrices-en-rstudio",
    "href": "Anexos.html#taller-2-introducci√≥n-al-rstudio-y-a-matrices-en-rstudio",
    "title": "Anexos",
    "section": "Taller 2 Introducci√≥n al RStudio y a Matrices en RStudio",
    "text": "Taller 2 Introducci√≥n al RStudio y a Matrices en RStudio\n\n\n(datos1.csv) Base de datos con informaci√≥n de 4 variables morfom√©tricas de estudiantes de Unimagdalena."
  },
  {
    "objectID": "Anexos.html#taller-3.-figuras-exploratorias",
    "href": "Anexos.html#taller-3.-figuras-exploratorias",
    "title": "Anexos",
    "section": "Taller 3. Figuras Exploratorias",
    "text": "Taller 3. Figuras Exploratorias\n\n\n(Insectos.xlsx) Base de datos con con informaci√≥n de dos variables ambientales y con √≥rdenes de insectos en diferentes quebradas y en dos cuencas.\n(Insectos.csv) Base de datos similar a la anterior pero en formato csv.\n(Insectos2.csv) Base de datos con informaci√≥n de Abundancia (Ab) y de Biomasa (Biom) de invertebrados, por sitios,por muestreos, Por grupos funcionales (GF) y por periodos clim√°ticos."
  },
  {
    "objectID": "Anexos.html#taller-4.-an√°lisis-de-componentes-principales---pca",
    "href": "Anexos.html#taller-4.-an√°lisis-de-componentes-principales---pca",
    "title": "Anexos",
    "section": "Taller 4. An√°lisis de Componentes Principales - PCA",
    "text": "Taller 4. An√°lisis de Componentes Principales - PCA\n\n\n(FQmarino.csv) Base de datos con informaci√≥n de 7 variables ambientales y 7 bah√≠as de Santa Marta.\n(Tayrona.csv) Base de datos con informaci√≥n de diferentes taxones de invertebrados y de variables ambientales."
  },
  {
    "objectID": "Anexos.html#taller-5.-an√°lisis-de-escalamiento-multidimensional---nmds",
    "href": "Anexos.html#taller-5.-an√°lisis-de-escalamiento-multidimensional---nmds",
    "title": "Anexos",
    "section": "Taller 5. An√°lisis de Escalamiento Multidimensional - NMDS",
    "text": "Taller 5. An√°lisis de Escalamiento Multidimensional - NMDS\n\n\n(malezas.csv) Base de datos con informaci√≥n de taxones de malezas en diferentes lugares del Magdalena."
  },
  {
    "objectID": "Anexos.html#taller-6.-an√°lisis-de-cl√∫ster---cla",
    "href": "Anexos.html#taller-6.-an√°lisis-de-cl√∫ster---cla",
    "title": "Anexos",
    "section": "Taller 6. An√°lisis de Cl√∫ster - CLA",
    "text": "Taller 6. An√°lisis de Cl√∫ster - CLA\n\n\n(FQmarino1.csv) Base de datos con informaci√≥n de 7 variables ambientales y 7 bah√≠as de Santa Marta.\n(datos.csv) Base de datos con informaci√≥n morfom√©trica de individuos pertenecientes a 5 especies de peces de la India."
  },
  {
    "objectID": "Anexos.html#taller-6.-an√°lisis-discrimianante--lda-manovas-y-permanovas",
    "href": "Anexos.html#taller-6.-an√°lisis-discrimianante--lda-manovas-y-permanovas",
    "title": "Anexos",
    "section": "Taller 6. An√°lisis Discrimianante -LDA, Manovas y Permanovas",
    "text": "Taller 6. An√°lisis Discrimianante -LDA, Manovas y Permanovas\n\n\n(datos.csv) Base de datos identica a la anterios del CLA, con informaci√≥n morfom√©trica de individuos pertenecientes a 5 especies de peces de la India."
  },
  {
    "objectID": "Anexos.html#tallerers-7-al-9.-an√°lisis-discrimianante--lda-manovas-y-permanovas",
    "href": "Anexos.html#tallerers-7-al-9.-an√°lisis-discrimianante--lda-manovas-y-permanovas",
    "title": "Anexos",
    "section": "Tallerers 7 al 9. An√°lisis Discrimianante -LDA, Manovas y Permanovas",
    "text": "Tallerers 7 al 9. An√°lisis Discrimianante -LDA, Manovas y Permanovas\n\n\n(peces.csv) Base de datos identica a la anterios del CLA, con informaci√≥n morfom√©trica de individuos pertenecientes a 5 especies de peces de la India."
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#objetivo-de-la-actividad",
    "href": "Taller2.2.Introd.matrices.html#objetivo-de-la-actividad",
    "title": "Taller2.2 Intro_Matrices",
    "section": "Objetivo de la actividad",
    "text": "Objetivo de la actividad\n\n\n\n\nIm√°gen tomada de wittayayut\n\n\n\n\nEl presente taller tiene como objetivo, realizar un entrenamiento b√°sico, realizar un entrenamiento general sobre algebra lineal aplicada a datos multivariados. Iniciar√©mos con operaciones b√°sicas y posteriormente se realizar√°n algunas aplicaciones estad√≠sticas como el an√°lisis de componentes principales (pca) y el an√°lisis discriminante (lda)."
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#documento-de-soporte",
    "href": "Taller2.2.Introd.matrices.html#documento-de-soporte",
    "title": "Taller2.2 Intro_Matrices",
    "section": "Documento de soporte",
    "text": "Documento de soporte\n\n\n\nSe utilizar√° como referente al capitulo 3 del libro An√°lisis de datos ecol√≥gicos y ambientales (Rodr√≠guez-Barrios, J. 2023), alojado en el siguiente enlace üìñEnlace_Libro"
  },
  {
    "objectID": "Taller2.2.Introd.matrices.html#section-2",
    "href": "Taller2.2.Introd.matrices.html#section-2",
    "title": "Taller2.2 Intro_Matrices",
    "section": "‚Äî",
    "text": "‚Äî"
  }
]