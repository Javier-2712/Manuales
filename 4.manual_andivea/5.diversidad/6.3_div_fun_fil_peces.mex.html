<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="Es-es" xml:lang="Es-es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz">
<meta name="dcterms.date" content="2025-11-13">
<meta name="description" content="Ejercicios de entrenamiento para la el análisis de diversidad funcional y filogenética en muestras de peces en ríos en Mexico.">

<title>Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="6.3_div_fun_fil_peces.mex_files/libs/clipboard/clipboard.min.js"></script>
<script src="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/quarto.js"></script>
<script src="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/popper.min.js"></script>
<script src="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/anchor.min.js"></script>
<link href="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="6.3_div_fun_fil_peces.mex_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="6.3_div_fun_fil_peces.mex_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="6.3_div_fun_fil_peces.mex_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="6.3_div_fun_fil_peces.mex_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>
    .quarto-title-block .quarto-title-banner {
      background: #2b8cbe;
    }
    </style>

<script src="6.3_div_fun_fil_peces.mex_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="6.3_div_fun_fil_peces.mex_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles2..css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</h1>
            <p class="subtitle lead">Capítulo 6.3 Visualización gráfica - Diversidad Funcional y Filogenética</p>
                  <div>
        <div class="description">
          Ejercicios de entrenamiento para la el análisis de diversidad funcional y filogenética en muestras de peces en ríos en Mexico.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p>Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 13, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Menú flotante</h2>
   
  <ul>
  <li><a href="#resumen" id="toc-resumen" class="nav-link active" data-scroll-target="#resumen">Resumen</a></li>
  <li><a href="#introducción" id="toc-introducción" class="nav-link" data-scroll-target="#introducción">Introducción</a>
  <ul>
  <li><a href="#hacia-un-marco-unificado-de-análisis-de-los-índices-tradicionales-a-los-modelos-estandarizados" id="toc-hacia-un-marco-unificado-de-análisis-de-los-índices-tradicionales-a-los-modelos-estandarizados" class="nav-link" data-scroll-target="#hacia-un-marco-unificado-de-análisis-de-los-índices-tradicionales-a-los-modelos-estandarizados">Hacia un marco unificado de análisis: de los índices tradicionales a los modelos estandarizados</a></li>
  <li><a href="#selección-y-análisis-de-rasgos-funcionales" id="toc-selección-y-análisis-de-rasgos-funcionales" class="nav-link" data-scroll-target="#selección-y-análisis-de-rasgos-funcionales">Selección y análisis de rasgos funcionales</a></li>
  <li><a href="#hacia-una-visión-multidimensional-de-la-diversidad" id="toc-hacia-una-visión-multidimensional-de-la-diversidad" class="nav-link" data-scroll-target="#hacia-una-visión-multidimensional-de-la-diversidad">Hacia una visión multidimensional de la diversidad</a></li>
  </ul></li>
  <li><a href="#a.-ejercicio-de-visualización-de-diversidad-funcional-y-filogenética-de-peces-en-ríos-de-méxico" id="toc-a.-ejercicio-de-visualización-de-diversidad-funcional-y-filogenética-de-peces-en-ríos-de-méxico" class="nav-link" data-scroll-target="#a.-ejercicio-de-visualización-de-diversidad-funcional-y-filogenética-de-peces-en-ríos-de-méxico">A. Ejercicio de visualización de diversidad funcional y filogenética de peces en ríos de México</a>
  <ul>
  <li><a href="#resumen-1" id="toc-resumen-1" class="nav-link" data-scroll-target="#resumen-1">Resumen</a></li>
  <li><a href="#objetivos-del-ejercicio" id="toc-objetivos-del-ejercicio" class="nav-link" data-scroll-target="#objetivos-del-ejercicio">Objetivos del ejercicio</a>
  <ul>
  <li><a href="#objetivo-general" id="toc-objetivo-general" class="nav-link" data-scroll-target="#objetivo-general"><strong>Objetivo general</strong></a></li>
  <li><a href="#objetivos-específicos" id="toc-objetivos-específicos" class="nav-link" data-scroll-target="#objetivos-específicos"><strong>Objetivos específicos</strong></a></li>
  </ul></li>
  <li><a href="#recomendaciones-para-preparar-los-datos" id="toc-recomendaciones-para-preparar-los-datos" class="nav-link" data-scroll-target="#recomendaciones-para-preparar-los-datos">Recomendaciones para preparar los datos</a></li>
  <li><a href="#diversidad-funcional-y-filogenética" id="toc-diversidad-funcional-y-filogenética" class="nav-link" data-scroll-target="#diversidad-funcional-y-filogenética">1. Diversidad funcional y filogenética</a>
  <ul>
  <li><a href="#librerías-requeridas" id="toc-librerías-requeridas" class="nav-link" data-scroll-target="#librerías-requeridas">1) Librerías requeridas</a></li>
  <li><a href="#organizacion-de-los-datos" id="toc-organizacion-de-los-datos" class="nav-link" data-scroll-target="#organizacion-de-los-datos">2) Organizacion de los datos</a></li>
  <li><a href="#a.-diversidad-funcional-alfa--basada-en-rasgos" id="toc-a.-diversidad-funcional-alfa--basada-en-rasgos" class="nav-link" data-scroll-target="#a.-diversidad-funcional-alfa--basada-en-rasgos">A. Diversidad funcional alfa- basada en rasgos</a>
  <ul>
  <li><a href="#diversidad-funcional-alfa-con-la-función-dbfd" id="toc-diversidad-funcional-alfa-con-la-función-dbfd" class="nav-link" data-scroll-target="#diversidad-funcional-alfa-con-la-función-dbfd">1) Diversidad funcional alfa con la función dbFD()</a></li>
  <li><a href="#clasificación-de-especies-por-sus-estrategias-funcionales" id="toc-clasificación-de-especies-por-sus-estrategias-funcionales" class="nav-link" data-scroll-target="#clasificación-de-especies-por-sus-estrategias-funcionales">2) Clasificación de especies por sus estrategias funcionales</a></li>
  <li><a href="#clasificación-de-sitios-por-su-diversidad-funcional" id="toc-clasificación-de-sitios-por-su-diversidad-funcional" class="nav-link" data-scroll-target="#clasificación-de-sitios-por-su-diversidad-funcional">3) Clasificación de sitios por su diversidad funcional</a></li>
  <li><a href="#relación-entre-la-diversidad-alfa-taxonómica-y-funcional" id="toc-relación-entre-la-diversidad-alfa-taxonómica-y-funcional" class="nav-link" data-scroll-target="#relación-entre-la-diversidad-alfa-taxonómica-y-funcional">4) Relación entre la diversidad alfa taxonómica y funcional</a></li>
  </ul></li>
  <li><a href="#b.-diversidad-beta--taxonómica-funcional-y-filogenética-por-entropía-cuadrática-de-rao" id="toc-b.-diversidad-beta--taxonómica-funcional-y-filogenética-por-entropía-cuadrática-de-rao" class="nav-link" data-scroll-target="#b.-diversidad-beta--taxonómica-funcional-y-filogenética-por-entropía-cuadrática-de-rao">B. Diversidad beta- taxonómica, funcional y filogenética por entropía cuadrática de Rao</a>
  <ul>
  <li><a href="#partición-aditiva-de-la-diversidad-taxonómica-filogenética-y-funcional" id="toc-partición-aditiva-de-la-diversidad-taxonómica-filogenética-y-funcional" class="nav-link" data-scroll-target="#partición-aditiva-de-la-diversidad-taxonómica-filogenética-y-funcional">Partición aditiva de la diversidad taxonómica, filogenética y funcional</a></li>
  <li><a href="#construcción-de-la-matriz-de-abundancia-biol2" id="toc-construcción-de-la-matriz-de-abundancia-biol2" class="nav-link" data-scroll-target="#construcción-de-la-matriz-de-abundancia-biol2">1) Construcción de la matriz de abundancia (<code>biol2</code>)</a></li>
  <li><a href="#preparación-de-la-matriz-de-rasgos-rasgos2" id="toc-preparación-de-la-matriz-de-rasgos-rasgos2" class="nav-link" data-scroll-target="#preparación-de-la-matriz-de-rasgos-rasgos2">2) Preparación de la matriz de rasgos (<code>rasgos2</code>)</a></li>
  <li><a href="#identificación-de-especies-problemáticas-mediante-ncbi" id="toc-identificación-de-especies-problemáticas-mediante-ncbi" class="nav-link" data-scroll-target="#identificación-de-especies-problemáticas-mediante-ncbi">3) Identificación de especies problemáticas mediante NCBI</a></li>
  <li><a href="#exclusión-de-especies-no-encontradas" id="toc-exclusión-de-especies-no-encontradas" class="nav-link" data-scroll-target="#exclusión-de-especies-no-encontradas">4) Exclusión de especies no encontradas</a></li>
  <li><a href="#construcción-de-la-matriz-de-distancia-filogenética-phylo.d" id="toc-construcción-de-la-matriz-de-distancia-filogenética-phylo.d" class="nav-link" data-scroll-target="#construcción-de-la-matriz-de-distancia-filogenética-phylo.d">5) Construcción de la matriz de distancia filogenética (<code>phylo.d</code>)</a></li>
  <li><a href="#cálculo-de-la-disimilitud-funcional-de-gower-rasgos.d" id="toc-cálculo-de-la-disimilitud-funcional-de-gower-rasgos.d" class="nav-link" data-scroll-target="#cálculo-de-la-disimilitud-funcional-de-gower-rasgos.d">6) Cálculo de la disimilitud funcional de Gower (<code>rasgos.d</code>)</a></li>
  <li><a href="#partición-aditiva-de-la-diversidad-td-pd-fd" id="toc-partición-aditiva-de-la-diversidad-td-pd-fd" class="nav-link" data-scroll-target="#partición-aditiva-de-la-diversidad-td-pd-fd">7) Partición aditiva de la diversidad (TD, PD, FD)</a></li>
  <li><a href="#recomendaciones-para-garantizar-la-replicabilidad-del-análisis-de-diversidad-beta-de-bello-et-al.-2010" id="toc-recomendaciones-para-garantizar-la-replicabilidad-del-análisis-de-diversidad-beta-de-bello-et-al.-2010" class="nav-link" data-scroll-target="#recomendaciones-para-garantizar-la-replicabilidad-del-análisis-de-diversidad-beta-de-bello-et-al.-2010">Recomendaciones para garantizar la replicabilidad del análisis de diversidad beta (De Bello et al.&nbsp;2010)</a>
  <ul class="collapse">
  <li><a href="#hoja-de-abundancias-tax" id="toc-hoja-de-abundancias-tax" class="nav-link" data-scroll-target="#hoja-de-abundancias-tax">1. Hoja de abundancias (<code>tax</code>)</a></li>
  <li><a href="#hoja-de-rasgos-rasgos" id="toc-hoja-de-rasgos-rasgos" class="nav-link" data-scroll-target="#hoja-de-rasgos-rasgos">2. Hoja de rasgos (<code>rasgos</code>)</a></li>
  <li><a href="#árbol-filogenético-arbol_filo_alfa.rds" id="toc-árbol-filogenético-arbol_filo_alfa.rds" class="nav-link" data-scroll-target="#árbol-filogenético-arbol_filo_alfa.rds">3. Árbol filogenético (<code>arbol_filo_alfa.rds</code>)</a></li>
  <li><a href="#consistencia-entre-las-tres-fuentes-de-datos" id="toc-consistencia-entre-las-tres-fuentes-de-datos" class="nav-link" data-scroll-target="#consistencia-entre-las-tres-fuentes-de-datos">4. Consistencia entre las tres fuentes de datos</a></li>
  <li><a href="#qué-revisar-si-algo-falla" id="toc-qué-revisar-si-algo-falla" class="nav-link" data-scroll-target="#qué-revisar-si-algo-falla">5. Qué revisar si algo falla</a></li>
  <li><a href="#reglas-cortas-para-el-usuario" id="toc-reglas-cortas-para-el-usuario" class="nav-link" data-scroll-target="#reglas-cortas-para-el-usuario">6. Reglas cortas para el usuario</a></li>
  </ul></li>
  <li><a href="#tabulación-y-visualización-de-la-diversidad-con-partición-aditiva" id="toc-tabulación-y-visualización-de-la-diversidad-con-partición-aditiva" class="nav-link" data-scroll-target="#tabulación-y-visualización-de-la-diversidad-con-partición-aditiva">8) Tabulación y visualización de la diversidad con partición aditiva</a></li>
  </ul></li>
  <li><a href="#c.-diversidad-taxonómica-funcional-y-filogenética-con-números-efectivos-q-0-1-y-2" id="toc-c.-diversidad-taxonómica-funcional-y-filogenética-con-números-efectivos-q-0-1-y-2" class="nav-link" data-scroll-target="#c.-diversidad-taxonómica-funcional-y-filogenética-con-números-efectivos-q-0-1-y-2">C. Diversidad taxonómica, funcional y filogenética con números efectivos q = 0, 1 y 2</a>
  <ul>
  <li><a href="#enfoques-previos-estructura-y-partición-de-la-diversidad" id="toc-enfoques-previos-estructura-y-partición-de-la-diversidad" class="nav-link" data-scroll-target="#enfoques-previos-estructura-y-partición-de-la-diversidad">Enfoques previos: estructura y partición de la diversidad</a></li>
  <li><a href="#el-marco-unificado-de-chao-et-al.-2021-2023-integración-y-estandarización" id="toc-el-marco-unificado-de-chao-et-al.-2021-2023-integración-y-estandarización" class="nav-link" data-scroll-target="#el-marco-unificado-de-chao-et-al.-2021-2023-integración-y-estandarización">El marco unificado de Chao et al.&nbsp;(2021, 2023): integración y estandarización</a></li>
  </ul></li>
  <li><a href="#c.1-diversidad-alfa-taxonómica-td-filogenética-pd-y-funcional-fd-con-inext.3d" id="toc-c.1-diversidad-alfa-taxonómica-td-filogenética-pd-y-funcional-fd-con-inext.3d" class="nav-link" data-scroll-target="#c.1-diversidad-alfa-taxonómica-td-filogenética-pd-y-funcional-fd-con-inext.3d">C.1 Diversidad alfa taxonómica (TD), filogenética (PD) y funcional (FD) con iNEXT.3D</a>
  <ul>
  <li><a href="#a.-diversidad-taxonómica-td-con-abundancias" id="toc-a.-diversidad-taxonómica-td-con-abundancias" class="nav-link" data-scroll-target="#a.-diversidad-taxonómica-td-con-abundancias">A. Diversidad taxonómica (TD) con abundancias</a>
  <ul class="collapse">
  <li><a href="#estimadores-estandarizados-de-diversidad-taxonómica-td" id="toc-estimadores-estandarizados-de-diversidad-taxonómica-td" class="nav-link" data-scroll-target="#estimadores-estandarizados-de-diversidad-taxonómica-td">1) Estimadores estandarizados de diversidad taxonómica (TD)</a></li>
  <li><a href="#estimación-estandarizada-de-la-diversidad-taxonómica" id="toc-estimación-estandarizada-de-la-diversidad-taxonómica" class="nav-link" data-scroll-target="#estimación-estandarizada-de-la-diversidad-taxonómica">2) Estimación estandarizada de la diversidad taxonómica</a></li>
  <li><a href="#figura-1.-diversidad-taxonómica-td-con-abundancias" id="toc-figura-1.-diversidad-taxonómica-td-con-abundancias" class="nav-link" data-scroll-target="#figura-1.-diversidad-taxonómica-td-con-abundancias">Figura 1. Diversidad taxonómica (TD) con abundancias</a></li>
  <li><a href="#figura-2.-estimación-estandarizada-de-la-diversidad-taxonómica" id="toc-figura-2.-estimación-estandarizada-de-la-diversidad-taxonómica" class="nav-link" data-scroll-target="#figura-2.-estimación-estandarizada-de-la-diversidad-taxonómica">Figura 2. Estimación estandarizada de la diversidad taxonómica</a></li>
  <li><a href="#figura-3.-estimación-asintótica-de-la-diversidad-taxonómica" id="toc-figura-3.-estimación-asintótica-de-la-diversidad-taxonómica" class="nav-link" data-scroll-target="#figura-3.-estimación-asintótica-de-la-diversidad-taxonómica">Figura 3. Estimación asintótica de la diversidad taxonómica</a></li>
  <li><a href="#diversidad-taxonómica-td-basada-en-perfiles-de-orden-q" id="toc-diversidad-taxonómica-td-basada-en-perfiles-de-orden-q" class="nav-link" data-scroll-target="#diversidad-taxonómica-td-basada-en-perfiles-de-orden-q">3) Diversidad taxonómica (TD) basada en perfiles de orden q</a></li>
  <li><a href="#figura-4.-lectura-del-perfil-q-td" id="toc-figura-4.-lectura-del-perfil-q-td" class="nav-link" data-scroll-target="#figura-4.-lectura-del-perfil-q-td">Figura 4. Lectura del perfil-q (TD)</a></li>
  </ul></li>
  <li><a href="#b.-diversidad-filogenética-pd" id="toc-b.-diversidad-filogenética-pd" class="nav-link" data-scroll-target="#b.-diversidad-filogenética-pd">B. Diversidad filogenética (PD)</a>
  <ul class="collapse">
  <li><a href="#construir-la-matriz-de-abundancias-especies-sitios" id="toc-construir-la-matriz-de-abundancias-especies-sitios" class="nav-link" data-scroll-target="#construir-la-matriz-de-abundancias-especies-sitios">1) Construir la matriz de abundancias (Especies × Sitios)</a></li>
  <li><a href="#armonizar-nombres-y-alinear-con-el-árbol-latinname-exacto" id="toc-armonizar-nombres-y-alinear-con-el-árbol-latinname-exacto" class="nav-link" data-scroll-target="#armonizar-nombres-y-alinear-con-el-árbol-latinname-exacto">2) Armonizar nombres y alinear con el árbol (LatinName exacto)</a></li>
  <li><a href="#calculo-de-la-diversidad-filogenética-con-inext3d." id="toc-calculo-de-la-diversidad-filogenética-con-inext3d." class="nav-link" data-scroll-target="#calculo-de-la-diversidad-filogenética-con-inext3d.">3) Calculo de la diversidad filogenética con iNEXT3D.</a></li>
  <li><a href="#estimaciones-estandarizadas-de-diversidad-filogenética" id="toc-estimaciones-estandarizadas-de-diversidad-filogenética" class="nav-link" data-scroll-target="#estimaciones-estandarizadas-de-diversidad-filogenética">4) Estimaciones estandarizadas de diversidad filogenética</a></li>
  <li><a href="#estimaciones-de-diversidad-filogenética-estandarizadas-por-cobertura" id="toc-estimaciones-de-diversidad-filogenética-estandarizadas-por-cobertura" class="nav-link" data-scroll-target="#estimaciones-de-diversidad-filogenética-estandarizadas-por-cobertura">5) Estimaciones de diversidad filogenética estandarizadas por cobertura</a></li>
  <li><a href="#estimaciones-observadas-y-asintóticas-de-la-diversidad-filogenética" id="toc-estimaciones-observadas-y-asintóticas-de-la-diversidad-filogenética" class="nav-link" data-scroll-target="#estimaciones-observadas-y-asintóticas-de-la-diversidad-filogenética">6) Estimaciones observadas y asintóticas de la diversidad filogenética</a></li>
  <li><a href="#figura-1.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" id="toc-figura-1.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" class="nav-link" data-scroll-target="#figura-1.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad">Figura 1. Curvas de rarefacción y extrapolación por orden de diversidad</a></li>
  <li><a href="#figura-2.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" id="toc-figura-2.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" class="nav-link" data-scroll-target="#figura-2.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad">Figura 2. Curvas de rarefacción y extrapolación por orden de diversidad</a></li>
  <li><a href="#figura-3.-curvas-de-completitud-de-muestra-sample-completeness-curve" id="toc-figura-3.-curvas-de-completitud-de-muestra-sample-completeness-curve" class="nav-link" data-scroll-target="#figura-3.-curvas-de-completitud-de-muestra-sample-completeness-curve">Figura 3. Curvas de completitud de muestra (Sample completeness curve)</a></li>
  <li><a href="#figura-4.-curvas-de-diversidad-filogenética-estandarizadas-por-cobertura" id="toc-figura-4.-curvas-de-diversidad-filogenética-estandarizadas-por-cobertura" class="nav-link" data-scroll-target="#figura-4.-curvas-de-diversidad-filogenética-estandarizadas-por-cobertura">Figura 4. Curvas de diversidad filogenética estandarizadas por cobertura</a></li>
  <li><a href="#figura-5.-perfiles-tau-de-diversidad-funcional-con-datos-de-abundancia" id="toc-figura-5.-perfiles-tau-de-diversidad-funcional-con-datos-de-abundancia" class="nav-link" data-scroll-target="#figura-5.-perfiles-tau-de-diversidad-funcional-con-datos-de-abundancia">Figura 5. Perfiles tau de diversidad funcional con datos de abundancia</a></li>
  </ul></li>
  <li><a href="#c.-diversidad-funcional-fd" id="toc-c.-diversidad-funcional-fd" class="nav-link" data-scroll-target="#c.-diversidad-funcional-fd">C. Diversidad funcional (FD)</a></li>
  <li><a href="#matriz-de-distancias-de-gower" id="toc-matriz-de-distancias-de-gower" class="nav-link" data-scroll-target="#matriz-de-distancias-de-gower">1) Matriz de distancias de Gower</a></li>
  <li><a href="#base-de-abundancia-por-cada-zona-comparada-m-p-y-rm" id="toc-base-de-abundancia-por-cada-zona-comparada-m-p-y-rm" class="nav-link" data-scroll-target="#base-de-abundancia-por-cada-zona-comparada-m-p-y-rm">2) Base de abundancia por cada zona comparada (M, P y RM)</a></li>
  <li><a href="#estimación-general-de-la-diversidad-funcional-fd-en-ensamblajes-de-especies" id="toc-estimación-general-de-la-diversidad-funcional-fd-en-ensamblajes-de-especies" class="nav-link" data-scroll-target="#estimación-general-de-la-diversidad-funcional-fd-en-ensamblajes-de-especies">3) Estimación general de la diversidad funcional (FD) en ensamblajes de especies</a></li>
  <li><a href="#estimaciones-estandarizadas-de-diversidad-funcional-fd" id="toc-estimaciones-estandarizadas-de-diversidad-funcional-fd" class="nav-link" data-scroll-target="#estimaciones-estandarizadas-de-diversidad-funcional-fd">4) Estimaciones estandarizadas de diversidad funcional (FD)</a></li>
  <li><a href="#diversidad-funcional-estandarizada-por-cobertura-muestral" id="toc-diversidad-funcional-estandarizada-por-cobertura-muestral" class="nav-link" data-scroll-target="#diversidad-funcional-estandarizada-por-cobertura-muestral">5) Diversidad funcional estandarizada por cobertura muestral</a></li>
  <li><a href="#estimaciones-asintóticas-de-diversidad-funcional-fdasyest" id="toc-estimaciones-asintóticas-de-diversidad-funcional-fdasyest" class="nav-link" data-scroll-target="#estimaciones-asintóticas-de-diversidad-funcional-fdasyest">6) Estimaciones asintóticas de diversidad funcional (FDAsyEst)</a>
  <ul class="collapse">
  <li><a href="#figura-1.-curvas-de-rarefacciónextrapolación-basadas-en-el-tamaño-de-muestra-fd" id="toc-figura-1.-curvas-de-rarefacciónextrapolación-basadas-en-el-tamaño-de-muestra-fd" class="nav-link" data-scroll-target="#figura-1.-curvas-de-rarefacciónextrapolación-basadas-en-el-tamaño-de-muestra-fd">Figura 1. Curvas de rarefacción/extrapolación basadas en el tamaño de muestra (FD)</a></li>
  <li><a href="#figura-2.-curvas-de-rarefacciónextrapolación-por-orden-de-diversidad-fd" id="toc-figura-2.-curvas-de-rarefacciónextrapolación-por-orden-de-diversidad-fd" class="nav-link" data-scroll-target="#figura-2.-curvas-de-rarefacciónextrapolación-por-orden-de-diversidad-fd">Figura 2. Curvas de rarefacción/extrapolación por orden de diversidad (FD)</a></li>
  <li><a href="#figura-3.-curvas-de-completitud-muestral-fd" id="toc-figura-3.-curvas-de-completitud-muestral-fd" class="nav-link" data-scroll-target="#figura-3.-curvas-de-completitud-muestral-fd">Figura 3. Curvas de completitud muestral (FD)</a></li>
  <li><a href="#figura-4.-curvas-de-rarefacción-y-extrapolación-basadas-en-cobertura-fd" id="toc-figura-4.-curvas-de-rarefacción-y-extrapolación-basadas-en-cobertura-fd" class="nav-link" data-scroll-target="#figura-4.-curvas-de-rarefacción-y-extrapolación-basadas-en-cobertura-fd">Figura 4. Curvas de rarefacción y extrapolación basadas en cobertura (FD)</a></li>
  <li><a href="#figura-5.-curvas-de-cobertura-estandarizada-y-comparación-entre-ensamblajes" id="toc-figura-5.-curvas-de-cobertura-estandarizada-y-comparación-entre-ensamblajes" class="nav-link" data-scroll-target="#figura-5.-curvas-de-cobertura-estandarizada-y-comparación-entre-ensamblajes">Figura 5. Curvas de cobertura estandarizada y comparación entre ensamblajes</a></li>
  </ul></li>
  <li><a href="#perfiles-de-diversidad-funcional-fd-según-el-orden-de-diversidad-q-profiles" id="toc-perfiles-de-diversidad-funcional-fd-según-el-orden-de-diversidad-q-profiles" class="nav-link" data-scroll-target="#perfiles-de-diversidad-funcional-fd-según-el-orden-de-diversidad-q-profiles">7) Perfiles de diversidad funcional (FD) según el orden de diversidad (q-profiles)</a>
  <ul class="collapse">
  <li><a href="#figura-6.-perfiles-de-distintividad-funcional-τ-profiles" id="toc-figura-6.-perfiles-de-distintividad-funcional-τ-profiles" class="nav-link" data-scroll-target="#figura-6.-perfiles-de-distintividad-funcional-τ-profiles">Figura 6. perfiles de distintividad funcional (τ-profiles)</a></li>
  </ul></li>
  <li><a href="#estimación-de-la-diversidad-funcional-fd-basada-en-los-números-de-hill" id="toc-estimación-de-la-diversidad-funcional-fd-basada-en-los-números-de-hill" class="nav-link" data-scroll-target="#estimación-de-la-diversidad-funcional-fd-basada-en-los-números-de-hill">8) Estimación de la diversidad funcional (FD) basada en los números de Hill</a>
  <ul class="collapse">
  <li><a href="#figura-6.-perfil-q-de-diversidad-funcional" id="toc-figura-6.-perfil-q-de-diversidad-funcional" class="nav-link" data-scroll-target="#figura-6.-perfil-q-de-diversidad-funcional">Figura 6. Perfil-q de diversidad funcional</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#c.2-diversidad-beta-filogenética-pd-y-funcional-fd" id="toc-c.2-diversidad-beta-filogenética-pd-y-funcional-fd" class="nav-link" data-scroll-target="#c.2-diversidad-beta-filogenética-pd-y-funcional-fd">C.2 Diversidad beta filogenética (PD) y funcional (FD)</a>
  <ul>
  <li><a href="#a.-diversidad-beta-filogenética-con-inext.beta3d" id="toc-a.-diversidad-beta-filogenética-con-inext.beta3d" class="nav-link" data-scroll-target="#a.-diversidad-beta-filogenética-con-inext.beta3d">A. Diversidad beta filogenética con iNEXT.beta3D</a></li>
  <li><a href="#cálculo-de-la-diversidad-beta-filogenética-con-inext.beta3d" id="toc-cálculo-de-la-diversidad-beta-filogenética-con-inext.beta3d" class="nav-link" data-scroll-target="#cálculo-de-la-diversidad-beta-filogenética-con-inext.beta3d">1) Cálculo de la diversidad beta filogenética con iNEXT.beta3D</a>
  <ul class="collapse">
  <li><a href="#cargar-insumos" id="toc-cargar-insumos" class="nav-link" data-scroll-target="#cargar-insumos">1.1) Cargar insumos</a></li>
  <li><a href="#alineación-automática-con-alineador.r" id="toc-alineación-automática-con-alineador.r" class="nav-link" data-scroll-target="#alineación-automática-con-alineador.r">1.2) Alineación automática con <code>alineador.R</code></a></li>
  <li><a href="#cálculo-de-la-diversidad-beta-filogenética" id="toc-cálculo-de-la-diversidad-beta-filogenética" class="nav-link" data-scroll-target="#cálculo-de-la-diversidad-beta-filogenética">1.3) Cálculo de la diversidad beta filogenética</a></li>
  <li><a href="#figura-1.-curvas-de-rarefacción-y-extrapolación-de-la-diversidad-beta-filogenética" id="toc-figura-1.-curvas-de-rarefacción-y-extrapolación-de-la-diversidad-beta-filogenética" class="nav-link" data-scroll-target="#figura-1.-curvas-de-rarefacción-y-extrapolación-de-la-diversidad-beta-filogenética">Figura 1. Curvas de rarefacción y extrapolación de la diversidad beta filogenética</a></li>
  <li><a href="#figura-2.-curvas-de-rarefacción-y-extrapolación-basadas-en-el-tamaño-de-muestra" id="toc-figura-2.-curvas-de-rarefacción-y-extrapolación-basadas-en-el-tamaño-de-muestra" class="nav-link" data-scroll-target="#figura-2.-curvas-de-rarefacción-y-extrapolación-basadas-en-el-tamaño-de-muestra">Figura 2. Curvas de rarefacción y extrapolación basadas en el tamaño de muestra</a></li>
  <li><a href="#información-general-de-la-beta-filogenética-con-la-función-datainfobeta3d" id="toc-información-general-de-la-beta-filogenética-con-la-función-datainfobeta3d" class="nav-link" data-scroll-target="#información-general-de-la-beta-filogenética-con-la-función-datainfobeta3d">2) Información general de la beta filogenética con la función DataInfobeta3D()</a></li>
  </ul></li>
  <li><a href="#b.-diversidad-beta-funcional---fd-beta-con-inext.beta3d" id="toc-b.-diversidad-beta-funcional---fd-beta-con-inext.beta3d" class="nav-link" data-scroll-target="#b.-diversidad-beta-funcional---fd-beta-con-inext.beta3d">B. Diversidad beta funcional - FD beta con iNEXT.beta3D</a></li>
  <li><a href="#construir-la-matriz-de-abundancias-especies-sitios-1" id="toc-construir-la-matriz-de-abundancias-especies-sitios-1" class="nav-link" data-scroll-target="#construir-la-matriz-de-abundancias-especies-sitios-1">1) Construir la matriz de abundancias (Especies × Sitios)</a></li>
  <li><a href="#armar-los-pares-de-sitios-para-β-fd" id="toc-armar-los-pares-de-sitios-para-β-fd" class="nav-link" data-scroll-target="#armar-los-pares-de-sitios-para-β-fd">2) Armar los pares de sitios para β-FD</a></li>
  <li><a href="#preparar-rasgos-funcionales" id="toc-preparar-rasgos-funcionales" class="nav-link" data-scroll-target="#preparar-rasgos-funcionales">3) Preparar rasgos funcionales</a></li>
  <li><a href="#distancias-funcionales-gower" id="toc-distancias-funcionales-gower" class="nav-link" data-scroll-target="#distancias-funcionales-gower">4) Distancias funcionales (Gower)</a></li>
  <li><a href="#alinear-abundancias-rasgos" id="toc-alinear-abundancias-rasgos" class="nav-link" data-scroll-target="#alinear-abundancias-rasgos">5) Alinear “abundancias ↔︎ rasgos”</a></li>
  <li><a href="#chequeos-de-consistencia" id="toc-chequeos-de-consistencia" class="nav-link" data-scroll-target="#chequeos-de-consistencia">6) Chequeos de consistencia</a></li>
  <li><a href="#diversidad-beta-funcional-fd-por-re-rarefacción-y-extrapolación" id="toc-diversidad-beta-funcional-fd-por-re-rarefacción-y-extrapolación" class="nav-link" data-scroll-target="#diversidad-beta-funcional-fd-por-re-rarefacción-y-extrapolación">7) Diversidad beta funcional FD por R/E (rarefacción y extrapolación)</a>
  <ul class="collapse">
  <li><a href="#figura-1.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-cobertura" id="toc-figura-1.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-cobertura" class="nav-link" data-scroll-target="#figura-1.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-cobertura">Figura 1. curvas de rarefacción y extrapolación (R/E) basadas en cobertura</a></li>
  </ul></li>
  <li><a href="#curvas-re-por-tamaño-de-muestra-fd-γ-y-α" id="toc-curvas-re-por-tamaño-de-muestra-fd-γ-y-α" class="nav-link" data-scroll-target="#curvas-re-por-tamaño-de-muestra-fd-γ-y-α">8) Curvas R/E por tamaño de muestra (FD γ y α)</a>
  <ul class="collapse">
  <li><a href="#figura-2.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-abundancias" id="toc-figura-2.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-abundancias" class="nav-link" data-scroll-target="#figura-2.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-abundancias">Figura 2. curvas de rarefacción y extrapolación (R/E) basadas en abundancias</a></li>
  </ul></li>
  <li><a href="#información-general-de-la-beta-funcional-con-la-función-datainfobeta3d" id="toc-información-general-de-la-beta-funcional-con-la-función-datainfobeta3d" class="nav-link" data-scroll-target="#información-general-de-la-beta-funcional-con-la-función-datainfobeta3d">9) Información general de la beta funcional con la función DataInfobeta3D()</a></li>
  </ul></li>
  <li><a href="#aproximaciones-metodológicas-complementarias" id="toc-aproximaciones-metodológicas-complementarias" class="nav-link" data-scroll-target="#aproximaciones-metodológicas-complementarias">Aproximaciones metodológicas complementarias</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>Conclusion</strong></a></li>
  <li><a href="#conclusiones-prácticas" id="toc-conclusiones-prácticas" class="nav-link" data-scroll-target="#conclusiones-prácticas">Conclusiones prácticas</a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias">Referencias</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<hr>
<section id="resumen" class="level1">
<h1>Resumen</h1>
<p>La <strong>diversidad funcional</strong> amplía la visión tradicional de la biodiversidad al incorporar los <strong>rasgos ecológicos</strong> que determinan cómo las especies interactúan con su ambiente y entre sí. Esta dimensión busca entender no solo <strong>cuántas especies existen</strong>, sino <strong>qué funciones cumplen</strong> y cómo su pérdida o reemplazo puede alterar el funcionamiento ecosistémico.</p>
<p>Los enfoques clásicos, como los índices <strong>FRic</strong>, <strong>FEve</strong> y <strong>FDiv</strong> de <strong>Villéger et al.&nbsp;(2008)</strong> o la <strong>entropía cuadrática de Rao (Q)</strong> aplicada por <strong>De Bello et al.&nbsp;(2010)</strong>, han sido fundamentales para describir la estructura funcional y filogenética de las comunidades. Sin embargo, estos métodos dependen del <strong>esfuerzo de muestreo</strong> y no permiten comparaciones directas entre ensamblajes con diferente completitud.</p>
<p>En respuesta, <strong>Chao et al.&nbsp;(2021, 2023)</strong> desarrollaron los marcos <strong>iNEXT.3D</strong> e <strong>iNEXTbeta3D</strong>, que integran las tres dimensiones de la biodiversidad —<strong>taxonómica (TD)</strong>, <strong>funcional (FD)</strong> y <strong>filogenética (PD)</strong>— bajo los <strong>números de Hill</strong> y la <strong>estandarización por cobertura muestral</strong>. Este enfoque permite interpolar, extrapolar y comparar comunidades de manera <strong>estadísticamente justa</strong>, incorporando matrices de rasgos funcionales o árboles filogenéticos según el caso. Así, los métodos contemporáneos de <strong>Chao y colaboradores</strong> complementan y amplían las métricas tradicionales, ofreciendo un marco <strong>unificado, comparativo y reproducible</strong> para evaluar la diversidad ecológica en distintas escalas y dimensiones.</p>
<hr>
</section>
<section id="introducción" class="level1">
<h1>Introducción</h1>
<p>La <strong>diversidad funcional</strong> representa una de las formas más profundas y modernas de comprender la biodiversidad, ya que no se limita a contar especies, sino que busca entender <strong>qué funciones ecológicas cumple cada una dentro del ecosistema</strong>. Desde hace más de medio siglo, los ecólogos han intentado describir los patrones de la vida considerando los <strong>rasgos funcionales</strong>, es decir, aquellas características morfológicas, fisiológicas o conductuales que influyen directamente en el papel ecológico de las especies.</p>
<p>Inicialmente, este enfoque se desarrolló con mayor detalle en <strong>ensamblajes vegetales</strong>, pero en las últimas décadas ha crecido su aplicación en <strong>ensamblajes animales</strong>, tanto acuáticos como terrestres. En estos casos, los desafíos son mayores: muchas especies son escasas, evasivas o de hábitos nocturnos, lo que dificulta la medición directa de sus rasgos y exige muestreos intensivos para lograr una representación adecuada.</p>
<p>El interés por este tipo de análisis se fortaleció desde la década de 1970, con el surgimiento del concepto de <strong>grupos funcionales</strong> (Cummins, 1974), que clasifica a las especies según el rol que desempeñan en el ecosistema. Desde entonces, se ha reconocido que los <strong>cambios ambientales y las perturbaciones humanas</strong> no solo afectan la riqueza de especies, sino también la manera en que los organismos contribuyen al funcionamiento ecológico (por ejemplo, la descomposición, la polinización o el reciclaje de nutrientes).</p>
<p>Hoy en día, la tendencia en ecología es integrar de manera simultánea <strong>las dimensiones taxonómica, funcional y filogenética</strong> para lograr una visión más completa de la biodiversidad. Analizar los rasgos funcionales permite responder preguntas sobre <strong>cómo se estructuran los ensamblajes, cómo responden a los gradientes ambientales o a las perturbaciones, y cómo esas respuestas influyen en los procesos ecosistémicos</strong>.</p>
<section id="hacia-un-marco-unificado-de-análisis-de-los-índices-tradicionales-a-los-modelos-estandarizados" class="level3">
<h3 class="anchored" data-anchor-id="hacia-un-marco-unificado-de-análisis-de-los-índices-tradicionales-a-los-modelos-estandarizados">Hacia un marco unificado de análisis: de los índices tradicionales a los modelos estandarizados</h3>
<p>Durante las dos últimas décadas, los métodos clásicos para estimar la diversidad funcional y filogenética —como los índices <strong>FRic</strong>, <strong>FEve</strong>, <strong>FDiv</strong> (Villéger et al., 2008) o la <strong>entropía cuadrática de Rao (Q)</strong> (De Bello et al., 2010)— han permitido caracterizar la estructura interna de los ensamblajes y su partición espacial (α, β, γ). Sin embargo, estos enfoques <strong>dependen directamente del número de individuos y del esfuerzo de muestreo</strong>, lo que dificulta la comparación entre comunidades con diferente tamaño de muestra o grado de completitud.</p>
<p>Frente a estas limitaciones, <strong>Chao et al.&nbsp;(2021)</strong> propusieron el marco <strong>iNEXT.3D</strong> (<em>interpolation and extrapolation for three dimensions of biodiversity</em>), el cual unifica el análisis de la <strong>diversidad taxonómica (TD)</strong>, <strong>funcional (FD)</strong> y <strong>filogenética (PD)</strong> bajo una misma formulación matemática basada en los <strong>números de Hill</strong>. Este enfoque combina la teoría de la diversidad efectiva con un principio de <strong>estandarización por cobertura muestral (sample coverage)</strong>, permitiendo comparar comunidades con diferente esfuerzo o tamaño de muestra en términos de su <strong>completitud estadística</strong> y no solo del número de especies detectadas.</p>
<p>En el caso de la <strong>diversidad funcional</strong>, el cálculo requiere una <strong>matriz de distancias funcionales</strong> derivada de rasgos morfológicos, fisiológicos o tróficos, mientras que la <strong>diversidad filogenética</strong> se estima a partir de un <strong>árbol filogenético</strong> o dendrograma que refleje las relaciones evolutivas entre las especies. De este modo, las métricas de iNEXT.3D incorporan explícitamente la <strong>distintividad funcional o evolutiva</strong> entre especies, y no únicamente su abundancia.</p>
<p>Posteriormente, <strong>Chao (2023)</strong> extendió este marco a la evaluación de la <strong>diversidad beta</strong> mediante el desarrollo del paquete <strong>iNEXTbeta3D</strong>, que combina la descomposición multiplicativa clásica de Whittaker (1960) con los números de Hill. Este avance permite <strong>comparar la diferenciación composicional (β) entre ensamblajes</strong> estandarizando previamente las diversidades <strong>alfa (α)</strong> y <strong>gamma (γ)</strong> a un mismo nivel de cobertura. Así, la diversidad beta resultante refleja únicamente <strong>la variación real en composición o funciones</strong>, independiente de los efectos del esfuerzo de muestreo.</p>
<p>Estas innovaciones metodológicas han transformado el análisis ecológico, permitiendo <strong>visualizar, interpolar y extrapolar la diversidad funcional y filogenética</strong> con curvas de rarefacción, perfiles de diversidad y estimaciones asintóticas comparables entre sitios, periodos o grupos funcionales.</p>
</section>
<section id="selección-y-análisis-de-rasgos-funcionales" class="level3">
<h3 class="anchored" data-anchor-id="selección-y-análisis-de-rasgos-funcionales">Selección y análisis de rasgos funcionales</h3>
<p>La selección y medición de rasgos funcionales constituye uno de los pasos más determinantes en el estudio de la diversidad funcional, pues de ello depende que los resultados reflejen con fidelidad el papel ecológico de las especies. Los rasgos funcionales son aquellas características biológicas —morfológicas, fisiológicas, conductuales o tróficas— que explican <strong>cómo los organismos responden a su ambiente y afectan los procesos ecosistémicos</strong> (Chapin et al., 2000; Díaz y Cabido, 2001; Lavorel y Garnier, 2002).</p>
<p>Una buena selección de rasgos exige coherencia con los objetivos del estudio, el tipo de organismo y la escala ecológica considerada (Petchey y Gaston, 2006; de Bello et al., 2010; Swenson, 2014). Idealmente, los rasgos deben estar <strong>vinculados con funciones clave</strong> —como la captura de recursos, la tolerancia a disturbios o la reproducción— y medirse de forma estandarizada (Lepš et al., 2006; Mouillot et al., 2007).</p>
<p>En la práctica, muchos rasgos son difíciles de medir directamente, por lo que se recurre a <strong>colecciones biológicas</strong>, <strong>bases de datos especializadas</strong> (como <em>FishBase</em> o <em>TRY</em>) o literatura técnica. Es fundamental documentar la fuente y la metodología para garantizar la <strong>reproducibilidad y comparabilidad</strong> de los resultados (Cornelissen et al., 2003; Violle et al., 2007).</p>
<p>Los rasgos pueden ser <strong>cuantitativos</strong> (continuos o discretos) o <strong>cualitativos</strong> (ordinales o categóricos). La combinación de ambos requiere una <strong>estandarización previa</strong>, habitualmente mediante el índice de Gower, para evitar que las diferencias de escala distorsionen la estructura funcional del ensamblaje (Lepš et al., 2006; Schleuter et al., 2010).</p>
<p>Un aspecto clave es distinguir entre <strong>rasgos de respuesta</strong> (que explican la adaptación a gradientes o perturbaciones) y <strong>rasgos de efecto</strong> (que determinan la influencia sobre procesos ecosistémicos). Algunos rasgos pueden cumplir ambos roles dependiendo del contexto ecológico (Lavorel y Garnier, 2002; Suding et al., 2008).</p>
<p>En el caso de los animales, los rasgos funcionales suelen agruparse en categorías como <strong>morfológicos, reproductivos, conductuales, fisiológicos, tróficos y espaciales o temporales</strong> (Litchman et al., 2013; Gravel et al., 2016; Gómez-Ortiz y Moreno, 2017). Esta clasificación facilita la construcción de protocolos comparables entre comunidades y su posterior análisis multivariado.</p>
</section>
<section id="hacia-una-visión-multidimensional-de-la-diversidad" class="level3">
<h3 class="anchored" data-anchor-id="hacia-una-visión-multidimensional-de-la-diversidad">Hacia una visión multidimensional de la diversidad</h3>
<p>La ecología funcional moderna avanza hacia una visión <strong>multidimensional y comparativa</strong> de los rasgos y las relaciones filogenéticas. En esta perspectiva, los ensamblajes se interpretan como configuraciones dentro de un <strong>espacio funcional o evolutivo</strong>, cuya forma, amplitud y redundancia reflejan la <strong>resiliencia y funcionalidad</strong> de los ecosistemas.</p>
<p>Autores como <strong>Boersma et al.&nbsp;(2016)</strong> han propuesto marcos conceptuales que vinculan hipótesis ecológicas con métricas cuantitativas, permitiendo visualizar cómo los ensamblajes se distribuyen en el espacio de rasgos y cómo las perturbaciones modifican esas configuraciones.</p>
<p>Al integrar los enfoques clásicos con los desarrollos recientes de <strong>Chao et al.&nbsp;(2021, 2023)</strong>, el análisis de la diversidad funcional y filogenética alcanza un nuevo nivel de precisión:</p>
<ul>
<li><p>incorpora simultáneamente <strong>abundancia, rasgos y relaciones evolutivas</strong>,</p></li>
<li><p>permite <strong>ajustar por completitud muestral</strong>,</p></li>
<li><p>y expresa los resultados en <strong>unidades comparables entre dimensiones (TD, FD, PD)</strong>.</p></li>
</ul>
<p>Esta integración estadística y ecológica constituye la base de los ejercicios que se desarrollan a continuación, orientados a <strong>visualizar, estimar y comparar la diversidad funcional y filogenética</strong> en distintos ensamblajes de peces, como un ejemplo práctico de aplicación de los marcos conceptuales y metodológicos contemporáneos en ecología.</p>
<hr>
</section>
</section>
<section id="a.-ejercicio-de-visualización-de-diversidad-funcional-y-filogenética-de-peces-en-ríos-de-méxico" class="level1">
<h1>A. Ejercicio de visualización de diversidad funcional y filogenética de peces en ríos de México</h1>
<section id="resumen-1" class="level3">
<h3 class="anchored" data-anchor-id="resumen-1">Resumen</h3>
<p>Este ejercicio se basa en el estudio de <strong>Ruiz-Campos et al.&nbsp;(2021)</strong>, en el que se analiza la diversidad y distribución longitudinal de ensamblajes de peces en la cuenca del río <strong>Soto La Marina</strong>, ubicada al noreste de México. A partir de la información biológica y ambiental recolectada en <strong>42 sitios</strong>, los autores identificaron tres ensamblajes principales asociados a distintas zonas fisiográficas: <strong>montaña (M)</strong>, <strong>planicie (P)</strong> y <strong>desembocadura (RM)</strong>.</p>
<p>El conjunto de datos incluye abundancias de especies, rasgos funcionales y un árbol filogenético de referencia, lo que permite aplicar tres enfoques complementarios para evaluar la diversidad funcional y filogenética:</p>
<ol type="1">
<li><p><strong>El enfoque geométrico de Villéger et al.&nbsp;(2008)</strong>, que caracteriza la estructura interna del espacio funcional mediante índices como <strong>FRic</strong>, <strong>FEve</strong> y <strong>FDiv</strong>, derivados de la matriz de rasgos.</p></li>
<li><p><strong>El enfoque de partición aditiva de Rao (De Bello et al., 2010)</strong>, que cuantifica la diversidad <strong>alfa, beta y gamma</strong> integrando matrices de abundancia y de distancia funcional o filogenética.</p></li>
<li><p><strong>El marco unificado de Chao et al.&nbsp;(2021, 2023)</strong>, implementado en los paquetes <strong>iNEXT3D</strong> e <strong>iNEXTbeta3D</strong>, que combina los números de Hill con la <strong>estandarización por cobertura muestral</strong>, permitiendo rarefacción, extrapolación y comparaciones entre dimensiones (TD, FD y PD) bajo un mismo nivel de completitud.</p></li>
</ol>
<p>A través de este ejercicio, se pretende <strong>visualizar y comparar la diversidad funcional y filogenética</strong> de los ensamblajes de peces en las tres zonas fisiográficas, explorando cómo las distintas métricas e indicadores describen la estructura funcional, la historia evolutiva y la completitud muestral de cada comunidad.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://media.springernature.com/full/springer-static/image/art%3A10.1007%2Fs10641-021-01158-9/MediaObjects/10641_2021_1158_Fig1_HTML.png?as=webp" class="img-fluid figure-img" width="654"></p>
<p></p><figcaption class="figure-caption">Área de estudio en: <a href="https://link-springer-com.biblioteca.unimagdalena.edu.co/article/10.1007/s10641-021-01158-9">Ruiz-Campos et al.&nbsp;(2021)</a>. Sitios de muestreo en la cuenca del río Soto La Marina, Tamaulipas, México. Los códigos de los 10 ríos son <strong>a</strong> Soto la Marina, <strong>b</strong> Palmas, <strong>c</strong> Arroyo Grande, <strong>d</strong> San Marcos, <strong>e</strong> San Felipe, <strong>f</strong> Santa Ana, <strong>g</strong> Corona, <strong>h</strong> Purificación, <strong>i</strong> Pilón y <strong>j</strong> San Carlos.</figcaption><p></p>
</figure>
</div>
<hr>
</section>
<section id="objetivos-del-ejercicio" class="level3">
<h3 class="anchored" data-anchor-id="objetivos-del-ejercicio">Objetivos del ejercicio</h3>
<section id="objetivo-general" class="level4">
<h4 class="anchored" data-anchor-id="objetivo-general"><strong>Objetivo general</strong></h4>
<p>Evaluar y comparar la diversidad funcional y filogenética de ensamblajes de peces de la cuenca del río Soto La Marina (México) mediante la aplicación de tres enfoques analíticos complementarios (Villéger, De Bello y Chao), que integran información de abundancia, rasgos y filogenia.</p>
</section>
<section id="objetivos-específicos" class="level4">
<h4 class="anchored" data-anchor-id="objetivos-específicos"><strong>Objetivos específicos</strong></h4>
<ol type="1">
<li><p>Construir las <strong>matrices de abundancia</strong>, <strong>rasgos funcionales</strong> y <strong>filogenía</strong> requeridas para el análisis multimensional de la diversidad.</p></li>
<li><p>Calcular los <strong>índices clásicos de diversidad funcional</strong> (FRic, FEve, FDiv) propuestos por Villéger et al.&nbsp;(2008) y analizar su variación entre ensamblajes.</p></li>
<li><p>Aplicar la <strong>entropía cuadrática de Rao (Q)</strong> para estimar la diversidad <strong>taxonómica, funcional y filogenética</strong>, y descomponerla en sus componentes <strong>alfa, beta y gamma</strong>, siguiendo a De Bello et al.&nbsp;(2010).</p></li>
<li><p>Implementar el <strong>marco iNEXT3D</strong> para obtener estimaciones <strong>observadas, asintóticas y estandarizadas por cobertura</strong> de FD y PD, visualizando las curvas de rarefacción y extrapolación.</p></li>
<li><p>Comparar los resultados entre los tres enfoques para interpretar diferencias en <strong>estructura funcional</strong>, <strong>recambio filogenético</strong> y <strong>completitud del muestreo</strong>, integrando la dimensión estadística de la diversidad ecológica.</p></li>
<li><p>Discutir las <strong>ventajas, limitaciones y complementariedad</strong> de cada método en el contexto de estudios de biodiversidad acuática y gradientes ambientales.</p></li>
</ol>
<hr>
</section>
</section>
<section id="recomendaciones-para-preparar-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="recomendaciones-para-preparar-los-datos">Recomendaciones para preparar los datos</h3>
<blockquote class="blockquote">
<p>Antes de procesar los datos en <strong>R</strong>, asegúrate de que los <strong>nombres abreviados y completos de las especies</strong> coincidan exactamente en todas las hojas del archivo (por ejemplo, <em>tax</em>, <em>rasgos</em> y <em>ambiente</em>). Muchos procedimientos de alineación requieren correspondencia perfecta entre nombres y abreviaturas.</p>
<ul>
<li><p><strong>Unifica las abreviaturas:</strong> usa la misma en todas las hojas, sin espacios, tildes ni caracteres especiales. Mantén la misma capitalización (todo en mayúsculas o minúsculas).</p></li>
<li><p><strong>Evita nombres incompletos o genéricos</strong> (<em>sp.</em>, <em>spp.</em>, <em>cf.</em>), ya que causan errores en búsquedas filogenéticas o taxonómicas.</p></li>
<li><p><strong>Ejemplo ilustrativo:</strong> se incluye <em>Notropis aguirrepequenoi</em> para mostrar qué hacer con especies no reconocidas en bases de datos, aunque no se recomienda incluirlas en análisis reales.</p></li>
<li><p><strong>Depura los datos:</strong> elimina filas o columnas vacías, especies sin abundancias. Para este ejemplo se eliminan especies sin abundancias (<em>Atractosteus spatula</em>, <em>Cyprinus carpio</em>) o que están duplicadas (<em>Fundus grandis</em>). En este ejercicio también se excluye la estación <strong>24P</strong> por falta de datos ambientales.</p></li>
<li><p><strong>Verifica consistencia:</strong> antes de correr los análisis, revisa qué especies están en una hoja y faltan en otra (<code>setdiff()</code> o <code>anti_join()</code> en R).</p></li>
<li><p><strong>Cuida el formato:</strong> usa puntos (<code>.</code>) como separador decimal, nombres de columnas únicos y sin espacios, y evita celdas vacías (usa <code>0</code> o <code>NA</code> según corresponda).</p></li>
</ul>
</blockquote>
<hr>
</section>
<section id="diversidad-funcional-y-filogenética" class="level2">
<h2 class="anchored" data-anchor-id="diversidad-funcional-y-filogenética">1. Diversidad funcional y filogenética</h2>
<p>A continuación se presentan algunas propuestas para el cálculo de la diversidad funcional, al igual que la diversidad filogenética, de una forma general, dado a que no corresponden al enfoque principal de este documento, el cual se centra en la diversidad taxonómica. En este sentido se consideran estas dimensiones complementarias de la diversidad, para un entendimiento más completo de los patrones que promueves a estos procesos ecológicos de las comunidades.</p>
<p>Se inicia con el cálculo de la diversidad funcional, bajo enfoques algo tradicionales como (1) el enfoque de marco flexible, con la <strong>diversidad funcional alfa</strong> (Villéger et al.,&nbsp;2008&nbsp;; Laliberté y Legendre&nbsp;, 2010&nbsp;). (2) el enfoque de marco unificado con los componentes <strong>alfa, beta y gamma, basado en la entropía cuadrática de Rao</strong> (de Bello et al.,&nbsp;2010 y Botta-Dukát, 2005). (3) el enfoque estandarizado con números efectivos de Hill (Chao et al, 2021, 2023).</p>
<p>La diversidad funcional alfa describe cómo las especies de un lugar se diferencian y complementan según sus rasgos ecológicos, es decir, las estrategias que utilizan para sobrevivir, alimentarse o reproducirse. Este enfoque, propuesto por <strong>Villéger et al.&nbsp;(2008)</strong>, permite ir más allá del simple conteo de especies, incorporando el papel funcional de cada una dentro del ecosistema. Este enfoque se basa en tres componentes generales:</p>
<ul>
<li><p><strong>Riqueza funcional (FRic)</strong>: mide cuánto espacio funcional ocupa la muestra, equivalente al volumen del “nicho colectivo” de todas las especies en un espacio de rasgos multidimensional.</p></li>
<li><p><strong>Equidad funcional (FEve)</strong>: refleja qué tan uniformemente se distribuyen las abundancias a lo largo de ese espacio funcional; valores cercanos a 1 indican una comunidad funcionalmente equilibrada.</p></li>
<li><p><strong>Divergencia funcional (FDiv)</strong>: indica si las especies dominantes ocupan posiciones extremas del espacio funcional, es decir, si la muestras de la comunidad está formada por especies muy especializadas o, por el contrario, por generalistas similares.</p></li>
</ul>
<p>Más adelante, <strong>Laliberté y Legendre (2010)</strong> incorporaron la <strong>dispersión funcional (FDis)</strong>, que resume la distancia promedio de las especies (ponderadas por su abundancia) al centro del espacio de rasgos. Este índice está estrechamente vinculado a la <strong>entropía cuadrática de Rao</strong>, una medida general de diversidad basada en disimilitudes funcionales.</p>
<p>Finalmente, se incluyen también las <strong>medias ponderadas de los rasgos (CWM)</strong>, que resumen el valor promedio de cada rasgo en la comunidad según la abundancia de las especies, y la <strong>riqueza de grupos funcionales (FGR)</strong>, que cuantifica cuántos grupos de especies con funciones ecológicas similares coexisten.</p>
<p>En conjunto, estos índices —implementados en el paquete <strong>FD</strong> de R— ofrecen una visión integral del funcionamiento ecológico de los ensamblajes, permitiendo evaluar no solo cuántas especies existen, sino cómo contribuye cada una al conjunto de funciones que mantienen el ecosistema. A continuación se aplicará este marco al análisis de una muestra de peces, utilizando una matriz de abundancia por sitios (<em>biol1</em>) y una matriz de rasgos funcionales (<em>rasgos1</em>).</p>
<hr>
<section id="librerías-requeridas" class="level4">
<h4 class="anchored" data-anchor-id="librerías-requeridas">1) Librerías requeridas</h4>
<p>A continuación se cargan las diferentes librerías requeridas en los procedimientos de esta sección de diversidad funcional y filogenética.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Núcleo de datos ---</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)     <span class="co"># Para manipulación, visualización y programación.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nota: si se carga tidyverse, NO es necesario: dplyr, tidyr, purrr, stringr o ggplot2.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Entrada / salida ---</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)        <span class="co"># Leer archivos Excel (.xlsx)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(writexl)       <span class="co"># Exportar data frames a Excel (.xlsx)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Tablas en reportes ---</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)    <span class="co"># Mejorar el formato de tablas (kable) en reportes</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Diversidad funcional y herramientas afines ---</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(FD)            <span class="co"># Métricas de div. funcional (FRic, FEve, FDiv, CWM, etc.)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(factoextra)    <span class="co"># Visualización de clustering (jerárquico y particional).</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Gráficos y estética ---</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)       <span class="co"># Construir figuras (gramática de los gráficos)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)  <span class="co"># Paletas de color para ggplot2</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggrepel)       <span class="co"># Etiquetas que no se sobreponen en gráficos</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Filogenia y taxonomía ---</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ape)           <span class="co"># Manipulación de árboles filogenéticos</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(taxize)        <span class="co"># Resolución/validación de nombres, IDs taxonómicos y consultas</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Diversidad (números de Hill) ---</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Instalar si hace falta (desde GitHub):</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remotes::install_github("JohnsonHsing/iNEXT.3D")</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remotes::install_github("JohnsonHsing/iNEXTbeta3D")</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(iNEXT<span class="fl">.3</span>D)      <span class="co"># Números de Hill en 3 dimensiones (TD/FD/PD)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(iNEXT.beta3D)   <span class="co"># Extensión para beta-diversidad (TD/FD/PD)</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="organizacion-de-los-datos" class="level4">
<h4 class="anchored" data-anchor-id="organizacion-de-los-datos">2) Organizacion de los datos</h4>
<p>Son tres las bases de datos que se deben construir para este ejercicio:</p>
<blockquote class="blockquote">
<p>Se reuiere contar con tres bases de datos o dataframes que coincidan en sus especies y localidades: <strong>(1) dataframe de taxones, (2) dataframe de rasfos funcionales, (3) dataframe de coordenadas de las localidades</strong>.</p>
</blockquote>
<ol type="1">
<li><strong>Dataframe taxonómico.</strong> Se carga la base de datos con las abundancias de las 87 especies (columnas) en las 42 localidades (filas), la cual se asigna como “<strong>biol1</strong>” (<a href="#tbl-tbl1">Tabla&nbsp;1</a>).</li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar datos desde Excel</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>taxas <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres abreviados de los taxones</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>biol1 <span class="ot">&lt;-</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  taxas <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>      <span class="co"># Excluye la primera columna (Sites)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">abbreviate</span>(.x, <span class="at">minlength =</span> <span class="dv">4</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Se puede guardar archivo con abreviaturas</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(list(rasgoss = biol1), "biol1.xlsx")</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de la base de datos biol1</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(biol1, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl1" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;1:  Resumen de la base de datos de abundancias </caption>
 <thead>
  <tr>
   <th style="text-align:right;"> Hyps </th>
   <th style="text-align:right;"> Elps </th>
   <th style="text-align:right;"> Mgla </th>
   <th style="text-align:right;"> Albv </th>
   <th style="text-align:right;"> Angr </th>
   <th style="text-align:right;"> Myrp </th>
   <th style="text-align:right;"> Ancm </th>
   <th style="text-align:right;"> Anch </th>
   <th style="text-align:right;"> Brvg </th>
   <th style="text-align:right;"> Brvp </th>
   <th style="text-align:right;"> Drsc </th>
   <th style="text-align:right;"> Drsp </th>
   <th style="text-align:right;"> Hrnj </th>
   <th style="text-align:right;"> Opso </th>
   <th style="text-align:right;"> Cmpa </th>
   <th style="text-align:right;"> Cypl </th>
   <th style="text-align:right;"> Dnde </th>
   <th style="text-align:right;"> Dsp. </th>
   <th style="text-align:right;"> Ntra </th>
   <th style="text-align:right;"> Mxsc </th>
   <th style="text-align:right;"> Astm </th>
   <th style="text-align:right;"> Arpf </th>
   <th style="text-align:right;"> Amrm </th>
   <th style="text-align:right;"> Amrn </th>
   <th style="text-align:right;"> Ictl </th>
   <th style="text-align:right;"> Ictp </th>
   <th style="text-align:right;"> Isp. </th>
   <th style="text-align:right;"> Pylo </th>
   <th style="text-align:right;"> Synf </th>
   <th style="text-align:right;"> Prcp </th>
   <th style="text-align:right;"> Djsm </th>
   <th style="text-align:right;"> Mglc </th>
   <th style="text-align:right;"> Mmbm </th>
   <th style="text-align:right;"> Mndb </th>
   <th style="text-align:right;"> Hmrb </th>
   <th style="text-align:right;"> Strt </th>
   <th style="text-align:right;"> Fndg </th>
   <th style="text-align:right;"> Lcnp </th>
   <th style="text-align:right;"> Gmbsaf </th>
   <th style="text-align:right;"> Gmbsar </th>
   <th style="text-align:right;"> Gmbr </th>
   <th style="text-align:right;"> Gsp. </th>
   <th style="text-align:right;"> Pclf </th>
   <th style="text-align:right;"> Pcll </th>
   <th style="text-align:right;"> Pclm </th>
   <th style="text-align:right;"> Psp. </th>
   <th style="text-align:right;"> Xphv </th>
   <th style="text-align:right;"> Prnr </th>
   <th style="text-align:right;"> Cntu </th>
   <th style="text-align:right;"> Mycb </th>
   <th style="text-align:right;"> Srra </th>
   <th style="text-align:right;"> Lpmm </th>
   <th style="text-align:right;"> Msp. </th>
   <th style="text-align:right;"> Crnc </th>
   <th style="text-align:right;"> Crnh </th>
   <th style="text-align:right;"> Crnl </th>
   <th style="text-align:right;"> Olgs </th>
   <th style="text-align:right;"> Trcc </th>
   <th style="text-align:right;"> Trcf </th>
   <th style="text-align:right;"> Ltjnscm </th>
   <th style="text-align:right;"> Ltjnscy </th>
   <th style="text-align:right;"> Ltjg </th>
   <th style="text-align:right;"> Dpta </th>
   <th style="text-align:right;"> Dptr </th>
   <th style="text-align:right;"> Ecnm </th>
   <th style="text-align:right;"> Grrc </th>
   <th style="text-align:right;"> Anss </th>
   <th style="text-align:right;"> Arcp </th>
   <th style="text-align:right;"> Lgdr </th>
   <th style="text-align:right;"> Aplg </th>
   <th style="text-align:right;"> Brdc </th>
   <th style="text-align:right;"> Brdr </th>
   <th style="text-align:right;"> Cyna </th>
   <th style="text-align:right;"> Cynn </th>
   <th style="text-align:right;"> Lstx </th>
   <th style="text-align:right;"> Mcru </th>
   <th style="text-align:right;"> Pgnc </th>
   <th style="text-align:right;"> Hrcl </th>
   <th style="text-align:right;"> Hrcc </th>
   <th style="text-align:right;"> Orca </th>
   <th style="text-align:right;"> Drmm </th>
   <th style="text-align:right;"> Gbmd </th>
   <th style="text-align:right;"> Gbno </th>
   <th style="text-align:right;"> Scmr </th>
   <th style="text-align:right;"> Etrc </th>
   <th style="text-align:right;"> Achl </th>
   <th style="text-align:right;"> Symc </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 106 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Dataframe funcional.</strong> Posteriormente, se carga la base de datos con los rasgos funcionales (columnas) de las 87 especies (filas), la cual se asigna como “<strong>rasgos1</strong>” (<a href="#tbl-tbl2">Tabla&nbsp;2</a>). Esta base debe garantizar que las abreviaturas de las especies coincidan en cantidad y organización con las de <strong>biol1</strong>.</li>
</ol>
<p>Siguiendo las consideracones de Borcard et al.&nbsp;(2018) y de otros autores, esta base de datos se construye con referentes teóricos. Esto se hace con fines didácticos, pero lo ideal es tener la caracterización específica de los peces evaluados.</p>
<p>La base de datos de <strong>rasgos funcionales</strong> describe tanto las dimensiones corporales como los hábitos tróficos de las especies de peces, integrando <strong>cuatro variables cuantitativas</strong> y <strong>seis binarias</strong> relacionadas con la dieta. Los valores provienen principalmente de <strong>FishBase</strong> (Froese y Pauly, eds.), complementados con descripciones morfoecológicas tomadas de <strong>Helfman et al.&nbsp;(2009)</strong> y <strong>Moyle y Cech (2004)</strong>.</p>
<p>Las variables cuantitativas incluyen:</p>
<ul>
<li><strong>Longitud corporal promedio (BodyLength):</strong> longitud total media del pez adulto, indicador del tamaño corporal típico.</li>
</ul>
<!-- -->
<ul>
<li><strong>Longitud corporal máxima (BodyLengthMax):</strong> longitud total máxima reportada para la especie.</li>
</ul>
<!-- -->
<ul>
<li><strong>Factor de forma (ShapeFactor):</strong> relación entre la longitud total y la altura corporal máxima, que refleja el grado de alargamiento del cuerpo.</li>
</ul>
<!-- -->
<ul>
<li><strong>Nivel trófico (TrophicLevel):</strong> posición relativa de la especie en la cadena trófica, basada en la dieta y el tipo de recurso consumido.</li>
</ul>
<p>Estos rasgos permiten caracterizar estrategias ecológicas de las especies y relacionarlas con procesos de ensamblaje comunitario, productividad y flujo de energía. Para efectos didácticos, los valores aquí mostrados fueron <strong>ajustados y homogenizados</strong> por familia, con fines ilustrativos. En análisis científicos o publicaciones, se recomienda sustituirlos por promedios reales obtenidos directamente de las bases de datos originales, <strong>documentando la fuente y referencia específica para cada especie</strong>.</p>
<blockquote class="blockquote">
<p><strong>Nota:</strong> Los valores de los rasgos funcionales se obtuvieron principalmente de <strong>FishBase</strong> (Froese y Pauly, 2017) y, de forma complementaria, de otras fuentes como <strong>FishTraits</strong> y <strong>FishRasgos</strong>. Los rasgos cuantitativos considerados son: <strong>Longitud corporal promedio</strong> (BodyLength), <strong>Longitud corporal máxima</strong> (BodyLengthMax), <strong>Factor de forma</strong> (ShapeFactor, relación entre longitud total y altura corporal máxima) y <strong>Nivel trófico</strong> (TrophicLevel, posición relativa de la especie en la cadena alimentaria).</p>
<p>Estos atributos describen aspectos morfológicos y ecológicos que permiten interpretar la estructura y el funcionamiento de los ensamblajes de peces. En este ejercicio los valores fueron homogenizados por familia con fines didácticos; para análisis científicos se recomienda emplear promedios reales obtenidos directamente de las bases de datos y <strong>documentar la fuente de cada especie</strong>.</p>
</blockquote>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar datos desde Excel</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer como tibble y convertir a data.frame (para poder usar rownames)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>rasgos <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"rasgos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Usar la primera columna (abreviaturas) como nombres de fila</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># asegurar unicidad/validez</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(rasgos) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(rasgos[[<span class="dv">1</span>]], <span class="at">unique =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># eliminar la columna de abreviaturas</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>rasgos <span class="ot">&lt;-</span> rasgos[ , <span class="sc">-</span><span class="dv">1</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]       </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># str(rasgos)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>rasgos1 <span class="ot">&lt;-</span> rasgos[ , <span class="dv">5</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de la base de datos de rasgos funcionales.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rasgos1, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl2" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;2:  Resumen de la base de datos de rasgos funcionales </caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> TrophicLevel </th>
   <th style="text-align:right;"> BodyLength </th>
   <th style="text-align:right;"> BodyLengthMax </th>
   <th style="text-align:right;"> ShapeFactor </th>
   <th style="text-align:right;"> omnivory </th>
   <th style="text-align:right;"> detritivory </th>
   <th style="text-align:right;"> herbivory </th>
   <th style="text-align:right;"> invertivory </th>
   <th style="text-align:right;"> piscivory </th>
   <th style="text-align:right;"> carnivory </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hyps </td>
   <td style="text-align:right;"> 3.3 </td>
   <td style="text-align:right;"> 227.451 </td>
   <td style="text-align:right;"> 431.7647 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elps </td>
   <td style="text-align:right;"> 3.8 </td>
   <td style="text-align:right;"> 227.451 </td>
   <td style="text-align:right;"> 431.7647 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mgla </td>
   <td style="text-align:right;"> 4.4 </td>
   <td style="text-align:right;"> 227.451 </td>
   <td style="text-align:right;"> 431.7647 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albv </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 227.451 </td>
   <td style="text-align:right;"> 431.7647 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Opcionalmente se pueden guardar los datos de <strong>rasgos1</strong> en un archivo de excel, para tenerlos como referente de comparación con los de <strong>biol1</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Guardar archivo con abreviaturas ---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tibble)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(writexl)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rasgos1a &lt;- </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  rasgos1 %&gt;% </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  as.data.frame() %&gt;% </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  rownames_to_column(var = "Abbrev")  # crea la 1ª columna con las abreviaturas</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(list(rasgoss = rasgos1a), "rasgos1.xlsx")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li><strong>Dataframe de coordenadas de las localidades.</strong> Esta base de datos (<strong>coord</strong>) será utilizada para espacializar y visualizar el patrón de diversidad funcional y filogenética de las especies evaluadas (<strong>?@tbl-tbl3</strong>).</li>
</ol>
<div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>coord <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"coord"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">6</span>,<span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x=</span> Longitude, <span class="at">y=</span> Latitude)   <span class="co"># columnas de coordenadas</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de la base de datos de coordenadas.</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl3" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="Resumen de la base de datos de las coordenadas de las localidades">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
</div>
</div>
<hr>
</section>
<section id="a.-diversidad-funcional-alfa--basada-en-rasgos" class="level3">
<h3 class="anchored" data-anchor-id="a.-diversidad-funcional-alfa--basada-en-rasgos">A. Diversidad funcional alfa- basada en rasgos</h3>
<p>A contiuación se aplica el enfoque conceptual y matemático propuesto por Villéger et al.&nbsp;(2008), utilizando la función <strong><code>functcomp()</code></strong> del paquete <strong>FD</strong>, la cual calcula la <strong>composición funcional de los ensamblajes</strong> a partir de los <strong>promedios ponderados por abundancia de los valores de los rasgos</strong> (<em>Community Weighted Means</em>, CWM). Este procedimiento resume la identidad funcional de cada comunidad, mostrando qué rasgos dominan según la abundancia de las especies presentes.</p>
<p>Esta función permite traducir la matriz de rasgos y la de abundancias en una descripción funcional de los ensamblajes (<a href="#tbl-tbl4">Tabla&nbsp;3</a>), útil para comparar <strong>cómo los valores promedio de los rasgos cambian entre sitios o tratamientos</strong>, y por tanto, <strong>cómo varía su estructura funcional</strong>.</p>
<ul>
<li><p>Para <strong>rasgos continuos</strong>, el CWM corresponde al promedio ponderado del valor del rasgo en cada comunidad, considerando la abundancia relativa de las especies.</p></li>
<li><p>Para <strong>rasgos cualitativos u ordinales</strong> (incluidos los binarios), puede devolver:</p>
<ul>
<li><p>la <strong>clase dominante</strong> del rasgo (<code>CWM.type = "dom"</code>), o</p></li>
<li><p>la <strong>abundancia relativa de cada clase</strong> (<code>CWM.type = "all"</code>).</p></li>
</ul></li>
<li><p>Además, los rasgos binarios pueden tratarse como <strong>numéricos</strong> si se especifica el argumento <code>bin.num = TRUE</code>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular los valores promedio ponderados por abundancia (CWM) de cada rasgo funcional</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># para cada sitio, usando la matriz de rasgos (rasgos1) y la matriz de abundancias (biol1).</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>d.func1 <span class="ot">&lt;-</span> <span class="fu">functcomp</span>(rasgos1, <span class="fu">as.matrix</span>(biol1), <span class="at">CWM.type =</span> <span class="st">"all"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiza las primeras filas del resumen de CWMs en formato de tabla.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d.func1, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl4" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;3:  Valores promedio ponderados por abundancia (CWM) de cada rasgo funcionales </caption>
 <thead>
  <tr>
   <th style="text-align:right;"> TrophicLevel </th>
   <th style="text-align:right;"> BodyLength </th>
   <th style="text-align:right;"> BodyLengthMax </th>
   <th style="text-align:right;"> ShapeFactor </th>
   <th style="text-align:right;"> omnivory_0 </th>
   <th style="text-align:right;"> omnivory_1 </th>
   <th style="text-align:right;"> detritivory_0 </th>
   <th style="text-align:right;"> detritivory_1 </th>
   <th style="text-align:right;"> herbivory_0 </th>
   <th style="text-align:right;"> herbivory_1 </th>
   <th style="text-align:right;"> invertivory_0 </th>
   <th style="text-align:right;"> invertivory_1 </th>
   <th style="text-align:right;"> piscivory_0 </th>
   <th style="text-align:right;"> piscivory_1 </th>
   <th style="text-align:right;"> carnivory_0 </th>
   <th style="text-align:right;"> carnivory_1 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2.63 </td>
   <td style="text-align:right;"> 198.12 </td>
   <td style="text-align:right;"> 385.13 </td>
   <td style="text-align:right;"> 4.86 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 0.17 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 201.08 </td>
   <td style="text-align:right;"> 388.96 </td>
   <td style="text-align:right;"> 4.90 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.54 </td>
   <td style="text-align:right;"> 211.08 </td>
   <td style="text-align:right;"> 403.03 </td>
   <td style="text-align:right;"> 5.33 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.25 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.71 </td>
   <td style="text-align:right;"> 217.05 </td>
   <td style="text-align:right;"> 412.83 </td>
   <td style="text-align:right;"> 5.54 </td>
   <td style="text-align:right;"> 0.94 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>El resultado obtenido con la función <strong><code>functcomp()</code></strong> muestra la <strong>composición funcional promedio ponderada por abundancia (CWM)</strong> de los ensamblajes analizadas. En este caso, los valores continuos —como <strong>NivelTrófico</strong>, <strong>LongitudCorporal</strong>, <strong>LongitudCorporalMáxima</strong> y <strong>FactorForma</strong>— reflejan el valor medio de cada rasgo considerando la contribución proporcional de las especies más abundantes. Por ejemplo, los niveles tróficos cercanos a <strong>2.5–2.7</strong> indican una dominancia de especies <strong>omnivoras e invertívoras</strong>, propias de posiciones intermedias en la red alimentaria. Los valores promedio de <strong>longitud corporal (≈200–220 mm)</strong> y <strong>factor de forma (≈5)</strong> sugieren ensamblajes compuestas por peces de tamaño medio y cuerpo moderadamente alargado.</p>
<p>En cuanto a los <strong>rasgos binarios</strong>, los valores cercanos a <strong>1 o 0</strong> en columnas como <em>omnivory_1</em> o <em>detritivory_1</em> expresan la <strong>proporción de especies con o sin ese tipo de dieta</strong> dentro de cada comunidad. Por ejemplo, <em>omnivory_1 = 0.17</em> indica que solo el 17% de las especies ponderadas por abundancia presentan hábitos omnívoros, mientras el 83% no. En conjunto, este tipo de análisis permite interpretar <strong>qué estrategias funcionales dominan</strong> en cada sitio, evidenciando la estructura trófica y morfológica promedio de los ensamblajes, y proporcionando una base para explorar diferencias funcionales entre zonas o condiciones ambientales.</p>
<hr>
<section id="diversidad-funcional-alfa-con-la-función-dbfd" class="level4">
<h4 class="anchored" data-anchor-id="diversidad-funcional-alfa-con-la-función-dbfd">1) Diversidad funcional alfa con la función dbFD()</h4>
<p>La función <strong><code>dbFD()</code></strong> del paquete <strong>FD</strong> implementa un marco flexible para calcular los <strong>índices de diversidad funcional</strong> más utilizados en ecología, basados en distancias entre especies según sus rasgos (<a href="#tbl-tbl5">Tabla&nbsp;4</a>). Este enfoque permite representar a los ensamblajes dentro de un <strong>espacio multidimensional de rasgos</strong> y cuantificar su <strong>ocupación, uniformidad y divergencia funcional</strong>, integrando tanto la composición como la estructura funcional de los ensamblajes.</p>
<p>En términos prácticos, <code>dbFD()</code> calcula varios índices clave:</p>
<ul>
<li><p><strong>FRic (Riqueza funcional)</strong>: volumen del espacio funcional ocupado por la comunidad (Villéger et al., 2008).</p></li>
<li><p><strong>FEve (Equidad funcional)</strong>: uniformidad en la distribución de las abundancias dentro de ese espacio.</p></li>
<li><p><strong>FDiv (Divergencia funcional)</strong>: grado en que las especies más abundantes ocupan los extremos del espacio funcional.</p></li>
<li><p><strong>FDis (Dispersión funcional)</strong>: distancia media de las especies al centroide funcional, ponderada por abundancia (Laliberté y Legendre, 2010).</p></li>
<li><p><strong>RaoQ (Entropía cuadrática de Rao)</strong>: medida general de diversidad funcional basada en disimilitudes (Botta-Dukát, 2005).</p></li>
<li><p><strong>FGR (Riqueza de grupos funcionales)</strong>: número de grupos definidos a partir de la similitud funcional entre especies (Petchey y Gaston, 2006).</p></li>
<li><p><strong>CWM (Medias ponderadas de rasgos comunitarios)</strong>: valores promedio de los rasgos en cada comunidad, ponderados por la abundancia (Lavorel et al., 2008).</p></li>
</ul>
<p>En su ejecución práctica, el procedimiento combina la <strong>matriz de rasgos funcionales</strong> (<code>rasgos1</code>) con la <strong>matriz de abundancias por sitio</strong> (<code>biol1</code>), estandariza los valores de los rasgos para hacerlos comparables y aplica el método de <strong>agrupamiento jerárquico Ward.D</strong> para calcular distancias entre especies en el espacio funcional. Posteriormente, permite <strong>definir grupos funcionales</strong> a partir del dendrograma generado (por ejemplo, usando <code>g</code> seguido del número de grupos, como <code>10</code>).</p>
<p>El objeto resultante (<code>res</code>) contiene todos los índices calculados (FRic, FEve, FDiv, FDis, RaoQ, CWM, FGR), ofreciendo una descripción completa de la <strong>organización funcional, redundancia ecológica y estructura de rasgos</strong> de los ensamblajes estudiadas. En síntesis, <code>dbFD()</code> constituye una herramienta integral que permite analizar cómo la <strong>diversidad de funciones biológicas</strong> se distribuye en los ecosistemas y cómo responde a los gradientes ambientales o a las perturbaciones ecológicas (<a href="#tbl-tbl5">Tabla&nbsp;4</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de índices de diversidad funcional con dbFD() del paquete FD</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rasgos1 : matriz de rasgos funcionales (filas = especies, columnas = rasgos)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1   : matriz de ensamblajes (filas = sitios, columnas = especies)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           Las especies deben coincidir entre rasgos1 (filas) y biol1 (columnas)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbFD</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  rasgos1, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(biol1),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">asym.bin   =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>,        <span class="co"># definir columnas con rasgos binarios asimétricos</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stand.FRic =</span> <span class="cn">TRUE</span>,        <span class="co"># estandarizar FRic (riqueza funcional) por No especies</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">corr       =</span> <span class="st">"cailliez"</span>,  <span class="co"># aplica corrección para asegurar distancias euclidianas en la PCoA</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">CWM.type   =</span> <span class="st">"all"</span>,       <span class="co"># calcular todas las medias ponderadas por rasgo (CWMs)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">calc.FDiv  =</span> <span class="cn">TRUE</span>,        <span class="co"># incluir el cálculo de Divergencia Funcional (FDiv)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">calc.FGR   =</span> <span class="cn">FALSE</span>,       <span class="co"># no calcula los grupos funcionales (evita interactividad en Quarto)</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages   =</span> <span class="cn">FALSE</span>        <span class="co"># suprimir mensajes durante la ejecución</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo con diversidad funcional- (res$FRic)</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame con los valores de FRic por sitio</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>df_FRic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sitio =</span> <span class="fu">rownames</span>(biol1),</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">FRic  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>FRic)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Combina los índices principales calculados por dbFD()</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>df_FD <span class="ot">&lt;-</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sitio =</span> <span class="fu">rownames</span>(biol1),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">FRic  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>FRic),     <span class="co"># Riqueza funcional</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">FEve  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>FEve),     <span class="co"># Uniformidad funcional</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDiv  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>FDiv),     <span class="co"># Divergencia funcional</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDis  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>FDis),     <span class="co"># Dispersión funcional</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">RaoQ  =</span> <span class="fu">as.numeric</span>(res<span class="sc">$</span>RaoQ)      <span class="co"># Entropía de Rao (opcional)</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar las 8 primeras filas</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>df_FD <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resumen de índices de diversidad funcional por sitio"</span>,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl5" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;4:  Índices de diversidad funcional con dbFD() del paquete FD </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Sitio </th>
   <th style="text-align:right;"> FRic </th>
   <th style="text-align:right;"> FEve </th>
   <th style="text-align:right;"> FDiv </th>
   <th style="text-align:right;"> FDis </th>
   <th style="text-align:right;"> RaoQ </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.48 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 3.65 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 0.78 </td>
   <td style="text-align:right;"> 0.98 </td>
   <td style="text-align:right;"> 1.19 </td>
   <td style="text-align:right;"> 1.49 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:right;"> 3.63 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 1.13 </td>
   <td style="text-align:right;"> 3.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 0.16 </td>
   <td style="text-align:right;"> 0.36 </td>
   <td style="text-align:right;"> 0.76 </td>
   <td style="text-align:right;"> 2.01 </td>
   <td style="text-align:right;"> 6.93 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 0.35 </td>
   <td style="text-align:right;"> 0.70 </td>
   <td style="text-align:right;"> 1.09 </td>
   <td style="text-align:right;"> 2.44 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 7 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 8 </td>
   <td style="text-align:right;"> 0.23 </td>
   <td style="text-align:right;"> 0.35 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 1.46 </td>
   <td style="text-align:right;"> 2.96 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>La <strong>?@tbl-tbl6</strong> muestra una clara variación en los índices de diversidad funcional entre los sitios muestreados. Los valores de <strong>FRic</strong> (riqueza funcional) y <strong>RaoQ</strong> (entropía funcional) evidencian una mayor amplitud del espacio de rasgos en los sitios 5 y 8, mientras que los sitios 1 a 4 presentan valores moderados y el sitio 2 muestra la menor diversidad funcional. La <strong>uniformidad funcional (FEve)</strong> y la <strong>divergencia funcional (FDiv)</strong> indican diferencias en la distribución de las abundancias y en la disposición de las especies dentro del espacio funcional: el sitio 2 destaca por su alta divergencia (0.98), lo que sugiere especies con rasgos muy disímiles, mientras que el sitio 5 muestra menor uniformidad (0.36), reflejando cierta dominancia funcional.</p>
<p>El sitio 7 presenta valores <strong>NA</strong>, señalando que no fue posible definir un volumen funcional por escasa riqueza o redundancia de rasgos, esto ocurre cuando el número de especies presentes en un sitio es <strong>menor o igual al número de rasgos funcionales</strong> utilizados en el análisis, o cuando las especies tienen <strong>rasgos idénticos o muy similares</strong>, lo que impide formar un volumen funcional distinto de cero. En conjunto, estos resultados muestran una estructura funcional heterogénea entre los sitios, con comunidades que varían tanto en amplitud del espacio funcional ocupado como en la distribución y diferenciación de sus rasgos.</p>
<hr>
</section>
<section id="clasificación-de-especies-por-sus-estrategias-funcionales" class="level4">
<h4 class="anchored" data-anchor-id="clasificación-de-especies-por-sus-estrategias-funcionales">2) Clasificación de especies por sus estrategias funcionales</h4>
<p>La estructura del dendrograma que se muestra a continuación en la <a href="#fig-fig1">Figura&nbsp;1</a>, sugiere que <strong>tres grupos funcionales</strong> sintetizan de manera adecuada la diversidad de estrategias presentes en el ensamblaje. Este nivel de agrupamiento permite distinguir grandes conjuntos de especies que probablemente cumplen <strong>roles ecológicos contrastantes</strong> dentro del ecosistema, como depredadores de niveles tróficos altos, especies con hábitos generalistas y especies más asociadas a fondos o recursos detritales.</p>
<p>La elección de tres grupos no obedece solo a un criterio estadístico, sino también a una <strong>decisión ecológica e interpretativa</strong>: resume las principales estrategias de vida sin fragmentar en exceso la información funcional. Así, el dendrograma ofrece una visión clara y equilibrada del espacio de rasgos, mostrando cómo las especies se distribuyen en torno a unos pocos gremios funcionales dominantes. Esta representación constituye un punto de partida sólido para explorar la <strong>redundancia funcional</strong> y el papel que cada grupo desempeña en el mantenimiento de los procesos ecosistémicos.</p>
<div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo manual de los grupos funcionales (FGR) con Ward.D2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># En este paso se agrupan las especies según su similitud funcional</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (utilizando la matriz de disimilitudes de Gower y el método de Ward)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>d_trait <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(rasgos1, <span class="at">asym.bin =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)  <span class="co"># calcula la disimilitud funcional (mezcla de rasgos cuantitativos y binarios)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>hc      <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d_trait, <span class="st">"ward.D2"</span>)   <span class="co"># generar el dendrograma jerárquico con el método de Ward</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>grp     <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k =</span> <span class="dv">3</span>)            <span class="co"># definir tres grupos funcionales (FGR = 3) de forma no interactiva</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl6" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="Grupos funcionales (FGR) con Ward.D2">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
</div>
</div>
<p>La <a href="#fig-fig1">Figura&nbsp;1</a> el dendograma funcional —basado en el método de Ward.D— para la <strong>agrupación jerárquica de las especies según la similitud de sus rasgos funcionales</strong>. En el eje vertical (Distancia funcional) se representa la distancia funcional entre los grupos, de modo que las uniones más bajas indican especies o conjuntos de especies con rasgos más semejantes. Cada bifurcación refleja un nivel de afinidad ecológica, y la altura de los nodos permite identificar los saltos en la disimilitud funcional dentro del ensamblaje.</p>
<p>En este tipo de análisis, el número de grupos funcionales (FGR) no está fijado de antemano, sino que depende del nivel de corte que el investigador elija sobre el dendrograma. Este punto de corte debe equilibrar el detalle biológico con la generalización ecológica: cortes muy bajos generan muchos grupos pequeños con diferencias mínimas entre sí, mientras que cortes muy altos agrupan especies con rasgos funcionales muy distintos, reduciendo la resolución ecológica. En este caso, un <strong>corte en tres grupos</strong> ofrece una síntesis más clara de la estructura funcional del ensamblaje, sin fragmentar excesivamente el patrón general.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paquetes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(FD)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(factoextra)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1) Distancia funcional y clustering jerárquico</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>x.dist <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(rasgos1)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(x.dist, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2) Limpieza de etiquetas</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>hc<span class="sc">$</span>labels <span class="ot">&lt;-</span> hc<span class="sc">$</span>labels <span class="sc">%&gt;%</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3) Número de grupos funcionales</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4) Dendrograma sin rectángulos ni fondo</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  hc,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> k,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.55</span>,                    <span class="co"># tamaño de etiquetas</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fl">0.7</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">k_colors =</span> <span class="fu">brewer.pal</span>(<span class="fu">max</span>(k, <span class="dv">3</span>), <span class="st">"Dark2"</span>),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">rect =</span> <span class="cn">FALSE</span>,                 <span class="co"># &lt;&lt;&lt; SIN RECTÁNGULOS</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">horiz =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Dendrograma funcional de especies"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Distancia funcional (Ward.D2)"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">""</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5) Exportar imagen en alta resolución</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  "dendrograma_funcional_sin_rectangulos.png",</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#  p, wiTDh = 12, height = 9, dpi = 300, bg = "white"</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: Dendograma jerárquico para la clasificación de especies por sus estrategias funcionales</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>La clasificación en tres grupos permite distinguir <strong>tres núcleos funcionales principales</strong> dentro de los ensamblajes. <strong>El primer grupo reúne especies con rasgos morfológicos y tróficos que indican adaptaciones bentónicas o demersales</strong>; el <strong>segundo agrupa especies de hábitos generalistas o intermedios</strong>, con una combinación diversa de tamaños y estrategias tróficas; y <strong>el tercero reúne especies con rasgos especializados</strong>, posiblemente asociadas a estrategias pelágicas o piscívoras. Esta partición simplificada facilita la interpretación ecológica del ensamblaje, evidenciando un gradiente funcional que va desde especies adaptadas a fondos estructurados hasta aquellas con mayor movilidad o amplitud trófica. Por tanto, la estructura con tres grupos no solo reduce la complejidad visual del dendrograma, sino que también resalta los <strong>ejes funcionales dominantes</strong> que sustentan la organización ecológica de la comunidad.</p>
<p>La <a href="#fig-fig2">Figura&nbsp;2</a> corresponde a un <strong>análisis de <em>k</em>-medias (o <em>k-means</em>)</strong> como alternativa no jerárquica al agrupamiento tradicional por dendrogramas. En lugar de construir una estructura arborescente, <strong>este método define directamente el número de grupos (<em>k</em>) y optimiza su conformación en función de la distancia entre las especies en el espacio funcional, buscando minimizar la variabilidad dentro de los grupos y maximizarla entre ellos.</strong> Esta técnica resulta especialmente útil cuando se trabaja con un número elevado de especies, pues evita el exceso de ramificaciones y el solapamiento visual característico de los dendrogramas jerárquicos. Además, al proyectarse sobre los dos primeros ejes del análisis de coordenadas principales (PCoA), ofrece una representación más intuitiva y compacta de la estructura funcional, facilitando la comparación entre grupos ecológicos y su posible relación con gradientes ambientales o espaciales.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paquetes</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(FD)        <span class="co"># gowdis</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ape)       <span class="co"># pcoa</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggrepel)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1) Distancia funcional (Gower) desde rasgos (filas = especies)</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>d_gow <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(rasgos1)  <span class="co"># si tienes ordinales/binarios asimétricos, ajusta args de gowdis()</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2) PCoA con corrección (garantiza euclidianidad)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">pcoa</span>(<span class="fu">as.matrix</span>(d_gow), <span class="at">correction =</span> <span class="st">"cailliez"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">ncol</span>(pc<span class="sc">$</span>vectors) <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># % var. por eje para rótulos</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> pc<span class="sc">$</span>values<span class="sc">$</span>Rel_corr_eig[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> pc<span class="sc">$</span>values<span class="sc">$</span>Rel_corr_eig[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas para graficar (PCoA1-2)</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pc<span class="sc">$</span>vectors[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PCoA1"</span>,<span class="st">"PCoA2"</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>Especie <span class="ot">&lt;-</span> <span class="fu">rownames</span>(X)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Abreviaturas legibles (ajusta minlength si quieres más/menos letras)</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>Abrev <span class="ot">&lt;-</span> <span class="fu">abbreviate</span>(X<span class="sc">$</span>Especie <span class="sc">%&gt;%</span> <span class="fu">str_replace_all</span>(<span class="st">"_"</span>,<span class="st">" "</span>) <span class="sc">%&gt;%</span> <span class="fu">str_squish</span>(),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">minlength =</span> <span class="dv">6</span>, <span class="at">strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3) k-means con k = 3</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(X[, <span class="fu">c</span>(<span class="st">"PCoA1"</span>,<span class="st">"PCoA2"</span>)]), <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">50</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km3<span class="sc">$</span>cluster)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 4) Gráfico único (sin fondo gris, con etiquetas abreviadas y elipses de confianza)</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(X, <span class="fu">aes</span>(PCoA1, PCoA2, <span class="at">color =</span> cluster, <span class="at">label =</span> Abrev)) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewiTDh =</span> <span class="fl">0.7</span>, <span class="at">alpha =</span> <span class="fl">0.12</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.1</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">3.2</span>, <span class="at">max.overlaps =</span> <span class="dv">100</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Clúster k-medias en el espacio funcional (PCoA)"</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PCoA1 ("</span>, var1, <span class="st">"%)"</span>),</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PCoA2 ("</span>, var2, <span class="st">"%)"</span>),</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"cluster"</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background  =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position  =</span> <span class="st">"bottom"</span>,</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 5) Exportar y (opcional) guardar tabla especie→grupo</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("kmeans_funcional_k3_labels.png", p, wiTDh = 10, height = 7, dpi = 300, bg = "white")</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>grupos_k3 <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">select</span>(Especie, Abrev, cluster) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(cluster, Especie)</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(grupos_k3, "grupos_kmeans_k3.csv", row.names = FALSE)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: Dendograma no jerárquico de k-medias para la clasificación de especies por sus estrategias funcionales</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Esta <a href="#fig-fig2">Figura&nbsp;2</a> <strong>muestra la distribución de las especies en el espacio funcional</strong>, donde los tres grupos definidos por <em>k</em>-medias reflejan conjuntos de especies con rasgos similares. Cada clúster agrupa peces que comparten estrategias morfológicas y tróficas, lo que sugiere la existencia de gremios funcionales diferenciados dentro del ensamblaje. Se observa que las especies del <strong>clúster 1 (verde)</strong> ocupan un sector más acotado del espacio, posiblemente asociado a rasgos de tamaño corporal intermedio y hábitos bentónicos; <strong>el clúster 2 (naranja)</strong> presenta mayor dispersión, integrando especies con amplitud trófica o morfologías más variables; mientras que <strong>el</strong> <strong>clúster 3 (violeta)</strong> agrupa un conjunto pequeño y bien delimitado de especies con rasgos especializados. Este patrón indica que la comunidad no está funcionalmente homogénea, sino estructurada en subgrupos que podrían corresponder a distintos tipos de hábitats o estrategias adaptativas, un punto que puede explorarse posteriormente al compararlos con las zonas de muestreo.</p>
<p>El <strong>dendrograma jerárquico y el clúster k-medias</strong> representan dos formas complementarias de explorar la organización funcional de las especies. El <strong>dendrograma jerárquico</strong>, construido con el método de Ward.D2, agrupa las especies en función de su similitud en los rasgos funcionales, permitiendo visualizar las jerarquías y distancias entre ellas. Este análisis es especialmente útil para identificar la estructura general del ensamblaje y decidir un número adecuado de grupos funcionales. En este caso, el corte en <strong>tres grupos principales</strong> reflejó un balance adecuado entre detalle y generalización ecológica.</p>
<p>Por su parte, el <strong>análisis k-medias</strong> utiliza el mismo espacio funcional generado a partir de las distancias de rasgos, pero aplica un enfoque no jerárquico, que optimiza la asignación de las especies en un número fijo de grupos (k = 3) buscando maximizar la homogeneidad interna y la separación entre grupos. A diferencia del dendrograma, que muestra relaciones sucesivas de fusión, el k-medias ofrece una <strong>representación espacial más intuitiva</strong>, facilitando la interpretación de los gradientes funcionales y la visualización de los solapamientos entre gremios.</p>
<hr>
</section>
<section id="clasificación-de-sitios-por-su-diversidad-funcional" class="level4">
<h4 class="anchored" data-anchor-id="clasificación-de-sitios-por-su-diversidad-funcional">3) Clasificación de sitios por su diversidad funcional</h4>
<p>Los mapas que se muestran a continuación (<strong>?@fig-fig3</strong>), representan la <strong>distribución espacial de distintos índices de diversidad funcional</strong> calculados con la función <code>dbFD()</code> del paquete <strong>FD</strong>. Cada círculo corresponde a una localidad o sitio de muestreo, y su tamaño es proporcional al valor del índice funcional mostrado en cada panel. Las figuras permiten visualizar de manera comparativa cómo varía la <strong>riqueza funcional (FRic), la equidad funcional (FEve), la divergencia (FDiv), la dispersión (FDis)</strong>, <strong>la entropía cuadrática de Rao (RaoQ) y la riqueza de grupos funcionales (FGR)</strong> a lo largo del gradiente espacial definido por las coordenadas geográficas. En conjunto, este enfoque integra la información de los rasgos de las especies con su distribución espacial, facilitando la interpretación ecológica de los procesos que estructuran los ensamblajes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>FRic <span class="sc">*</span> <span class="dv">5</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Riqueza Funcional"</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x Coordenadas (km)"</span>, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"y Coordenadas (km)"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>FEve <span class="sc">*</span> <span class="dv">6</span>, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Equidad Funcional"</span>, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Coordenadas x (km)"</span>, </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Coordenadas y (km)"</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>FDiv <span class="sc">*</span> <span class="dv">5</span>, </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Divergencia Funcional"</span>, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Coordenadas x (km)"</span>, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Coordenadas y (km)"</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>FDis <span class="sc">*</span> <span class="fl">1.5</span>, </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Dispersión Funcional"</span>, </span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Coordenadas x (km)"</span>, </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Coordenadas y (km)"</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>RaoQ <span class="sc">/</span> <span class="dv">2</span>, </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Entropía cuadrática de Rao"</span>, </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Coordenadas x (km)"</span>, </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Coordenadas y (km)"</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg =</span> <span class="st">"brown"</span>, </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> res<span class="sc">$</span>FGR <span class="sc">/</span> <span class="dv">2</span>, </span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Riqueza de Grupos Funcionales"</span>, </span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Coordenadas x (km)"</span>, </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Coordenadas y (km)"</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: Mapas de distribución espacial de distintos índices de diversidad funcional - riqueza funcional (FRic), la equidad funcional (FEve), la divergencia (FDiv), la dispersión (FDis), la entropía cuadrática de Rao (RaoQ) y la riqueza de grupos funcionales (FGR)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-fig3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig3-2.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;4: Mapas de distribución espacial de distintos índices de diversidad funcional - riqueza funcional (FRic), la equidad funcional (FEve), la divergencia (FDiv), la dispersión (FDis), la entropía cuadrática de Rao (RaoQ) y la riqueza de grupos funcionales (FGR)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-fig3-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig3-3.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;5: Mapas de distribución espacial de distintos índices de diversidad funcional - riqueza funcional (FRic), la equidad funcional (FEve), la divergencia (FDiv), la dispersión (FDis), la entropía cuadrática de Rao (RaoQ) y la riqueza de grupos funcionales (FGR)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Los patrones observados en las <strong>?@fig-fig3</strong>, indican una notable heterogeneidad funcional entre los sitios. La <strong>riqueza funcional (FRic)</strong> muestra valores altos en zonas puntuales, lo que sugiere que algunos sitios albergan especies con una amplia gama de rasgos ecológicos, posiblemente asociados a hábitats más diversos o menos perturbados. En contraste, la <strong>equidad (FEve)</strong> y la <strong>divergencia funcional (FDiv)</strong> exhiben valores elevados en áreas intermedias del gradiente, donde las especies parecen distribuirse de forma más equilibrada en el espacio de rasgos, evitando la dominancia de un solo tipo funcional.</p>
<p>La <strong>dispersión funcional (FDis)</strong> y la <strong>entropía de Rao (RaoQ)</strong> presentan patrones similares, reflejando la amplitud del espacio funcional ocupado por los ensamblajes y la contribución desigual de las especies a ese espacio. Finalmente, la <strong>riqueza de grupos funcionales (FGR)</strong> se concentra en menos localidades, lo cual sugiere que la redundancia ecológica podría ser baja: pocas especies comparten funciones similares.</p>
<p>En conjunto, estas figuras revelan que la estructura funcional del ensamblaje no es homogénea, sino que varía espacialmente, lo que probablemente refleja diferencias ambientales o de disponibilidad de recursos entre los sitios muestreados.</p>
<hr>
</section>
<section id="relación-entre-la-diversidad-alfa-taxonómica-y-funcional" class="level4">
<h4 class="anchored" data-anchor-id="relación-entre-la-diversidad-alfa-taxonómica-y-funcional">4) Relación entre la diversidad alfa taxonómica y funcional</h4>
<p>A continuación se calcula un conjunto de índices de diversidad alfa a partir de la matriz de abundancia de peces (<code>biol1</code>), integrando medidas tradicionales (taxonómicas) con las de rasgos tróficos o funcionales.</p>
<p>En primer lugar, se estiman índices clásicos de diversidad: la <strong>riqueza de especies (N₀)</strong>, la <strong>diversidad de Shannon (N₁)</strong> y de <strong>Simpson (N₂)</strong>, así como sus respectivas <strong>medidas de equidad</strong> (E₁₀, E₂₀ y J de Pielou). Estas métricas permiten cuantificar el número de especies, la dominancia y la uniformidad en la abundancia de los ensamblajes.</p>
<p>Posteriormente, se incorporan los <strong>índices funcionales</strong> calculados previamente con la función <code>dbFD()</code>: <strong>FRic</strong> (riqueza funcional), <strong>FEve</strong> (equidad funcional), <strong>FDiv</strong> (divergencia funcional), <strong>FDis</strong> (dispersión funcional), <strong>RaoQ</strong> (entropía cuadrática de Rao) y <strong>FGR</strong> (riqueza de grupos funcionales). La integración de todos estos valores en un solo marco de datos (<code>div</code>) permite comparar simultáneamente la diversidad de especies y la diversidad funcional, evidenciando cómo las diferencias en composición y abundancia se traducen en cambios en la estructura funcional de los ensamblajes.</p>
<p>El resumen de la <a href="#tbl-tbl7">Tabla&nbsp;5</a> que se muestra, indica que los sitios difieren tanto en su diversidad taxonómica como funcional. Por ejemplo, el sitio <strong>13M</strong> presenta la mayor <strong>riqueza de especies (N₀ = 9)</strong> y los valores más altos de <strong>diversidad de Shannon (H = 1.70)</strong> y <strong>riqueza funcional (FRic = 0.08)</strong>, lo que sugiere la coexistencia de especies con rasgos variados y potencialmente complementarios. En contraste, el sitio <strong>12M</strong> exhibe una menor riqueza (N₀ = 4), pero una <strong>equidad funcional (FEve = 0.78)</strong> cercana a 1, indicando una distribución más uniforme de los rasgos funcionales entre las especies presentes. La <strong>divergencia funcional (FDiv)</strong> y la <strong>dispersión funcional (FDis)</strong> reflejan una separación moderada en el espacio de rasgos, mientras que la <strong>entropía de Rao (RaoQ)</strong> muestra una tendencia similar a FDis, representando la variabilidad funcional ponderada por abundancia. Finalmente, la <strong>riqueza de grupos funcionales (FGR = 1)</strong> en todos los sitios evidencia que, aunque existen diferencias en diversidad y composición, las especies tienden a concentrarse en un mismo tipo funcional dominante. En conjunto, estos resultados sugieren que <strong>los ensamblajes varían más por la abundancia relativa de las especies que por la aparición de nuevos tipos funcionales, lo que podría reflejar condiciones ambientales similares o una redundancia funcional alta en el sistema.</strong></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de índices de diversidad alfa de los ensamblajes de peces</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(biol1 <span class="sc">&gt;</span> <span class="dv">0</span>)          <span class="co"># Riqueza de especies (conteo de especies presentes)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">specnumber</span>(biol1)           <span class="co"># Riqueza de especies (alternativa con función de vegan)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol1)             <span class="co"># Entropía de Shannon (base e)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Hb2 <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol1, <span class="at">base =</span> <span class="dv">2</span>) <span class="co"># Entropía de Shannon (base 2)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(H)                      <span class="co"># Diversidad de Shannon (base e)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (número efectivo de especies abundantes)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>N1b2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>Hb2                     <span class="co"># Diversidad de Shannon (base 2)</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">diversity</span>(biol1, <span class="st">"inv"</span>)     <span class="co"># Diversidad de Simpson </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (número efectivo de especies dominantes)</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> H <span class="sc">/</span> <span class="fu">log</span>(N0)                  <span class="co"># Equidad de Pielou</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>E10 <span class="ot">&lt;-</span> N1 <span class="sc">/</span> N0                    <span class="co"># Equidad de Shannon (razón de Hill)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>E20 <span class="ot">&lt;-</span> N2 <span class="sc">/</span> N0                    <span class="co"># Equidad de Simpson (razón de Hill)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(N0, H, Hb2, N1, N1b2, N2, E10, E20, J)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar los índices funcionales al data frame 'div'</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>FRic <span class="ot">&lt;-</span> res<span class="sc">$</span>FRic   <span class="co"># Riqueza funcional</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>FEve <span class="ot">&lt;-</span> res<span class="sc">$</span>FEve   <span class="co"># Equidad funcional</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>FDiv <span class="ot">&lt;-</span> res<span class="sc">$</span>FDiv   <span class="co"># Divergencia funcional</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>FDis <span class="ot">&lt;-</span> res<span class="sc">$</span>FDis   <span class="co"># Dispersión funcional</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>RaoQ <span class="ot">&lt;-</span> res<span class="sc">$</span>RaoQ   <span class="co"># Entropía cuadrática de Rao</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>FGR  <span class="ot">&lt;-</span> res<span class="sc">$</span>FGR    <span class="co"># Riqueza de grupos funcionales</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el marco de datos final incluyendo los nombres de los sitios</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>div <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sitios =</span> taxas<span class="sc">$</span>Sites, div)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar las primeras 4 filas de la tabla con formato estético</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(div, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resumen taxonómico y funcional alfa"</span>, </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl7" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;5:  Cálculo de índices de diversidad alfa de los ensamblajes de peces </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Sitios </th>
   <th style="text-align:right;"> N0 </th>
   <th style="text-align:right;"> H </th>
   <th style="text-align:right;"> Hb2 </th>
   <th style="text-align:right;"> N1 </th>
   <th style="text-align:right;"> N1b2 </th>
   <th style="text-align:right;"> N2 </th>
   <th style="text-align:right;"> E10 </th>
   <th style="text-align:right;"> E20 </th>
   <th style="text-align:right;"> J </th>
   <th style="text-align:right;"> FRic </th>
   <th style="text-align:right;"> FEve </th>
   <th style="text-align:right;"> FDiv </th>
   <th style="text-align:right;"> FDis </th>
   <th style="text-align:right;"> RaoQ </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 11M </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 1.48 </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:right;"> 4.41 </td>
   <td style="text-align:right;"> 4.41 </td>
   <td style="text-align:right;"> 3.64 </td>
   <td style="text-align:right;"> 0.73 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.48 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 3.65 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12M </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1.04 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 2.83 </td>
   <td style="text-align:right;"> 2.83 </td>
   <td style="text-align:right;"> 2.48 </td>
   <td style="text-align:right;"> 0.71 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 0.78 </td>
   <td style="text-align:right;"> 0.98 </td>
   <td style="text-align:right;"> 1.19 </td>
   <td style="text-align:right;"> 1.49 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13M </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1.70 </td>
   <td style="text-align:right;"> 2.45 </td>
   <td style="text-align:right;"> 5.47 </td>
   <td style="text-align:right;"> 5.47 </td>
   <td style="text-align:right;"> 4.27 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.47 </td>
   <td style="text-align:right;"> 0.77 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:right;"> 3.63 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14M </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 1.22 </td>
   <td style="text-align:right;"> 1.77 </td>
   <td style="text-align:right;"> 3.40 </td>
   <td style="text-align:right;"> 3.40 </td>
   <td style="text-align:right;"> 2.72 </td>
   <td style="text-align:right;"> 0.57 </td>
   <td style="text-align:right;"> 0.45 </td>
   <td style="text-align:right;"> 0.68 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 1.13 </td>
   <td style="text-align:right;"> 3.11 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar la tabla completa en formato Excel</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(list(rasgoss = div), "div.xlsx")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
<section id="b.-diversidad-beta--taxonómica-funcional-y-filogenética-por-entropía-cuadrática-de-rao" class="level3">
<h3 class="anchored" data-anchor-id="b.-diversidad-beta--taxonómica-funcional-y-filogenética-por-entropía-cuadrática-de-rao">B. Diversidad beta- taxonómica, funcional y filogenética por entropía cuadrática de Rao</h3>
<p>Como ya se exploró en la sesión anterior, según Whittaker (1960), el concepto de <strong>diversidad beta</strong> se refiere a la variación en la composición de especies entre ensamblajes. Esta descomposición aditiva propuesta por De Bello et al.&nbsp;(2010) es considerada un análisis de <strong>diversidad beta</strong> porque su propósito central es separar la diversidad total de una región (γ) en la contribución interna de cada ensamblaje (α) y en el componente restante que surge por diferencias entre ensamblajes (β).</p>
<p>A continuación de propone un marco lógico, de como este nivel ecológico puede abordarse desde distintas facetas de la biodiversidad: <strong>taxonómica</strong> (basada en especies), <strong>funcional</strong> (basada en rasgos) y <strong>filogenética</strong> (basada en relaciones evolutivas). De Bello et al.&nbsp;(2010) propusieron un marco unificado para cuantificar estas tres dimensiones utilizando la <strong>entropía cuadrática de Rao (Q)</strong>, un índice que integra la disimilitud entre pares de especies ponderada por sus abundancias relativas. En términos generales, el índice se expresa como:</p>
<p><span class="math inline">\(Q={\sum}_{i=1}^q{\sum}_{j=1}^q{d}_{ij}{p}_{ic}{p}_{jc}\)</span></p>
<p>donde <span class="math inline">\(d_{ij}\)</span>​ representa la diferencia o distancia funcional, filogenética o taxonómica entre las especies <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span>, mientras que <span class="math inline">\(p_{ic}\)</span>​ y <span class="math inline">\(p_{jc}\)</span>​ son las abundancias relativas de cada especie en la comunidad <span class="math inline">\(C\)</span>. Este enfoque permite extender la idea de diversidad más allá del simple conteo de especies, incorporando información sobre cuán distintas son las especies entre sí en términos funcionales o evolutivos.</p>
<p>Cuando <span class="math inline">\(d_{ij}\)</span>​ se fija en 1 para especies distintas y 0 para idénticas, Q se reduce a la <strong>diversidad de Simpson inversa (N₂)</strong>, es decir, una medida puramente taxonómica. Si las distancias <span class="math inline">\(d_{ij}\)</span>​ provienen de un árbol filogenético, el índice Q representa la <strong>diversidad filogenética</strong>, mientras que si derivan de una matriz de rasgos funcionales, representa la <strong>diversidad funcional</strong>. En ambos casos, el valor de Q captura cuánta diferencia funcional o evolutiva existe dentro de una comunidad y permite comparar la estructura de ensamblajes desde una perspectiva integradora.</p>
<p>El rango de variación de <span class="math inline">\(d_{ij}\)</span>​ (0 a 1) también permite evaluar la <strong>redundancia funcional o filogenética</strong>, comparando el valor de Q con su máximo teórico (cuando todas las especies son completamente diferentes). Esta comparación indica si una comunidad está dominada por especies funcionalmente semejantes o si, por el contrario, las especies ocupan nichos muy diferenciados.</p>
<p>A nivel espacial, la diversidad total puede descomponerse en sus componentes <strong>alfa (interna)</strong> y <strong>beta (entre ensamblajes)</strong>. La propuesta de De Bello et al.&nbsp;(2010) permite realizar esta partición de manera no sesgada mediante la aplicación de equivalentes numéricos, según el enfoque de Jost (2007). De este modo, <strong>la diversidad beta</strong> se interpreta como la parte de la diversidad total que surge de la sustitución de especies y de sus diferencias funcionales o filogenéticas a lo largo del gradiente espacial o ambiental.</p>
<hr>
<p>Durante el proceso, es común que algunas especies no puedan ser localizadas (por ejemplo, aquellas registradas como <em>sp.</em> o <em>spp.</em>). Estas deben eliminarse de las matrices de rasgos y abundancia para asegurar la consistencia de las dimensiones del análisis. A partir de las especies restantes, se construyen las matrices depuradas <code>biol2</code> (abundancias) y <code>tra2</code> (rasgos), que servirán para los cálculos de diversidad beta en sus distintas facetas.</p>
<p>Este enfoque permite, finalmente, evaluar simultáneamente la <strong>variación taxonómica, funcional y filogenética</strong> entre sitios, aportando una visión más completa de los procesos ecológicos que estructuran los ensamblajes, como el recambio de especies, la redundancia funcional o la conservación filogenética de los rasgos. Hay 6 especies no encontradas, a continuación se excluyen de biol1, para poder realizar el siguiente paso:</p>
<hr>
<section id="partición-aditiva-de-la-diversidad-taxonómica-filogenética-y-funcional" class="level4">
<h4 class="anchored" data-anchor-id="partición-aditiva-de-la-diversidad-taxonómica-filogenética-y-funcional">Partición aditiva de la diversidad taxonómica, filogenética y funcional</h4>
<p><em>(De Bello et al.&nbsp;2010; Rao 1982)</em></p>
<p>Esta sección combina de forma integrada las tres dimensiones de la diversidad —taxonómica, filogenética y funcional— utilizando el marco propuesto por <strong>de Bello et al.&nbsp;(2010)</strong>, basado en la entropía cuadrática de <strong>Rao (1982)</strong>. Primero se construye una <strong>matriz de disimilitud funcional</strong> a partir de los rasgos morfológicos y tróficos de las especies mediante el índice de Gower (<code>gowdis()</code>), apropiado cuando se combinan variables cuantitativas y binarias. La partición aditiva de la diversidad permite descomponer la diversidad total en sus componentes <strong>alfa</strong>, <strong>beta</strong> y <strong>gamma</strong>, utilizando la entropía cuadrática de Rao y sus equivalentes numéricos.<br>
En esta sección se muestran los pasos necesarios para preparar las matrices de abundancia, distancia filogenética y distancia funcional, y luego ejecutar la partición aditiva de las tres facetas de la biodiversidad.</p>
</section>
<section id="construcción-de-la-matriz-de-abundancia-biol2" class="level4">
<h4 class="anchored" data-anchor-id="construcción-de-la-matriz-de-abundancia-biol2">1) Construcción de la matriz de abundancia (<code>biol2</code>)</h4>
<p>La <a href="#tbl-tbl8">Tabla&nbsp;6</a> muestra los valores de abundancia y creando una matriz con:</p>
<ul>
<li><p><strong>filas = sitios</strong> y <strong>columnas = especies abreviadas</strong>,</p></li>
<li><p>todos los valores convertidos a numéricos, sin valores faltantes.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la base de datos taxonómica "tax"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>taxas <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># abreviar los nombres de las especies, elimina columnas no necesarias </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>biol1 <span class="ot">&lt;-</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  taxas <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>) <span class="sc">%&gt;%</span>          <span class="co"># excluye 'Sites' y 'Sites1'</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">abbreviate</span>(.x, <span class="at">minlength =</span> <span class="dv">4</span>))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># transformar todos los valores a numéricos sin NA.</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>biol2 <span class="ot">&lt;-</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>biol2 <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl8" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;6:  Resumen de los Valores de abundancia de las especies de peces en cada localidad evaluada </caption>
 <thead>
  <tr>
   <th style="text-align:right;"> Hyps </th>
   <th style="text-align:right;"> Elps </th>
   <th style="text-align:right;"> Mgla </th>
   <th style="text-align:right;"> Albv </th>
   <th style="text-align:right;"> Angr </th>
   <th style="text-align:right;"> Myrp </th>
   <th style="text-align:right;"> Ancm </th>
   <th style="text-align:right;"> Anch </th>
   <th style="text-align:right;"> Brvg </th>
   <th style="text-align:right;"> Brvp </th>
   <th style="text-align:right;"> Drsc </th>
   <th style="text-align:right;"> Drsp </th>
   <th style="text-align:right;"> Hrnj </th>
   <th style="text-align:right;"> Opso </th>
   <th style="text-align:right;"> Cmpa </th>
   <th style="text-align:right;"> Cypl </th>
   <th style="text-align:right;"> Dnde </th>
   <th style="text-align:right;"> Dsp. </th>
   <th style="text-align:right;"> Ntra </th>
   <th style="text-align:right;"> Mxsc </th>
   <th style="text-align:right;"> Astm </th>
   <th style="text-align:right;"> Arpf </th>
   <th style="text-align:right;"> Amrm </th>
   <th style="text-align:right;"> Amrn </th>
   <th style="text-align:right;"> Ictl </th>
   <th style="text-align:right;"> Ictp </th>
   <th style="text-align:right;"> Isp. </th>
   <th style="text-align:right;"> Pylo </th>
   <th style="text-align:right;"> Synf </th>
   <th style="text-align:right;"> Prcp </th>
   <th style="text-align:right;"> Djsm </th>
   <th style="text-align:right;"> Mglc </th>
   <th style="text-align:right;"> Mmbm </th>
   <th style="text-align:right;"> Mndb </th>
   <th style="text-align:right;"> Hmrb </th>
   <th style="text-align:right;"> Strt </th>
   <th style="text-align:right;"> Fndg </th>
   <th style="text-align:right;"> Lcnp </th>
   <th style="text-align:right;"> Gmbsaf </th>
   <th style="text-align:right;"> Gmbsar </th>
   <th style="text-align:right;"> Gmbr </th>
   <th style="text-align:right;"> Gsp. </th>
   <th style="text-align:right;"> Pclf </th>
   <th style="text-align:right;"> Pcll </th>
   <th style="text-align:right;"> Pclm </th>
   <th style="text-align:right;"> Psp. </th>
   <th style="text-align:right;"> Xphv </th>
   <th style="text-align:right;"> Prnr </th>
   <th style="text-align:right;"> Cntu </th>
   <th style="text-align:right;"> Mycb </th>
   <th style="text-align:right;"> Srra </th>
   <th style="text-align:right;"> Lpmm </th>
   <th style="text-align:right;"> Msp. </th>
   <th style="text-align:right;"> Crnc </th>
   <th style="text-align:right;"> Crnh </th>
   <th style="text-align:right;"> Crnl </th>
   <th style="text-align:right;"> Olgs </th>
   <th style="text-align:right;"> Trcc </th>
   <th style="text-align:right;"> Trcf </th>
   <th style="text-align:right;"> Ltjnscm </th>
   <th style="text-align:right;"> Ltjnscy </th>
   <th style="text-align:right;"> Ltjg </th>
   <th style="text-align:right;"> Dpta </th>
   <th style="text-align:right;"> Dptr </th>
   <th style="text-align:right;"> Ecnm </th>
   <th style="text-align:right;"> Grrc </th>
   <th style="text-align:right;"> Anss </th>
   <th style="text-align:right;"> Arcp </th>
   <th style="text-align:right;"> Lgdr </th>
   <th style="text-align:right;"> Aplg </th>
   <th style="text-align:right;"> Brdc </th>
   <th style="text-align:right;"> Brdr </th>
   <th style="text-align:right;"> Cyna </th>
   <th style="text-align:right;"> Cynn </th>
   <th style="text-align:right;"> Lstx </th>
   <th style="text-align:right;"> Mcru </th>
   <th style="text-align:right;"> Pgnc </th>
   <th style="text-align:right;"> Hrcl </th>
   <th style="text-align:right;"> Hrcc </th>
   <th style="text-align:right;"> Orca </th>
   <th style="text-align:right;"> Drmm </th>
   <th style="text-align:right;"> Gbmd </th>
   <th style="text-align:right;"> Gbno </th>
   <th style="text-align:right;"> Scmr </th>
   <th style="text-align:right;"> Etrc </th>
   <th style="text-align:right;"> Achl </th>
   <th style="text-align:right;"> Symc </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 32 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 106 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="preparación-de-la-matriz-de-rasgos-rasgos2" class="level4">
<h4 class="anchored" data-anchor-id="preparación-de-la-matriz-de-rasgos-rasgos2">2) Preparación de la matriz de rasgos (<code>rasgos2</code>)</h4>
<p>Esta <a href="#tbl-tbl9">Tabla&nbsp;7</a> contiene la abreviatura de cada especie y varias características funcionales. En este paso se usa la abreviatura como nombre de fila y se seleccionan las columnas de rasgos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque carga la matriz de rasgos funcionales, </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># asigna las abreviaturas como nombres de fila</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># y selecciona únicamente las columnas correspondientes a los rasgos.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la hoja de rasgos</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>rasgos_raw <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"rasgos"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar abreviaturas como nombres de fila (columna 1 del archivo)</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(rasgos_raw) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(rasgos_raw[[<span class="dv">1</span>]], <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar únicamente las columnas de rasgos (5 a 14)</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>rasgos1 <span class="ot">&lt;-</span> rasgos_raw[, <span class="dv">5</span><span class="sc">:</span><span class="dv">14</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>rasgos1 <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl9" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;7:  Resumen de los rasgos funcionales de las especies de peces en cada localidad evaluada </caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> Guild </th>
   <th style="text-align:right;"> TrophicLevel </th>
   <th style="text-align:right;"> BodyLength </th>
   <th style="text-align:right;"> BodyLengthMax </th>
   <th style="text-align:right;"> ShapeFactor </th>
   <th style="text-align:right;"> omnivory </th>
   <th style="text-align:right;"> detritivory </th>
   <th style="text-align:right;"> herbivory </th>
   <th style="text-align:right;"> invertivory </th>
   <th style="text-align:right;"> piscivory </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hyps </td>
   <td style="text-align:left;"> invertívoro bentónico </td>
   <td style="text-align:right;"> 3.3 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elps </td>
   <td style="text-align:left;"> piscívoro </td>
   <td style="text-align:right;"> 3.8 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mgla </td>
   <td style="text-align:left;"> piscívoro </td>
   <td style="text-align:right;"> 4.4 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albv </td>
   <td style="text-align:left;"> invertívoro </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="identificación-de-especies-problemáticas-mediante-ncbi" class="level4">
<h4 class="anchored" data-anchor-id="identificación-de-especies-problemáticas-mediante-ncbi">3) Identificación de especies problemáticas mediante NCBI</h4>
<p>Los nombres científicos completos (<code>LatinName</code>) se consultan en una base taxonómica (NCBI o GBIF). Las especies que no aparecen —por errores en el nombre o por términos como <em>sp., spp.</em>— deben excluirse para evitar desalineaciones entre abundancias, rasgos y filogenia.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque consulta la clasificación taxonómica en NCBI</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para cada especie del archivo de rasgos, identifica cuáles</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># no fueron encontradas en la base de datos y genera sus</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># abreviaturas para poder excluirlas más adelante.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(taxize)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector de nombres científicos completos</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>splist <span class="ot">&lt;-</span> <span class="fu">as.character</span>(rasgos_raw<span class="sc">$</span>LatinName)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Consultar jerarquía taxonómica en NCBI</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>spcla  <span class="ot">&lt;-</span> <span class="fu">classification</span>(splist, <span class="at">db =</span> <span class="st">"ncbi"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══  87 queries  ══════════════</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Hypanus+sabinus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Elops+saurus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Megalops+atlanticus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Albula+vulpes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Anguilla+rostrata</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Myrophis+punctatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Anchoa+mitchilli</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Anchoa+hepsetus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Brevoortia+gunteri</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Brevoortia+patronus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Dorosoma+cepedianum</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Dorosoma+petenense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Harengula+jaguana</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Opisthonema+oglinum</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Campostoma+anomalum</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Cyprinella+lutrensis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Dionda+episcopa</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Moxostoma+congestum</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Astyanax++mexicanus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Ariopsis+felis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Ameiurus+melas</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Ameiurus+natalis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Ictalurus+lupus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Ictalurus+punctatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Pylodictis+olivaris</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Synodus+foetens</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Porichthys+plectrodon</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Dajaus+monticola</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Mugil+curema</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Membras+martinica</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Menidia+beryllina</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Hemiramphus+brasiliensis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Strongylura+timucu</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Fundulus+grandis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lucania+parva</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gambusia+affinis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gambusia+aurata</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gambusia+regani</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Poecilia+formosa</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Poecilia+latipinna</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Poecilia+mexicana</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Poecilia+sp.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Xiphophorus+variatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Prionotus+rubio</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Centropomus+undecimalis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Mycteroperca+bonaci</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Serranus+atrobranchus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lepomis+macrochirus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Caranx+crysos</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Caranx+hippos</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Caranx+latus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Oligoplites+saurus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Trachinotus+carolinus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Trachinotus+falcatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lutjanus+campechanus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lutjanus+cyanopterus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lutjanus+griseus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Diapterus+auratus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Diapterus+rhombeus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Eucinostomus+melanopterus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gerres+cinereus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Anisotremus+surinamensis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Archosargus+probatocephalus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Lagodon+rhomboides</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Aplodinotus+grunniens</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Bairdiella+chrysoura</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Bairdiella+ronchus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Cynoscion+arenarius</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Cynoscion+nebulosus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Leiostomus+xanthurus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Micropogonias+undulatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Pogonias+cromis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Herichthys+labridens</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Herichthys+cyanoguttatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Oreochromis+aureus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Dormitator+maculatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gobiomorus+dormitor</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Gobionellus+oceanicus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Scomberomorus+regalis</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Etropus+crossotus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Achirus+lineatus</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>✔  Found:  Symphurus+civitatum
══  Results  ═════════════════

• Total: 87 
• Found: 82 
• Not Found: 0</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar especies no encontradas</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>no_encontradas <span class="ot">&lt;-</span> <span class="fu">names</span>(spcla)[</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vapply</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    spcla,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">is.null</span>(x) <span class="sc">||</span> <span class="fu">all</span>(<span class="fu">is.na</span>(x)),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">logical</span>(<span class="dv">1</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Abreviaturas de especies no encontradas</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>no_encontradas_abrev <span class="ot">&lt;-</span> <span class="fu">abbreviate</span>(no_encontradas, <span class="at">minlength =</span> <span class="dv">4</span>)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>no_encontradas_abrev</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Dionda sp. Notropis aguirrepequenoi            Ictalurus sp. 
                  "Dsp."                   "Ntra"                   "Isp." 
            Gambusia sp.         Micropterus spp. 
                  "Gsp."                   "Msp." </code></pre>
</div>
</div>
<hr>
</section>
<section id="exclusión-de-especies-no-encontradas" class="level4">
<h4 class="anchored" data-anchor-id="exclusión-de-especies-no-encontradas">4) Exclusión de especies no encontradas</h4>
<p>Para evitar inconsistencias, las especies identificadas como problemáticas se eliminan de la matriz de abundancias (<code>biol2</code>) y de la matriz de rasgos (<code>rasgos2</code>) (<a href="#tbl-tbl10">Tabla&nbsp;8</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque elimina de ambas matrices (biol2 y rasgos2) las</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># especies que no fueron encontradas en la clasificación NCBI.</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Posteriormente fuerza los valores de abundancia a numéricos</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># y reemplaza cualquier NA por cero para garantizar matrices limpias.</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar abundancias eliminando especies problemáticas</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>biol2 <span class="ot">&lt;-</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  biol1 <span class="sc">%&gt;%</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(no_encontradas_abrev)) <span class="sc">%&gt;%</span>   <span class="co"># remueve columnas (especies) no encontradas</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(.)))) <span class="sc">%&gt;%</span> </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar rasgos eliminando las mismas especies</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>rasgos2 <span class="ot">&lt;-</span> rasgos1[</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span>(<span class="fu">rownames</span>(rasgos1) <span class="sc">%in%</span> no_encontradas_abrev),</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  , drop <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>rasgos2 <span class="sc">%&gt;%</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl10" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;8:  Resumen de los rasgos funcionales sin las especies problemáticas de peces en cada localidad evaluada </caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> Guild </th>
   <th style="text-align:right;"> TrophicLevel </th>
   <th style="text-align:right;"> BodyLength </th>
   <th style="text-align:right;"> BodyLengthMax </th>
   <th style="text-align:right;"> ShapeFactor </th>
   <th style="text-align:right;"> omnivory </th>
   <th style="text-align:right;"> detritivory </th>
   <th style="text-align:right;"> herbivory </th>
   <th style="text-align:right;"> invertivory </th>
   <th style="text-align:right;"> piscivory </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hyps </td>
   <td style="text-align:left;"> invertívoro bentónico </td>
   <td style="text-align:right;"> 3.3 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elps </td>
   <td style="text-align:left;"> piscívoro </td>
   <td style="text-align:right;"> 3.8 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mgla </td>
   <td style="text-align:left;"> piscívoro </td>
   <td style="text-align:right;"> 4.4 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albv </td>
   <td style="text-align:left;"> invertívoro </td>
   <td style="text-align:right;"> 3.2 </td>
   <td style="text-align:right;"> 227.45 </td>
   <td style="text-align:right;"> 431.76 </td>
   <td style="text-align:right;"> 5.73 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="construcción-de-la-matriz-de-distancia-filogenética-phylo.d" class="level4">
<h4 class="anchored" data-anchor-id="construcción-de-la-matriz-de-distancia-filogenética-phylo.d">5) Construcción de la matriz de distancia filogenética (<code>phylo.d</code>)</h4>
<p>A partir de la clasificación taxonómica se genera un árbol filogenético simplificado <a href="#tbl-tbl11">Tabla&nbsp;9</a>. Luego se obtiene la matriz cofenética (distancias entre especies), que se escala y renombra con las abreviaturas finales.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque construye un árbol filogenético simplificado a partir de la</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># clasificación taxonómica (NCBI) y calcula la matriz de distancias</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticas entre especies. Finalmente, reetiqueta filas y columnas </span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># para que coincidan exactamente con los nombres abreviados presentes en biol2.</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Construcción del árbol filogenético simplificado basado en taxize::classification</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> <span class="fu">class2tree</span>(spcla)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancias filogenéticas (cofenética), escalada a ~0–1</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>phylo.d <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(tr<span class="sc">$</span>phylo) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reetiquetar filas y columnas para que coincidan con las especies abreviadas de biol2</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(phylo.d) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(biol2)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(phylo.d) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(biol2)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>phylo.d <span class="sc">%&gt;%</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl11" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;9:  árbol filogenético simplificado a partir de la clasificación taxonómica (NCBI) y calcula la matriz de distancias cofenéticas entre especies. </caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> Hyps </th>
   <th style="text-align:right;"> Elps </th>
   <th style="text-align:right;"> Mgla </th>
   <th style="text-align:right;"> Albv </th>
   <th style="text-align:right;"> Angr </th>
   <th style="text-align:right;"> Myrp </th>
   <th style="text-align:right;"> Ancm </th>
   <th style="text-align:right;"> Anch </th>
   <th style="text-align:right;"> Brvg </th>
   <th style="text-align:right;"> Brvp </th>
   <th style="text-align:right;"> Drsc </th>
   <th style="text-align:right;"> Drsp </th>
   <th style="text-align:right;"> Hrnj </th>
   <th style="text-align:right;"> Opso </th>
   <th style="text-align:right;"> Cmpa </th>
   <th style="text-align:right;"> Cypl </th>
   <th style="text-align:right;"> Dnde </th>
   <th style="text-align:right;"> Mxsc </th>
   <th style="text-align:right;"> Astm </th>
   <th style="text-align:right;"> Arpf </th>
   <th style="text-align:right;"> Amrm </th>
   <th style="text-align:right;"> Amrn </th>
   <th style="text-align:right;"> Ictl </th>
   <th style="text-align:right;"> Ictp </th>
   <th style="text-align:right;"> Pylo </th>
   <th style="text-align:right;"> Synf </th>
   <th style="text-align:right;"> Prcp </th>
   <th style="text-align:right;"> Djsm </th>
   <th style="text-align:right;"> Mglc </th>
   <th style="text-align:right;"> Mmbm </th>
   <th style="text-align:right;"> Mndb </th>
   <th style="text-align:right;"> Hmrb </th>
   <th style="text-align:right;"> Strt </th>
   <th style="text-align:right;"> Fndg </th>
   <th style="text-align:right;"> Lcnp </th>
   <th style="text-align:right;"> Gmbsaf </th>
   <th style="text-align:right;"> Gmbsar </th>
   <th style="text-align:right;"> Gmbr </th>
   <th style="text-align:right;"> Pclf </th>
   <th style="text-align:right;"> Pcll </th>
   <th style="text-align:right;"> Pclm </th>
   <th style="text-align:right;"> Psp. </th>
   <th style="text-align:right;"> Xphv </th>
   <th style="text-align:right;"> Prnr </th>
   <th style="text-align:right;"> Cntu </th>
   <th style="text-align:right;"> Mycb </th>
   <th style="text-align:right;"> Srra </th>
   <th style="text-align:right;"> Lpmm </th>
   <th style="text-align:right;"> Crnc </th>
   <th style="text-align:right;"> Crnh </th>
   <th style="text-align:right;"> Crnl </th>
   <th style="text-align:right;"> Olgs </th>
   <th style="text-align:right;"> Trcc </th>
   <th style="text-align:right;"> Trcf </th>
   <th style="text-align:right;"> Ltjnscm </th>
   <th style="text-align:right;"> Ltjnscy </th>
   <th style="text-align:right;"> Ltjg </th>
   <th style="text-align:right;"> Dpta </th>
   <th style="text-align:right;"> Dptr </th>
   <th style="text-align:right;"> Ecnm </th>
   <th style="text-align:right;"> Grrc </th>
   <th style="text-align:right;"> Anss </th>
   <th style="text-align:right;"> Arcp </th>
   <th style="text-align:right;"> Lgdr </th>
   <th style="text-align:right;"> Aplg </th>
   <th style="text-align:right;"> Brdc </th>
   <th style="text-align:right;"> Brdr </th>
   <th style="text-align:right;"> Cyna </th>
   <th style="text-align:right;"> Cynn </th>
   <th style="text-align:right;"> Lstx </th>
   <th style="text-align:right;"> Mcru </th>
   <th style="text-align:right;"> Pgnc </th>
   <th style="text-align:right;"> Hrcl </th>
   <th style="text-align:right;"> Hrcc </th>
   <th style="text-align:right;"> Orca </th>
   <th style="text-align:right;"> Drmm </th>
   <th style="text-align:right;"> Gbmd </th>
   <th style="text-align:right;"> Gbno </th>
   <th style="text-align:right;"> Scmr </th>
   <th style="text-align:right;"> Etrc </th>
   <th style="text-align:right;"> Achl </th>
   <th style="text-align:right;"> Symc </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Hyps </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Elps </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.27 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mgla </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.27 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albv </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.32 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="cálculo-de-la-disimilitud-funcional-de-gower-rasgos.d" class="level4">
<h4 class="anchored" data-anchor-id="cálculo-de-la-disimilitud-funcional-de-gower-rasgos.d">6) Cálculo de la disimilitud funcional de Gower (<code>rasgos.d</code>)</h4>
<p>La diversidad funcional se basa en diferencias en rasgos. Para combinarlos (continuos y binarios) se usa la distancia de Gower. Las dietas (omnivory, invertivory, etc.) se tratan como variables binarias asimétricas.</p>
<p>La <strong>agrupación jerárquica de Ward.D2</strong>, permite visualizar la similitud funcional entre especies. Con esta base, la función <code>Rao()</code> descompone la diversidad total en sus componentes <strong>alfa, beta y gamma</strong>, calculando los índices equivalentes para las tres facetas: <strong>TD (taxonómica)</strong>, <strong>PD (filogenética)</strong> y <strong>FD (funcional)</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque calcula la matriz de disimilitud funcional basada en la</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distancia de Gower (especies × especies). Se especifican las columnas </span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># binarias que deben tratarse como variables asimétricas (0/1).</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Además, se genera un dendrograma funcional usando el método Ward.D2.</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables binarias presentes en la matriz de rasgos</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>vars_bin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"omnivory"</span>,<span class="st">"detritivory"</span>,<span class="st">"herbivory"</span>,</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">"invertivory"</span>,<span class="st">"piscivory"</span>)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificar su posición por índice dentro de rasgos2</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>asym_idx <span class="ot">&lt;-</span> <span class="fu">match</span>(vars_bin, <span class="fu">colnames</span>(rasgos2))</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de disimilitud funcional según Gower</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>rasgos.d <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(rasgos2, <span class="at">asym.bin =</span> asym_idx)</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendrograma funcional basado en la matriz anterior</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>rasgos.gw <span class="ot">&lt;-</span> <span class="fu">hclust</span>(rasgos.d, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="partición-aditiva-de-la-diversidad-td-pd-fd" class="level4">
<h4 class="anchored" data-anchor-id="partición-aditiva-de-la-diversidad-td-pd-fd">7) Partición aditiva de la diversidad (TD, PD, FD)</h4>
<p>Finalmente se utiliza la función <strong>Rao</strong> (De Bello et al.&nbsp;2010) para estimar:</p>
<ul>
<li><p><strong>diversidad taxonómica</strong> (TD),</p></li>
<li><p><strong>diversidad filogenética</strong> (PD),</p></li>
<li><p><strong>diversidad funcional</strong> (FD).</p></li>
</ul>
<p>Cada una se descompone en alfa, beta y gamma.</p>
<p>La función <strong><code>Rao()</code></strong>, es tomada de Borcard et al.&nbsp;(2018) y permite estimar y descomponer la diversidad ecológica en sus tres principales dimensiones: <strong>taxonómica (TD)</strong>, <strong>filogenética (PD)</strong> y <strong>funcional (FD)</strong> (<a href="#tbl-tbl12">Tabla&nbsp;10</a>). Basada en la <em>entropía cuadrática de Rao</em> (Rao, 1982), esta función cuantifica la diversidad considerando simultáneamente la abundancia de las especies y sus diferencias (ya sean en identidad, parentesco o rasgos ecológicos). Su estructura integra los algoritmos de <em>Villeger y Mouillot (2008)</em> para la descomposición de la varianza (diversidad alfa, beta y gamma) y de <em>Pavoine (ade4)</em> para el cálculo de distancias. En la práctica, <code>Rao()</code> evalúa la diversidad promedio local (<strong>α</strong>), la diversidad total regional (<strong>γ</strong>) y la proporción de recambio o diferenciación entre ensamblajes (<strong>β</strong>), expresada tanto de forma aditiva (γ − α) como multiplicativa (γ / α). Al incorporar matrices de disimilitud funcional y filogenética, el índice amplía el enfoque clásico basado solo en especies, permitiendo analizar cómo los ensamblajes de peces se estructuran no solo por el número de especies, sino también por su parentesco evolutivo y sus estrategias ecológicas.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad particionada aditiva (taxonómica, filogenética y funcional)</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Este bloque ejecuta la partición aditiva de la diversidad </span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># taxonómica (TD), funcional (FD) y filogenética (PD) utilizando </span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># la función Rao() (De Bello et al. 2010). </span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Se emplean las tres matrices previamente alineadas:</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  - biol2  → abundancias (especies × sitios)</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  - rasgos.d → disimilitud funcional (Gower)</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  - phylo.d  → disimilitud filogenética (cofenética).</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Los valores de alpha-diversidad obtenidos para TD, PD y FD </span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># se incorporan al data frame “div” para su análisis y graficación.</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Rao.R"</span>)   <span class="co"># función proporcionada en el capítulo</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>biol1.rao <span class="ot">&lt;-</span> <span class="fu">Rao</span>(</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">t</span>(biol2),   <span class="co"># especies en columnas (se requiere trasponer)</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">dfunc  =</span> rasgos.d,   <span class="co"># matriz funcional (Gower)</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">dphyl  =</span> phylo.d,    <span class="co"># matriz filogenética (cofenética normalizada)</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="cn">FALSE</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Jost   =</span> <span class="cn">TRUE</span>        <span class="co"># aplica corrección de Jost (2007)</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accesos típicos:</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$TD$Gamma; biol1.rao$TD$Mean_Alpha; biol1.rao$TD$Beta_add; biol1.rao$TD$Beta_prop</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$FD$... (si dfunc no es NULL)</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$PD$... (si dphyl no es NULL)</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame con los índices de diversidad</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>div_resumen <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sitio   =</span> <span class="fu">rownames</span>(biol1),</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">alfaTD =</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Alpha,</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">alfaPD =</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Alpha,</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">alfaFD =</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Alpha</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla con formato</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>div_resumen <span class="sc">%&gt;%</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Resumen de índices de diversidad taxonómica (TD), filogenética (PD) y funcional (FD)"</span>,</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">FALSE</span>,</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">longtable =</span> <span class="cn">TRUE</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl12" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;10:  Resumen de la diversidad taxonómica, funcional y filogenética. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Sitio </th>
   <th style="text-align:right;"> alfaTD </th>
   <th style="text-align:right;"> alfaPD </th>
   <th style="text-align:right;"> alfaFD </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 3.241 </td>
   <td style="text-align:right;"> 1.850 </td>
   <td style="text-align:right;"> 1.275 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1.373 </td>
   <td style="text-align:right;"> 1.152 </td>
   <td style="text-align:right;"> 1.075 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 3.269 </td>
   <td style="text-align:right;"> 1.705 </td>
   <td style="text-align:right;"> 1.292 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 2.331 </td>
   <td style="text-align:right;"> 1.654 </td>
   <td style="text-align:right;"> 1.171 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:right;"> 3.756 </td>
   <td style="text-align:right;"> 1.829 </td>
   <td style="text-align:right;"> 1.260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:right;"> 2.517 </td>
   <td style="text-align:right;"> 1.765 </td>
   <td style="text-align:right;"> 1.186 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="recomendaciones-para-garantizar-la-replicabilidad-del-análisis-de-diversidad-beta-de-bello-et-al.-2010" class="level4">
<h4 class="anchored" data-anchor-id="recomendaciones-para-garantizar-la-replicabilidad-del-análisis-de-diversidad-beta-de-bello-et-al.-2010">Recomendaciones para garantizar la replicabilidad del análisis de diversidad beta (De Bello et al.&nbsp;2010)</h4>
<p>El cálculo de la diversidad taxonómica, funcional y filogenética mediante el índice de Rao exige que <strong>las tres fuentes de información —abundancias, rasgos y filogenia— contengan exactamente las mismas especies y sin inconsistencias en los nombres</strong>. Si esta regla se cumple, el procedimiento funciona siempre. Estas son las condiciones que el usuario debe verificar antes de ejecutar los bloques del código.</p>
<section id="hoja-de-abundancias-tax" class="level5">
<h5 class="anchored" data-anchor-id="hoja-de-abundancias-tax">1. Hoja de abundancias (<code>tax</code>)</h5>
<ul>
<li><p>Debe tener esta estructura en las columnas:<br>
<strong>Sites | Sites1 | especie1 | especie2 | …</strong></p></li>
<li><p>Los nombres de las columnas de especies deben ser válidos y consistentes (sin tildes, sin caracteres especiales). No debe haber valores NA.</p></li>
<li><p>No deben aparecer especies etiquetadas como <em>sp.</em>, <em>spp.</em>, <em>cf.</em>, <em>aff.</em>, etc.</p></li>
<li><p>Todas las abundancias deben ser <strong>numéricas</strong> (≥ 0), sin NA, sin caracteres extraños.</p></li>
</ul>
</section>
<section id="hoja-de-rasgos-rasgos" class="level5">
<h5 class="anchored" data-anchor-id="hoja-de-rasgos-rasgos">2. Hoja de rasgos (<code>rasgos</code>)</h5>
<p>Debe contener como mínimo estas columnas:</p>
<ul>
<li><p><strong>LatinName</strong>: nombre científico <strong>exactamente igual</strong> al usado en <code>tax</code>.</p></li>
<li><p><strong>Rasgos continuos</strong>: numéricos (ej. <em>TrophicLevel</em>, <em>BodyLength</em>, <em>ShapeFactor</em>).</p></li>
<li><p><strong>Rasgos binarios</strong>: exclusivamente <strong>0 y 1</strong> (omnivory, piscivory, etc.).</p></li>
</ul>
<p><strong>Regla clave:</strong> no deben existir NA en las columnas usadas para calcular Gower.</p>
</section>
<section id="árbol-filogenético-arbol_filo_alfa.rds" class="level5">
<h5 class="anchored" data-anchor-id="árbol-filogenético-arbol_filo_alfa.rds">3. Árbol filogenético (<code>arbol_filo_alfa.rds</code>)</h5>
<ul>
<li>Debe ser un objeto <strong>phylo</strong> con tip.label = nombres científicos.</li>
</ul>
<!-- -->
<ul>
<li>Los nombres de las puntas deben coincidir exactamente con <strong>LatinName</strong>.</li>
</ul>
<!-- -->
<ul>
<li>El árbol <strong>no debe incluir especies ambiguas</strong> (sp., spp., nombres incompletos).</li>
</ul>
<!-- -->
<ul>
<li>Su estructura queda fija: el usuario solo lo carga; no necesita generarlo.</li>
</ul>
</section>
<section id="consistencia-entre-las-tres-fuentes-de-datos" class="level5">
<h5 class="anchored" data-anchor-id="consistencia-entre-las-tres-fuentes-de-datos">4. Consistencia entre las tres fuentes de datos</h5>
<p>Antes de correr Rao, debe cumplirse:</p>
<ul>
<li><p><strong>Las especies de <code>tax</code>, de <code>rasgos</code> y del árbol deben coincidir.</strong><br>
Si una especie no aparece en las tres, quedará <strong>excluida automáticamente</strong>.</p></li>
<li><p>Los nombres deben estar escritos de manera estándar:</p>
<ul>
<li>mismos espacios, sin acentos, sin caracteres especiales.</li>
</ul></li>
</ul>
</section>
<section id="qué-revisar-si-algo-falla" class="level5">
<h5 class="anchored" data-anchor-id="qué-revisar-si-algo-falla">5. Qué revisar si algo falla</h5>
<p>Si el proceso arroja advertencias o detiene la ejecución, casi siempre se debe a:</p>
<ul>
<li><p>Rasgos binarios con valores diferentes de 0/1.</p></li>
<li><p>Nombres científicos mal escritos o parcialmente escritos.</p></li>
<li><p>Especies presentes en tax pero ausentes en rasgos o en el árbol.</p></li>
<li><p>NA en columnas numéricas de rasgos.</p></li>
<li><p>Columnas de abundancia que contienen caracteres no numéricos.</p></li>
</ul>
</section>
<section id="reglas-cortas-para-el-usuario" class="level5">
<h5 class="anchored" data-anchor-id="reglas-cortas-para-el-usuario">6. Reglas cortas para el usuario</h5>
<ul>
<li><p>No incluya especies sin identificación completa.</p></li>
<li><p>Asegurar que <strong>LatinName</strong> = nombre de las columnas de abundancia.</p></li>
<li><p>Los <strong>rasgos</strong> deben ser numéricos o 0/1, sin excepción.</p></li>
<li><p><strong>El árbol</strong> debe contener las mismas especies que aparece en <code>tax</code> y <code>rasgos</code>.</p></li>
<li><p>Evitar tildes, caracteres especiales y espacios dobles.</p></li>
</ul>
<p>En la base de datos utilizada en esta sección, surgieron varias situaciones frecuentes en estudios ecológicos que justificaron ajustes antes de aplicar la partición aditiva.</p>
<ul>
<li><p>Algunas especies presentaban nombres incompletos o ambiguos (por ejemplo, <em>sp.</em>, <em>spp.</em>, abreviaciones no estandarizadas o nombres con caracteres especiales), lo que impedía su reconocimiento tanto por la matriz de rasgos como por el árbol filogenético.</p></li>
<li><p>Algunos rasgos funcionales contenían valores no numéricos o inconsistentes, en especial en columnas binarias que deben estar codificadas estrictamente como 0 y 1 para que el cálculo de distancias de Gower sea válido.</p></li>
<li><p>Se detectaron especies presentes en las abundancias pero ausentes en el árbol o en la tabla de rasgos, lo que obliga a excluirlas para garantizar la alineación exacta entre las tres fuentes de información requeridas por el índice de Rao.</p></li>
</ul>
<p>Todas estas inconsistencias se mantuvieron deliberadamente en el material didáctico para ilustrar problemas comunes en bases ecológicas reales y mostrar paso a paso cómo identificarlos y corregirlos mediante filtrado, estandarización de nombres y depuración de rasgos, garantizando así un análisis replicable y robusto.</p>
<hr>
</section>
</section>
<section id="tabulación-y-visualización-de-la-diversidad-con-partición-aditiva" class="level4">
<h4 class="anchored" data-anchor-id="tabulación-y-visualización-de-la-diversidad-con-partición-aditiva">8) Tabulación y visualización de la diversidad con partición aditiva</h4>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de los componentes devueltos por la función Rao()</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(biol1.rao)</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad de especies (índices de Simpson)</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># names(biol1.rao$TD)               # lista de componentes dentro de TD</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad alfa media de Simpson (diversidad promedio dentro de los ensamblajes)</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Mean_Alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.597088</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad gamma de Simpson (diversidad total del conjunto de ensamblajes)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Gamma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.628374</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta aditiva (diferencia entre gamma y alfa)</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Beta_add</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.031286</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprobación alternativa de la partición aditiva</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Gamma <span class="sc">-</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Mean_Alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.031286</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta expresada como porcentaje de la diversidad gamma</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Beta_prop</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.81863</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo equivalente de la proporción beta/gamma</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Beta_add <span class="sc">/</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Gamma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6081863</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta multiplicativa (razón entre gamma y alfa)</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Gamma <span class="sc">/</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Mean_Alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.552233</code></pre>
</div>
</div>
<p>Los resultados obtenidos muestran que la <strong>diversidad alfa taxonómica (αTD)</strong> tiene valores medios más altos que la <strong>filogenética (αPD)</strong> y la <strong>funcional (αFD)</strong>, lo que indica que aunque los ensamblajes albergan un número razonable de especies, estas comparten proximidad evolutiva y rasgos similares (<a href="#tbl-tbl13">Tabla&nbsp;11</a>). Por ejemplo, en los primeros sitios, αTD ≈ 3.2 contrasta con αFD ≈ 1.1, reflejando <strong>redundancia funcional</strong>: varias especies ocupan roles ecológicos parecidos. Este patrón sugiere que la pérdida de algunas especies no modificaría drásticamente las funciones ecosistémicas, pero sí podría afectar la diversidad taxonómica o la estructura filogenética. En conjunto, este análisis evidencia cómo las tres facetas de la diversidad proporcionan una visión complementaria del ensamblaje, enriqueciendo la interpretación ecológica más allá del simple conteo de especies.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad filogenética (índice de Rao)</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(biol1.rao$PD)  # lista de insumos para diversidad filogenética</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad alfa media de Rao (filogenética)</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Mean_Alpha</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad gamma de Rao (filogenética)</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Gamma</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta aditiva de Rao (filogenética)</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Beta_add</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación alternativa del cálculo aditivo (gamma – alfa)</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Gamma <span class="sc">-</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Mean_Alpha</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta filogenética expresada como porcentaje de la diversidad gamma</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Beta_prop</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo equivalente de la proporción beta/gamma</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Beta_add <span class="sc">/</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Gamma</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta multiplicativa de Rao (filogenética)</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Gamma <span class="sc">/</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Mean_Alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad funcional (índice de Rao)</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co"># names(biol1.rao$FD)  # lista de insumos para la diversidad funcional</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad alfa media de Rao (funcional)</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Mean_Alpha</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad gamma de Rao (funcional)</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Gamma</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta aditiva de Rao (funcional)</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Beta_add</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación alternativa del cálculo (gamma – alfa)</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Gamma <span class="sc">-</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Mean_Alpha</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta funcional expresada como porcentaje de la diversidad gamma</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Beta_prop</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo equivalente de la proporción beta/gamma</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Beta_add <span class="sc">/</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Gamma</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad beta multiplicativa de Rao (funcional)</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Gamma <span class="sc">/</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Mean_Alpha</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Variación de las diversidades alfa (taxonómica, filogenética y funcional)</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a><span class="co"># a lo largo del gradiente espacial (p. ej. el río Doubs o sitios de muestreo).</span></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$TD$Alpha  # diversidad alfa taxonómica</span></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$PD$Alpha  # diversidad alfa filogenética</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="co"># biol1.rao$FD$Alpha  # diversidad alfa funcional</span></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorporar los índices de diversidad basados en Rao al marco de datos “div”</span></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>alfaTD <span class="ot">&lt;-</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Alpha</span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>alfaPD <span class="ot">&lt;-</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Alpha</span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>div<span class="sc">$</span>alfaFD <span class="ot">&lt;-</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Alpha</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar las primeras filas de la tabla de diversidad</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluye los índices tradicionales (Shannon, Simpson) y los derivados de Rao (TD, PD, FD).</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(div, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">longtable =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl13" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;11:  Resumen de la diversidad taxonómica, funcional y filogenética. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Sitios </th>
   <th style="text-align:right;"> N0 </th>
   <th style="text-align:right;"> H </th>
   <th style="text-align:right;"> Hb2 </th>
   <th style="text-align:right;"> N1 </th>
   <th style="text-align:right;"> N1b2 </th>
   <th style="text-align:right;"> N2 </th>
   <th style="text-align:right;"> E10 </th>
   <th style="text-align:right;"> E20 </th>
   <th style="text-align:right;"> J </th>
   <th style="text-align:right;"> FRic </th>
   <th style="text-align:right;"> FEve </th>
   <th style="text-align:right;"> FDiv </th>
   <th style="text-align:right;"> FDis </th>
   <th style="text-align:right;"> RaoQ </th>
   <th style="text-align:right;"> alfaTD </th>
   <th style="text-align:right;"> alfaPD </th>
   <th style="text-align:right;"> alfaFD </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 11M </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 1.48 </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:right;"> 4.41 </td>
   <td style="text-align:right;"> 4.41 </td>
   <td style="text-align:right;"> 3.64 </td>
   <td style="text-align:right;"> 0.73 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.48 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 3.65 </td>
   <td style="text-align:right;"> 3.24 </td>
   <td style="text-align:right;"> 1.85 </td>
   <td style="text-align:right;"> 1.28 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12M </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1.04 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 2.83 </td>
   <td style="text-align:right;"> 2.83 </td>
   <td style="text-align:right;"> 2.48 </td>
   <td style="text-align:right;"> 0.71 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 0.78 </td>
   <td style="text-align:right;"> 0.98 </td>
   <td style="text-align:right;"> 1.19 </td>
   <td style="text-align:right;"> 1.49 </td>
   <td style="text-align:right;"> 1.37 </td>
   <td style="text-align:right;"> 1.15 </td>
   <td style="text-align:right;"> 1.07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13M </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1.70 </td>
   <td style="text-align:right;"> 2.45 </td>
   <td style="text-align:right;"> 5.47 </td>
   <td style="text-align:right;"> 5.47 </td>
   <td style="text-align:right;"> 4.27 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.47 </td>
   <td style="text-align:right;"> 0.77 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 1.64 </td>
   <td style="text-align:right;"> 3.63 </td>
   <td style="text-align:right;"> 3.27 </td>
   <td style="text-align:right;"> 1.71 </td>
   <td style="text-align:right;"> 1.29 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14M </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 1.22 </td>
   <td style="text-align:right;"> 1.77 </td>
   <td style="text-align:right;"> 3.40 </td>
   <td style="text-align:right;"> 3.40 </td>
   <td style="text-align:right;"> 2.72 </td>
   <td style="text-align:right;"> 0.57 </td>
   <td style="text-align:right;"> 0.45 </td>
   <td style="text-align:right;"> 0.68 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 0.83 </td>
   <td style="text-align:right;"> 1.13 </td>
   <td style="text-align:right;"> 3.11 </td>
   <td style="text-align:right;"> 2.33 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 1.17 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar la tabla de diversidad en un archivo Excel (opcional)</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write_xlsx(list(rasgoss = div), "div.xlsx")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>El mapa comparativo de las tres facetas de la diversidad —<strong>taxonómica, filogenética y funcional</strong>— complementa los valores tabulados y permite visualizar su distribución espacial a lo largo del gradiente analizado. La <strong>diversidad taxonómica</strong> (arriba izquierda) muestra una mayor variación entre sitios, con algunos puntos que concentran un número relativamente alto de especies, reflejando diferencias locales en la riqueza específica. En contraste, la <strong>diversidad filogenética</strong> (arriba derecha) presenta una distribución más homogénea, lo que sugiere que, aunque cambie el número de especies entre sitios, muchas de ellas pertenecen a linajes cercanos o comparten historia evolutiva reciente. Finalmente, la <strong>diversidad funcional</strong> (abajo) evidencia un patrón intermedio: los sitios con mayor abundancia de especies no siempre presentan mayor diversidad de funciones, lo que indica la presencia de redundancia funcional. En conjunto, el gráfico revela que las tres dimensiones de la diversidad no varían de forma paralela, destacando la importancia de analizarlas simultáneamente para entender cómo la estructura de los ensamblajes de peces refleja tanto su historia evolutiva como la diversidad de estrategias ecológicas presentes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg  =</span> <span class="st">"brown"</span>, </span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> biol1.rao<span class="sc">$</span>TD<span class="sc">$</span>Alpha <span class="sc">/</span> <span class="dv">4</span>, </span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Diversidad Taxonómica"</span>, </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x Coordenadas (km)"</span>, </span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"y Coordenadas (km)"</span>)</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg  =</span> <span class="st">"brown"</span>, </span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> biol1.rao<span class="sc">$</span>PD<span class="sc">$</span>Alpha <span class="sc">*</span> <span class="fl">1.5</span>, </span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Diversidad Filogenética"</span>, </span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x Coordenadas (km)"</span>, </span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"y Coordenadas (km)"</span>)</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coord, </span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">asp =</span> <span class="dv">1</span>, </span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">21</span>, </span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">bg  =</span> <span class="st">"brown"</span>, </span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> biol1.rao<span class="sc">$</span>FD<span class="sc">$</span>Alpha <span class="sc">*</span> <span class="fl">2.5</span>, </span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Diversidad Funcional"</span>, </span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x Coordenadas (km)"</span>, </span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"y Coordenadas (km)"</span>)</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(coord, <span class="at">col =</span> <span class="st">"light blue"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig4-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;6: Mapas de distribución espacial de distintos índices de diversidad taxnòmica, funcional y filogenètica</figcaption><p></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="c.-diversidad-taxonómica-funcional-y-filogenética-con-números-efectivos-q-0-1-y-2" class="level3">
<h3 class="anchored" data-anchor-id="c.-diversidad-taxonómica-funcional-y-filogenética-con-números-efectivos-q-0-1-y-2">C. Diversidad taxonómica, funcional y filogenética con números efectivos q = 0, 1 y 2</h3>
<p>La cuantificación contemporánea de la biodiversidad reconoce que los ensamblajes poseen <strong>múltiples dimensiones interrelacionadas</strong>: una <strong>taxonómica (TD)</strong>, centrada en las especies y sus abundancias; una <strong>filogenética (PD)</strong>, que incorpora la historia evolutiva de los linajes y una <strong>funcional (FD)</strong>, basada en los rasgos ecológicos que determinan cómo las especies interactúan con su ambiente y entre sí. Históricamente, cada una de estas dimensiones se abordó mediante enfoques independientes que, aunque robustos, adolecían de una falta de comparabilidad y de control estadístico del esfuerzo de muestreo.</p>
<section id="enfoques-previos-estructura-y-partición-de-la-diversidad" class="level5">
<h5 class="anchored" data-anchor-id="enfoques-previos-estructura-y-partición-de-la-diversidad">Enfoques previos: estructura y partición de la diversidad</h5>
<ol type="1">
<li><p><strong>Villéger et al.&nbsp;(2008)</strong> desarrollaron un marco para evaluar la <strong>diversidad funcional alfa</strong> dentro de comunidades, basado en la geometría del espacio de rasgos. Este enfoque caracteriza la <strong>estructura interna del espacio funcional</strong> mediante índices como <strong>FRic</strong> (riqueza funcional), <strong>FEve</strong> (equidad funcional) y <strong>FDiv</strong> (divergencia funcional), que describen cómo las especies ocupan, equilibran o polarizan el espacio multidimensional definido por sus rasgos ecológicos.</p></li>
<li><p><strong>De Bello et al.&nbsp;(2010)</strong> propusieron la <strong>partición aditiva de la diversidad taxonómica, funcional y filogenética</strong>, fundamentada en la <strong>entropía cuadrática de Rao (Q)</strong>. Este método permite descomponer la diversidad total en sus componentes <strong>α (local)</strong>, <strong>β (recambio)</strong> y <strong>γ (regional)</strong>, incorporando matrices de abundancia y matrices de distancia funcional o filogenética. De este modo, se evalúa la contribución relativa de cada ensamblaje local a la diversidad regional total.</p></li>
</ol>
<p>Ambos métodos representan avances sustanciales en la descripción de la estructura y la variación de la biodiversidad. Sin embargo, <strong>comparten una limitación crítica</strong>: dependen directamente del número de individuos muestreados, de las especies detectadas y de la completitud de los rasgos o del árbol filogenético, <strong>sin incluir un marco de estandarización estadística</strong> que permita comparar comunidades con distinto esfuerzo de muestreo o cobertura.</p>
</section>
<section id="el-marco-unificado-de-chao-et-al.-2021-2023-integración-y-estandarización" class="level5">
<h5 class="anchored" data-anchor-id="el-marco-unificado-de-chao-et-al.-2021-2023-integración-y-estandarización">El marco unificado de Chao et al.&nbsp;(2021, 2023): integración y estandarización</h5>
<p>Para superar estas limitaciones, <strong>Chao et al.&nbsp;(2021)</strong> desarrollaron el marco <strong>iNEXT3D</strong> (<em>interpolation and extrapolation for three dimensions of diversity</em>), que unifica las tres dimensiones —TD, PD y FD— bajo una <strong>formulación común basada en los números de Hill</strong> y la <strong>estandarización por cobertura muestral</strong>. A diferencia de los enfoques previos, este modelo:</p>
<ul>
<li><p>integra simultáneamente <strong>matrices de abundancia</strong> y <strong>matrices de distancia funcional o filogenética</strong>,</p></li>
<li><p>y ajusta las estimaciones de diversidad mediante <strong>rarefacción y extrapolación</strong>, de modo que la comparación entre comunidades se realiza bajo el <strong>mismo nivel de completitud muestral</strong>.</p></li>
</ul>
<p>En este marco:</p>
<ul>
<li><p><strong>TD</strong> representa el número efectivo de especies igualmente abundantes,</p></li>
<li><p><strong>PD</strong> expresa la longitud efectiva de ramas evolutivas igualmente divergentes,</p></li>
<li><p><strong>FD</strong> cuantifica el número efectivo de grupos funcionales igualmente distintos, a partir de la <strong>matriz de distancias funcionales derivada de rasgos estandarizados</strong>.</p></li>
</ul>
<p>Así, <strong>iNEXT3D</strong> con un enfoque de <strong>diversidad alfa</strong> (Chao el al.&nbsp;2023) proporciona estimaciones coherentes entre dimensiones ecológicas que antes eran difíciles de comparar. Posteriormente, <strong>Chao el al.&nbsp;(2023)</strong> extendió este enfoque al análisis de <strong>diversidad beta (iNEXTbeta3D)</strong>, combinando la descomposición multiplicativa clásica de Whittaker (1960) con los números de Hill.<br>
En este modelo, <strong>β = γ / α</strong>, pero tanto la diversidad local (α) como la regional (γ) se ajustan al mismo nivel de cobertura, haciendo que la diversidad beta resultante sea <strong>independiente del tamaño de muestra o de la riqueza regional</strong>, y refleje únicamente <strong>la diferenciación composicional real</strong> entre comunidades.</p>
<p>En resumen, mientras que:</p>
<ul>
<li><p><strong>Villéger et al.&nbsp;(2008)</strong> y <strong>De Bello et al.&nbsp;(2010)</strong> describen la estructura interna o la partición de la diversidad observada,</p></li>
<li><p><strong>Chao et al.&nbsp;(2021, 2023)</strong> proponen una <strong>tercera generación de métodos</strong>, que integra <strong>las dimensiones taxonómica, funcional y filogenética</strong> en un <strong>marco probabilístico y estadísticamente estandarizado</strong>, en el que la diversidad puede <strong>rarefactarse y extrapolarse</strong> de manera coherente y comparable entre sitios o periodos.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tbl14" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;12:  Cuadro comparativo de tres enfoques para estimar la diversidad taxonómica, funcional y filogenética. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Aspecto </th>
   <th style="text-align:left;"> (1) Villéger et al. (2008) </th>
   <th style="text-align:left;"> (2) De Bello et al. (2010) </th>
   <th style="text-align:left;"> (3) Chao et al. (2021, 2023) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Enfoque principal </td>
   <td style="text-align:left;width: 6cm; "> Evalúa la diversidad funcional (FD) dentro de ensamblajes mediante índices geométricos basados en rasgos. </td>
   <td style="text-align:left;width: 6cm; "> Descompone la diversidad total (TD, FD, PD) en componentes alfa, beta y gamma usando la entropía cuadrática de Rao (Q). </td>
   <td style="text-align:left;width: 6cm; "> Integra TD, FD y PD bajo los números de Hill y la estandarización por cobertura, incorporando rarefacción y extrapolación. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Unidad de análisis </td>
   <td style="text-align:left;width: 6cm; "> Matriz de rasgos funcionales (especies × rasgos). </td>
   <td style="text-align:left;width: 6cm; "> Matrices de abundancia y de distancias funcionales o filogenéticas. </td>
   <td style="text-align:left;width: 6cm; "> Matriz de abundancias junto con matrices de distancia funcional (derivadas de rasgos) o árboles filogenéticos. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Tipo de diversidad estimada </td>
   <td style="text-align:left;width: 6cm; "> Diversidad funcional alfa (FRic, FEve, FDiv, FDis). </td>
   <td style="text-align:left;width: 6cm; "> Diversidad alfa, beta y gamma (aditiva) para TD, FD y PD. </td>
   <td style="text-align:left;width: 6cm; "> Diversidad alfa, beta y gamma (multiplicativa) estandarizada por cobertura muestral. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Dimensiones ecológicas abordadas </td>
   <td style="text-align:left;width: 6cm; "> Funcional (FD). </td>
   <td style="text-align:left;width: 6cm; "> Taxonómica (TD), funcional (FD) y filogenética (PD). </td>
   <td style="text-align:left;width: 6cm; "> Taxonómica (TD), funcional (FD) y filogenética (PD). </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Dependencia del esfuerzo de muestreo </td>
   <td style="text-align:left;width: 6cm; "> Alta: los índices dependen del número de especies y del tamaño de muestra. </td>
   <td style="text-align:left;width: 6cm; "> Moderada: la partición de Rao es sensible al esfuerzo y a la completitud de la muestra. </td>
   <td style="text-align:left;width: 6cm; "> Baja: las estimaciones se estandarizan por cobertura muestral, permitiendo comparaciones entre muestreos desiguales. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Fundamento matemático </td>
   <td style="text-align:left;width: 6cm; "> Geometría del espacio de rasgos (distancias y volúmenes). </td>
   <td style="text-align:left;width: 6cm; "> Entropía cuadrática de Rao (varianza ponderada entre especies). </td>
   <td style="text-align:left;width: 6cm; "> Números de Hill aplicados a abundancias, distancias funcionales y longitudes filogenéticas, bajo estandarización por cobertura. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Interpretación ecológica </td>
   <td style="text-align:left;width: 6cm; "> Describe la ocupación y distribución de las especies en el espacio funcional. </td>
   <td style="text-align:left;width: 6cm; "> Evalúa la contribución local y regional a la diversidad total. </td>
   <td style="text-align:left;width: 6cm; "> Permite comparar la diversidad efectiva entre comunidades con distinto esfuerzo y completitud muestral. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Supuestos principales </td>
   <td style="text-align:left;width: 6cm; "> Los rasgos están bien medidos y normalizados; la disimilitud refleja diferencias ecológicas reales. </td>
   <td style="text-align:left;width: 6cm; "> Las matrices de distancia son válidas y comparables; los ensamblajes representan el conjunto regional. </td>
   <td style="text-align:left;width: 6cm; "> Los árboles filogenéticos o matrices funcionales reflejan adecuadamente las relaciones entre especies; la cobertura refleja la completitud biológica. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Ventajas </td>
   <td style="text-align:left;width: 6cm; "> Proporciona una descripción detallada de la estructura funcional interna. </td>
   <td style="text-align:left;width: 6cm; "> Integra las tres dimensiones y permite descomponer la diversidad en sus componentes alfa, beta y gamma. </td>
   <td style="text-align:left;width: 6cm; "> Permite comparaciones robustas y estandarizadas entre sitios, escalas o periodos; unifica TD, FD y PD bajo un mismo marco matemático. </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 4.5cm; font-weight: bold;"> Limitaciones </td>
   <td style="text-align:left;width: 6cm; "> No corrige diferencias en esfuerzo de muestreo ni permite comparaciones entre muestras incompletas. </td>
   <td style="text-align:left;width: 6cm; "> Sensible al número de especies detectadas y a la rareza. </td>
   <td style="text-align:left;width: 6cm; "> Requiere matrices de distancia funcional o árboles filogenéticos; el cálculo es más intensivo y complejo. </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
</section>
<section id="c.1-diversidad-alfa-taxonómica-td-filogenética-pd-y-funcional-fd-con-inext.3d" class="level3">
<h3 class="anchored" data-anchor-id="c.1-diversidad-alfa-taxonómica-td-filogenética-pd-y-funcional-fd-con-inext.3d">C.1 Diversidad alfa taxonómica (TD), filogenética (PD) y funcional (FD) con iNEXT.3D</h3>
<p>El paquete <strong>iNEXT.3D</strong> (<em>Interpolation and Extrapolation for Three Dimensions of Biodiversity</em>; Chao et al., 2021) amplía el enfoque clásico de <strong>iNEXT</strong> (Hsieh et al., 2016) para incorporar tres dimensiones complementarias de la diversidad ecológica: la <strong>taxonómica (TD)</strong>, la <strong>filogenética (PD)</strong> y la <strong>funcional (FD)</strong>. Todas se cuantifican dentro de un marco unificado basado en los <strong>números de Hill</strong> y sus extensiones (<strong>números de Hill–Chao</strong>), lo que permite expresar la diversidad en unidades equivalentes de “especies efectivas”. Así, TD refleja el número efectivo de especies, PD el número efectivo de linajes (longitudes de rama), y FD el número efectivo de grupos funcionales o “especies funcionales”.</p>
<p>Este enfoque permite comparar directamente distintas facetas de la biodiversidad bajo una misma escala común, integrando estructura taxonómica, historia evolutiva y rasgos ecológicos. <strong>iNEXT.3D</strong> ofrece dos tipos de análisis complementarios:</p>
<ol type="1">
<li><p><strong>No asintótico (interpolación y extrapolación)</strong>, que estandariza la diversidad por <strong>tamaño de muestra</strong> o por <strong>cobertura muestral</strong> (completitud). Esto permite comparar ensamblajes que difieren en esfuerzo de muestreo bajo condiciones de equidad estadística, a través de curvas de rarefacción y extrapolación.</p></li>
<li><p><strong>Asintótico</strong>, que estima la diversidad teórica a partir de los datos observados, y genera perfiles de diversidad (q-perfiles) para diferentes órdenes de sensibilidad (q = 0, 1, 2), así como perfiles temporales (PD) y de umbral funcional (FD).</p></li>
</ol>
<p>Entre sus principales funciones se encuentran:</p>
<ul>
<li><p><code>iNEXT3D()</code> — calcula la diversidad estandarizada (TD, PD, FD) para q = 0, 1, 2;</p></li>
<li><p><code>ggiNEXT3D()</code> — visualiza las curvas de rarefacción/extrapolación;</p></li>
<li><p><code>ObsAsy3D()</code> y <code>ggObsAsy3D()</code> — estiman y grafican la diversidad observada y asintótica;</p></li>
<li><p><code>estimate3D()</code> — calcula diversidad para niveles específicos de tamaño o cobertura;</p></li>
<li><p><code>DataInfo3D()</code> — resume la información básica de la muestra.</p></li>
</ul>
<p>En síntesis, <strong>iNEXT.3D permite evaluar y comparar la diversidad ecológica de manera integrada, estandarizada y visual</strong>, conciliando las tres dimensiones de la biodiversidad en un mismo marco analítico.</p>
<hr>
<section id="a.-diversidad-taxonómica-td-con-abundancias" class="level4">
<h4 class="anchored" data-anchor-id="a.-diversidad-taxonómica-td-con-abundancias">A. Diversidad taxonómica (TD) con abundancias</h4>
<p>El primer paso para analizar la diversidad ecológica con el paquete <strong>iNEXT.3D</strong> consiste en estimar la <strong>diversidad taxonómica (TD)</strong> a partir de los datos de <strong>abundancia de especies</strong>. Esta dimensión representa la <strong>diversidad clásica</strong> basada en el número efectivo de especies, ajustada por la <strong>abundancia relativa</strong> y la <strong>completitud del muestreo</strong>, lo que permite comparar ensamblajes con diferentes tamaños o esfuerzos de muestreo mediante los procedimientos de <strong>rarefacción (interpolación)</strong> y <strong>extrapolación</strong> de los números de Hill.</p>
<p>De acuerdo con <strong>Chao et al.&nbsp;(2021)</strong>, el primer componente del resultado (<code>$TDInfo</code>) resume la información básica de los datos, incluyendo el nombre del ensamblaje, el tamaño de muestra (<em>n</em>), la <strong>riqueza observada de especies (S.obs)</strong>, la <strong>cobertura muestral estimada para el tamaño de referencia</strong> (<em>SC(n)</em>) y para una muestra extrapolada al doble del esfuerzo (<em>SC(2n)</em>), así como las frecuencias de abundancia de las cinco primeras clases (<em>f1–f5</em>), es decir, el número de especies que aparecen una, dos, tres, cuatro o cinco veces en el muestreo.</p>
<p>Este componente es equivalente al que se obtiene mediante la función <code>DataInfo3D()</code> al especificar <code>diversity = 'TD'</code> y <code>datatype = "abundance"</code>. Por tanto, puede emplearse como una forma rápida de explorar la información de base antes de continuar con los cálculos de diversidad observada y asintótica, que se estiman con la función <code>ObsAsy3D()</code> presentada más adelante.</p>
<p>A continuación se muestra el procedimiento aplicado a la matriz de abundancia de peces, donde la función <code>iNEXT3D()</code> calcula los valores de diversidad taxonómica de orden <em>q = 0, 1 y 2</em>, correspondientes a la <strong>riqueza de especies</strong>, la <strong>diversidad de Shannon</strong> y la <strong>diversidad de Simpson</strong>, respectivamente. El argumento <code>datatype = "abundance"</code> indica que los datos corresponden a conteos de individuos y no a presencia/ausencia.</p>
<p>Las <strong>coberturas muestrales cercanas a 1.00</strong> en los sitios M y P indican que el esfuerzo de muestreo fue suficiente para capturar prácticamente la totalidad de las especies presentes, mientras que el valor inferior en RM sugiere que aún podrían detectarse especies adicionales con un muestreo complementario.</p>
<p>Los valores de las frecuencias <em>f1–f5</em> aportan información sobre la <strong>estructura de rareza</strong> de cada ensamblaje. Por ejemplo, el ensamblaje RM presenta un mayor número de especies con baja frecuencia (f1 y f2), lo que denota una comunidad con una <strong>alta proporción de especies raras</strong>, mientras que los ensamblajes M y P presentan composiciones más uniformes, con menor proporción de especies de ocurrencia única.</p>
<p>En conjunto, este primer componente proporciona una <strong>visión general del grado de completitud del muestreo y de la estructura de abundancias</strong>, estableciendo la base para las estimaciones posteriores de diversidad observada, asintótica y estandarizada mediante rarefacción y extrapolación.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)     <span class="co"># leer Excel</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)      <span class="co"># manipulación</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tibble)     <span class="co"># rownames-to-column, etc.</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(FD)         <span class="co"># gowdis (distancia para rasgos mixtos)</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ape)        <span class="co"># as.phylo</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># iNEXT.3D / iNEXTbeta3D: instalar si hace falta</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remotes::install_github("JohnsonHsing/iNEXT.3D")</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remotes::install_github("JohnsonHsing/iNEXTbeta3D")</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(iNEXT<span class="fl">.3</span>D)</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(iNEXT.beta3D)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># biol: matriz Especies x Sitio (columnas = sitios, filas = especies)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span>  </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  biol <span class="sc">%&gt;%</span> </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>      <span class="co"># Elimina la primera columna (Sites)</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Abrevia nombres de especies/variables, excepto la columna de sitios</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">abbreviate</span>(.x, <span class="at">minlength =</span> <span class="dv">4</span>), <span class="sc">-</span>Sites1) <span class="sc">%&gt;%</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Largo → sumar por (Sitio, Especie) por si hay duplicados</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Sites1, </span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Especies"</span>, </span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Abundancia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sites1, Especies) <span class="sc">%&gt;%</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundance =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ancho: columnas = sitios, filas = especies</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Sites1, </span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance, </span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>biol <span class="sc">%&gt;%</span></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl15" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;13:  Resumen de las seis primeras filas de abundancia por sitio </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Especies </th>
   <th style="text-align:right;"> M </th>
   <th style="text-align:right;"> P </th>
   <th style="text-align:right;"> RM </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Achl </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albv </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Amrm </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Amrn </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Anch </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ancm </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diversidad taxonómica (TD) por rarefacción y extrapolación</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>salida_abun1 <span class="ot">&lt;-</span> <span class="fu">iNEXT3D</span>(biol[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">diversity =</span> <span class="st">'TD'</span>, <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">datatype =</span> <span class="st">"abundance"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla con los estimadores alfa</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>salida_abun1<span class="sc">$</span>TDInfo <span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl16" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;14:  Estimadores generales de diversidad alfa para las zonas de montaña (M), de laderas (P) y de desembocadura (RM) </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> f1 </th>
   <th style="text-align:right;"> f2 </th>
   <th style="text-align:right;"> f3 </th>
   <th style="text-align:right;"> f4 </th>
   <th style="text-align:right;"> f5 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
<section id="estimadores-estandarizados-de-diversidad-taxonómica-td" class="level5">
<h5 class="anchored" data-anchor-id="estimadores-estandarizados-de-diversidad-taxonómica-td">1) Estimadores estandarizados de diversidad taxonómica (TD)</h5>
<p>El segundo bloque de resultados generados por la función <code>iNEXT3D()</code> se encuentra en el componente <strong><code>$TDiNextEst</code></strong>, el cual incluye los <strong>estimadores estandarizados de diversidad taxonómica</strong> calculados en función del <strong>tamaño de muestra (size-based)</strong> y de la <strong>cobertura de muestra (coverage-based)</strong> (<a href="#tbl-tbl17">Tabla&nbsp;15</a>).</p>
<p>Este componente resume los valores de diversidad obtenidos mediante procedimientos de <strong>rarefacción (interpolación)</strong> y <strong>extrapolación</strong>, permitiendo evaluar la diversidad esperada para distintos niveles de esfuerzo de muestreo. Por defecto, el paquete calcula las estimaciones en <strong>40 puntos de muestreo (“knots”)</strong>, que abarcan desde muestras muy pequeñas hasta extrapolaciones por encima del tamaño de referencia. Por ejemplo, la zona <em>M</em> (Montañas), los tamaños de muestra considerados van desde <em>m = 1, 95, 189, …, 1699, 1794, 1795, 1899, …, 3588</em>, ubicando el tamaño de referencia aproximadamente en el punto medio del rango evaluado (<a href="#tbl-tbl17">Tabla&nbsp;15</a>).</p>
<p>La estructura del componente <code>$TDiNextEst</code> se organiza en dos data frames:</p>
<ol type="1">
<li><p><code>$size_based</code>, que muestra los estimadores estandarizados por tamaño de muestra.</p></li>
<li><p><code>$coverage_based</code>, que presenta los estimadores estandarizados por cobertura de muestra (mostrados en la siguiente sección).</p></li>
</ol>
<p>En el caso de <code>$size_based</code>, cada fila contiene la siguiente información:</p>
<ul>
<li><p><strong>Assemblage:</strong> nombre del ensamblaje o comunidad (M, P o RM).</p></li>
<li><p><strong>Order.q:</strong> orden de diversidad (q = 0, 1 o 2), correspondiente a los números de Hill.</p></li>
<li><p><strong>m:</strong> tamaño de muestra considerado.</p></li>
<li><p><strong>Method:</strong> método de cálculo utilizado según la relación entre <em>m</em> y el tamaño de referencia (<em>Rarefaction</em>, <em>Observed</em> o <em>Extrapolation</em>).</p></li>
<li><p><strong>qTD:</strong> valor estimado de la diversidad de orden <em>q</em> para el tamaño <em>m</em>.</p></li>
<li><p><strong>qTD.LCL / qTD.UCL:</strong> límites inferior y superior del intervalo de confianza de la diversidad.</p></li>
<li><p><strong>SC / SC.LCL / SC.UCL:</strong> estimaciones de la <strong>cobertura muestral</strong> y sus intervalos de confianza, que permiten graficar la <strong>curva de completitud muestral</strong>.</p></li>
</ul>
<p>Cuando el argumento <code>nboot</code> se define con un valor mayor que cero, la función aplica un <strong>método bootstrap</strong> para calcular los intervalos de confianza de las estimaciones, aumentando la precisión de la inferencia estadística.</p>
<p>Este enfoque de rarefacción y extrapolación permite <strong>comparar ensamblajes con diferente esfuerzo de muestreo</strong> bajo un marco estandarizado, eliminando el sesgo asociado al número de individuos observados y revelando diferencias reales en la <strong>diversidad efectiva de especies</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla con los estimadores alfa </span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>salida_abun1<span class="sc">$</span>TDiNextEst<span class="sc">$</span>size_based<span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl17" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;15:  Estimadores estandarizados de diversidad taxonómica (TD) </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> m </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> qTD </th>
   <th style="text-align:right;"> qTD.LCL </th>
   <th style="text-align:right;"> qTD.UCL </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> SC.LCL </th>
   <th style="text-align:right;"> SC.UCL </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 0.22 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 693 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 17.18 </td>
   <td style="text-align:right;"> 16.64 </td>
   <td style="text-align:right;"> 17.72 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1386 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 19.51 </td>
   <td style="text-align:right;"> 18.68 </td>
   <td style="text-align:right;"> 20.34 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2079 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 21.09 </td>
   <td style="text-align:right;"> 20.03 </td>
   <td style="text-align:right;"> 22.16 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2772 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 22.35 </td>
   <td style="text-align:right;"> 21.09 </td>
   <td style="text-align:right;"> 23.61 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3465 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 23.40 </td>
   <td style="text-align:right;"> 21.96 </td>
   <td style="text-align:right;"> 24.84 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="estimación-estandarizada-de-la-diversidad-taxonómica" class="level5">
<h5 class="anchored" data-anchor-id="estimación-estandarizada-de-la-diversidad-taxonómica">2) Estimación estandarizada de la diversidad taxonómica</h5>
<p>El tercer componente del objeto <code>iNEXT3D()</code> corresponde a <strong><code>$TDAsyEst</code></strong>, el cual presenta las estimaciones de <strong>diversidad observada y asintótica</strong> para cada ensamblaje y para los órdenes de diversidad <em>q = 0, 1 y 2</em> (<a href="#tbl-tbl18">Tabla&nbsp;16</a>). Este componente sintetiza la información más relevante del análisis, al comparar los valores directamente observados en la muestra con las estimaciones asintóticas derivadas del modelo de completitud de Chao et al.&nbsp;(2021).</p>
<p>Las estimaciones asintóticas representan el valor esperado de la diversidad si el esfuerzo de muestreo fuera infinito o completamente exhaustivo, mientras que las observadas (<em>TD_obs</em>) reflejan la diversidad real detectada con el tamaño de muestra disponible.</p>
<p>El resultado incluye además el error estándar de remuestreo (<em>s.e.</em>) y los intervalos de confianza de la estimación (<em>qTD.LCL</em>, <em>qTD.UCL</em>), obtenidos mediante procedimientos bootstrap (<a href="#tbl-tbl18">Tabla&nbsp;16</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>salida_abun1<span class="sc">$</span>TDAsyEst <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-tbl18" class="anchored">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla&nbsp;16:  Estimaciones de diversidad observada y asintótica para cada ensamblaje y para los órdenes de diversidad q = 0, 1 y 2. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:left;"> qTD </th>
   <th style="text-align:right;"> TD_obs </th>
   <th style="text-align:right;"> TD_asy </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qTD.LCL </th>
   <th style="text-align:right;"> qTD.UCL </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> Species richness </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 42.50 </td>
   <td style="text-align:right;"> 14.54 </td>
   <td style="text-align:right;"> 14.00 </td>
   <td style="text-align:right;"> 71.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> Shannon diversity </td>
   <td style="text-align:right;"> 6.53 </td>
   <td style="text-align:right;"> 6.54 </td>
   <td style="text-align:right;"> 0.06 </td>
   <td style="text-align:right;"> 6.41 </td>
   <td style="text-align:right;"> 6.67 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> Simpson diversity </td>
   <td style="text-align:right;"> 4.72 </td>
   <td style="text-align:right;"> 4.72 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 4.64 </td>
   <td style="text-align:right;"> 4.79 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> Species richness </td>
   <td style="text-align:right;"> 30.00 </td>
   <td style="text-align:right;"> 38.00 </td>
   <td style="text-align:right;"> 6.67 </td>
   <td style="text-align:right;"> 24.92 </td>
   <td style="text-align:right;"> 51.08 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> Shannon diversity </td>
   <td style="text-align:right;"> 12.41 </td>
   <td style="text-align:right;"> 12.46 </td>
   <td style="text-align:right;"> 0.18 </td>
   <td style="text-align:right;"> 12.10 </td>
   <td style="text-align:right;"> 12.82 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> Simpson diversity </td>
   <td style="text-align:right;"> 9.48 </td>
   <td style="text-align:right;"> 9.49 </td>
   <td style="text-align:right;"> 0.17 </td>
   <td style="text-align:right;"> 9.16 </td>
   <td style="text-align:right;"> 9.83 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<hr>
</section>
<section id="figura-1.-diversidad-taxonómica-td-con-abundancias" class="level5">
<h5 class="anchored" data-anchor-id="figura-1.-diversidad-taxonómica-td-con-abundancias">Figura 1. Diversidad taxonómica (TD) con abundancias</h5>
<p>Cuando se usa el argumento <code>facet.var = "Assemblage"</code>, se genera una gráfica independiente para cada ensamblaje o sitio, y dentro de cada panel se muestran, con distintos colores, las curvas correspondientes a los diferentes órdenes de diversidad (<em>q = 0, 1 y 2</em>). En este caso, se representan las <strong>curvas de rarefacción y extrapolación basadas en el tamaño de muestra (type = 1)</strong>, que relacionan el número de individuos muestreados con la diversidad esperada (<a href="#fig-fig5">Figura&nbsp;7</a>).</p>
<p>La figura muestra las <strong>curvas de rarefacción (líneas continuas)</strong> y <strong>extrapolación (líneas punteadas)</strong> para los tres órdenes de diversidad:</p>
<ul>
<li><p><strong>q = 0 (naranja):</strong> representa la riqueza de especies, sin considerar abundancias.</p></li>
<li><p><strong>q = 1 (azul):</strong> corresponde a la diversidad de Shannon, que pondera las especies según su abundancia relativa.</p></li>
<li><p><strong>q = 2 (rosado):</strong> expresa la diversidad de Simpson, más sensible a las especies dominantes.</p></li>
</ul>
<p>En los tres ensamblajes (<strong>M, P</strong> y <strong>RM</strong>), se observa que las curvas de riqueza (q = 0) crecen de manera más pronunciada, lo que indica una mayor proporción de especies raras que podrían detectarse con un esfuerzo de muestreo adicional. Por el contrario, las curvas de <em>q = 1</em> y <em>q = 2</em> tienden rápidamente a una asíntota, evidenciando que las especies más abundantes —que dominan el valor de estos índices— ya fueron registradas en el muestreo actual (<a href="#fig-fig5">Figura&nbsp;7</a>).</p>
<p>Las zonas sombreadas alrededor de las curvas representan los <strong>intervalos de confianza del 95%</strong>, obtenidos mediante remuestreo bootstrap, lo que permite visualizar la incertidumbre asociada a las estimaciones.<br>
En conjunto, las curvas sugieren que los ensamblajes M (Montaña) y P (Planicie) presentan un nivel de completitud de muestreo alto (SC ≈ 1), mientras que RM (Río Medio) muestra una diversidad aún en ascenso, con mayor probabilidad de detección de especies adicionales si se incrementara el esfuerzo de captura (<a href="#fig-fig5">Figura&nbsp;7</a>).</p>
<p>Este tipo de representación gráfica es especialmente útil para <strong>comparar la completitud del muestreo entre localidades</strong> y <strong>evaluar la eficiencia de los inventarios</strong>, permitiendo distinguir si las diferencias observadas en diversidad entre sitios reflejan patrones ecológicos reales o limitaciones metodológicas del muestreo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggiNEXT3D permite representar las curvas de diversidad para cada ensamblaje,</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># diferenciadas por el orden q y con facetado para comparación visual.</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggiNEXT3D</span>(</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    salida_abun1,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type      =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,              <span class="co"># muestra las tres dimensiones: tamaños, cobertura y q-profiles</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>,     <span class="co"># separa las curvas por ensamblaje</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color.var =</span> <span class="st">"Order.q"</span>         <span class="co"># colorea según el orden de diversidad (q)</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Curvas R/E basadas en el tamaño de muestra (sample-size-based),</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="co"># diferenciadas por ensamblaje (facet.var = "Assemblage").</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  salida_abun1,</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type      =</span> <span class="dv">1</span>,                  <span class="co"># solo curvas basadas en tamaño de muestra</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>        <span class="co"># un panel por ensamblaje</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="co"># También se puede graficar así</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fig[[1]]</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;7: curvas de rarefacción y extrapolación basadas en el tamaño de muestra (type = 1)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En la figura anterior (facetada por <em>Assemblage</em>), cada panel representaba un sitio (M, P, RM), y dentro de él se comparaban las tres órdenes de diversidad (<em>q = 0, 1, 2</em>). En cambio, en la siguiente <a href="#fig-fig6">Figura&nbsp;8</a> (facetada por <em>Order.q</em>), cada panel muestra un orden de diversidad, y dentro de él se comparan los ensamblajes, destacando así sus diferencias en composición y dominancia.</p>
<p>La reorganización por orden de diversidad (<em>facet.var = “Order.q”</em>) ofrece una lectura más ecológica del gradiente de dominancia entre ensamblajes:</p>
<ul>
<li><p>En <strong>q = 0</strong> (riqueza de especies), el ensamblaje RM muestra la mayor diversidad taxonómica, evidenciando una comunidad con alta cantidad de especies raras o poco abundantes.</p></li>
<li><p>En <strong>q = 1</strong> (índice de Shannon), las diferencias entre sitios se reducen, ya que las especies raras pierden peso y la diversidad refleja más el número de especies comunes.</p></li>
<li><p>En <strong>q = 2</strong> (índice de Simpson), las curvas se aplanan aún más y los valores convergen, indicando que los tres ensamblajes están dominados por unas pocas especies abundantes, y que la estructura de dominancia es similar entre ellos.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggiNEXT3D crea un panel independiente para cada valor de q,</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># facilitando la comparación visual de la sensibilidad de las curvas</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># frente a las especies raras (q = 0), comunes (q = 1) y dominantes (q = 2).</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  salida_abun1,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">type      =</span> <span class="dv">1</span>,            <span class="co"># curvas basadas en tamaño de muestra (sample-size-based)</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.var =</span> <span class="st">"Order.q"</span>     <span class="co"># un panel por orden de diversidad q</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;8: curvas de rarefacción y extrapolación basadas en el tamaño de muestra (type = 1)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figura-2.-estimación-estandarizada-de-la-diversidad-taxonómica" class="level5">
<h5 class="anchored" data-anchor-id="figura-2.-estimación-estandarizada-de-la-diversidad-taxonómica">Figura 2. Estimación estandarizada de la diversidad taxonómica</h5>
<p>El segundo tipo de gráfico generado por la función <code>ggiNEXT3D()</code> (<em>type = 2</em>) corresponde a las <strong>curvas de completitud muestral</strong>, o <em>sample coverage curves</em> (<a href="#fig-fig7">Figura&nbsp;9</a>).</p>
<p>En este caso, el eje vertical muestra la <strong>cobertura muestral (SC)</strong>, es decir, la proporción de la comunidad total que se estima ha sido detectada con el tamaño de muestra observado. El eje horizontal mantiene la escala del número de individuos, y los colores diferencian los ensamblajes (M, P y RM).</p>
<p>Estas curvas de completitud muestral permiten evaluar si el esfuerzo de muestreo fue suficiente para capturar la mayor parte de la diversidad presente en cada ensamblaje. En este ejemplo, los tres sitios —M, P y RM— muestran <strong>niveles de cobertura cercanos a 1.0</strong>, lo que indica que casi todas las especies detectables ya fueron registradas. Las líneas sólidas corresponden a la porción de <strong>rarefacción</strong> (estimaciones basadas en submuestras más pequeñas), mientras que las líneas punteadas representan la <strong>extrapolación</strong> (estimaciones proyectadas a un tamaño de muestra mayor) (<a href="#fig-fig7">Figura&nbsp;9</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># curvas de completitud de muestra (sample completeness curves)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para datos de incidencia. </span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estas curvas son útiles para determinar si la diversidad observada</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># está subestimada y si es necesario extrapolar más allá del esfuerzo actual.</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  salida_abun1,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">type      =</span> <span class="dv">2</span>,            <span class="co"># curvas de completitud de la muestra</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color.var =</span> <span class="st">"Assemblage"</span>  <span class="co"># color según el ensamblaje</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co"># También se puede cargar así</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fig[[2]]</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;9: Curvas de completitud de muestra (sample completeness curves) para datos de incidencia.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figura-3.-estimación-asintótica-de-la-diversidad-taxonómica" class="level5">
<h5 class="anchored" data-anchor-id="figura-3.-estimación-asintótica-de-la-diversidad-taxonómica">Figura 3. Estimación asintótica de la diversidad taxonómica</h5>
<p>El tercer tipo de (<a href="#fig-fig8">Figura&nbsp;10</a>) que genera la función <code>ggiNEXT3D()</code> (<em>type = 3</em>) corresponde a las <strong>curvas de rarefacción y extrapolación basadas en la cobertura muestral</strong>, o <em>coverage-based sampling curves</em>.</p>
<p>A diferencia de las curvas basadas en el tamaño de muestra (<em>sample-size-based</em>), aquí el eje horizontal no representa el número de individuos, sino el <strong>grado de completitud de la muestra (SC)</strong>, es decir, la fracción esperada de la comunidad que ha sido observada.</p>
<p>Estas curvas permiten <strong>comparar la diversidad efectiva de los ensamblajes bajo un mismo nivel de completitud muestral</strong>, eliminando las diferencias asociadas a distintos tamaños de muestra o esfuerzos de captura. En otras palabras, proporcionan un marco justo de comparación: todas los ensamblajes se estandarizan al mismo grado de representatividad del muestreo. En este caso, los tres ensamblajes (M, P y RM) muestran una tendencia ascendente clara conforme aumenta la cobertura, con diferencias notables entre órdenes de diversidad (<strong>q = 0, 1 y 2</strong>) (<a href="#fig-fig8">Figura&nbsp;10</a>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># curvas R/E basadas en cobertura (coverage-based R/E curves)</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># para datos de incidencia</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estas curvas son especialmente útiles cuando las muestras difieren en intensidad</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># de muestreo o cuando se busca interpretar patrones desde una perspectiva</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co"># comparable entre ensamblajes con diferentes niveles de completitud.</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  salida_abun1,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type      =</span> <span class="dv">3</span>,             <span class="co"># curvas R/E basadas en cobertura</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>   <span class="co"># un panel por ensamblaje</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co"># También se puede cargar así</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fig[[3]]</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig8-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;10: Curvas R/E basadas en cobertura (coverage-based R/E curves) para datos de incidencia.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diversidad-taxonómica-td-basada-en-perfiles-de-orden-q" class="level5">
<h5 class="anchored" data-anchor-id="diversidad-taxonómica-td-basada-en-perfiles-de-orden-q">3) Diversidad taxonómica (TD) basada en perfiles de orden q</h5>
<p>El análisis se realiza mediante la función <code>ObsAsy3D()</code>, que permite estimar la diversidad observada y asintótica para una gama continua de órdenes de diversidad (q) entre 0 y 2, lo que genera los llamados <strong>perfiles-q</strong> o <strong>curvas de Hill</strong>.</p>
<p>El argumento <code>diversity = "TD"</code> indica que se calculará la diversidad taxonómica, y <code>datatype = "abundance"</code> especifica que los datos corresponden a abundancias de individuos. La salida del comando ($qTD) incluye el nombre del ensamblaje, el orden de diversidad (Order.q), los valores observados y asintóticos de TD, el error estándar (s.e.) y los intervalos de confianza (qTD.LCL, qTD.UCL).</p>
<p>Estos perfiles muestran cómo la diversidad efectiva varía según el peso relativo que se asigne a las especies comunes o raras:</p>
<ul>
<li><p><strong>q = 0</strong> refleja la riqueza de especies (todas pesan igual),</p></li>
<li><p><strong>q = 1</strong> corresponde a la diversidad de Shannon (pondera por abundancia proporcional), y</p></li>
<li><p><strong>q = 2</strong> aproxima la diversidad de Simpson (resalta las especies dominantes).</p></li>
</ul>
<p>De esta forma, los perfiles-q permiten visualizar de manera continua la estructura de dominancia y equidad en cada ensamblaje, constituyendo el punto de partida para comparar las tres dimensiones de la diversidad: taxonómica, filogenética y funcional.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La función retorna los valores observados y asintóticos de TD,</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># así como intervalos de confianza bootstrap (nboot por defecto = 50).</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A continuación se visualizan las primeras filas mediante una tabla ordenada.</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>salida_abun1a <span class="ot">&lt;-</span> <span class="fu">ObsAsy3D</span>(</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  biol[, <span class="sc">-</span><span class="dv">1</span>],          <span class="co"># matriz de abundancia (sin metadatos)</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"TD"</span>,    <span class="co"># diversidad taxonómica</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)        <span class="co"># órdenes de diversidad</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>salida_abun1a <span class="sc">%&gt;%</span> </span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fig9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Assemblage
</th>
<th style="text-align:right;">
Order.q
</th>
<th style="text-align:right;">
qTD
</th>
<th style="text-align:right;">
s.e.
</th>
<th style="text-align:right;">
qTD.LCL
</th>
<th style="text-align:right;">
qTD.UCL
</th>
<th style="text-align:left;">
Method
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
42.50
</td>
<td style="text-align:right;">
10.97
</td>
<td style="text-align:right;">
20.99
</td>
<td style="text-align:right;">
64.00
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6.54
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
6.41
</td>
<td style="text-align:right;">
6.67
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.72
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
4.63
</td>
<td style="text-align:right;">
4.80
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
38.00
</td>
<td style="text-align:right;">
6.06
</td>
<td style="text-align:right;">
26.13
</td>
<td style="text-align:right;">
49.87
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.46
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
12.13
</td>
<td style="text-align:right;">
12.78
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
9.49
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
9.20
</td>
<td style="text-align:right;">
9.79
</td>
<td style="text-align:left;">
Asymptotic
</td>
</tr>
</tbody>

</table>
<p></p><figcaption class="figure-caption">Figura&nbsp;11: Perfiles de diversidad TD (Taxonomic Diversity) para datos de abundancia mediante ObsAsy3D().</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="figura-4.-lectura-del-perfil-q-td" class="level5">
<h5 class="anchored" data-anchor-id="figura-4.-lectura-del-perfil-q-td">Figura 4. Lectura del perfil-q (TD)</h5>
<p>Las curvas muestran cómo cambia la diversidad efectiva al mover q de 0 a 2. En q=0 (riqueza), <strong>RM</strong> se ubica más alto que <strong>P</strong> y <strong>M</strong>, indicando más especies registradas; al aumentar q, todas las curvas descienden porque el índice pondera más la dominancia y menos a las raras. La <strong>pendiente</strong> resume equidad: curvas que caen <strong>rápido</strong> (p.&nbsp;ej., M) revelan fuerte dominancia; curvas que caen <strong>lento</strong> (p.&nbsp;ej., RM) indican repartos de abundancia más parejos.</p>
<p>Las líneas <strong>continuas</strong> son estimaciones asintóticas y las <strong>segmentadas</strong> las observadas; cuando ambas casi coinciden (P y M en q≥1), la cobertura es alta y la estimación es estable; si se separan (sobre todo cerca de q=0 en RM), hay más sensibilidad a especies raras y posible ganancia si se muestrea más.</p>
<p>Las <strong>bandas</strong> son los IC: anchas cerca de q=0 reflejan la incertidumbre propia de la riqueza; se estrechan hacia q=2 porque las especies comunes dominan el cómputo. En conjunto, el perfil-q permite comparar sitios en todo el gradiente “raras→comunes”: RM lidera en riqueza, P se aproxima en q=1 y q=2, y M queda por debajo por mayor dominancia.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este tipo de visualización permite comparar la sensibilidad de la</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># diversidad ante especies raras (q=0), abundantes (q=1) o dominantes (q=2),</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># y evaluar patrones de estructura comunitaria entre ensamblajes.</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggObsAsy3D</span>(salida_abun1a)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/fig-fig10-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;12: Curvas de perfiles de diversidad (q-profiles) mediante la función ggObsAsy3D().</figcaption><p></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="b.-diversidad-filogenética-pd" class="level4">
<h4 class="anchored" data-anchor-id="b.-diversidad-filogenética-pd">B. Diversidad filogenética (PD)</h4>
<section id="construir-la-matriz-de-abundancias-especies-sitios" class="level5">
<h5 class="anchored" data-anchor-id="construir-la-matriz-de-abundancias-especies-sitios">1) Construir la matriz de abundancias (Especies × Sitios)</h5>
<p>Para los análisis de diversidad filogenética (PD) con <strong>iNEXT.3D</strong>, se utiliza la matriz de abundancias <code>biol_PD</code>, construida a partir de los datos crudos y depurada para garantizar su consistencia con el árbol filogenético (<code>arbol_filo_alfa</code>). En este proceso se excluyó la especie <em>Notropis aguirrepequenoi</em>, que no pudo ser verificada en la base taxonómica empleada durante la construcción del árbol; mantenerla habría generado desalineaciones entre el árbol y la matriz de abundancia. Tras esta depuración, <code>biol_PD</code> queda organizada en formato <strong>Especies × Sitios</strong>, con valores numéricos y sin filas o columnas vacías, lista para calcular PD junto al árbol <code>arbol_filo_alfa</code> suministrado.</p>
<p>El <strong>paso 2</strong>, correspondiente a la exclusión de especies, es opcional y depende de la coincidencia entre los nombres de la matriz de abundancia y los del árbol filogenético. Este paso se aplica únicamente cuando alguna especie no puede ser identificada en la base taxonómica o no aparece en el árbol. Si todas las especies están correctamente alineadas, puede omitirse sin afectar los resultados posteriores.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl); </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr); </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Crear dataframe biol_PD</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>biol_PD <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span>                  <span class="co"># descarta la 1ra col. (IDs)</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Sites1, </span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Especies"</span>, </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Abundancia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sites1, Especies) <span class="sc">%&gt;%</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundance =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Sites1, </span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance, </span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"Especies"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) (opcional) excluir especie no reconocida por la base filogenética:</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  { .[<span class="fu">rownames</span>(.) <span class="sc">!=</span> <span class="st">"Notropis aguirrepequenoi"</span>, </span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>      , drop <span class="ot">=</span> <span class="cn">FALSE</span>] } <span class="sc">%&gt;%</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># limpieza básica</span></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>  { .[, <span class="fu">colSums</span>(.) <span class="sc">&gt;</span> <span class="dv">0</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>] } <span class="sc">%&gt;%</span></span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>  { .[<span class="fu">rowSums</span>(.) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">rownames</span>(.)), , drop <span class="ot">=</span> <span class="cn">FALSE</span>] }</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a><span class="co"># biol_PD %&gt;% head()</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="armonizar-nombres-y-alinear-con-el-árbol-latinname-exacto" class="level5">
<h5 class="anchored" data-anchor-id="armonizar-nombres-y-alinear-con-el-árbol-latinname-exacto">2) Armonizar nombres y alinear con el árbol (LatinName exacto)</h5>
<p>A continuación se armonizan los nombres de las especies de <code>biol_PD</code>, para garantizar su alineación exacta con los del árbol filogenético (<code>arbol_filo_alfa</code>). Para ello, se usa la informacion de la hoja (<code>tax1</code>) que relaciona las abreviaturas utilizadas en la matriz de abundancia con los nombres científicos completos (columna <code>LatinName</code>). Esta correspondencia garantiza que cada fila de <code>biol_PD</code> coincida con una punta del árbol, evitando errores por diferencias tipográficas, abreviaciones o duplicados. Una vez realizada la verificación y la alineación, la matriz de abundancias y el árbol quedan sincronizados, permitiendo que los análisis de diversidad filogenética se ejecuten sin inconsistencias taxonómicas.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># función de normalización mínima (espacios, guiones bajos, minúsculas)</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>.fix <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, x))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>, x)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>(x)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar el árbol filogenético</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>arbol_filo_alfa <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"arbol_filo_alfa.rds"</span>)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizar nombres en matriz y árbol</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(biol_PD) <span class="ot">&lt;-</span> <span class="fu">.fix</span>(<span class="fu">rownames</span>(biol_PD))</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>arbol_filo_alfa<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> <span class="fu">.fix</span>(arbol_filo_alfa<span class="sc">$</span>tip.label)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="co"># conservar únicamente las especies en común y ordenar como el árbol</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>comunes <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(biol_PD), </span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>                     arbol_filo_alfa<span class="sc">$</span>tip.label)</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">length</span>(comunes) <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># garantía: debe haber intersección</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="co"># podar árbol a comunes y reordenar matriz al orden del árbol</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>arbol_filo_alfa <span class="ot">&lt;-</span> </span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>  ape<span class="sc">::</span><span class="fu">drop.tip</span>(arbol_filo_alfa, </span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">setdiff</span>(arbol_filo_alfa<span class="sc">$</span>tip.label, comunes))</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a>biol_PD <span class="ot">&lt;-</span> </span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a>  biol_PD[<span class="fu">match</span>(arbol_filo_alfa<span class="sc">$</span>tip.label, <span class="fu">rownames</span>(biol_PD)), </span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>          , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="co"># (Opcional) Comprobación rápida y lista para PD</span></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a><span class="co"># deben coincidir número de filas (especies) y tips del árbol</span></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a><span class="co"># nrow(biol_PD); </span></span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a><span class="co"># length(arbol_filo_alfa$tip.label)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculo-de-la-diversidad-filogenética-con-inext3d." class="level5">
<h5 class="anchored" data-anchor-id="calculo-de-la-diversidad-filogenética-con-inext3d.">3) Calculo de la diversidad filogenética con iNEXT3D.</h5>
<p>Para estimar la diversidad filogenética (PD) con el paquete <strong>iNEXT.3D</strong>, es indispensable contar con un árbol filogenético que refleje las relaciones evolutivas entre las especies registradas en las comunidades analizadas. En este ejercicio, el objeto <strong><code>arbol_filo_alfa</code></strong> corresponde a dicho árbol, construido previamente a partir de los nombres científicos presentes en la matriz de abundancia <strong><code>biol_PD</code></strong>. El árbol se generó mediante consultas taxonómicas automáticas en la base de datos <strong>NCBI</strong>. Durante el proceso, se excluyeron especies con nomenclatura incompleta o no reconocida por la base de datos (por ejemplo, <em>Notropis aguirrepequenoi</em>) para mantener la coherencia taxonómica entre el árbol y la matriz de abundancias. A continuación se muestra el código utilizado para calcular la diversidad filogenética mediante <strong>iNEXT.3D</strong>, empleando la matriz <strong><code>biol_PD</code></strong> y el árbol <strong><code>arbol_filo_alfa</code></strong> previamente armonizados.</p>
<p>Los resultados de la diversidad filogenética (PD) evidencian diferencias claras entre las tres zonas analizadas de la cuenca. La <strong>zona de desembocadura (RM)</strong> presentó el valor más alto de diversidad filogenética observada (PD = 840.35), lo que indica que las especies registradas en esta zona pertenecen a linajes evolutivamente más distantes entre sí. Este patrón sugiere una mayor heterogeneidad filogenética y una posible mezcla de especies marinas y dulceacuícolas asociadas a la influencia estuarina. En contraste, las <strong>zonas de montaña (M)</strong> y <strong>laderas (P)</strong> mostraron valores de PD más bajos (359.92 y 427.45, respectivamente), reflejando comunidades conformadas por especies más emparentadas y con una historia evolutiva más homogénea. La alta completitud de muestreo (SC ≈ 1.0) en los tres ensamblajes confirma que las estimaciones de PD son robustas. En conjunto, los resultados sugieren un gradiente filogenético asociado a la transición ambiental desde los tramos altos hacia la desembocadura, donde la conectividad y la diversidad de hábitats favorecen la coexistencia de linajes evolutivamente diversos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) iNEXT3D con PD</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT<span class="fl">.3</span>D)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejecuttar la diversidad filogenética</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>salida_abun2 <span class="ot">&lt;-</span> </span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">iNEXT3D</span>(</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  biol_PD,</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"PD"</span>,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype =</span> <span class="st">"abundance"</span>,</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot =</span> <span class="dv">20</span>,</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtree =</span> arbol_filo_alfa,</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtype =</span> <span class="st">"meanPD"</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>salida_abun2<span class="sc">$</span>PDInfo<span class="sc">%&gt;%</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> PD.obs </th>
   <th style="text-align:right;"> f1* </th>
   <th style="text-align:right;"> f2* </th>
   <th style="text-align:right;"> g1 </th>
   <th style="text-align:right;"> g2 </th>
   <th style="text-align:right;"> Reftime </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 12172 </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 359.92 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 24.52 </td>
   <td style="text-align:right;"> 3.43 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5140 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 427.45 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.18 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 411 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 840.35 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 169.46 </td>
   <td style="text-align:right;"> 100.07 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="estimaciones-estandarizadas-de-diversidad-filogenética" class="level5">
<h5 class="anchored" data-anchor-id="estimaciones-estandarizadas-de-diversidad-filogenética">4) Estimaciones estandarizadas de diversidad filogenética</h5>
<p>La segunda lista del objeto de salida (<code>$PDiNextEst</code>) presenta las <strong>estimaciones estandarizadas de diversidad filogenética</strong> obtenidas por rarefacción y extrapolación. Estas estimaciones se calculan por defecto para 40 tamaños de muestra (<em>knots</em>), distribuidos entre el tamaño mínimo y el doble del tamaño de muestra observado.</p>
<p>El componente <code>$size_based</code> muestra los valores de diversidad filogenética en función del <strong>tamaño de muestra (m)</strong>, junto con los intervalos de confianza generados mediante <em>bootstrap</em>. En esta tabla se incluyen:</p>
<ul>
<li><p>el nombre del <strong>ensamblaje (Assemblage)</strong>,</p></li>
<li><p>el <strong>orden de diversidad (Order.q)</strong>,</p></li>
<li><p>el <strong>método de estimación</strong> (<em>Rarefaction</em>, <em>Observed</em> o <em>Extrapolation</em>),</p></li>
<li><p>el <strong>valor estimado de diversidad (qPD)</strong> y sus límites inferior y superior (<em>qPD.LCL</em> y <em>qPD.UCL</em>),</p></li>
<li><p>la <strong>cobertura muestral (SC)</strong> y sus intervalos de confianza,</p></li>
<li><p>el <strong>tiempo de referencia (Reftime)</strong> y el <strong>tipo de diversidad filogenética (Type)</strong> —en este caso, <code>meanPD</code>.</p></li>
</ul>
<p>Estas estimaciones permiten comparar los ensamblajes bajo un mismo nivel de esfuerzo de muestreo, identificando si la diversidad filogenética tiende a estabilizarse o continúa aumentando con la incorporación de nuevas especies. Esta información es clave para determinar la suficiencia del muestreo y para realizar comparaciones ecológicamente válidas entre sitios con diferentes intensidades de colecta.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>salida_abun2<span class="sc">$</span>PDiNextEst<span class="sc">$</span>size_based <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> m </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> qPD </th>
   <th style="text-align:right;"> qPD.LCL </th>
   <th style="text-align:right;"> qPD.UCL </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> SC.LCL </th>
   <th style="text-align:right;"> SC.UCL </th>
   <th style="text-align:right;"> Reftime </th>
   <th style="text-align:left;"> Type </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> 0.25 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 641 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.11 </td>
   <td style="text-align:right;"> 4.99 </td>
   <td style="text-align:right;"> 5.24 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1282 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.52 </td>
   <td style="text-align:right;"> 5.30 </td>
   <td style="text-align:right;"> 5.74 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1922 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.79 </td>
   <td style="text-align:right;"> 5.49 </td>
   <td style="text-align:right;"> 6.10 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2563 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 6.01 </td>
   <td style="text-align:right;"> 5.64 </td>
   <td style="text-align:right;"> 6.39 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3203 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 6.20 </td>
   <td style="text-align:right;"> 5.77 </td>
   <td style="text-align:right;"> 6.63 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="estimaciones-de-diversidad-filogenética-estandarizadas-por-cobertura" class="level5">
<h5 class="anchored" data-anchor-id="estimaciones-de-diversidad-filogenética-estandarizadas-por-cobertura">5) Estimaciones de diversidad filogenética estandarizadas por cobertura</h5>
<p>El segundo conjunto de resultados del análisis (<code>$coverage_based</code>) muestra los valores de diversidad filogenética estandarizados por <strong>cobertura muestral</strong> (en lugar de por tamaño de muestra).<br>
En esta tabla se presentan, para cada ensamblaje y orden de diversidad (q = 0, 1, 2):</p>
<ul>
<li><p>el <strong>nivel de cobertura</strong> alcanzado (<em>SC</em>),</p></li>
<li><p>el <strong>tamaño de muestra correspondiente</strong> (<em>m</em>),</p></li>
<li><p>el <strong>método de estimación</strong> (<em>Rarefaction</em>, <em>Observed</em> o <em>Extrapolation</em>),</p></li>
<li><p>la <strong>diversidad filogenética estimada</strong> (<em>qPD</em>) junto con sus límites de confianza (<em>qPD.LCL</em> y <em>qPD.UCL</em>),</p></li>
<li><p>además del <strong>tiempo de referencia (Reftime)</strong> y el <strong>tipo de PD</strong> (<em>meanPD</em>).</p></li>
</ul>
<p>Este enfoque permite comparar ensamblajes con diferente tamaño de muestra bajo un mismo nivel de completitud del muestreo, lo cual elimina el sesgo producido por diferencias en esfuerzo de captura o abundancia total.<br>
Es importante notar que, al fijar un valor de cobertura, los intervalos de confianza suelen ser <strong>más amplios</strong> que en la estandarización por tamaño de muestra, debido a la variación asociada al número de individuos necesarios para alcanzar dicho nivel de completitud.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>salida_abun2<span class="sc">$</span>PDiNextEst<span class="sc">$</span>coverage_based <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> m </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> qPD </th>
   <th style="text-align:right;"> qPD.LCL </th>
   <th style="text-align:right;"> qPD.UCL </th>
   <th style="text-align:right;"> Reftime </th>
   <th style="text-align:left;"> Type </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 1.01 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 641 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.11 </td>
   <td style="text-align:right;"> 4.91 </td>
   <td style="text-align:right;"> 5.31 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1282 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.52 </td>
   <td style="text-align:right;"> 5.12 </td>
   <td style="text-align:right;"> 5.92 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1922 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 5.79 </td>
   <td style="text-align:right;"> 5.26 </td>
   <td style="text-align:right;"> 6.32 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 2563 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 6.01 </td>
   <td style="text-align:right;"> 5.38 </td>
   <td style="text-align:right;"> 6.64 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 3203 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 6.20 </td>
   <td style="text-align:right;"> 5.48 </td>
   <td style="text-align:right;"> 6.91 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="estimaciones-observadas-y-asintóticas-de-la-diversidad-filogenética" class="level5">
<h5 class="anchored" data-anchor-id="estimaciones-observadas-y-asintóticas-de-la-diversidad-filogenética">6) Estimaciones observadas y asintóticas de la diversidad filogenética</h5>
<p>El tercer conjunto de resultados (<code>$PDAsyEst</code>) resume la <strong>diversidad filogenética observada y asintótica</strong> para cada ensamblaje y para los tres órdenes de diversidad de Hill (q = 0, 1, 2).<br>
En esta tabla se reporta:</p>
<ul>
<li><p><strong>qPD</strong>: la diversidad filogenética correspondiente a cada orden (riqueza, Shannon y Simpson filogenéticos).</p></li>
<li><p><strong>PD_obs</strong>: la diversidad observada en los datos muestreados.</p></li>
<li><p><strong>PD_asy</strong>: la diversidad asintótica estimada mediante extrapolación, es decir, la diversidad esperada si el muestreo fuera completo.</p></li>
<li><p><strong>s.e.</strong>: el error estándar del estimador bootstrap.</p></li>
<li><p><strong>qPD.LCL</strong> y <strong>qPD.UCL</strong>: los límites inferior y superior del intervalo de confianza (95%).</p></li>
<li><p><strong>Reftime</strong> y <strong>Type</strong>, que corresponden al tiempo de referencia del árbol y al tipo de métrica usada (en este caso, <em>meanPD</em>).</p></li>
</ul>
<p>Esta salida permite comparar la diversidad filogenética observada con la estimada bajo un muestreo completo, mostrando qué tan cercana está la diversidad actual a su valor potencial. Cuando los valores observados (PD_obs) son similares a los asintóticos (PD_asy), se interpreta que el muestreo filogenético fue <strong>suficiente</strong> para capturar la mayor parte de la diversidad evolutiva presente en los ensamblajes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>salida_abun2<span class="sc">$</span>PDAsyEst <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:left;"> qPD </th>
   <th style="text-align:right;"> PD_obs </th>
   <th style="text-align:right;"> PD_asy </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qPD.LCL </th>
   <th style="text-align:right;"> qPD.UCL </th>
   <th style="text-align:right;"> Reftime </th>
   <th style="text-align:left;"> Type </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 0 PD </td>
   <td style="text-align:right;"> 7.20 </td>
   <td style="text-align:right;"> 8.95 </td>
   <td style="text-align:right;"> 1.65 </td>
   <td style="text-align:right;"> 5.72 </td>
   <td style="text-align:right;"> 12.19 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 1 PD </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 2.12 </td>
   <td style="text-align:right;"> 2.15 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 2 PD </td>
   <td style="text-align:right;"> 1.71 </td>
   <td style="text-align:right;"> 1.71 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.70 </td>
   <td style="text-align:right;"> 1.72 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 0 PD </td>
   <td style="text-align:right;"> 8.55 </td>
   <td style="text-align:right;"> 9.93 </td>
   <td style="text-align:right;"> 1.05 </td>
   <td style="text-align:right;"> 7.88 </td>
   <td style="text-align:right;"> 11.99 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 1 PD </td>
   <td style="text-align:right;"> 2.95 </td>
   <td style="text-align:right;"> 2.95 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.91 </td>
   <td style="text-align:right;"> 2.99 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 2 PD </td>
   <td style="text-align:right;"> 1.96 </td>
   <td style="text-align:right;"> 1.96 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.93 </td>
   <td style="text-align:right;"> 1.98 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="figura-1.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" class="level5">
<h5 class="anchored" data-anchor-id="figura-1.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad">Figura 1. Curvas de rarefacción y extrapolación por orden de diversidad</h5>
<p>En este caso, al usar <code>facet.var = "Order.q"</code> dentro de la función <code>ggiNEXT3D()</code>, las curvas de rarefacción y extrapolación se agrupan por <strong>orden de diversidad filogenética (q)</strong>.<br>
Cada panel muestra la respuesta de la diversidad filogenética media (<em>meanPD</em>) para un valor de q determinado:</p>
<ul>
<li><p><strong>q = 0:</strong> refleja la <strong>riqueza filogenética</strong>, equivalente al número efectivo de linajes distintos.</p></li>
<li><p><strong>q = 1:</strong> representa la <strong>diversidad filogenética de Shannon</strong>, ponderando las ramas según la abundancia relativa de los taxones.</p></li>
<li><p><strong>q = 2:</strong> corresponde a la <strong>diversidad filogenética de Simpson</strong>, dominada por las ramas más abundantes.</p></li>
</ul>
<p>En cada panel, las <strong>curvas de colores</strong> indican los ensamblajes (M, P y RM), y las líneas <strong>continuas</strong> y <strong>punteadas</strong> distinguen entre los procesos de <strong>rarefacción</strong> y <strong>extrapolación</strong>, respectivamente.<br>
Este tipo de visualización permite comparar cómo varía la estructura evolutiva de los ensamblajes según la importancia que se otorgue a las especies raras (q = 0) o dominantes (q = 2).<br>
En el ejemplo, el ensamblaje RM muestra un incremento abrupto en la diversidad para q = 0, lo que sugiere una mayor contribución de linajes poco abundantes o únicos en el conjunto muestreado.Curvas de rarefacción y extrapolación basadas en el tamaño de muestra</p>
<p>La función <code>ggiNEXT3D()</code> permite representar gráficamente las curvas de <strong>rarefacción y extrapolación</strong> de la diversidad filogenética (<em>PD</em>). En este ejemplo, al establecer <code>facet.var = "Assemblage"</code>, se generan paneles independientes para cada ensamblaje (M, P y RM). Dentro de cada panel, los <strong>colores</strong> diferencian los tres órdenes de diversidad (q = 0, 1 y 2), correspondientes a la <strong>riqueza filogenética</strong>, la <strong>diversidad de Shannon filogenética</strong> y la <strong>diversidad de Simpson filogenética</strong>, respectivamente.</p>
<p>El gráfico muestra cómo la diversidad filogenética aumenta con el <strong>número de individuos muestreados</strong>, reflejando el grado de completitud del muestreo en cada ensamblaje. Las líneas <strong>continuas</strong> representan la rarefacción (diversidad esperada para tamaños de muestra menores al observado), mientras que las <strong>líneas punteadas</strong> indican extrapolación (diversidad proyectada más allá del tamaño observado). El sombreado alrededor de las curvas corresponde al intervalo de confianza del 95% generado por los 20 <em>bootstraps</em>.</p>
<p>Este tipo de curvas facilita comparar el ritmo de acumulación de la diversidad filogenética entre ensamblajes y estimar si el muestreo realizado fue suficiente para representar adecuadamente la diversidad evolutiva del sistema estudiado.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PD sample-size-based R/E curves, separating by "Assemblage"</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun2, <span class="at">type =</span> <span class="dv">1</span>, <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-2.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad" class="level5">
<h5 class="anchored" data-anchor-id="figura-2.-curvas-de-rarefacción-y-extrapolación-por-orden-de-diversidad">Figura 2. Curvas de rarefacción y extrapolación por orden de diversidad</h5>
<p>En este caso, al usar <code>facet.var = "Order.q"</code> dentro de la función <code>ggiNEXT3D()</code>, las curvas de rarefacción y extrapolación se agrupan por <strong>orden de diversidad filogenética (q)</strong>. Cada panel muestra la respuesta de la diversidad filogenética media (<em>meanPD</em>) para un valor de q determinado:</p>
<ul>
<li><p><strong>q = 0:</strong> refleja la <strong>riqueza filogenética</strong>, equivalente al número efectivo de linajes distintos.</p></li>
<li><p><strong>q = 1:</strong> representa la <strong>diversidad filogenética de Shannon</strong>, ponderando las ramas según la abundancia relativa de los taxones.</p></li>
<li><p><strong>q = 2:</strong> corresponde a la <strong>diversidad filogenética de Simpson</strong>, dominada por las ramas más abundantes.</p></li>
</ul>
<p>En cada panel, las <strong>curvas de colores</strong> indican los ensamblajes (M, P y RM), y las líneas <strong>continuas</strong> y <strong>punteadas</strong> distinguen entre los procesos de <strong>rarefacción</strong> y <strong>extrapolación</strong>, respectivamente.<br>
Este tipo de visualización permite comparar cómo varía la estructura evolutiva de los ensamblajes según la importancia que se otorgue a las especies raras (q = 0) o dominantes (q = 2).<br>
En el ejemplo, el ensamblaje RM muestra un incremento abrupto en la diversidad para q = 0, lo que sugiere una mayor contribución de linajes poco abundantes o únicos en el conjunto muestreado.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PD sample-size-based R/E curves, separating by "Order.q"</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun2, <span class="at">type =</span> <span class="dv">1</span>, <span class="at">facet.var =</span> <span class="st">"Order.q"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-3.-curvas-de-completitud-de-muestra-sample-completeness-curve" class="level5">
<h5 class="anchored" data-anchor-id="figura-3.-curvas-de-completitud-de-muestra-sample-completeness-curve">Figura 3. Curvas de completitud de muestra (Sample completeness curve)</h5>
<p>El tercer tipo de gráfico generado con <code>ggiNEXT3D()</code> (<code>type = 2</code>) muestra la <strong>curva de completitud de la muestra</strong>, que representa la <strong>cobertura muestral</strong> (<em>sample coverage</em>) en función del número de individuos muestreados. En esta figura, cada color corresponde a un ensamblaje (M, P y RM), y las líneas <strong>continuas</strong> y <strong>punteadas</strong> indican las fases de <strong>rarefacción</strong> y <strong>extrapolación</strong>, respectivamente.</p>
<p>La cobertura muestral refleja el grado de representatividad de las especies y linajes en el muestreo; valores cercanos a 1, como los observados en M y P, indican que casi todas las ramas filogenéticas presentes en la comunidad fueron detectadas. Por el contrario, el ensamblaje RM, con un tamaño de muestra menor, exhibe una cobertura ligeramente inferior, lo que sugiere que podrían existir linajes adicionales aún no observados.</p>
<p>Este tipo de curva es útil para evaluar la <strong>completitud filogenética</strong> del esfuerzo de muestreo y comparar el nivel de representación entre ensamblajes con distintos tamaños o estructuras evolutivas.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample completeness curves for abundance data, separating by "Assemblage"</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun2, <span class="at">type =</span> <span class="dv">2</span>, <span class="at">color.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-4.-curvas-de-diversidad-filogenética-estandarizadas-por-cobertura" class="level5">
<h5 class="anchored" data-anchor-id="figura-4.-curvas-de-diversidad-filogenética-estandarizadas-por-cobertura">Figura 4. Curvas de diversidad filogenética estandarizadas por cobertura</h5>
<p>Las <strong>curvas de rarefacción y extrapolación basadas en cobertura</strong> (<code>type = 3</code>) representan cómo cambia la <strong>diversidad filogenética promedio</strong> en función de la <strong>completitud muestral</strong>. (1) En la primera figura, donde <code>facet.var = "Assemblage"</code>, cada panel muestra un ensamblaje (M, P y RM) y las curvas de color indican los tres <strong>órdenes de diversidad (q = 0, 1 y 2)</strong>, que corresponden a la <strong>riqueza filogenética</strong>, la <strong>diversidad de Shannon</strong> y la <strong>de Simpson</strong>, respectivamente. (2) En la segunda figura, donde <code>facet.var = "Order.q"</code>, se invierte la perspectiva: cada panel corresponde a un orden de diversidad fijo, y las curvas de color comparan la diversidad filogenética entre los ensamblajes.</p>
<p>En conjunto, ambas visualizaciones permiten interpretar cómo varía la longitud total de las ramas del árbol filogenético conforme aumenta la cobertura. El ensamblaje <strong>RM</strong> alcanza los mayores valores de diversidad filogenética para q = 0, evidenciando una mayor representatividad de linajes evolutivos únicos, mientras que los ensamblajes <strong>M</strong> y <strong>P</strong> exhiben una estructura más homogénea con menor incremento de diversidad al aumentar la cobertura. Estas curvas facilitan comparar ensamblajes con distinto tamaño de muestra bajo un mismo nivel de completitud, integrando la información de abundancia, historia evolutiva y equitatividad entre linajes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PD coverage-based R/E curves, separating by "Assemblage"</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun2, <span class="at">type =</span> <span class="dv">3</span>, <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PD coverage-based R/E curves, separating by "Order.q"</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun2, <span class="at">type =</span> <span class="dv">3</span>, <span class="at">facet.var =</span> <span class="st">"Order.q"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-5.-perfiles-tau-de-diversidad-funcional-con-datos-de-abundancia" class="level5">
<h5 class="anchored" data-anchor-id="figura-5.-perfiles-tau-de-diversidad-funcional-con-datos-de-abundancia">Figura 5. Perfiles tau de diversidad funcional con datos de abundancia</h5>
<p>En PD, el eje del tiempo de referencia (<em>Reftime</em>) “corta” el árbol desde la raíz hacia el presente: a tiempos muy pequeños solo se reconocen linajes muy profundos (pocas ramas largas); a tiempos grandes se van incorporando divisiones más recientes (más ramas y longitud total efectiva). Con <strong>meanPD</strong> expresamos la diversidad en “número efectivo de linajes igualmente divergentes”, de modo que las curvas son comparables entre ensamblajes. Para cada sitio (M, P, RM) y para cada orden q∈{0,1,2}qq∈{0,1,2}, el perfil muestra: (i) <strong>observado vs.&nbsp;asintótico</strong> (líneas segmentadas/continuas) y sus <strong>IC</strong>; (ii) <strong>sensibilidad al tiempo</strong>: si una curva crece rápido al aumentar <em>Reftime</em>, el ensamblaje gana linajes por encima de ramas recientes (historia evolutiva más “ramificada” en escalas cortas); si crece lento, la señal está concentrada en clados profundos. Además, la comparación entre órdenes resume <strong>equidad filogenética</strong>: q=0q=0q=0 (todas las ramas cuentan por igual) tiende a ser mayor y con IC más anchos; q=1q=1q=1 (Shannon filogenético) y q=2q=2q=2 (Simpson filogenético) penalizan dominancia de linajes comunes y reducen la incertidumbre. En tus resultados, <strong>RM</strong> suele superar a <strong>P</strong> y <strong>M</strong> en q=0q=0q=0 para <em>Reftime</em> altos (más linajes recientes incorporados), mientras que en q=1,2q=1,2q=1,2 las diferencias se atenúan si unos pocos clados dominan la abundancia.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>salida_abun2 <span class="ot">&lt;-</span> <span class="fu">ObsAsy3D</span>(biol_PD,</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">diversity =</span> <span class="st">'PD'</span>, </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">PDreftime =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">400</span>, </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">datatype =</span> <span class="st">"abundance"</span>, </span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nboot =</span> <span class="dv">20</span>, </span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">PDtree =</span> arbol_filo_alfa)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>salida_abun2 <span class="sc">%&gt;%</span> </span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> qPD </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qPD.LCL </th>
   <th style="text-align:right;"> qPD.UCL </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> Reftime </th>
   <th style="text-align:left;"> Type </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 41.50 </td>
   <td style="text-align:right;"> 12.86 </td>
   <td style="text-align:right;"> 16.29 </td>
   <td style="text-align:right;"> 66.71 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 5.71 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 5.64 </td>
   <td style="text-align:right;"> 5.78 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 4.14 </td>
   <td style="text-align:right;"> 0.03 </td>
   <td style="text-align:right;"> 4.09 </td>
   <td style="text-align:right;"> 4.20 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 34.00 </td>
   <td style="text-align:right;"> 3.43 </td>
   <td style="text-align:right;"> 27.28 </td>
   <td style="text-align:right;"> 40.71 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 12.32 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 12.03 </td>
   <td style="text-align:right;"> 12.61 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 9.45 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 9.16 </td>
   <td style="text-align:right;"> 9.75 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:left;"> meanPD </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>En estos perfiles, el eje <strong>Reference time</strong> recorre la profundidad del árbol: tiempos muy pequeños incorporan solo ramas profundas; al aumentar el tiempo se agregan divisiones recientes. Cada panel fija un orden q:</p>
<ul>
<li><p>q=0 (todas las ramas pesan igual) suele dar valores altos al inicio y <strong>cae bruscamente</strong>, porque al principio se “descubre” mucha longitud en pocos linajes profundos; luego <strong>se estabiliza</strong> cuando ya casi todo el árbol está incluido.</p></li>
<li><p>q=1 y q=2 penalizan la dominancia: las curvas son <strong>más bajas y más planas</strong>, reflejando que la historia evolutiva está concentrada en unos linajes más comunes.<br>
Las líneas <strong>continuas</strong> son los estimados asintóticos y las <strong>segmentadas</strong> los observados; las bandas son IC. En tus datos, <strong>RM</strong> arranca con PD más alta a tiempos cortos (más profundidad filogenética temprana), pero todas las curvas <strong>convergen</strong> a tiempos grandes, señal de que, al integrar ramas recientes, las diferencias se reducen en términos de número efectivo de linajes igualmente divergentes. Esta lectura conjunta (forma de la caída + separación entre ensamblajes) resume <strong>qué tan profunda</strong> es la porción del árbol representada y <strong>cómo</strong> se distribuye entre linajes comunes y raros.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># time-profile curves</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggObsAsy3D</span>(salida_abun2, <span class="at">profile =</span> <span class="st">"time"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="c.-diversidad-funcional-fd" class="level4">
<h4 class="anchored" data-anchor-id="c.-diversidad-funcional-fd">C. Diversidad funcional (FD)</h4>
<p>Atendiendo a las consideraciones de Chao et al.&nbsp;(2021), se construye una <strong>matriz de distancias entre especies</strong> a partir de sus <strong>patrones de abundancia</strong> en los distintos sitios, utilizando la <strong>distancia de Gower</strong>. Aunque este método suele aplicarse para comparar especies mediante rasgos funcionales, aquí se adapta para estimar qué tan <strong>diferentes son las especies en su distribución ecológica</strong> (es decir, cómo varía su presencia o abundancia relativa entre los ensamblajes). Con datos de abundancia, <strong>Gower</strong> equivale (esencialmente) a la <strong>distancia</strong> <strong>Manhattan estandarizada por rango</strong> y queda acotada en [0,1]. Valores cercanos a 0 reflejan especies con distribuciones muy similares entre los sitios, mientras que valores cercanos a 1 señalan especies que difieren en sus abundancias.</p>
<p>Puede usarse en <strong>iNEXT3D</strong> como argumento <code>FDdistM</code>, permitiendo calcular la <strong>diversidad funcional</strong> basada en las diferencias ecológicas inferidas de las abundancias, en ausencia de información de rasgos directos.</p>
<hr>
</section>
<section id="matriz-de-distancias-de-gower" class="level4">
<h4 class="anchored" data-anchor-id="matriz-de-distancias-de-gower">1) Matriz de distancias de Gower</h4>
<p>A continuación se construye <strong><code>biol.dist.alfa</code></strong> (matriz de distancias Gower por <strong>rasgos funcionales</strong>) para usar en <strong>iNEXT3D</strong> (análisis <strong>individual</strong> por sitio).</p>
<p><strong>Paso a paso (conceptual)</strong></p>
<ol type="1">
<li><p><strong>Leer rasgos</strong> desde la hoja <code>"rasgos"</code> (una fila = especie).</p></li>
<li><p><strong>Seleccionar variables</strong>: continuas (p.ej. <code>TrophicLevel</code>, <code>BodyLength</code>, <code>BodyLengthMax</code>, <code>ShapeFactor</code>) y binarias (<code>omnivory</code>, <code>detritivory</code>, <code>herbivory</code>, <code>invertivory</code>, <code>piscivory</code>, <code>carnivory</code>).</p></li>
<li><p><strong>Estandarizar tipos</strong>:</p>
<ul>
<li><p>Continuas → numéricas.</p></li>
<li><p>Binarias → 0/1 (homogeneizar “Sí/No”, “True/False”, etc.).</p></li>
</ul></li>
<li><p><strong>Opcional) Escalar continuas</strong> si quieres poner todo en [0,1] antes de Gower (no es obligatorio; <code>gowdis()</code> ya maneja mixtas).</p></li>
<li><p><strong>Eliminar especies con NA</strong> en todas las variables elegidas.</p></li>
<li><p><strong>Poner <code>LatinName</code> como <code>rownames</code></strong>.</p></li>
<li><p><strong>Calcular distancia Gower</strong> con <code>FD::gowdis()</code> y <strong>convertir a matriz</strong>.</p></li>
<li><p><strong>(Opcional) Alinear</strong> filas/columnas con las especies de tu matriz de abundancias <code>biol</code> si luego usarás ambas juntas.</p></li>
<li><p><strong>Chequear</strong> simetría y nombres. Resultado: <code>biol.dist.alfa</code>.</p></li>
</ol>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(FD)       <span class="co"># gowdis()</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 1) Leer rasgos ---</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>rasgos <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"rasgos"</span>)</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 2) Definir variables ---</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>vars_cont <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TrophicLevel"</span>, <span class="st">"BodyLength"</span>, <span class="st">"BodyLengthMax"</span>, <span class="st">"ShapeFactor"</span>)</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>vars_bin  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"omnivory"</span>,<span class="st">"detritivory"</span>,<span class="st">"herbivory"</span>,<span class="st">"invertivory"</span>,<span class="st">"piscivory"</span>,<span class="st">"carnivory"</span>)</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 3) Limpiar y tipar (continuas numéricas, binarias 0/1) ---</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>rasgos2 <span class="ot">&lt;-</span> rasgos <span class="sc">%&gt;%</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">all_of</span>(vars_cont), as.numeric),</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">all_of</span>(vars_bin), <span class="sc">~</span> <span class="fu">case_when</span>(</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>      .x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Sí"</span>,<span class="st">"Si"</span>,<span class="st">"sí"</span>,<span class="st">"si"</span>,<span class="st">"yes"</span>,<span class="st">"TRUE"</span>,<span class="st">"True"</span>,<span class="st">"true"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>      .x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"no"</span>,<span class="st">"FALSE"</span>,<span class="st">"False"</span>,<span class="st">"false"</span>,<span class="st">"0"</span>,<span class="st">""</span>)          <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(.x))</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5) quitar filas con NA en alguna de las variables elegidas</span></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(vars_cont, vars_bin))) <span class="sc">%&gt;%</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6) usar LatinName como rownames</span></span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"LatinName"</span>)</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a><span class="co"># (Opcional) 4) escalar continuas si lo prefieres (comentado):</span></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a><span class="co"># rasgos2[vars_cont] &lt;- lapply(rasgos2[vars_cont], scales::rescale)  # a [0,1]</span></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 7) Distancia Gower (especies x especies) ---</span></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>biol.dist.alfa <span class="ot">&lt;-</span> FD<span class="sc">::</span><span class="fu">gowdis</span>(rasgos2[, <span class="fu">c</span>(vars_cont, vars_bin)]) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 8) (Opcional) Alinear con 'biol' si lo usarás junto a abundancias ---</span></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a><span class="co"># stopifnot(exists("biol"))</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a><span class="co"># spp_keep &lt;- intersect(rownames(biol), rownames(biol.dist.alfa))</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a><span class="co"># biol.dist.alfa &lt;- biol.dist.alfa[spp_keep, spp_keep, drop = FALSE]</span></span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a><span class="co"># --- 9) Chequeos útiles ---</span></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(biol.dist.alfa), <span class="fu">isSymmetric</span>(biol.dist.alfa))</span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">identical</span>(<span class="fu">rownames</span>(biol.dist.alfa), <span class="fu">colnames</span>(biol.dist.alfa)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="base-de-abundancia-por-cada-zona-comparada-m-p-y-rm" class="level4">
<h4 class="anchored" data-anchor-id="base-de-abundancia-por-cada-zona-comparada-m-p-y-rm">2) Base de abundancia por cada zona comparada (M, P y RM)</h4>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tibble)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>tax <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limpiar espacios al final en encabezados</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tax) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">names</span>(tax), <span class="st">"</span><span class="sc">\\</span><span class="st">s+$"</span>, <span class="st">""</span>)</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="co"># detectar columna de sitio</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>site_col <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">first</span>(<span class="fu">intersect</span>(<span class="fu">c</span>(<span class="st">"Sites1"</span>,<span class="st">"Sites"</span>,<span class="st">"Sitio"</span>,<span class="st">"Station"</span>,<span class="st">"Site"</span>), <span class="fu">names</span>(tax)))</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(site_col))</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="co"># construir biol: filas = Especies, columnas = sitios</span></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> tax <span class="sc">%&gt;%</span></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> <span class="sc">!!</span>site_col) <span class="sc">%&gt;%</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">where</span>(is.numeric),      <span class="co"># solo columnas numéricas (especies)</span></span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Especies"</span>,</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Abundancia"</span></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abundancia =</span> <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(Abundancia))) <span class="sc">%&gt;%</span></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especies, Site) <span class="sc">%&gt;%</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundancia =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Site, <span class="at">values_from =</span> Abundancia, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Especies"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a><span class="co"># chequeo rápido</span></span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">nrow</span>(biol) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">ncol</span>(biol) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a><span class="co"># asegurar alineación especies ↔ distancias</span></span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a>spp_keep <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">rownames</span>(biol), <span class="fu">rownames</span>(biol.dist.alfa))</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">length</span>(spp_keep) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> biol[spp_keep, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a>biol.dist.alfa <span class="ot">&lt;-</span> biol.dist.alfa[spp_keep, spp_keep, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a><span class="co"># por seguridad, mismo orden</span></span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> biol[<span class="fu">rownames</span>(biol.dist.alfa), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Vista rápida</span></span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>biol <span class="sc">%&gt;%</span></span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> M </th>
   <th style="text-align:right;"> P </th>
   <th style="text-align:right;"> RM </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Achirus lineatus </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Albula vulpes </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ameiurus melas </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ameiurus natalis </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Anchoa hepsetus </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Anchoa mitchilli </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 17 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="estimación-general-de-la-diversidad-funcional-fd-en-ensamblajes-de-especies" class="level4">
<h4 class="anchored" data-anchor-id="estimación-general-de-la-diversidad-funcional-fd-en-ensamblajes-de-especies">3) Estimación general de la diversidad funcional (FD) en ensamblajes de especies</h4>
<p>En este análisis se estima la <strong>diversidad funcional (FD)</strong> a partir de los datos de abundancia de especies y de una <strong>matriz de distancias funcionales</strong> construida con base en los rasgos morfológicos y tróficos de cada taxón (<em>biol.dist.alfa</em>).<br>
La estimación se realiza mediante la función <code>iNEXT3D()</code> del paquete <strong>iNEXT.3D</strong>, especificando <code>diversity = "FD"</code>. Este procedimiento permite calcular la <strong>diversidad funcional observada, interpolada y extrapolada</strong> para distintos órdenes de diversidad (<em>q</em> = 0, 1 y 2), lo que posibilita una descripción integral del espacio funcional ocupado por las especies.</p>
<p>El argumento <strong><code>FDdistM</code></strong> indica la matriz de disimilitudes funcionales entre especies, mientras que <strong><code>FDtype = "AUC"</code></strong> solicita que la diversidad se obtenga a partir de la <strong>integración del perfil de distintividad (τ-profile)</strong>, considerando todos los posibles umbrales de similitud entre 0 y 1.<br>
Este enfoque resume la <strong>contribución funcional total</strong> de las especies, integrando tanto su <strong>singularidad</strong> (especies con rasgos únicos) como su <strong>redundancia</strong> (especies que comparten funciones ecológicas similares) dentro del espacio funcional.</p>
<p>La salida inicial del análisis (<code>$FDInfo</code>) resume información básica de cada ensamblaje o sitio, que incluye:</p>
<ul>
<li><p><strong>n:</strong> tamaño muestral total (número de individuos);</p></li>
<li><p><strong>S.obs:</strong> riqueza funcional observada;</p></li>
<li><p><strong>C(n)</strong> y <strong>SC(2n):</strong> coberturas muestrales observadas y extrapoladas, que reflejan el grado de completitud del muestreo;</p></li>
<li><p><strong>dmin, dmean y dmax:</strong> valores mínimo, medio y máximo de disimilitud funcional, que expresan la heterogeneidad de los rasgos dentro de cada comunidad.</p></li>
</ul>
<p>Estos indicadores permiten valorar la <strong>representatividad funcional</strong> de los ensamblajes y examinar el grado de <strong>diferenciación o redundancia</strong> entre las especies en función de sus rasgos ecológicos.</p>
<p>Dado que el cálculo integral del perfil τ (con <code>FDtype = "AUC"</code>) implica procesar numerosas combinaciones de especies, órdenes de diversidad y remuestreos (<em>nboot</em>), se recomienda emplear un número moderado de puntos en las curvas (<code>knots = 20</code>) para mantener un tiempo de ejecución razonable sin comprometer la calidad de las estimaciones.</p>
<p>El resumen de salida confirma que la <strong>cobertura muestral (SC)</strong> alcanza valores cercanos a 1.00 en todos los ensamblajes, lo cual indica una <strong>alta completitud del muestreo</strong> y una <strong>buena representación de la diversidad funcional</strong> presente en las zonas de montaña (M), laderas (P) y desembocadura (RM).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT<span class="fl">.3</span>D)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedimiento un poco acelerado</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>salida_abun3 <span class="ot">&lt;-</span> <span class="fu">iNEXT3D</span>(biol,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">diversity =</span> <span class="st">"FD"</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),         </span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">datatype =</span> <span class="st">"abundance"</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nboot =</span> <span class="dv">5</span>,              <span class="co"># SIN bootstrap</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">knots =</span> <span class="dv">20</span>,             <span class="co"># menos puntos en las curvas</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">endpoint =</span> <span class="cn">NULL</span>,        <span class="co"># o un endpoint menor: p.ej. 1.2 * n</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">FDdistM =</span> biol.dist.alfa,  <span class="co"># matriz especie x especie en [0,1]</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">FDtype =</span> <span class="st">"AUC"</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>salida_abun3<span class="sc">$</span>FDInfo <span class="sc">%&gt;%</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> dmin </th>
   <th style="text-align:right;"> dmean </th>
   <th style="text-align:right;"> dmax </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 0.43 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.51 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 0.65 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="estimaciones-estandarizadas-de-diversidad-funcional-fd" class="level4">
<h4 class="anchored" data-anchor-id="estimaciones-estandarizadas-de-diversidad-funcional-fd">4) Estimaciones estandarizadas de diversidad funcional (FD)</h4>
<p>La segunda salida principal del análisis, contenida en la lista <code>$FDiNextEst</code>, presenta las <strong>estimaciones estandarizadas de diversidad funcional (FD)</strong> obtenidas mediante <strong>rarefacción y extrapolación</strong>. Este componente permite comparar los ensamblajes bajo condiciones de <strong>igual tamaño de muestra o cobertura muestral</strong>, eliminando los sesgos asociados a diferencias en el número total de individuos entre sitios.</p>
<p>En este bloque se muestran las estimaciones de diversidad funcional para una secuencia de tamaños de muestra estandarizados.<br>
Cada registro incluye:</p>
<ul>
<li><p><strong>Assemblage:</strong> el sitio o ensamblaje analizado.</p></li>
<li><p><strong>Order.q:</strong> el orden de diversidad (<em>q</em> = 0, 1 o 2).</p></li>
<li><p><strong>m:</strong> tamaño de muestra evaluado.</p></li>
<li><p><strong>Method:</strong> tipo de estimación, donde <em>Rarefaction</em> representa interpolación, <em>Observed</em> el valor empírico y <em>Extrapolation</em> la proyección más allá del tamaño original de muestra.</p></li>
<li><p><strong>qFD:</strong> valor estimado de diversidad funcional.</p></li>
<li><p><strong>qFD.LCL</strong> y <strong>qFD.UCL:</strong> límites inferior y superior del intervalo de confianza al 95 %.</p></li>
<li><p><strong>SC:</strong> nivel de cobertura muestral asociado a cada estimación.</p></li>
<li></li>
</ul>
<p>Estas estimaciones permiten explorar cómo varía la <strong>diversidad funcional observada e inferida</strong> conforme aumenta el tamaño de muestra, proporcionando la base para construir las <strong>curvas de rarefacción y extrapolación funcionales</strong>. Dichas curvas ilustran la ganancia de diversidad funcional (es decir, la incorporación de nuevas funciones ecológicas) a medida que se incrementa el número de individuos muestreados.</p>
<p>Este enfoque permite distinguir si las diferencias en diversidad funcional entre los ensamblajes se deben a una <strong>mayor variedad de funciones ecológicas</strong> representadas o simplemente a un <strong>mayor esfuerzo de muestreo o abundancia total</strong>.</p>
<p>Los resultados evidencian que la diversidad funcional en la <strong>zona de montaña (M)</strong> alcanza rápidamente una <strong>cobertura total (SC ≈ 1.00)</strong>, lo que indica que el muestreo fue suficientemente exhaustivo para representar la mayoría de las funciones ecológicas presentes. La estabilidad de los valores de <strong>qFD</strong> al aumentar el tamaño de muestra sugiere una <strong>composición funcional bien definida</strong>, con <strong>baja redundancia</strong> entre especies y un espacio funcional ya saturado por las funciones dominantes en el ensamblaje.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>salida_abun3<span class="sc">$</span>FDiNextEst<span class="sc">$</span>size_based<span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> m </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> qFD </th>
   <th style="text-align:right;"> qFD.LCL </th>
   <th style="text-align:right;"> qFD.UCL </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> SC.LCL </th>
   <th style="text-align:right;"> SC.UCL </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 0.22 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1463 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.84 </td>
   <td style="text-align:right;"> 1.80 </td>
   <td style="text-align:right;"> 1.89 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2926 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.95 </td>
   <td style="text-align:right;"> 1.91 </td>
   <td style="text-align:right;"> 1.99 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4389 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.02 </td>
   <td style="text-align:right;"> 1.99 </td>
   <td style="text-align:right;"> 2.06 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 5852 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.08 </td>
   <td style="text-align:right;"> 2.02 </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 7314 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.12 </td>
   <td style="text-align:right;"> 2.04 </td>
   <td style="text-align:right;"> 2.20 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="diversidad-funcional-estandarizada-por-cobertura-muestral" class="level4">
<h4 class="anchored" data-anchor-id="diversidad-funcional-estandarizada-por-cobertura-muestral">5) Diversidad funcional estandarizada por cobertura muestral</h4>
<p>En esta etapa del análisis se presentan las <strong>estimaciones de diversidad funcional (FD)</strong> estandarizadas por <strong>cobertura muestral</strong>, obtenidas del componente <code>$FDiNextEst$coverage_based</code> del objeto de salida.<br>
Este procedimiento ajusta las estimaciones de diversidad funcional a un <strong>nivel de completitud común (SC)</strong> entre los ensamblajes, lo que permite realizar <strong>comparaciones equitativas</strong> entre comunidades con distintos tamaños de muestra o abundancias totales.</p>
<p>A diferencia de la estandarización por tamaño de muestra, este enfoque <strong>homologa la representatividad funcional</strong> de los datos, no el número de individuos. En otras palabras, las comunidades se comparan bajo un <strong>mismo grado de completitud muestral</strong>, eliminando los efectos del esfuerzo de muestreo y permitiendo identificar <strong>diferencias reales en la estructura funcional</strong> de las comunidades.</p>
<p>Es importante señalar que los <strong>intervalos de confianza</strong> tienden a ser más amplios que en el caso del análisis por tamaño de muestra, debido a que la cobertura fija requiere estimar —mediante remuestreo (<em>bootstrap</em>)— el tamaño de muestra necesario para alcanzar cada nivel de completitud, lo cual incrementa la variabilidad de las estimaciones.</p>
<p>Los resultados evidencian que, bajo una <strong>cobertura completa (SC ≈ 1.00)</strong>, las estimaciones de diversidad funcional en el ensamblaje de montaña (M) se mantienen <strong>estables y consistentes</strong> con las obtenidas por tamaño de muestra. Esto confirma una <strong>alta completitud funcional del muestreo</strong> y sugiere una <strong>baja redundancia de rasgos ecológicos</strong>, reflejando una comunidad con funciones bien representadas y una estructura funcional equilibrada.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>salida_abun3<span class="sc">$</span>FDiNextEst<span class="sc">$</span>coverage_based <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> m </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> qFD </th>
   <th style="text-align:right;"> qFD.LCL </th>
   <th style="text-align:right;"> qFD.UCL </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.98 </td>
   <td style="text-align:right;"> 1.02 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1463 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.84 </td>
   <td style="text-align:right;"> 1.75 </td>
   <td style="text-align:right;"> 1.94 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 2926 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 1.95 </td>
   <td style="text-align:right;"> 1.83 </td>
   <td style="text-align:right;"> 2.07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 4389 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.02 </td>
   <td style="text-align:right;"> 1.91 </td>
   <td style="text-align:right;"> 2.14 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 5852 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.08 </td>
   <td style="text-align:right;"> 1.97 </td>
   <td style="text-align:right;"> 2.19 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 7314 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 2.12 </td>
   <td style="text-align:right;"> 1.98 </td>
   <td style="text-align:right;"> 2.26 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="estimaciones-asintóticas-de-diversidad-funcional-fdasyest" class="level4">
<h4 class="anchored" data-anchor-id="estimaciones-asintóticas-de-diversidad-funcional-fdasyest">6) Estimaciones asintóticas de diversidad funcional (FDAsyEst)</h4>
<p>La última salida del análisis, contenida en la lista <code>$FDAsyEst</code>, presenta las <strong>estimaciones observadas y asintóticas de la diversidad funcional (FD)</strong> para distintos órdenes de diversidad (<em>q</em> = 0, 1 y 2).<br>
Este componente permite evaluar tanto la <strong>magnitud de la diversidad funcional</strong> en cada ensamblaje como su <strong>grado de completitud muestral</strong> y la <strong>consistencia estadística</strong> de las inferencias derivadas del modelo.</p>
<p>En términos ecológicos, <strong>valores cercanos entre FD_obs y FD_asy</strong> indican que el muestreo logró capturar adecuadamente la diversidad funcional del ensamblaje, mientras que <strong>diferencias notorias</strong> sugieren un posible submuestreo o la existencia de especies con rasgos funcionales únicos que aún no han sido registradas.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>salida_abun3<span class="sc">$</span>FDAsyEst <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption></caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:left;"> qFD </th>
   <th style="text-align:right;"> FD_obs </th>
   <th style="text-align:right;"> FD_asy </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qFD.LCL </th>
   <th style="text-align:right;"> qFD.UCL </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 0 FD(AUC) </td>
   <td style="text-align:right;"> 2.23 </td>
   <td style="text-align:right;"> 2.36 </td>
   <td style="text-align:right;"> 0.18 </td>
   <td style="text-align:right;"> 2.01 </td>
   <td style="text-align:right;"> 2.71 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 1 FD(AUC) </td>
   <td style="text-align:right;"> 1.27 </td>
   <td style="text-align:right;"> 1.27 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.26 </td>
   <td style="text-align:right;"> 1.28 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> q = 2 FD(AUC) </td>
   <td style="text-align:right;"> 1.21 </td>
   <td style="text-align:right;"> 1.21 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> 1.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 0 FD(AUC) </td>
   <td style="text-align:right;"> 2.72 </td>
   <td style="text-align:right;"> 2.95 </td>
   <td style="text-align:right;"> 0.19 </td>
   <td style="text-align:right;"> 2.58 </td>
   <td style="text-align:right;"> 3.32 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 1 FD(AUC) </td>
   <td style="text-align:right;"> 1.54 </td>
   <td style="text-align:right;"> 1.54 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.53 </td>
   <td style="text-align:right;"> 1.56 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:left;"> q = 2 FD(AUC) </td>
   <td style="text-align:right;"> 1.37 </td>
   <td style="text-align:right;"> 1.37 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.36 </td>
   <td style="text-align:right;"> 1.39 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
<section id="figura-1.-curvas-de-rarefacciónextrapolación-basadas-en-el-tamaño-de-muestra-fd" class="level5">
<h5 class="anchored" data-anchor-id="figura-1.-curvas-de-rarefacciónextrapolación-basadas-en-el-tamaño-de-muestra-fd">Figura 1. Curvas de rarefacción/extrapolación basadas en el tamaño de muestra (FD)</h5>
<p>En esta figura se representan las <strong>curvas de rarefacción y extrapolación</strong> de la <strong>diversidad funcional (FD)</strong>, separadas por ensamblaje según el argumento <code>facet.var = "Assemblage"</code>.<br>
Cada panel corresponde a una zona (Montaña —M—, Laderas —P— y Desembocadura —RM—), donde los colores identifican los <strong>órdenes de diversidad</strong> (<em>q</em> = 0, 1 y 2). Las <strong>líneas continuas</strong> indican la fase de <strong>rarefacción</strong> (interpolación dentro del rango de muestreo observado) y las <strong>líneas discontinuas</strong> muestran la <strong>extrapolación</strong> (predicción más allá del tamaño de muestra real). El eje <strong>X</strong> representa el número de individuos y el eje <strong>Y</strong> la <strong>diversidad funcional</strong>, expresada como el <strong>área bajo la curva (AUC)</strong> del perfil de distintividad (τ-profile).</p>
<p>Las curvas reflejan cómo la diversidad funcional acumulada se estabiliza progresivamente con el incremento del esfuerzo de muestreo. En los ensamblajes <strong>M</strong> y <strong>P</strong>, las curvas de <em>q = 0</em> alcanzan una meseta pronunciada, indicando una <strong>alta completitud del muestreo</strong> y una <strong>baja probabilidad de detectar nuevas funciones ecológicas</strong> con mayor esfuerzo. En contraste, el ensamblaje <strong>RM</strong> muestra curvas más cortas y con mayor incertidumbre, reflejando un <strong>tamaño muestral reducido</strong> y una <strong>mayor sensibilidad a la presencia de especies funcionalmente raras</strong>.</p>
<p>Este patrón sugiere que las localidades de montaña y laderas presentan un espacio funcional bien representado, mientras que en la desembocadura podría existir <strong>submuestreo</strong> o <strong>alta heterogeneidad funcional</strong> aún no capturada por el esfuerzo realizado.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FD sample-size-based R/E curves, separating by "Assemblage"</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun3, <span class="at">type =</span> <span class="dv">1</span>, <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-2.-curvas-de-rarefacciónextrapolación-por-orden-de-diversidad-fd" class="level5">
<h5 class="anchored" data-anchor-id="figura-2.-curvas-de-rarefacciónextrapolación-por-orden-de-diversidad-fd">Figura 2. Curvas de rarefacción/extrapolación por orden de diversidad (FD)</h5>
<p>En esta figura se presentan las <strong>curvas de rarefacción y extrapolación</strong> de la <strong>diversidad funcional (FD)</strong> separadas por <strong>orden de diversidad</strong> mediante el argumento <code>facet.var = "Order.q"</code>.<br>
Cada panel corresponde a un valor de <em>q</em> (0, 1 o 2), y dentro de cada uno se comparan los tres ensamblajes —<strong>Montaña (M)</strong>, <strong>Laderas (P)</strong> y <strong>Desembocadura (RM)</strong>—.</p>
<p>El eje <strong>X</strong> representa el número de individuos, mientras que el eje <strong>Y</strong> indica la <strong>diversidad funcional (AUC)</strong>. Las <strong>líneas continuas</strong> representan la <strong>rarefacción</strong>, y las <strong>discontinuas</strong> la <strong>extrapolación</strong>, con bandas sombreadas que muestran los intervalos de confianza. El panel de <em>q = 0</em> enfatiza la <strong>riqueza funcional</strong>, capturando la variedad de funciones sin considerar las abundancias relativas. En <em>q = 1</em> y <em>q = 2</em>, las estimaciones se ajustan progresivamente hacia la <strong>dominancia funcional</strong>, dando mayor peso a las especies más comunes y reduciendo la influencia de las raras.</p>
<p>Los resultados revelan que el ensamblaje <strong>de montaña (M)</strong> mantiene una diversidad funcional consistentemente mayor a lo largo de todos los órdenes de diversidad, lo que indica una <strong>estructura funcional equilibrada y con alta complementariedad de rasgos</strong>. Por su parte, el ensamblaje <strong>de laderas (P)</strong> muestra una diversidad intermedia, mientras que el <strong>de desembocadura (RM)</strong> presenta los valores más bajos y mayor incertidumbre, evidenciando una <strong>reducción de la diversidad funcional efectiva</strong> posiblemente asociada a una <strong>simplificación del ensamblaje o limitaciones ambientales</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FD sample-size-based R/E curves, separating by "Order.q"</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun3, <span class="at">type =</span> <span class="dv">1</span>, <span class="at">facet.var =</span> <span class="st">"Order.q"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-3.-curvas-de-completitud-muestral-fd" class="level5">
<h5 class="anchored" data-anchor-id="figura-3.-curvas-de-completitud-muestral-fd">Figura 3. Curvas de completitud muestral (FD)</h5>
<p>En cada panel, el eje <strong>X</strong> representa el número de individuos (tamaño de muestra) y el eje <strong>Y</strong> la <strong>cobertura muestral</strong> (<em>Sample coverage</em>), que mide la proporción estimada de la diversidad funcional detectada en relación con el total potencial. Las <strong>líneas continuas</strong> representan las fases de rarefacción (interpolación dentro del rango observado) y las <strong>líneas discontinuas</strong> la extrapolación (proyección más allá del tamaño de muestra original).</p>
<p>Los resultados muestran que todos los ensamblajes alcanzan <strong>niveles de cobertura muy altos (SC ≈ 1.0)</strong>, lo que indica una <strong>alta completitud del muestreo funcional</strong>. En otras palabras, casi la totalidad de las funciones ecológicas presentes en cada comunidad fueron registradas.</p>
<p>El ensamblaje <strong>de montaña (M)</strong> y el <strong>de laderas (P)</strong> presentan curvas que se estabilizan rápidamente, evidenciando un <strong>esfuerzo de muestreo suficiente</strong> y una <strong>estructura funcional bien representada</strong>. El ensamblaje <strong>de desembocadura (RM)</strong>, aunque con menor número total de individuos, también alcanza una cobertura cercana a 1, lo que sugiere que, pese al menor tamaño muestral, el esfuerzo fue adecuado para capturar su diversidad funcional real. En conjunto, estas curvas confirman que las estimaciones de diversidad funcional basadas en los datos son <strong>confiables y no están afectadas por insuficiencia de muestreo</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample completeness curves for abundance data, separating by "Assemblage"</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun3, <span class="at">type =</span> <span class="dv">2</span>, <span class="at">color.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-4.-curvas-de-rarefacción-y-extrapolación-basadas-en-cobertura-fd" class="level5">
<h5 class="anchored" data-anchor-id="figura-4.-curvas-de-rarefacción-y-extrapolación-basadas-en-cobertura-fd">Figura 4. Curvas de rarefacción y extrapolación basadas en cobertura (FD)</h5>
<p>Cada panel corresponde a un ensamblaje —<strong>Montaña (M)</strong>, <strong>Laderas (P)</strong> y <strong>Desembocadura (RM)</strong>—, y los colores distinguen los <strong>órdenes de diversidad</strong> (<em>q</em> = 0, 1, 2), asociados respectivamente a la <strong>riqueza funcional</strong>, la <strong>diversidad funcional ponderada por abundancia (Shannon)</strong> y la <strong>diversidad funcional dominada por especies comunes (Simpson)</strong>. El eje <strong>X</strong> representa la <strong>cobertura muestral (SC)</strong> y el eje <strong>Y</strong> la <strong>diversidad funcional efectiva (FD)</strong>, expresada como el área bajo la curva (AUC).<br>
Las <strong>líneas continuas</strong> muestran la fase de <strong>rarefacción</strong> (interpolación dentro del rango observado), mientras que las <strong>líneas punteadas</strong> reflejan la <strong>extrapolación</strong> más allá de la cobertura empírica.</p>
<p>Los resultados muestran que los tres ensamblajes alcanzan <strong>coberturas próximas a 1</strong>, lo que evidencia una <strong>alta completitud del muestreo</strong>. Sin embargo, el incremento en diversidad funcional con la cobertura varía según el orden de diversidad:</p>
<ul>
<li><p>En <em>q = 0</em>, la curva es más pronunciada, reflejando la influencia de <strong>especies raras</strong> que amplían el espacio funcional al aumentar la cobertura.</p></li>
<li><p>En <em>q = 1</em> y <em>q = 2</em>, las curvas son más estables, indicando una <strong>estructura funcional dominada por especies comunes</strong> y <strong>baja incorporación de nuevas funciones</strong> con mayor esfuerzo.</p></li>
</ul>
<p>Este patrón sugiere que las comunidades difieren principalmente en la proporción de especies raras con rasgos únicos, más que en la contribución de las especies dominantes al espacio funcional global.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FD coverage-based R/E curves, separating by "Assemblage"</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun3, <span class="at">type =</span> <span class="dv">3</span>, <span class="at">facet.var =</span> <span class="st">"Assemblage"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-5.-curvas-de-cobertura-estandarizada-y-comparación-entre-ensamblajes" class="level5">
<h5 class="anchored" data-anchor-id="figura-5.-curvas-de-cobertura-estandarizada-y-comparación-entre-ensamblajes">Figura 5. Curvas de cobertura estandarizada y comparación entre ensamblajes</h5>
<p>En este caso, el eje <strong>X</strong> representa la <strong>cobertura muestral (SC)</strong> —una medida del grado de completitud del muestreo—, mientras que el eje <strong>Y</strong> muestra la <strong>diversidad funcional efectiva (AUC)</strong>. Las <strong>líneas continuas</strong> indican las fases de <strong>rarefacción</strong> (interpolación) y las <strong>líneas punteadas</strong> las de <strong>extrapolación</strong>, con bandas de color que representan los intervalos de confianza del remuestreo.</p>
<p>Cada panel corresponde a un orden de diversidad (<em>q</em> = 0, 1 y 2), donde:</p>
<ul>
<li><p><em>q = 0</em> representa la <strong>riqueza funcional</strong>, sensible a la presencia de especies raras con rasgos únicos.</p></li>
<li><p><em>q = 1</em> refleja la <strong>diversidad funcional de Shannon</strong>, que pondera las especies según su abundancia.</p></li>
<li><p><em>q = 2</em> enfatiza la <strong>diversidad funcional de Simpson</strong>, influenciada por las especies dominantes.</p></li>
</ul>
<p>Las curvas comparan los tres ensamblajes —<strong>Montaña (M)</strong>, <strong>Laderas (P)</strong> y <strong>Desembocadura (RM)</strong>— bajo un mismo nivel de completitud. Los resultados muestran que, aunque todos alcanzan coberturas próximas a 1.0, los valores de FD son sistemáticamente mayores en los ensamblajes de <strong>Montaña</strong> y <strong>Laderas</strong>, indicando una <strong>mayor amplitud y complejidad del espacio funcional</strong> en comparación con el ensamblaje de <strong>Desembocadura</strong>, que exhibe una <strong>menor diversidad y mayor incertidumbre en las estimaciones extrapoladas</strong>.</p>
<p>En conjunto, estas curvas confirman que, incluso tras estandarizar por cobertura, la jerarquía funcional entre ensamblajes se mantiene, revelando diferencias consistentes en la organización y redundancia de los rasgos ecológicos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FD coverage-based R/E curves, separating by "Order.q"</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXT3D</span>(salida_abun3, <span class="at">type =</span> <span class="dv">3</span>, <span class="at">facet.var =</span> <span class="st">"Order.q"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="perfiles-de-diversidad-funcional-fd-según-el-orden-de-diversidad-q-profiles" class="level4">
<h4 class="anchored" data-anchor-id="perfiles-de-diversidad-funcional-fd-según-el-orden-de-diversidad-q-profiles">7) Perfiles de diversidad funcional (FD) según el orden de diversidad (q-profiles)</h4>
<p>Los <strong>perfiles de diversidad funcional (q-profiles)</strong> permiten explorar cómo cambia la diversidad cuando se modifican los pesos asignados a las especies según su abundancia.<br>
El análisis se realiza con la función <code>ObsAsy3D()</code> del paquete <strong>iNEXT.3D</strong>, configurando el argumento <code>diversity = "FD"</code> para calcular la <strong>diversidad funcional (FD)</strong>.<br>
En este procedimiento, el <strong>parámetro τ (tau)</strong> define el umbral de similitud funcional entre especies, mientras que los valores de <strong>q</strong> (0, 1, 2) determinan la sensibilidad a la dominancia de especies.</p>
<ul>
<li><p><strong>q = 0</strong>: todas las especies tienen el mismo peso, reflejando la <strong>riqueza funcional</strong>.</p></li>
<li><p><strong>q = 1</strong>: pondera las especies por su abundancia, análogo a la <strong>diversidad de Shannon</strong>.</p></li>
<li><p><strong>q = 2</strong>: enfatiza las especies dominantes, equivalente a la <strong>diversidad de Simpson</strong>.</p></li>
</ul>
<p>Curvas que <strong>descienden rápidamente con q</strong> evidencian que <strong>pocas especies dominan el espacio funcional</strong>, mientras que descensos más suaves indican un <strong>reparto más equitativo</strong> de las funciones ecológicas. En conjunto, los <strong>q-profiles</strong> describen cómo la diversidad funcional se distribuye entre especies comunes y raras, y cómo la estructura funcional responde al peso relativo que se les otorga.</p>
<p>Los resultados permiten visualizar cómo la <strong>diversidad funcional (FD)</strong> cambia con los diferentes órdenes de diversidad y niveles de <strong>distintividad funcional (τ)</strong>. En el ejemplo mostrado, el ensamblaje <strong>de montaña (M)</strong> presenta una disminución progresiva de FD a medida que aumenta <strong>q</strong>, indicando que la comunidad posee <strong>algunas especies dominantes</strong> que concentran gran parte de las funciones ecológicas. Por otro lado, los valores relativamente altos de FD en τ bajos (0–0.1) reflejan la <strong>presencia de especies con rasgos únicos</strong>, que amplían el espacio funcional incluso si son poco abundantes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de perfiles q de diversidad funcional (FD)</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ObsAsy3D calcula diversidad observada y asintótica para distintos valores de q y τ</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>salida_abun3a <span class="ot">&lt;-</span> <span class="fu">ObsAsy3D</span>(</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>  biol,                     <span class="co"># Matriz de abundancias</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">'FD'</span>,         <span class="co"># Dimensión funcional</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),           <span class="co"># Órdenes de diversidad (riqueza, Shannon y Simpson)</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype =</span> <span class="st">"abundance"</span>,   <span class="co"># Datos de tipo abundancia</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot =</span> <span class="dv">5</span>,                <span class="co"># Número de remuestreos bootstrap</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM =</span> biol.dist.alfa, <span class="co"># Matriz de distancias funcionales (Gower)</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype =</span> <span class="st">'tau_values'</span>,    <span class="co"># Tipo de cálculo: perfil τ discreto</span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtau =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)   <span class="co"># Secuencia de valores de τ (de 0 a 1 cada 0.05)</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de los primeros resultados</span></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Incluye ensamblaje, orden q, valor de FD, error estándar y límites de confianza</span></span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>salida_abun3a <span class="sc">%&gt;%</span> </span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Estimaciones observadas y asintóticas de diversidad funcional (q-profiles)"</span>, </span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Estimaciones observadas y asintóticas de diversidad funcional (q-profiles)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> qFD </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qFD.LCL </th>
   <th style="text-align:right;"> qFD.UCL </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> Tau </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.50 </td>
   <td style="text-align:right;"> 15.52 </td>
   <td style="text-align:right;"> 12.09 </td>
   <td style="text-align:right;"> 72.91 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 6.54 </td>
   <td style="text-align:right;"> 0.04 </td>
   <td style="text-align:right;"> 6.46 </td>
   <td style="text-align:right;"> 6.62 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 4.72 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 4.67 </td>
   <td style="text-align:right;"> 4.76 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 8.61 </td>
   <td style="text-align:right;"> 0.56 </td>
   <td style="text-align:right;"> 7.51 </td>
   <td style="text-align:right;"> 9.71 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.05 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2.29 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.25 </td>
   <td style="text-align:right;"> 2.34 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.05 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1.87 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.85 </td>
   <td style="text-align:right;"> 1.90 </td>
   <td style="text-align:left;"> Asymptotic </td>
   <td style="text-align:right;"> 0.05 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
<section id="figura-6.-perfiles-de-distintividad-funcional-τ-profiles" class="level5">
<h5 class="anchored" data-anchor-id="figura-6.-perfiles-de-distintividad-funcional-τ-profiles">Figura 6. perfiles de distintividad funcional (τ-profiles)</h5>
<p>Estos perfiles son generados con la función <code>ggObsAsy3D()</code> (argumento <code>profile = "tau"</code>), los cuales representan cómo varía la <strong>diversidad funcional (FD)</strong> a lo largo del gradiente de <strong>τ (tau)</strong> —el umbral de similitud funcional entre especies— para los tres ensamblajes: <strong>Montaña (M)</strong>, <strong>Laderas (P)</strong> y <strong>Desembocadura (RM)</strong>. Las <strong>líneas continuas</strong> muestran las estimaciones <strong>asintóticas</strong> (esperadas con muestreo completo), mientras que las <strong>líneas discontinuas</strong> indican los valores <strong>observados</strong> directamente en los datos.</p>
<p>Los resultados revelan una <strong>disminución pronunciada de FD</strong> al incrementar τ, lo que refleja que gran parte de la diversidad funcional se concentra en <strong>especies poco similares entre sí</strong> (τ bajos). A medida que τ aumenta —es decir, cuando se exige mayor similitud para considerar dos especies distintas—, la diversidad efectiva cae rápidamente y tiende a estabilizarse.</p>
<p>Este patrón indica que los ensamblajes presentan <strong>una estructura funcional con alto grado de singularidad en rasgos morfológicos y tróficos</strong>, dominada por especies que difieren marcadamente entre sí, especialmente en los valores de <em>q = 0</em>, donde la riqueza funcional total alcanza sus máximos antes de reducirse con el aumento del umbral τ.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tau-profile curves</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggObsAsy3D</span>(salida_abun3a, <span class="at">profile =</span> <span class="st">"tau"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="estimación-de-la-diversidad-funcional-fd-basada-en-los-números-de-hill" class="level4">
<h4 class="anchored" data-anchor-id="estimación-de-la-diversidad-funcional-fd-basada-en-los-números-de-hill">8) Estimación de la diversidad funcional (FD) basada en los números de Hill</h4>
<p>En esta sección se estima la <strong>diversidad funcional (FD)</strong> de los ensamblajes utilizando el enfoque de los <strong>números de Hill (q)</strong>, el cual permite caracterizar la estructura funcional de las comunidades desde diferentes grados de sensibilidad a la abundancia de las especies.</p>
<p>A través de este enfoque, se puede analizar cómo la composición funcional de los ensamblajes se modifica al pasar de valorar la simple presencia de especies a ponderar su dominancia ecológica.</p>
<p>Los resultados obtenidos muestran que la <strong>diversidad funcional disminuye de forma progresiva al aumentar el orden q</strong>, lo que refleja que las <strong>especies dominantes son funcionalmente más redundantes</strong> que las raras. Esto implica que, aunque las comunidades puedan albergar un número elevado de especies funcionalmente distintas (alto FD para <em>q = 0</em>), gran parte de las funciones ecológicas se concentran en unas pocas especies comunes cuando se pondera por abundancia (<em>q = 1</em> o <em>q = 2</em>).</p>
<p>En el ensamblaje <strong>Montaña (M)</strong>, la FD asintótica desciende de <strong>2.36 (q = 0)</strong> a <strong>1.21 (q = 2)</strong>, indicando una pérdida de diversidad funcional efectiva al considerar la dominancia de las especies. En contraste, el ensamblaje <strong>Laderas (P)</strong> mantiene valores más altos (FD ≈ 2.95 en <em>q = 0</em>), lo que sugiere una <strong>mayor amplitud de funciones ecológicas</strong> y una comunidad <strong>más heterogénea en sus rasgos funcionales</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Estimación observada y asintótica de diversidad funcional (FD) ---</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Carga la función principal del paquete iNEXT.3D</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ObsAsy3D calcula la diversidad funcional observada y asintótica</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co"># para distintos órdenes de diversidad q, empleando la matriz de distancias funcionales.</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>salida_abun3b <span class="ot">&lt;-</span> </span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ObsAsy3D</span>(</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  biol,                   <span class="co"># Matriz de abundancias (especies x sitios)</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">'FD'</span>,       <span class="co"># Diversidad funcional</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.5</span>),     <span class="co"># Valores de q (riqueza, Shannon y Simpson)</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype =</span> <span class="st">"abundance"</span>, <span class="co"># Tipo de datos: abundancias</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot =</span> <span class="dv">5</span>,              <span class="co"># Número de remuestreos bootstrap para IC</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM =</span> biol.dist.alfa, <span class="co"># Matriz de distancias funcionales (Gower)</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype =</span> <span class="st">'AUC'</span>          <span class="co"># Método AUC: integra todo el perfil τ (tau-profile)</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Visualización de resultados iniciales ---</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Muestra las primeras filas de la salida, incluyendo:</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ensamblaje, orden q, valor de FD, error estándar e intervalos de confianza.</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>salida_abun3b <span class="sc">%&gt;%</span> </span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Estimaciones observadas y asintóticas de diversidad funcional (FD) en los ensamblajes"</span>,</span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">booktabs =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Estimaciones observadas y asintóticas de diversidad funcional (FD) en los ensamblajes</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> qFD </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> qFD.LCL </th>
   <th style="text-align:right;"> qFD.UCL </th>
   <th style="text-align:left;"> Method </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 2.36 </td>
   <td style="text-align:right;"> 0.08 </td>
   <td style="text-align:right;"> 2.20 </td>
   <td style="text-align:right;"> 2.51 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 1.39 </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.38 </td>
   <td style="text-align:right;"> 1.40 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 1.27 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.26 </td>
   <td style="text-align:right;"> 1.28 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 1.5 </td>
   <td style="text-align:right;"> 1.23 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.23 </td>
   <td style="text-align:right;"> 1.23 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 2.0 </td>
   <td style="text-align:right;"> 1.21 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.20 </td>
   <td style="text-align:right;"> 1.21 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 2.95 </td>
   <td style="text-align:right;"> 0.39 </td>
   <td style="text-align:right;"> 2.18 </td>
   <td style="text-align:right;"> 3.72 </td>
   <td style="text-align:left;"> Asymptotic </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="figura-6.-perfil-q-de-diversidad-funcional" class="level5">
<h5 class="anchored" data-anchor-id="figura-6.-perfil-q-de-diversidad-funcional">Figura 6. Perfil-q de diversidad funcional</h5>
<p>El gráfico presenta los <strong>perfiles-q de diversidad funcional (FD)</strong> derivados de los valores observados y asintóticos para los tres ensamblajes: <strong>Montaña (M)</strong>, <strong>Laderas (P)</strong> y <strong>Desembocadura (RM)</strong>.<br>
Cada curva muestra cómo la diversidad funcional cambia cuando se modifican los <strong>pesos asignados a las especies según su abundancia</strong>, representados por el parámetro <strong>q</strong>.</p>
<p>En el eje <strong>X</strong> se ubica el <strong>orden de diversidad (q)</strong>, que varía entre 0 y 2, y en el eje <strong>Y</strong> se representa la <strong>diversidad funcional expresada como el área bajo la curva (AUC)</strong>.<br>
Las <strong>líneas continuas</strong> corresponden a las estimaciones <strong>asintóticas</strong>, mientras que las <strong>líneas punteadas</strong> representan los valores <strong>observados</strong>; las <strong>bandas sombreadas</strong> muestran los <strong>intervalos de confianza</strong> calculados mediante remuestreo (<em>bootstrap</em>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q-profile curves</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggObsAsy3D</span>(salida_abun3b, <span class="at">profile =</span> <span class="st">"q"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El patrón decreciente de las curvas indica que, al aumentar <strong>q</strong>, las especies dominantes adquieren mayor peso en el cálculo y la diversidad funcional efectiva se reduce. En este contexto, el ensamblaje <strong>RM</strong> mantiene los valores más altos de FD a lo largo del gradiente de q, lo que sugiere <strong>una comunidad con mayor amplitud funcional y menor redundancia entre especies</strong>. Por el contrario, <strong>M</strong> muestra una disminución más marcada, evidenciando <strong>una estructura funcional más homogénea</strong>, donde unas pocas especies dominantes concentran la mayoría de las funciones ecológicas.</p>
<hr>
</section>
</section>
</section>
<section id="c.2-diversidad-beta-filogenética-pd-y-funcional-fd" class="level3">
<h3 class="anchored" data-anchor-id="c.2-diversidad-beta-filogenética-pd-y-funcional-fd">C.2 Diversidad beta filogenética (PD) y funcional (FD)</h3>
<p>Tras estimar las diversidades taxonómica, filogenética y funcional mediante <strong>iNEXT3D (Chao et al., 2021)</strong>, el siguiente paso consiste en evaluar cómo varían estas dimensiones de la biodiversidad <strong>entre comunidades o ensamblajes</strong>, es decir, en el componente beta de la diversidad. Para ello se emplea el paquete <strong>iNEXTbeta3D (Chao et al., 2023)</strong>, una extensión directa de iNEXT.3D que implementa la <strong>rarefacción y extrapolación (R/E)</strong> para la diversidad beta en sus tres dimensiones: taxonómica (TD), filogenética (PD) y funcional (FD), bajo el mismo marco de los <strong>números de Hill</strong>.</p>
<p>El enfoque de <strong>iNEXTbeta3D</strong> se basa en la teoría de los <strong>números de Hill</strong> y su generalización a medidas filogenéticas y funcionales. En este marco unificado, la <strong>diversidad filogenética media (mean-PD)</strong> cuantifica el número efectivo de linajes independientes (ajustada por la profundidad del árbol), mientras que la <strong>diversidad funcional (FD)</strong> expresa el número efectivo de grupos funcionales o “especies funcionales virtuales”. Así, TD, PD y FD comparten una <strong>misma unidad de medida (equivalentes de especies)</strong>, lo que permite realizar comparaciones directas entre dimensiones de la diversidad.</p>
<p>En este sentido, mientras que <strong>iNEXT.3D (Chao et al., 2021)</strong> estima las tres dimensiones de la diversidad (taxonómica, filogenética y funcional) <strong>a nivel alfa</strong>, es decir, dentro de cada ensamblaje o comunidad, <strong>iNEXTbeta3D (Chao et al., 2023)</strong> amplía ese marco hacia la <strong>diversidad beta</strong>, introduciendo por primera vez un enfoque estadísticamente sólido y estandarizado para evaluar cómo <strong>varía la composición de especies, linajes o funciones ecológicas entre comunidades</strong>. Su aporte clave es la <strong>descomposición multiplicativa de la diversidad</strong> en sus tres componentes:</p>
<p><span class="math display">\[
\gamma = \alpha \times \beta
\]</span>donde:</p>
<ul>
<li><p><strong>α (alfa)</strong> representa la diversidad promedio dentro de los ensamblajes,</p></li>
<li><p><strong>γ (gamma)</strong> la diversidad total combinada de todos los ensamblajes, y</p></li>
<li><p><strong>β (beta)</strong> cuantifica la diferenciación o <strong>recambio (turnover)</strong> entre ellos.</p></li>
</ul>
<p>El paquete ofrece estimaciones <strong>estandarizadas por tamaño de muestra o cobertura</strong>, e incorpora cuatro clases de <strong>medidas de disimilitud</strong> basadas en cobertura, que reflejan la magnitud del cambio en la composición de especies, linajes o funciones ecológicas entre comunidades. En este apartado se dará prioridad a las dimensiones <strong>filogenética (PD)</strong> y <strong>funcional (FD)</strong>, con el fin de evaluar cómo la historia evolutiva compartida y los rasgos funcionales determinan los patrones de recambio a lo largo del gradiente ambiental estudiado.</p>
<p>Si el objetivo es <strong>evaluar la diversidad dentro de cada ensamblaje (α-diversidad)</strong> —por ejemplo, comparar la riqueza o diversidad funcional de comunidades aisladas—, el uso de <strong>iNEXT.3D</strong> es suficiente.<br>
Sin embargo, cuando se busca <strong>comparar comunidades</strong> y analizar el <strong>recambio filogenético o funcional (β-diversidad)</strong> a lo largo de gradientes ambientales, espaciales o temporales, <strong>se recomienda utilizar iNEXTbeta3D</strong>, ya que:</p>
<ol type="1">
<li><p><strong>Estandariza la comparación</strong> entre comunidades con distintos tamaños o esfuerzos de muestreo mediante cobertura, evitando sobre o subestimaciones.</p></li>
<li><p><strong>Permite interpretar β-diversidad filogenética y funcional en unidades comparables</strong>, expresadas como el número efectivo de linajes o grupos funcionales.</p></li>
<li><p><strong>Integra α, β y γ</strong> dentro del mismo marco analítico, facilitando inferencias ecológicas más completas sobre la estructuración de comunidades.</p></li>
</ol>
<p>Organización de los datos de abundancia</p>
<p>Similar a lo realizado en la diversidad beta, se utiliza la base de datos con las 87 especies de peces, para las tres zonas de la cuenca evaluada (<strong>?@tbl-tbl19</strong>).</p>
<hr>
<section id="a.-diversidad-beta-filogenética-con-inext.beta3d" class="level4">
<h4 class="anchored" data-anchor-id="a.-diversidad-beta-filogenética-con-inext.beta3d">A. Diversidad beta filogenética con iNEXT.beta3D</h4>
<p>Para calcular diversidad filogenética con <strong>iNEXT.beta3D</strong>, se requiere un <strong>árbol filogenético en formato <code>phylo</code></strong>, donde las ramas representen las relaciones evolutivas entre las especies analizadas. El siguiente procedimiento será similar al realizado con iNEXT3D, usando un código fuente <code>arbol.R</code>, para construir dicho árbol de forma semiautomática a partir de la lista de las especies desde la hoja <strong>“tax1”</strong> del archivo <code>datos.xlsx</code>, la cual contiene los nombres científicos completos y sus abreviaturas. Este formato permitirá el reconocimiento de cada especie con sus registros en bases de datos internacionales (como NCBI o GBIF).</p>
<p>El árbol filogenético requerido en este procedimiento con iNEXT.beta3D es diferente al usado para iNEXT3D, por lo siguiente:</p>
<ul>
<li><strong><code>arbol_filo</code></strong> (iNEXT3D) → árbol <em>global</em>, para evaluar <strong>diversidad filogenética dentro de ensamblajes</strong> (análisis alfa).</li>
<li><strong><code>arbol_filo_beta</code></strong> (iNEXT.beta3D) → árbol <em>filtrado o específico</em>, para evaluar <strong>diferencias filogenéticas entre ensamblajes</strong> (análisis beta).</li>
</ul>
<p>En otras palabras, el primero (iNEXT3D) responde a la pregunta:</p>
<blockquote class="blockquote">
<p>“¿Cuánta diversidad filogenética hay dentro de cada comunidad?”</p>
</blockquote>
<p>Mientras que el segundo iNEXT.beta3D) responde a:</p>
<blockquote class="blockquote">
<p>“¿Cuánto difieren las comunidades entre sí en términos de su composición filogenética?”</p>
</blockquote>
<hr>
</section>
<section id="cálculo-de-la-diversidad-beta-filogenética-con-inext.beta3d" class="level4">
<h4 class="anchored" data-anchor-id="cálculo-de-la-diversidad-beta-filogenética-con-inext.beta3d">1) Cálculo de la diversidad beta filogenética con iNEXT.beta3D</h4>
<p>El siguiente procedimiento resume el flujo de trabajo para calcular la <strong>diversidad filogenética beta (PD)</strong> mediante el paquete <code>iNEXT.beta3D</code>. Este análisis permite evaluar <strong>cuánto difieren las comunidades biológicas entre sí en términos evolutivos</strong>, integrando tanto la composición de especies como la estructura del árbol filogenético.</p>
<p>El proceso se divide en tres etapas: carga de insumos, alineación automática y ejecución del cálculo.</p>
<section id="cargar-insumos" class="level5">
<h5 class="anchored" data-anchor-id="cargar-insumos">1.1) Cargar insumos</h5>
<p>El análisis de diversidad filogenética <strong>beta</strong> con <code>iNEXT.beta3D</code> parte de la misma base de abundancias utilizada para el análisis alfa (<code>biol</code>), pero reorganizada en <strong>formato de lista</strong>, donde cada elemento representa un par de sitios o zonas de comparación.<br>
En este ejemplo se emplean tres zonas de la cuenca mexicana —<strong>M</strong> (montaña), <strong>P</strong> (laderas) y <strong>RM</strong> (desembocadura)—, lo que genera tres comparaciones posibles: <strong>M_vs_P</strong>, <strong>M_vs_RM</strong> y <strong>P_vs_RM</strong>.</p>
<p>El siguiente bloque transforma la matriz de abundancias en una lista con estas combinaciones, de modo que cada elemento pueda ser evaluado de forma independiente en el cálculo de diversidad beta.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl); </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr); </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr); </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Árbol (ya construido previamente) ---</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>arbol_filo_beta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"arbol_filo_beta.rds"</span>)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">inherits</span>(arbol_filo_beta, <span class="st">"phylo"</span>))</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>arbol_beta <span class="ot">&lt;-</span> arbol_filo_beta  <span class="co"># alias para claridad</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Matriz de abundancias 'biol' (Especies × Sitios: M,P,RM) ---</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (Si ya la tienes en el entorno, omite este bloque de lectura)</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Sites1, </span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Especies"</span>, </span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Abundancia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sites1, Especies) <span class="sc">%&gt;%</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundance =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Sites1, </span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Abundance, </span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"Especies"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Opcional: excluir especies problemáticas si aplica</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> biol[<span class="fu">rownames</span>(biol) <span class="sc">!=</span> <span class="st">"Notropis aguirrepequenoi"</span>, </span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a>             , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Tres pares (M_vs_P, M_vs_RM, P_vs_RM) ---</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"P"</span>,<span class="st">"RM"</span>) <span class="sc">%in%</span> <span class="fu">colnames</span>(biol)))</span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>biol_PD_beta <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_vs_P  =</span> biol[, <span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"P"</span>),  <span class="at">drop =</span> <span class="cn">FALSE</span>],</span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_vs_RM =</span> biol[, <span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"RM"</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>],</span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_vs_RM =</span> biol[, <span class="fu">c</span>(<span class="st">"P"</span>,<span class="st">"RM"</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>]</span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En este bloque se preparan los objetos necesarios para el análisis:</p>
<ul>
<li><p><code>arbol_filo_beta</code>: el árbol filogenético previamente construido y almacenado en formato <code>.rds</code>, con estructura de clase <code>phylo</code>.</p></li>
<li><p><code>biol_PD_beta</code>: la lista con las <strong>matrices de abundancia pareadas</strong> entre sitios o zonas (por ejemplo, <code>M_vs_P</code>, <code>M_vs_RM</code>, <code>P_vs_RM</code>).</p></li>
<li><p><code>tax1</code>: tabla de correspondencia entre abreviaturas (<code>Abbrev</code>) y nombres científicos (<code>LatinName</code>), utilizada solo si el árbol o las matrices no comparten el mismo formato de nombres.</p></li>
</ul>
<p>Este paso garantiza que los datos biológicos y evolutivos estén disponibles y correctamente formateados antes de la alineación.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl); </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT.beta3D)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>arbol_beta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"arbol_filo_beta.rds"</span>)   <span class="co"># phylo ya construido</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>tax1 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Abbrev =</span> <span class="dv">1</span>, <span class="at">LatinName =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="alineación-automática-con-alineador.r" class="level5">
<h5 class="anchored" data-anchor-id="alineación-automática-con-alineador.r">1.2) Alineación automática con <code>alineador.R</code></h5>
<p>El segundo paso consiste en <strong>garantizar que los nombres de especies del árbol y de las matrices coincidan exactamente</strong>.<br>
Este proceso, que solía requerir varios bloques de código, se simplifica mediante la función <code>alinear_beta()</code> definida en el archivo <code>alineador.R</code>.</p>
<p>Esta función ejecuta internamente tres acciones:</p>
<ol type="1">
<li><p><strong>Estandarización de nombres</strong><br>
Limpia los nombres de especies en todas las matrices (<code>biol_PD_beta</code>) y en el árbol (<code>arbol_beta</code>), eliminando espacios o inconsistencias tipográficas.<br>
Si el árbol se encuentra en formato de abreviaturas, se reetiquetan automáticamente los tips con los nombres científicos completos, usando el diccionario <code>tax1</code>.</p></li>
<li><p><strong>Poda y sincronización</strong><br>
Identifica las especies comunes entre el árbol y las matrices y elimina aquellas que no aparecen simultáneamente.<br>
El árbol resultante conserva únicamente las especies efectivamente presentes en los datos, evitando errores de desajuste durante el cálculo.</p></li>
<li><p><strong>Alineación estructural</strong><br>
Rellena las especies faltantes con valores de abundancia cero y reordena las filas de todas las matrices según el orden de los tips del árbol.<br>
Esto asegura una correspondencia exacta uno a uno entre la información biológica y la filogenética.</p></li>
</ol>
<p>El resultado es un conjunto de datos <strong>estructuralmente coherente y listo para el análisis</strong>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"alineador.R"</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>ali <span class="ot">&lt;-</span> <span class="fu">alinear_beta</span>(biol_PD_beta, arbol_beta, <span class="at">tax1 =</span> tax1)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>biol_PD <span class="ot">&lt;-</span> ali<span class="sc">$</span>pairs_aligned     <span class="co"># lista final alineada con el árbol</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>arbol_PD  <span class="ot">&lt;-</span> ali<span class="sc">$</span>tree_aligned     <span class="co"># árbol podado y reordenado</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>ali<span class="sc">$</span>report                        <span class="co"># diagnóstico resumido del proceso</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$n_pairs
[1] 3

$n_tips_tree_in
[1] 84

$n_tips_tree_out
[1] 84

$relabeled_tree
[1] TRUE

$tips_dropped
[1] "Agonostomus monticola" "Symphurus civitatium" 

$species_union
[1] 86

$species_kept
[1] 84</code></pre>
</div>
</div>
<p>El objeto <code>ali$report</code> incluye un resumen del alineamiento, con información como el número de especies iniciales y finales, si el árbol fue reetiquetado, y cuántos tips fueron eliminados o conservados.<br>
Esto permite documentar la trazabilidad del procedimiento y verificar su reproducibilidad.</p>
</section>
<section id="cálculo-de-la-diversidad-beta-filogenética" class="level5">
<h5 class="anchored" data-anchor-id="cálculo-de-la-diversidad-beta-filogenética">1.3) Cálculo de la diversidad beta filogenética</h5>
<p>Una vez alineados los datos de abundancia con el árbol filogenético, se procede al cálculo de la <strong>diversidad filogenética beta</strong> mediante la función <code>iNEXTbeta3D()</code>. En este caso, se selecciona la opción <code>diversity = "PD"</code> para estimar la diversidad filogenética basada en las distancias evolutivas entre las especies registradas en cada par de ensamblajes de peces. El parámetro <code>base = "coverage"</code> indica que el procedimiento realiza <strong>rarefacción y extrapolación basadas en cobertura</strong>, es decir, ajusta los cálculos a un nivel de completitud muestral comparable entre zonas, evitando sesgos por diferencias en el esfuerzo de muestreo.</p>
<p>Se define <code>PDtype = "meanPD"</code>, lo que expresa la diversidad como el <strong>número efectivo de linajes igualmente divergentes</strong>, un estimador robusto y comparable de la diversidad filogenética entre comunidades. El argumento <code>biol_PD</code> representa la <strong>lista de matrices de abundancia</strong> para cada combinación pareada de zonas —en este caso, Montaña (M), Laderas (P) y Desembocadura (RM)—, mientras que <code>arbol_PD</code> proporciona el <strong>árbol filogenético sincronizado</strong> con los mismos nombres de especies. En este contexto, <code>Reftime = 50</code> es el tiempo de referencia (en millones de años) correspondiente a la raíz del árbol (<code>PDreftime = NULL</code> por defecto) Esto representa la <strong>edad del ancestro común más antiguo</strong> del conjunto de especies analizadas (la profundidad del árbol).</p>
<p>Durante la ejecución, <code>iNEXTbeta3D()</code> calcula simultáneamente tres componentes:</p>
<ul>
<li><p><strong>γ (gamma)</strong>: la diversidad total combinada de las dos zonas comparadas,</p></li>
<li><p><strong>α (alfa)</strong>: la diversidad promedio dentro de las zonas, y</p></li>
<li><p><strong>β (beta)</strong>: el grado de <strong>diferenciación filogenética entre zonas</strong>, expresado como el cociente γ/α.</p></li>
</ul>
<p>Estos componentes pueden estandarizarse por cobertura o tamaño de muestra, y se acompañan de estimadores de incertidumbre obtenidos mediante <strong>bootstrap</strong> (aquí con <code>nboot = 10</code> repeticiones).</p>
<p>El resultado, como se muestra en la tabla siguiente, presenta para cada comparación (por ejemplo, M_vs_P) los valores de diversidad filogenética (qPD) en función del orden de diversidad q, el nivel de cobertura (SC), el tamaño de muestra equivalente y los intervalos de confianza. En este caso, los resultados indican cómo la <strong>diversidad filogenética efectiva</strong> varía con el grado de completitud muestral, permitiendo identificar qué tan diferentes son las comunidades en términos de su historia evolutiva compartida.</p>
<table class="table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Ejemplo</strong>: comparación M_vs_P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Orden q = 0</strong> → refleja la riqueza filogenética total (todas las especies pesan igual).</td>
</tr>
<tr class="even">
<td><strong>Orden q = 1</strong> → pondera las ramas según su abundancia relativa.</td>
</tr>
<tr class="odd">
<td><strong>Orden q = 2</strong> → enfatiza las especies (o linajes) dominantes.</td>
</tr>
</tbody>
</table>
<p>De este modo, un valor de <code>meanPD</code> mayor en una comparación implica una <strong>mayor diferenciación evolutiva</strong> entre las comunidades, mientras que valores cercanos a uno indican un <strong>ensamblaje filogenéticamente similar</strong> entre zonas.<br>
Esta información resulta clave para interpretar la estructura biogeográfica y los patrones de recambio filogenético en gradientes ambientales o espaciales, como los observados entre las zonas de montaña, laderas y desembocadura de la cuenca.</p>
<blockquote class="blockquote">
<p><strong>Nota</strong>: Los valores de <strong>Gamma (meanPD)</strong> representan el número efectivo de linajes filogenéticamente diferenciados bajo el enfoque de cobertura estandarizada.</p>
</blockquote>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>salida.abun21 <span class="ot">&lt;-</span> <span class="fu">iNEXTbeta3D</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  biol_PD,</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"PD"</span>,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtree    =</span> arbol_PD,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">base      =</span> <span class="st">"coverage"</span>,</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot     =</span> <span class="dv">10</span>,</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDreftime =</span> <span class="cn">NULL</span>,</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtype    =</span> <span class="st">"meanPD"</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen (ejemplo: primera combinación de zonas $M_vs_P)</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>salida.abun21<span class="sc">$</span>M_vs_P<span class="sc">$</span>gamma <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Diversidad filogenética gamma (γ) de las comparaciones pareadas entre las zonas de montaña (M) y laderas (P)"</span>, </span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Diversidad filogenética gamma (γ) de las comparaciones pareadas entre las zonas de montaña (M) y laderas (P)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> Size </th>
   <th style="text-align:right;"> Gamma </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> LCL </th>
   <th style="text-align:right;"> UCL </th>
   <th style="text-align:left;"> Diversity </th>
   <th style="text-align:right;"> Reftime </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 4.12 </td>
   <td style="text-align:right;"> 1.99 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 1.96 </td>
   <td style="text-align:right;"> 2.01 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 4.54 </td>
   <td style="text-align:right;"> 2.06 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 2.04 </td>
   <td style="text-align:right;"> 2.09 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.55 </td>
   <td style="text-align:right;"> 4.97 </td>
   <td style="text-align:right;"> 2.14 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 2.11 </td>
   <td style="text-align:right;"> 2.17 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.58 </td>
   <td style="text-align:right;"> 5.50 </td>
   <td style="text-align:right;"> 2.22 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.01 </td>
   <td style="text-align:right;"> 2.19 </td>
   <td style="text-align:right;"> 2.25 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 6.05 </td>
   <td style="text-align:right;"> 2.30 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.27 </td>
   <td style="text-align:right;"> 2.33 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 6.74 </td>
   <td style="text-align:right;"> 2.39 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.36 </td>
   <td style="text-align:right;"> 2.42 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># También se puede tabular la diversidad alfa y beta para esas dos localidades</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun21$M_vs_P$alpha %&gt;% ...</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun21$M_vs_P$beta %&gt;% ... </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="figura-1.-curvas-de-rarefacción-y-extrapolación-de-la-diversidad-beta-filogenética" class="level5">
<h5 class="anchored" data-anchor-id="figura-1.-curvas-de-rarefacción-y-extrapolación-de-la-diversidad-beta-filogenética">Figura 1. Curvas de rarefacción y extrapolación de la diversidad beta filogenética</h5>
<p>El gráfico generado por la función <code>ggiNEXTbeta3D()</code> muestra las curvas de rarefacción y extrapolación de la diversidad filogenética (PD) para las tres comparaciones pareadas de ensamblajes: <strong>montaña–laderas (M_vs_P)</strong>, <strong>montaña–desembocadura (M_vs_RM)</strong> y <strong>laderas–desembocadura (P_vs_RM)</strong>.<br>
Cada panel representa uno de los <strong>órdenes de diversidad de Hill (q = 0, 1 y 2)</strong>, que ponderan de manera diferente la abundancia relativa de las especies:</p>
<ul>
<li><p><strong>q = 0</strong> considera únicamente la riqueza de linajes (todas las especies pesan igual).</p></li>
<li><p><strong>q = 1</strong> da mayor peso a los linajes abundantes (equivalente al índice exponencial de Shannon).</p></li>
<li><p><strong>q = 2</strong> resalta los linajes dominantes (relacionado con el índice de Simpson).</p></li>
</ul>
<p>Las filas del gráfico corresponden a los tres componentes de la diversidad filogenética:</p>
<ul>
<li><p><strong>Gamma (γ):</strong> diversidad total combinada de las comunidades comparadas.</p></li>
<li><p><strong>Alpha (α):</strong> diversidad promedio dentro de las comunidades.</p></li>
<li><p><strong>Beta (β):</strong> grado de diferenciación filogenética entre comunidades, calculado como γ/α.</p></li>
</ul>
<p>El eje <em>x</em> representa la <strong>cobertura muestral (Sample coverage)</strong>, que estandariza el esfuerzo de muestreo y permite comparar comunidades con diferentes tamaños de muestra. Las líneas continuas indican la porción de <strong>rarefacción (submuestreo)</strong> y las líneas discontinuas la <strong>extrapolación (proyección)</strong> hacia una cobertura completa (1.0).</p>
<p>En este ejemplo, las curvas de β-diversidad (fila inferior) evidencian <strong>una mayor diferenciación filogenética entre las zonas de montaña y desembocadura (M_vs_RM)</strong>, lo que sugiere un recambio evolutivo más pronunciado entre extremos altitudinales. Las diferencias se atenúan para q = 2, indicando que los linajes dominantes son más compartidos entre ensamblajes, mientras que las especies raras (q = 0) aportan gran parte de la singularidad filogenética observada.</p>
<p>Este enfoque gráfico, basado en la <strong>rarefacción y extrapolación estandarizada por cobertura</strong>, integra simultáneamente la información taxonómica, evolutiva y de completitud de muestreo, ofreciendo una visión robusta y comparable de la diversidad filogenética entre comunidades.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coverage-based R/E sampling curves for phylogenetic gamma, alpha and beta diversity</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXTbeta3D</span>(salida.abun21, <span class="at">type =</span> <span class="st">'B'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figura-2.-curvas-de-rarefacción-y-extrapolación-basadas-en-el-tamaño-de-muestra" class="level5">
<h5 class="anchored" data-anchor-id="figura-2.-curvas-de-rarefacción-y-extrapolación-basadas-en-el-tamaño-de-muestra">Figura 2. Curvas de rarefacción y extrapolación basadas en el tamaño de muestra</h5>
<p>El segundo enfoque disponible en <strong>iNEXT.beta3D()</strong> permite estandarizar la diversidad en función del <strong>tamaño de muestra (base = “size”)</strong>, en lugar de la cobertura de muestreo. En este caso, las curvas se construyen incrementando progresivamente el número de individuos (<em>Number of individuals</em>) hasta el doble del tamaño de muestra de referencia, lo que permite observar cómo varía la diversidad filogenética esperada a medida que aumenta el esfuerzo de colecta.</p>
<p>El gráfico muestra las curvas de rarefacción (líneas continuas) y extrapolación (líneas discontinuas) para la <strong>diversidad filogenética gamma (γ)</strong> y <strong>alfa (α)</strong>, bajo tres órdenes de diversidad (q = 0, 1, 2).</p>
<ul>
<li><p>El panel superior (γ) refleja la <strong>diversidad filogenética total combinada</strong> de las zonas comparadas.</p></li>
<li><p>El panel inferior (α) representa la <strong>diversidad promedio dentro de las comunidades</strong>.</p></li>
</ul>
<p>En ambos casos, el eje <em>x</em> corresponde al número acumulado de individuos, mientras que el eje <em>y</em> muestra el valor promedio de diversidad filogenética (<em>mean phylogenetic diversity</em>). Las comparaciones entre ensamblajes —<strong>M_vs_P</strong>, <strong>M_vs_RM</strong> y <strong>P_vs_RM</strong>— permiten observar cómo la diversidad total y la interna responden al incremento del tamaño de muestra.</p>
<p>A diferencia del enfoque basado en cobertura, el método <em>size-based</em> <strong>no genera estimaciones válidas para la diversidad beta (β)</strong> ni para los índices de disimilitud, ya que el tamaño de muestra no controla adecuadamente la heterogeneidad entre ensamblajes. Por ello, los resultados se limitan a los componentes γ y α.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>salida.abun22 <span class="ot">&lt;-</span> <span class="fu">iNEXTbeta3D</span>(</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  biol_PD,</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"PD"</span>,</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtree    =</span> arbol_PD,</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">base      =</span> <span class="st">"size"</span>,</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot     =</span> <span class="dv">10</span>,</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDreftime =</span> <span class="cn">NULL</span>,</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtype    =</span> <span class="st">"meanPD"</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen (ejemplo: primera combinación de zonas $M_vs_P)</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>salida.abun22<span class="sc">$</span>M_vs_P<span class="sc">$</span>gamma <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Diversidad filogenética gamma (γ) de las comparaciones pareadas entre las zonas de montaña (M) y laderas (P)"</span>, </span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Diversidad filogenética gamma (γ) de las comparaciones pareadas entre las zonas de montaña (M) y laderas (P)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> Size </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> Gamma </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> LCL </th>
   <th style="text-align:right;"> UCL </th>
   <th style="text-align:left;"> Diversity </th>
   <th style="text-align:right;"> Reftime </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.18 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 912 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 7.69 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.09 </td>
   <td style="text-align:right;"> 7.51 </td>
   <td style="text-align:right;"> 7.87 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1823 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 8.11 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 7.87 </td>
   <td style="text-align:right;"> 8.35 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2734 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 8.32 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 8.02 </td>
   <td style="text-align:right;"> 8.62 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3645 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 8.47 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.18 </td>
   <td style="text-align:right;"> 8.11 </td>
   <td style="text-align:right;"> 8.83 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4556 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 8.59 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 8.17 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:left;"> meanPD </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># También se puede tabular la diversidad alfa para esas dos localidades</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun22$M_vs_P$alpha %&gt;% ...</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En este ejemplo, las curvas indican que la diversidad filogenética total (γ) aumenta rápidamente en las etapas iniciales del muestreo, especialmente en la comparación <strong>M_vs_RM</strong>, reflejando una mayor acumulación de linajes evolutivamente distintos al incorporar más individuos. Sin embargo, la diversidad dentro de los ensamblajes (α) se estabiliza pronto, lo que sugiere que la mayoría de los linajes comunes ya se encuentran representados con tamaños de muestra moderados.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXTbeta3D</span>(salida.abun22)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Figura X.Y.</strong> Curvas de rarefacción y extrapolación basadas en tamaño de muestra para la diversidad filogenética (meanPD) de los ensamblajes de peces en montaña (M), laderas (P) y desembocadura (RM).<br>
Las líneas continuas representan la rarefacción y las discontinuas la extrapolación. Cada panel corresponde a un orden de diversidad (q = 0, 1 y 2) y a un componente de la diversidad (γ y α).<br>
Se observa un incremento inicial pronunciado de la diversidad filogenética total (γ) al aumentar el tamaño de muestra, mientras que la diversidad interna (α) tiende a estabilizarse, reflejando una saturación de los linajes más comunes.</p>
</blockquote>
<hr>
</section>
<section id="información-general-de-la-beta-filogenética-con-la-función-datainfobeta3d" class="level5">
<h5 class="anchored" data-anchor-id="información-general-de-la-beta-filogenética-con-la-función-datainfobeta3d">2) Información general de la beta filogenética con la función DataInfobeta3D()</h5>
<p>La función <strong><code>DataInfobeta3D()</code></strong> cumple un papel diagnóstico esencial antes del cálculo de la diversidad funcional beta. Su finalidad es <strong>resumir las características básicas de los datos funcionales y de abundancia</strong>, permitiendo evaluar la <strong>representatividad</strong> y <strong>completitud</strong> de los ensamblajes antes de aplicar los modelos de rarefacción y extrapolación.</p>
<p>El procedimiento entrega información resumida para tres niveles de organización:</p>
<ol type="1">
<li><p><strong>Cada ensamblaje individual (α):</strong> evalúa la diversidad funcional local de cada sitio.</p></li>
<li><p><strong>El ensamblaje combinado (γ):</strong> representa la diversidad total al unir ambos sitios del par.</p></li>
<li><p><strong>El ensamblaje conjunto (base de β):</strong> resume el conjunto funcional compartido y las diferencias entre comunidades.</p></li>
</ol>
<p>Los indicadores presentados en la tabla incluyen:</p>
<ul>
<li><p><strong>n:</strong> número total de individuos muestreados.</p></li>
<li><p><strong>S.obs:</strong> riqueza observada de especies.</p></li>
<li><p><strong>SC(n)</strong> y <strong>SC(2n):</strong> coberturas de muestra observada y extrapolada, que expresan la completitud del muestreo.</p></li>
<li><p><strong>PD.obs:</strong> longitud total observada del árbol filogenético abarcado por las especies de cada ensamblaje.</p></li>
<li><p><strong>f₁*</strong> y <strong>f₂*:</strong> número de ramas o nodos representados por especies únicas (simpletones) y duplicadas (dobletones).</p></li>
<li><p><strong>g₁</strong> y <strong>g₂:</strong> longitud filogenética total correspondiente a esas ramas únicas o duplicadas, respectivamente.</p></li>
<li><p><strong>Reftime:</strong> tiempo de referencia filogenético (edad del nodo basal del árbol).</p></li>
</ul>
<p>Los valores de <strong>cobertura (SC)</strong> próximos a <strong>1.00</strong> indican que el muestreo fue <strong>altamente completo</strong>, tanto a nivel local (α) como combinado (γ), garantizando la representatividad de los linajes observados.<br>
El aumento de <strong>PD.obs</strong> en los ensamblajes combinados y conjuntos evidencia una <strong>ampliación del espacio filogenético</strong>, producto de la incorporación de especies que pertenecen a diferentes ramas del árbol evolutivo.</p>
<p>Los valores más altos de <strong>f₁*</strong>, <strong>f₂*</strong>, <strong>g₁</strong> y <strong>g₂</strong> en la <strong>zona de desembocadura (RM)</strong> reflejan la presencia de <strong>linajes únicos y evolutivamente distantes</strong>, lo que sugiere un aporte significativo de esta zona a la diversidad filogenética regional.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data information for phylogenetic diversity</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>informacion_gral <span class="ot">&lt;-</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DataInfobeta3D</span>(</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> biol_PD,         <span class="co"># matrices de abundancia por pares</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"PD"</span>,            <span class="co"># dimensión funcional</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,     <span class="co"># datos cuantitativos</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDtree    =</span> arbol_PD,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">PDreftime =</span> <span class="cn">NULL</span>)</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla general</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>informacion_gral <span class="sc">%&gt;%</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Información general de la diversidad beta filogenética"</span>, </span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Información general de la diversidad beta filogenética</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> PD.obs </th>
   <th style="text-align:right;"> f1* </th>
   <th style="text-align:right;"> f2* </th>
   <th style="text-align:right;"> g1 </th>
   <th style="text-align:right;"> g2 </th>
   <th style="text-align:right;"> Reftime </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 12172 </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 359.92 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 24.52 </td>
   <td style="text-align:right;"> 3.43 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5140 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 427.45 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.18 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 17312 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 469.64 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.98 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 17312 </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 787.37 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 70.70 </td>
   <td style="text-align:right;"> 3.43 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 12172 </td>
   <td style="text-align:right;"> 29 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 359.92 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 24.52 </td>
   <td style="text-align:right;"> 3.43 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 411 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 840.35 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 169.46 </td>
   <td style="text-align:right;"> 100.07 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 12583 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1093.49 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 193.98 </td>
   <td style="text-align:right;"> 103.49 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 12583 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1200.27 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 193.98 </td>
   <td style="text-align:right;"> 103.49 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5140 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 427.45 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.18 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 411 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 840.35 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 169.46 </td>
   <td style="text-align:right;"> 100.07 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 5551 </td>
   <td style="text-align:right;"> 76 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1075.32 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 173.58 </td>
   <td style="text-align:right;"> 83.47 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 5551 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1267.79 </td>
   <td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 215.63 </td>
   <td style="text-align:right;"> 100.07 </td>
   <td style="text-align:right;"> 50 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
</section>
<section id="b.-diversidad-beta-funcional---fd-beta-con-inext.beta3d" class="level4">
<h4 class="anchored" data-anchor-id="b.-diversidad-beta-funcional---fd-beta-con-inext.beta3d">B. Diversidad beta funcional - FD beta con iNEXT.beta3D</h4>
<p>El análisis de diversidad funcional <strong>beta</strong> con <code>iNEXT.beta3D</code> parte de la misma base de abundancias utilizada para el análisis alfa (<code>biol</code>), pero reorganizada en <strong>formato de lista</strong>, donde cada elemento representa un par de sitios o zonas de comparación.<br>
En este ejemplo se emplean tres zonas de la cuenca mexicana —<strong>M</strong> (montaña), <strong>P</strong> (laderas) y <strong>RM</strong> (desembocadura)—, lo que genera tres comparaciones posibles: <strong>M_vs_P</strong>, <strong>M_vs_RM</strong> y <strong>P_vs_RM</strong>.</p>
<hr>
</section>
<section id="construir-la-matriz-de-abundancias-especies-sitios-1" class="level4">
<h4 class="anchored" data-anchor-id="construir-la-matriz-de-abundancias-especies-sitios-1">1) Construir la matriz de abundancias (Especies × Sitios)</h4>
<p>Se carga la hoja <strong><code>tax</code></strong>, se limpian los encabezados (espacios al final), se detecta la columna de sitios (<code>Sites</code>/<code>Sites1</code>), y se pivotea <strong>solo</strong> las columnas numéricas (especies). El resultado es <code>biol</code>, con especies en filas y sitios en columnas.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 1: Abundancias (Especies × Sitios)</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a>biol_raw <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"tax"</span>)</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co"># limpiar espacios finales en encabezados (importante en tu hoja)</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(biol_raw) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="fu">names</span>(biol_raw), <span class="st">"</span><span class="sc">\\</span><span class="st">s+$"</span>, <span class="st">""</span>)</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="co"># detectar columna de sitio y estandarizar a "Site"</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>site_col <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">c</span>(<span class="st">"Sites1"</span>,<span class="st">"Sites"</span>,<span class="st">"Sitio"</span>,<span class="st">"Station"</span>,<span class="st">"Site"</span>), </span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">names</span>(biol_raw)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">first</span>()</span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="sc">!</span><span class="fu">is.null</span>(site_col))</span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> biol_raw <span class="sc">%&gt;%</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> <span class="sc">!!</span>site_col) <span class="sc">%&gt;%</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivotear SOLO columnas numéricas (evita mezclar "Site" carácter con especies numéricas)</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Especies"</span>, </span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Abundancia"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abundancia =</span> <span class="fu">as.numeric</span>(Abundancia)) <span class="sc">%&gt;%</span></span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especies, Site) <span class="sc">%&gt;%</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundancia =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Site, <span class="at">values_from =</span> Abundancia, </span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"Especies"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="armar-los-pares-de-sitios-para-β-fd" class="level4">
<h4 class="anchored" data-anchor-id="armar-los-pares-de-sitios-para-β-fd">2) Armar los pares de sitios para β-FD</h4>
<p>A partir de <code>biol</code>, se generan las tres combinaciones: <strong>M_vs_P</strong>, <strong>M_vs_RM</strong> y <strong>P_vs_RM</strong> en la lista <code>biol_FD_beta</code>. Estos serán los ensamblajes que se comparan para FD β.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 2: Pares de sitios (β-FD)</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>sitios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"P"</span>,<span class="st">"RM"</span>); </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(sitios <span class="sc">%in%</span> <span class="fu">colnames</span>(biol)))</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>nombres_pares <span class="ot">&lt;-</span> <span class="fu">combn</span>(sitios, <span class="dv">2</span>, <span class="at">FUN =</span> \(p) <span class="fu">paste</span>(p, <span class="at">collapse =</span> <span class="st">"_vs_"</span>))</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>biol_FD_beta <span class="ot">&lt;-</span> <span class="fu">combn</span>(sitios, <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(nombres_pares) <span class="sc">%&gt;%</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(\(p) biol[, p, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="preparar-rasgos-funcionales" class="level4">
<h4 class="anchored" data-anchor-id="preparar-rasgos-funcionales">3) Preparar rasgos funcionales</h4>
<p>Se lee la base de <strong><code>rasgos</code></strong>, se convierten las variables continuas a numéricas y binarias a 0/1 (homogeneizando Sí/No/True/False). Se quitan especies con NA en los rasgos usados y se dejan los nombres científicos como <code>rownames</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 3: Rasgos funcionales</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>rasgos <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"rasgos"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(TrophicLevel, BodyLength, BodyLengthMax, ShapeFactor), as.numeric),</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(omnivory, detritivory, herbivory, invertivory, piscivory, carnivory),</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span> <span class="fu">case_when</span>(</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>             .x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Sí"</span>,<span class="st">"Si"</span>,<span class="st">"yes"</span>,<span class="st">"TRUE"</span>,<span class="st">"True"</span>,<span class="st">"true"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>             .x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"no"</span>,<span class="st">"FALSE"</span>,<span class="st">"False"</span>,<span class="st">"false"</span>,<span class="st">"0"</span>,<span class="st">""</span>)  <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>           ))</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(TrophicLevel<span class="sc">:</span>carnivory) <span class="sc">%&gt;%</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"LatinName"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="distancias-funcionales-gower" class="level4">
<h4 class="anchored" data-anchor-id="distancias-funcionales-gower">4) Distancias funcionales (Gower)</h4>
<p>Calculamos la <strong>distancia de Gower</strong> con <code>FD::gowdis()</code> y la pasamos a matriz cuadrada con nombres (<code>biol.dist.beta</code>).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 4: Distancias funcionales (Gower)</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>biol.dist.beta <span class="ot">&lt;-</span> <span class="fu">gowdis</span>(rasgos) <span class="sc">%&gt;%</span> </span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="alinear-abundancias-rasgos" class="level4">
<h4 class="anchored" data-anchor-id="alinear-abundancias-rasgos">5) Alinear “abundancias ↔︎ rasgos”</h4>
<p>Se define a <code>pares_sp</code> como el conjunto de especies presentes en <strong>al menos un</strong> par de <code>biol_FD_beta</code> y se cruzan con las especies que tienen rasgos (<code>rownames(biol.dist.beta)</code>), obteniendo <strong><code>alinear_sp</code></strong>.<br>
Con <code>alinear_sp</code>:</p>
<ul>
<li><p><strong>Se poda y ordena</strong> la matriz de distancias (<code>biol.dist.beta</code>).</p></li>
<li><p><strong>Se rellena y reordena</strong> cada matriz de abundancia 2-columnas en <code>biol_FD_beta</code> para que todas tengan <strong>exactamente</strong> <code>alinear_sp</code> en el mismo orden.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 5: Alineación abundancias ↔ rasgos</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co"># especies presentes en ≥1 par de sitios</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>pares_sp <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(biol_FD_beta, rownames)))</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># intersección con especies que tienen rasgos/distancias</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>alinear_sp  <span class="ot">&lt;-</span> <span class="fu">intersect</span>(pares_sp, <span class="fu">rownames</span>(biol.dist.beta))</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">length</span>(alinear_sp) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co"># podar/ordenar matriz de distancias al conjunto de trabajo</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>biol.dist.beta <span class="ot">&lt;-</span> biol.dist.beta[alinear_sp, alinear_sp, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co"># función para rellenar y reordenar cada matriz 2-columnas al orden 'alinear_sp'</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>relleno_sp <span class="ot">&lt;-</span> <span class="cf">function</span>(X, ref_sp){</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(X)</span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  missing <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(ref_sp, <span class="fu">rownames</span>(X))</span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(missing)) {</span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>      X,</span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(missing), <span class="at">ncol =</span> <span class="fu">ncol</span>(X),</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">dimnames =</span> <span class="fu">list</span>(missing, <span class="fu">colnames</span>(X)))</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[ref_sp, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a>  X[] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(X, \(v) <span class="fu">suppressWarnings</span>(<span class="fu">as.numeric</span>(v)))</span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(X)</span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true" tabindex="-1"></a>biol_FD_beta <span class="ot">&lt;-</span> <span class="fu">map</span>(biol_FD_beta, relleno_sp, <span class="at">ref_sp =</span> alinear_sp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="chequeos-de-consistencia" class="level4">
<h4 class="anchored" data-anchor-id="chequeos-de-consistencia">6) Chequeos de consistencia</h4>
<p>Verificar la simetría y los nombres. Con esto, todo queda listo para llamar <code>iNEXTbeta3D()</code>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 6: Chequeos de consistencia</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------------------</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">is.matrix</span>(biol.dist.beta), <span class="fu">isSymmetric</span>(biol.dist.beta))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">identical</span>(<span class="fu">rownames</span>(biol.dist.beta), <span class="fu">colnames</span>(biol.dist.beta)))</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">all</span>(<span class="fu">map_lgl</span>(biol_FD_beta, \(m) <span class="fu">identical</span>(<span class="fu">rownames</span>(m), alinear_sp))))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="diversidad-beta-funcional-fd-por-re-rarefacción-y-extrapolación" class="level4">
<h4 class="anchored" data-anchor-id="diversidad-beta-funcional-fd-por-re-rarefacción-y-extrapolación">7) Diversidad beta funcional FD por R/E (rarefacción y extrapolación)</h4>
<p>El objetivo de este bloque es estimar y comparar la <strong>diversidad funcional entre comunidades</strong> bajo un marco de <strong>rarefacción y extrapolación (R/E)</strong>, lo cual permite estandarizar la comparación entre sitios que difieren en el tamaño de muestra o cobertura.<br>
El enfoque R/E busca representar cómo cambia la diversidad a medida que aumenta el esfuerzo de muestreo, y proyectar la diversidad esperada más allá del esfuerzo observado.</p>
<p>En este caso, se trabaja con:</p>
<ul>
<li><p><strong>Datos de abundancia</strong>, almacenados en <code>biol_FD_beta</code> (pares de sitios como M_vs_P, M_vs_RM, etc.).</p></li>
<li><p><strong>Matriz de distancias funcionales</strong>, <code>biol.dist.beta</code>, que describe las disimilitudes funcionales entre especies según sus rasgos.</p></li>
</ul>
<p>La función <code>iNEXTbeta3D()</code> permite calcular la <strong>diversidad beta multicomponente</strong> (α, β, γ) para tres dimensiones de la diversidad: taxonómica (TD), funcional (FD) y filogenética (PD). En este caso, el interés se centra en la <strong>diversidad funcional (FD)</strong>, con las siguientes configuraciones:</p>
<ul>
<li><p><strong>FDtype = “AUC”</strong> indica que se usa el método de <strong>área bajo la curva (Area Under Curve)</strong>, que evalúa la diversidad funcional integrando todas las distancias posibles entre 0 y 1.<br>
Este enfoque evita depender de un umbral arbitrario para definir “diferencias funcionales” y ofrece una estimación más continua de la diversidad.</p></li>
<li><p><strong>base = “coverage”</strong> estandariza las comparaciones en función de la <strong>cobertura de muestra</strong>, garantizando que los ensamblajes se comparen a igual grado de completitud en lugar de igual número de individuos.</p></li>
<li><p><strong>nboot = 5</strong> define el número de remuestreos para obtener intervalos de confianza (puede aumentarse para análisis finales).</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R/E Analysis with functional diversity for abundance data - FDtype = 'AUC' (area under curve)</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT.beta3D)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de abundancia: biol_FD_beta</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancias: biol.dist.beta</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamada final</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>salida_abun31 <span class="ot">&lt;-</span> <span class="fu">iNEXTbeta3D</span>(</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> biol_FD_beta,  <span class="co"># matrices de abundancia por pares</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"FD"</span>,           <span class="co"># dimensión funcional</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,    <span class="co"># datos cuantitativos</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">base      =</span> <span class="st">"coverage"</span>,     <span class="co"># estandarización por cobertura</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot     =</span> <span class="dv">5</span>,              <span class="co"># número de remuestreos bootstrap</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM   =</span> biol.dist.beta, <span class="co"># matriz de distancias funcionales (Gower)</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype    =</span> <span class="st">"AUC"</span>,          <span class="co"># método AUC (área bajo la curva)</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDcut_number =</span> <span class="dv">30</span>           <span class="co"># número de umbrales considerados</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>El objeto <code>salida_abun31</code> es una lista anidada que contiene los resultados para cada par de sitios (p.&nbsp;ej. <code>M_vs_P</code>, <code>M_vs_RM</code>, <code>P_vs_RM</code>). Dentro de cada par se incluyen tres componentes:</p>
<ul>
<li><p><code>alpha</code>: diversidad promedio dentro de los ensamblajes (local o intra-sitio).</p></li>
<li><p><code>beta</code>: diferenciación funcional entre los ensamblajes.</p></li>
<li><p><code>gamma</code>: diversidad total combinada (regional o inter-sitio).</p></li>
</ul>
<p>El ejemplo mostrado tabula los primeros valores de <strong>diversidad funcional gamma (γ)</strong> para la comparación entre las zonas <strong>montaña (M)</strong> y <strong>laderas (P)</strong>:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen (ejemplo: primera combinación de zonas $M_vs_P)</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>salida_abun31<span class="sc">$</span>M_vs_P<span class="sc">$</span>gamma <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Diversidad funcional gamma (γ) entre las zonas de montaña (M) y laderas (P)"</span>, </span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Diversidad funcional gamma (γ) entre las zonas de montaña (M) y laderas (P)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> Size </th>
   <th style="text-align:right;"> Gamma </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> LCL </th>
   <th style="text-align:right;"> UCL </th>
   <th style="text-align:left;"> Diversity </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.50 </td>
   <td style="text-align:right;"> 4.67 </td>
   <td style="text-align:right;"> 2.27 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.23 </td>
   <td style="text-align:right;"> 2.31 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 5.12 </td>
   <td style="text-align:right;"> 2.36 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.32 </td>
   <td style="text-align:right;"> 2.40 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.55 </td>
   <td style="text-align:right;"> 5.66 </td>
   <td style="text-align:right;"> 2.44 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.41 </td>
   <td style="text-align:right;"> 2.48 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.58 </td>
   <td style="text-align:right;"> 6.24 </td>
   <td style="text-align:right;"> 2.54 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.49 </td>
   <td style="text-align:right;"> 2.58 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 6.91 </td>
   <td style="text-align:right;"> 2.63 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.59 </td>
   <td style="text-align:right;"> 2.67 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.62 </td>
   <td style="text-align:right;"> 7.69 </td>
   <td style="text-align:right;"> 2.73 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 2.69 </td>
   <td style="text-align:right;"> 2.77 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># De manera análoga, pueden explorarse los componentes α y β:</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun31$M_vs_P$alpha %&gt;% ...</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun31$M_vs_P$beta %&gt;% ... </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="figura-1.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-cobertura" class="level5">
<h5 class="anchored" data-anchor-id="figura-1.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-cobertura">Figura 1. curvas de rarefacción y extrapolación (R/E) basadas en cobertura</h5>
<p>Esta figura muestra las <strong>curvas (R/E)</strong> basadas en <strong>cobertura de muestra</strong> para la <strong>diversidad funcional</strong> (FD) en sus tres componentes: <strong>gamma (γ)</strong>, <strong>alfa (α)</strong> y <strong>beta (β)</strong>. Cada columna representa un orden de diversidad (<strong>q = 0, 1 y 2</strong>), y cada fila corresponde a una de las tres dimensiones de la diversidad.</p>
<p>En <strong>γ</strong>, se observa que el par <strong>P_vs_RM</strong> alcanza la mayor diversidad funcional total, especialmente en <strong>q = 0</strong>, lo que indica mayor variedad de funciones raras cuando se combinan ambas comunidades.<br>
En <strong>α</strong>, la diversidad local aumenta con la cobertura, pero tiende a estabilizarse en los órdenes superiores, mostrando una estructura funcional similar entre sitios. En <strong>β</strong>, el recambio funcional es alto solo en <strong>q = 0</strong>, impulsado por funciones raras; al ponderar por abundancia (<strong>q = 1–2</strong>), las comunidades comparten la mayoría de las funciones dominantes.</p>
<p>En conjunto, la figura evidencia que las diferencias funcionales entre zonas se deben principalmente a las <strong>funciones raras</strong>, mientras que las <strong>funciones comunes</strong> son ampliamente compartidas entre comunidades.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Coverage-based R/E sampling curves for functional gamma, alpha and beta diversity</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXTbeta3D</span>(salida_abun31, <span class="at">type =</span> <span class="st">'B'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="curvas-re-por-tamaño-de-muestra-fd-γ-y-α" class="level4">
<h4 class="anchored" data-anchor-id="curvas-re-por-tamaño-de-muestra-fd-γ-y-α">8) Curvas R/E por tamaño de muestra (FD γ y α)</h4>
<p>Este análisis estima y compara la <strong>diversidad funcional</strong> usando <strong>rarefacción/extrapolación</strong> en función del <strong>tamaño de muestra</strong> (<code>base = "size"</code>). A diferencia del enfoque por <strong>cobertura</strong>, aquí todas las curvas se estandarizan por el <strong>número de individuos</strong> muestreados.</p>
<p><strong>Configuración clave</strong></p>
<ul>
<li><p><code>diversity = "FD"</code> y <code>FDtype = "AUC"</code>: la FD se calcula como <strong>área bajo la curva</strong> de distancias funcionales (Gower), sin depender de un único umbral.</p></li>
<li><p><code>datatype = "abundance"</code>: pondera por abundancias (curvas más estables ante funciones dominantes).</p></li>
<li><p><code>nboot = 5</code>: remuestreos para IC (puedes subirlo para informes finales).</p></li>
</ul>
<p><strong>Lectura de resultados</strong></p>
<ul>
<li><p><strong>Eje X</strong>: tamaño de muestra (individuos).</p></li>
<li><p><strong>γ (gamma)</strong>: <strong>diversidad funcional total combinada</strong> del par; crecimiento de γ con el tamaño indica incorporación de <strong>nuevas funciones</strong> al unir los dos sitios.</p></li>
<li><p><strong>α (alfa)</strong>: <strong>promedio funcional local</strong>; su pendiente refleja cuán rápido cada comunidad <strong>acumula funciones</strong> al aumentar individuos.</p></li>
<li><p><strong>Comparación entre pares</strong>: a <strong>mismo tamaño de muestra</strong>, curvas más altas ⇒ <strong>mayor amplitud funcional</strong>. Convergencias entre pares sugieren <strong>funciones comunes</strong>; divergencias, <strong>funciones raras</strong> o poco compartidas.</p></li>
<li><p><strong>Cuándo preferir <code>base = "size"</code></strong></p></li>
<li><p>Cuando quieres comparar ensamblajes <strong>controlando el esfuerzo</strong> (individuos) y evaluar <strong>tasas de acumulación</strong> de funciones.</p></li>
<li><p>Úsalo como complemento del análisis por cobertura: si las conclusiones coinciden en ambos, la inferencia es más <strong>robusta</strong>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Size-based R/E curves for functional gamma and alpha diversity</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iNEXT.beta3D)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de abundancia: biol_FD_beta</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancias: biol.dist.beta</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamada final</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>salida_abun32 <span class="ot">&lt;-</span> <span class="fu">iNEXTbeta3D</span>(</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> biol_FD_beta,  <span class="co"># matrices de abundancia por pares</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"FD"</span>,           <span class="co"># dimensión funcional</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,    <span class="co"># datos cuantitativos</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">base      =</span> <span class="st">"size"</span>,         <span class="co"># estandarización por abundancia</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot     =</span> <span class="dv">2</span>,              <span class="co"># número de remuestreos bootstrap</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM   =</span> biol.dist.beta, <span class="co"># matriz de distancias funcionales (Gower)</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype    =</span> <span class="st">"AUC"</span>,          <span class="co"># método AUC (área bajo la curva)</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDcut_number =</span> <span class="dv">10</span>           <span class="co"># número de umbrales considerados</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Esta tabla resume los resultados del análisis de <strong>diversidad funcional gamma (γ)</strong> obtenidos para el par de zonas <strong>montaña (M)</strong> y <strong>laderas (P)</strong>, a partir del enfoque de <strong>rarefacción y extrapolación (R/E)</strong> basado en el <strong>tamaño de muestra</strong>.</p>
<p>La diversidad <strong>gamma (γ)</strong> representa la <strong>diversidad funcional total combinada</strong> de los dos ensamblajes (M y P). En este caso, los valores se expresan bajo el método <strong>AUC (área bajo la curva)</strong>, que integra toda la variación funcional entre las especies sin depender de un umbral arbitrario de distancia. Cada fila de la tabla corresponde a un punto de la curva de rarefacción, donde se incrementa progresivamente el <strong>tamaño de muestra (Size)</strong>.</p>
<p>Los resultados muestran que la <strong>diversidad funcional gamma</strong> aumenta gradualmente con el <strong>tamaño de muestra</strong>, pasando de 1.00 a 10.22 conforme se incorporan más individuos. Este patrón indica que la combinación de las zonas de <strong>montaña y laderas</strong> amplía el espectro funcional del ensamblaje, incorporando <strong>nuevas funciones ecológicas</strong> a medida que crece el esfuerzo de muestreo.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen (ejemplo: primera combinación de zonas $M_vs_P)</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>salida_abun32<span class="sc">$</span>M_vs_P<span class="sc">$</span>gamma <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Diversidad funcional gamma (γ) entre las zonas de montaña (M) y laderas (P)"</span>, </span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Diversidad funcional gamma (γ) entre las zonas de montaña (M) y laderas (P)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:right;"> Order.q </th>
   <th style="text-align:right;"> Size </th>
   <th style="text-align:right;"> SC </th>
   <th style="text-align:right;"> Gamma </th>
   <th style="text-align:left;"> Method </th>
   <th style="text-align:right;"> s.e. </th>
   <th style="text-align:right;"> LCL </th>
   <th style="text-align:right;"> UCL </th>
   <th style="text-align:left;"> Diversity </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.17 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 964 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 8.64 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 8.61 </td>
   <td style="text-align:right;"> 8.68 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1928 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 9.34 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.09 </td>
   <td style="text-align:right;"> 9.16 </td>
   <td style="text-align:right;"> 9.52 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2892 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 9.73 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.16 </td>
   <td style="text-align:right;"> 9.43 </td>
   <td style="text-align:right;"> 10.04 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3856 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 10.01 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.21 </td>
   <td style="text-align:right;"> 9.59 </td>
   <td style="text-align:right;"> 10.42 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4820 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 10.22 </td>
   <td style="text-align:left;"> Rarefaction </td>
   <td style="text-align:right;"> 0.26 </td>
   <td style="text-align:right;"> 9.71 </td>
   <td style="text-align:right;"> 10.73 </td>
   <td style="text-align:left;"> FD_AUC </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># De manera análoga, pueden explorarse al componente α:</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># salida.abun31$M_vs_P$alpha %&gt;% ...</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="figura-2.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-abundancias" class="level5">
<h5 class="anchored" data-anchor-id="figura-2.-curvas-de-rarefacción-y-extrapolación-re-basadas-en-abundancias">Figura 2. curvas de rarefacción y extrapolación (R/E) basadas en abundancias</h5>
<p>Esta figura muestra las <strong>curvas de rarefacción y extrapolación (R/E)</strong> por <strong>tamaño de muestra</strong> para la <strong>diversidad funcional gamma (γ)</strong> y <strong>alfa (α)</strong>, calculadas mediante el método <strong>AUC (área bajo la curva)</strong>. En ella se visualiza cómo cambia la diversidad funcional a medida que aumenta el <strong>número de individuos</strong> muestreados en los tres pares de zonas comparadas: <strong>M_vs_P</strong> (montaña vs piedemonte), <strong>M_vs_RM</strong> (montaña vs región media) y <strong>P_vs_RM</strong> (piedemonte vs región media).</p>
<p>Esta figura complementa la tabla anterior mostrando de forma visual cómo se acumula la <strong>diversidad funcional total (γ)</strong> y <strong>local (α)</strong> a medida que aumenta el tamaño de muestra. El patrón general indica que las diferencias funcionales entre pares de zonas son más evidentes cuando se consideran todas las funciones (q = 0), pero tienden a desaparecer al ponderar por abundancia (q = 1–2), evidenciando una <strong>alta redundancia funcional</strong> entre comunidades en los rasgos dominantes.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggiNEXTbeta3D</span>(salida_abun32)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="6.3_div_fun_fil_peces.mex_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="información-general-de-la-beta-funcional-con-la-función-datainfobeta3d" class="level4">
<h4 class="anchored" data-anchor-id="información-general-de-la-beta-funcional-con-la-función-datainfobeta3d">9) Información general de la beta funcional con la función DataInfobeta3D()</h4>
<p>La función <strong><code>DataInfobeta3D()</code></strong> cumple un papel diagnóstico esencial antes del cálculo de la diversidad funcional beta. Su finalidad es <strong>resumir las características básicas de los datos funcionales y de abundancia</strong>, permitiendo evaluar la <strong>representatividad</strong> y <strong>completitud</strong> de los ensamblajes antes de aplicar los modelos de rarefacción y extrapolación.</p>
<p>Los indicadores presentados en la tabla incluyen:</p>
<ul>
<li><p><strong>n:</strong> tamaño total de muestra (número de individuos).</p></li>
<li><p><strong>S.obs:</strong> riqueza observada de especies.</p></li>
<li><p><strong>SC(n)</strong> y <strong>SC(2n):</strong> coberturas de muestra observada y extrapolada, que reflejan el grado de completitud funcional.</p></li>
<li><p><strong>a₁*</strong> y <strong>a₂*:</strong> número de especies funcionalmente únicas (simpletones) y duplicadas (dobletones), según el umbral de similitud <strong>Tau</strong>.</p></li>
<li><p><strong>h₁</strong> y <strong>h₂:</strong> contribución funcional de esas especies al espacio funcional total.</p></li>
<li><p><strong>Tau:</strong> nivel de distintividad funcional utilizado para definir cuándo dos especies se consideran diferentes.</p></li>
</ul>
<p>La tabla siguiente resume estos valores para los tres pares de zonas comparadas: <strong>montaña (M)</strong>, <strong>laderas (P)</strong> y <strong>desembocadura (RM)</strong>. Los valores de <strong>cobertura (SC)</strong> cercanos a <strong>1.00</strong> en todos los ensamblajes indican que el muestreo fue <strong>altamente completo</strong> y que la información funcional disponible es representativa. Los mayores valores de <strong>S.obs</strong> y <strong>n</strong> en los ensamblajes combinados (γ) evidencian una <strong>ampliación del espacio funcional</strong> al integrar las comunidades.</p>
<p>El número relativamente bajo de <strong>simgletones funcionales (a₁*)</strong> y la contribución moderada de <strong>h₁ y h₂</strong> reflejan que la mayoría de las especies comparten funciones similares, es decir, existe <strong>cierto grado de redundancia funcional</strong> dentro de las comunidades.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data information for taxonomic diversity</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>informacion_gral <span class="ot">&lt;-</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DataInfobeta3D</span>(</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> biol_FD_beta,    <span class="co"># matrices de abundancia por pares</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"FD"</span>,            <span class="co"># dimensión funcional</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,     <span class="co"># datos cuantitativos</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM   =</span> biol.dist.beta,  <span class="co"># matriz de distancias funcionales (Gower)</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype    =</span> <span class="st">'tau_value'</span>, </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtau     =</span> <span class="cn">NULL</span>)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla general</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>informacion_gral <span class="sc">%&gt;%</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Información general de la diversidad funcional"</span>, </span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Información general de la diversidad funcional</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> a1* </th>
   <th style="text-align:right;"> a2* </th>
   <th style="text-align:right;"> h1 </th>
   <th style="text-align:right;"> h2 </th>
   <th style="text-align:right;"> Tau </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 18317 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.66 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 18317 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 4.51 </td>
   <td style="text-align:right;"> 3.40 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6.00 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 13580 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6.57 </td>
   <td style="text-align:right;"> 2.36 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 13580 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 8.09 </td>
   <td style="text-align:right;"> 2.90 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3.00 </td>
   <td style="text-align:right;"> 1.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6.00 </td>
   <td style="text-align:right;"> 2.50 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 5565 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 6.57 </td>
   <td style="text-align:right;"> 3.86 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 5565 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 7.79 </td>
   <td style="text-align:right;"> 4.85 </td>
   <td style="text-align:right;"> 0.25 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Esta segunda aplicación de la función <strong><code>DataInfobeta3D()</code></strong> emplea el método <strong>AUC (Área Bajo la Curva)</strong> para describir la <strong>estructura funcional</strong> de las comunidades antes de calcular la diversidad funcional beta. Mientras que la versión con <code>FDtype = "tau_value"</code> se centra en el número de especies funcionalmente indistintas, esta versión <strong>evalúa la amplitud y forma del espacio funcional</strong> representado por los rasgos ecológicos.</p>
<p>Los valores de <strong>cobertura (SC)</strong> próximos a <strong>1.00</strong> en casi todos los ensamblajes confirman un muestreo completo y representativo del espacio funcional. Las <strong>distancias mínimas (dmin)</strong>, generalmente entre <strong>0.07 y 0.14</strong>, indican que existen grupos de especies con rasgos muy similares (redundancia funcional), mientras que las <strong>distancias máximas (dmax)</strong>, que alcanzan valores entre <strong>0.65 y 0.85</strong>, evidencian una <strong>amplia diferenciación funcional</strong> entre otros pares de especies.</p>
<p>La <strong>distancia media (dmean)</strong>, comprendida entre <strong>0.23 y 0.34</strong>, sugiere un <strong>grado intermedio de disimilitud</strong> funcional en la mayoría de los ensamblajes, coherente con comunidades que comparten funciones básicas pero mantienen cierta heterogeneidad en los rasgos.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data information for functional diversity (FDtype = 'AUC')</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>informacion_gral1 <span class="ot">&lt;-</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DataInfobeta3D</span>(</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> biol_FD_beta,    <span class="co"># matrices de abundancia por pares</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">diversity =</span> <span class="st">"FD"</span>,            <span class="co"># dimensión funcional</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">datatype  =</span> <span class="st">"abundance"</span>,     <span class="co"># datos cuantitativos</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDdistM   =</span> biol.dist.beta,  <span class="co"># matriz de distancias funcionales (Gower)</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtype    =</span> <span class="st">'AUC'</span>, </span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDtau     =</span> <span class="cn">NULL</span>)</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla general</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>informacion_gral1 <span class="sc">%&gt;%</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Información general de la diversidad funcional"</span>, </span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Información general de la diversidad funcional</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Dataset </th>
   <th style="text-align:left;"> Assemblage </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> S.obs </th>
   <th style="text-align:right;"> SC(n) </th>
   <th style="text-align:right;"> SC(2n) </th>
   <th style="text-align:right;"> dmin </th>
   <th style="text-align:right;"> dmean </th>
   <th style="text-align:right;"> dmax </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.23 </td>
   <td style="text-align:right;"> 0.59 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.14 </td>
   <td style="text-align:right;"> 0.28 </td>
   <td style="text-align:right;"> 0.65 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 18317 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.25 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_P </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 18317 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.25 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> M </td>
   <td style="text-align:right;"> 13166 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.23 </td>
   <td style="text-align:right;"> 0.59 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 0.14 </td>
   <td style="text-align:right;"> 0.34 </td>
   <td style="text-align:right;"> 0.75 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 13580 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> M_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 13580 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.24 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> P </td>
   <td style="text-align:right;"> 5151 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.14 </td>
   <td style="text-align:right;"> 0.28 </td>
   <td style="text-align:right;"> 0.65 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> RM </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 53 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.99 </td>
   <td style="text-align:right;"> 0.14 </td>
   <td style="text-align:right;"> 0.34 </td>
   <td style="text-align:right;"> 0.75 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Pooled assemblage </td>
   <td style="text-align:right;"> 5565 </td>
   <td style="text-align:right;"> 79 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.29 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> P_vs_RM </td>
   <td style="text-align:left;"> Joint assemblage </td>
   <td style="text-align:right;"> 5565 </td>
   <td style="text-align:right;"> 83 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.07 </td>
   <td style="text-align:right;"> 0.29 </td>
   <td style="text-align:right;"> 0.85 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
</section>
<section id="aproximaciones-metodológicas-complementarias" class="level3">
<h3 class="anchored" data-anchor-id="aproximaciones-metodológicas-complementarias">Aproximaciones metodológicas complementarias</h3>
<p>Además de los marcos principales desarrollados por <strong>Villéger et al.&nbsp;(2008)</strong>, <strong>de Bello et al.&nbsp;(2010)</strong> y <strong>Chao et al.&nbsp;(2021, 2023)</strong>, existen <strong>enfoques complementarios</strong> que amplían o refinan la evaluación de la diversidad funcional (FD) y filogenética (PD) según el tipo de pregunta ecológica y la escala de análisis:</p>
<ol type="1">
<li><p><strong>Diversidad de similitud generalizada</strong> (<em>Leinster &amp; Cobbold, 2012</em>).<br>
Propone una formulación matemática que integra <strong>abundancias y similitudes</strong> entre especies en una sola métrica, extendiendo los números de Hill a matrices de distancia continua. Permite comparar comunidades con rasgos correlacionados o árboles no jerárquicos, y está implementada en el paquete <strong><code>rdiversity</code></strong>.</p></li>
<li><p><strong>Redundancia y divergencia funcional</strong> (<em>Mouchet et al., 2010; Mason et al., 2013</em>). Profundizan en cómo las especies <strong>llenan o solapan el espacio funcional</strong>, distinguiendo entre <strong>redundancia</strong>, <strong>complementariedad</strong> y <strong>divergencia de rasgos</strong>. Estas métricas, implementadas en el paquete <strong><code>FD</code></strong>, son útiles para analizar la estabilidad funcional y el reemplazo de funciones a lo largo de gradientes ambientales.</p></li>
<li><p><strong>Integración de diversidad funcional y filogenética</strong> (<em>Tucker et al., 2017</em>).<br>
Combina los espacios de <strong>rasgos</strong> y <strong>filogenia</strong> en un único marco analítico (<em>trait–phylogenetic space</em>), permitiendo evaluar el grado de <strong>congruencia o desacoplamiento</strong> entre FD y PD. Este enfoque está disponible en los paquetes <strong><code>pez</code></strong> y <strong><code>picante</code></strong>, y resulta apropiado cuando se busca explorar cómo la historia evolutiva sustenta las funciones ecológicas actuales.</p></li>
<li><p><strong>Extensiones basadas en entropía cuadrática y dinámica temporal</strong> (<em>Ricotta et al., 2016; Carmona et al., 2019</em>). Los primeros conectan la entropía de Rao con los números de Hill para mantener continuidad conceptual con De Bello, mientras que los segundos incorporan la dimensión <strong>temporal</strong>, analizando <strong>cambios de FD y PD</strong> a lo largo de sucesión o perturbaciones.<br>
Implementados en <strong><code>hilldiv</code></strong> y <strong><code>dynFD</code></strong>, permiten estudiar la evolución funcional y filogenética en el tiempo.</p></li>
</ol>
<p>En conjunto, estas propuestas no sustituyen los tres enfoques principales, sino que los <strong>complementan</strong> al ofrecer <strong>variantes especializadas</strong> para analizar la <strong>redundancia</strong>, la <strong>integración FD–PD</strong>, o la <strong>dinámica temporal</strong> de la diversidad. Incorporarlas en los análisis futuros puede aportar una visión más rica y multidimensional del funcionamiento ecológico y evolutivo de los ensamblajes.</p>
<hr>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h3>
<p>El análisis de la diversidad de peces presentado en esta sección evidencia que <strong>la integración de las dimensiones taxonómica, filogenética y funcional</strong> ofrece una visión más completa de la organización ecológica de los ensamblajes. Al combinar información sobre abundancias, rasgos funcionales y relaciones evolutivas, es posible pasar del simple conteo de especies a la comprensión de <strong>cómo se distribuyen las funciones y la historia evolutiva dentro de las comunidades</strong>.</p>
<p>Los resultados obtenidos, a partir del uso combinado de métricas tradicionales (como la <strong>entropía cuadrática de Rao</strong>) y de marcos modernos como <strong>iNEXT.3D</strong> e <strong>iNEXTbeta3D</strong>, demuestran el potencial de la <strong>ecología cuantitativa contemporánea</strong> para unificar la descripción de la diversidad bajo un mismo principio probabilístico y comparable. Este enfoque estandarizado por <strong>cobertura muestral</strong> permite identificar patrones de <strong>redundancia, complementariedad y diferenciación funcional o filogenética</strong>, sin el sesgo del tamaño de muestra.</p>
<p>En conjunto, los métodos aplicados revelan que la diversidad no solo reside en el número de especies, sino también en <strong>la variedad de funciones y linajes</strong> que sostienen los procesos ecológicos. Quedan abiertas líneas de investigación prometedoras: <strong>relacionar estas facetas con gradientes ambientales</strong>, evaluar <strong>la redundancia funcional como indicador de resiliencia</strong> y analizar <strong>cómo la pérdida selectiva de especies altera la estabilidad y el funcionamiento de los ecosistemas</strong>.</p>
<p>En síntesis, esta sección muestra que la diversidad, entendida en sus múltiples dimensiones y evaluada con herramientas comparables y reproducibles, constituye una base sólida para avanzar hacia una <strong>ecología integradora, predictiva y funcionalmente informada</strong>.</p>
<hr>
</section>
<section id="conclusiones-prácticas" class="level3">
<h3 class="anchored" data-anchor-id="conclusiones-prácticas">Conclusiones prácticas</h3>
<ul>
<li><p><strong>1. La biodiversidad es multidimensional.</strong><br>
Analizar simultáneamente las facetas <strong>taxonómica (TD)</strong>, <strong>filogenética (PD)</strong> y <strong>funcional (FD)</strong> permite comprender no solo cuántas especies existen, sino <strong>qué funciones y linajes representan</strong> dentro del ecosistema.</p></li>
<li><p><strong>2. Los métodos tradicionales siguen siendo fundamentales.</strong><br>
Los enfoques de <strong>Villéger et al.&nbsp;(2008)</strong> y <strong>de Bello et al.&nbsp;(2010)</strong> continúan siendo esenciales para caracterizar la estructura interna de los ensamblajes y su partición aditiva (α, β, γ) de diversidad.</p></li>
<li><p><strong>3. El marco iNEXT.3D / iNEXTbeta3D representa una evolución metodológica.</strong><br>
Las propuestas de <strong>Chao et al.&nbsp;(2021, 2023)</strong> integran las tres dimensiones de diversidad bajo un <strong>principio estadístico común</strong> basado en los <strong>números de Hill</strong> y la <strong>estandarización por cobertura</strong>, permitiendo comparaciones más justas y reproducibles entre sitios o periodos de muestreo.</p></li>
<li><p><strong>4. La redundancia y la complementariedad funcional son claves para la resiliencia ecológica.</strong><br>
Evaluar qué tan únicas o solapadas son las funciones de las especies ayuda a inferir la <strong>capacidad de los ecosistemas para resistir perturbaciones</strong> y mantener sus procesos esenciales.</p></li>
<li><p><strong>5. La ecología cuantitativa moderna exige integración y precisión.</strong><br>
La combinación de rasgos, filogenias y abundancias —analizadas con herramientas reproducibles en <strong>R</strong>— permite pasar de descripciones taxonómicas a una comprensión funcional y evolutiva del ensamblaje, reforzando la toma de decisiones en conservación y manejo.</p></li>
</ul>
<hr>
</section>
<section id="referencias" class="level3">
<h3 class="anchored" data-anchor-id="referencias">Referencias</h3>
<p><strong>Botta‐Dukát, Z.</strong> (2005). Rao’s quadratic entropy as a measure of functional diversity based on multiple rasgoss.&nbsp;<em>Journal of vegetation science</em>,&nbsp;<em>16</em>(5), 533-540.</p>
<p><strong>Laliberté, E.</strong>, &amp; Legendre, P. (2010). A distance‐based framework for measuring functional diversity from multiple rasgoss.&nbsp;<em>Ecology</em>,&nbsp;<em>91</em>(1), 299-305.</p>
<p><strong>Lavorel, S.</strong>, Grigulis, K., McIntyre, S., Williams, N. S., Garden, D., Dorrough, J., … &amp; Bonis, A. (2008). Assessing functional diversity in the field–methodology matters!.&nbsp;<em>Functional Ecology</em>,&nbsp;<em>22</em>(1), 134-147.</p>
<p><strong>Villéger, S.</strong>, Mason, N. W., &amp; Mouillot, D. (2008). New multidimensional functional diversity indices for a multifaceted framework in functional ecology.&nbsp;<em>Ecology</em>,&nbsp;<em>89</em>(8), 2290-2301.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>