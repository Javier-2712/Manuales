<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="Es-es" xml:lang="Es-es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz">
<meta name="dcterms.date" content="2025-10-16">
<meta name="description" content="Ejercicios de entrenamiento para la construcción de tablas de vida por estructura de edad.">

<title>Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="4.3.t.vida_files/libs/clipboard/clipboard.min.js"></script>
<script src="4.3.t.vida_files/libs/quarto-html/quarto.js"></script>
<script src="4.3.t.vida_files/libs/quarto-html/popper.min.js"></script>
<script src="4.3.t.vida_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="4.3.t.vida_files/libs/quarto-html/anchor.min.js"></script>
<link href="4.3.t.vida_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="4.3.t.vida_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="4.3.t.vida_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="4.3.t.vida_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="4.3.t.vida_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>
    .quarto-title-block .quarto-title-banner {
      background: #2b8cbe;
    }
    </style>

<script src="4.3.t.vida_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="4.3.t.vida_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles2..css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Manual de Análisis y Visualización de datos ecológicos y ambientales - Anvidea</h1>
            <p class="subtitle lead">Capítulo 4.3 Ejercicios para la elaboración de tablas de vida por estructura de edad (x)</p>
                  <div>
        <div class="description">
          Ejercicios de entrenamiento para la construcción de tablas de vida por estructura de edad.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p>Javier Rodríguez-Barrios, Kenedith Méndez y Javier de la Hoz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 16, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Menú flotante</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link" data-scroll-target="#objetivos">Objetivos</a></li>
  <li><a href="#competencias" id="toc-competencias" class="nav-link" data-scroll-target="#competencias">Competencias</a></li>
  <li><a href="#ejemplo-1.-tablas-de-vida-con-demografía-de-cementerios" id="toc-ejemplo-1.-tablas-de-vida-con-demografía-de-cementerios" class="nav-link" data-scroll-target="#ejemplo-1.-tablas-de-vida-con-demografía-de-cementerios">Ejemplo 1. Tablas de vida con demografía de cementerios</a></li>
  <li><a href="#objetivos-1" id="toc-objetivos-1" class="nav-link" data-scroll-target="#objetivos-1">Objetivos</a></li>
  <li><a href="#competencias-1" id="toc-competencias-1" class="nav-link" data-scroll-target="#competencias-1">Competencias</a></li>
  <li><a href="#apectos-generales-del-diseño-para-obtener-los-datos" id="toc-apectos-generales-del-diseño-para-obtener-los-datos" class="nav-link" data-scroll-target="#apectos-generales-del-diseño-para-obtener-los-datos">Apectos generales del diseño para obtener los datos</a>
  <ul>
  <li><a href="#proporción-de-sobrevivientes-por-clase-de-edad-l_x" id="toc-proporción-de-sobrevivientes-por-clase-de-edad-l_x" class="nav-link" data-scroll-target="#proporción-de-sobrevivientes-por-clase-de-edad-l_x">Proporción de sobrevivientes por clase de edad (<span class="math inline">\(l_x\)</span>)</a>
  <ul>
  <li><a href="#probabilidad-de-supervivencia-por-clase-de-edad-s_x" id="toc-probabilidad-de-supervivencia-por-clase-de-edad-s_x" class="nav-link" data-scroll-target="#probabilidad-de-supervivencia-por-clase-de-edad-s_x">Probabilidad de supervivencia por clase de edad (<span class="math inline">\(S_x\)</span>)</a></li>
  <li><a href="#esperanza-de-vida-por-clase-de-edad-e_x" id="toc-esperanza-de-vida-por-clase-de-edad-e_x" class="nav-link" data-scroll-target="#esperanza-de-vida-por-clase-de-edad-e_x">Esperanza de vida por clase de edad (<span class="math inline">\(e_x\)</span>)</a></li>
  </ul></li>
  <li><a href="#a.-cementerio-san-miguel---santa-marta" id="toc-a.-cementerio-san-miguel---santa-marta" class="nav-link" data-scroll-target="#a.-cementerio-san-miguel---santa-marta">A. Cementerio San Miguel - Santa Marta</a>
  <ul>
  <li><a href="#paso-1-librerías-y-lectura-de-la-base-de-datos" id="toc-paso-1-librerías-y-lectura-de-la-base-de-datos" class="nav-link" data-scroll-target="#paso-1-librerías-y-lectura-de-la-base-de-datos">Paso 1) Librerías y lectura de la base de datos</a></li>
  <li><a href="#paso-2-clases-de-edad-y-frecuencias-n_x" id="toc-paso-2-clases-de-edad-y-frecuencias-n_x" class="nav-link" data-scroll-target="#paso-2-clases-de-edad-y-frecuencias-n_x">Paso 2) Clases de edad y frecuencias <span class="math inline">\(n_x\)</span></a></li>
  <li><a href="#paso-3-cálculo-del-resto-de-estimadores-de-la-tabla-de-vida" id="toc-paso-3-cálculo-del-resto-de-estimadores-de-la-tabla-de-vida" class="nav-link" data-scroll-target="#paso-3-cálculo-del-resto-de-estimadores-de-la-tabla-de-vida">Paso 3) Cálculo del resto de estimadores de la tabla de vida</a></li>
  <li><a href="#paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x" id="toc-paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x" class="nav-link" data-scroll-target="#paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x">Paso 4) Gráficos: supervivencia <span class="math inline">\(l_x\)</span> y de esperanza de vida <span class="math inline">\(e_x\)</span></a></li>
  <li><a href="#paso-5-comparativo-entre-sexos---e_x-y-l_x" id="toc-paso-5-comparativo-entre-sexos---e_x-y-l_x" class="nav-link" data-scroll-target="#paso-5-comparativo-entre-sexos---e_x-y-l_x">Paso 5) Comparativo entre sexos - <span class="math inline">\(e_x\)</span> y <span class="math inline">\(l_x\)</span></a>
  <ul>
  <li><a href="#comparación-estadística-entre-sexos-bootstrap." id="toc-comparación-estadística-entre-sexos-bootstrap." class="nav-link" data-scroll-target="#comparación-estadística-entre-sexos-bootstrap.">5.1) Comparación estadística entre sexos (Bootstrap).</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#b.-cementerio-jardines-de-paz---santa-marta" id="toc-b.-cementerio-jardines-de-paz---santa-marta" class="nav-link" data-scroll-target="#b.-cementerio-jardines-de-paz---santa-marta">B. Cementerio Jardines de Paz - Santa Marta</a>
  <ul>
  <li><a href="#pasos-1-a-3-librerías-y-lectura-de-la-base-de-datos" id="toc-pasos-1-a-3-librerías-y-lectura-de-la-base-de-datos" class="nav-link" data-scroll-target="#pasos-1-a-3-librerías-y-lectura-de-la-base-de-datos">Pasos 1 a 3) Librerías y lectura de la base de datos</a></li>
  <li><a href="#paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x-1" id="toc-paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x-1" class="nav-link" data-scroll-target="#paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x-1">Paso 4) Gráficos: supervivencia <span class="math inline">\(l_x\)</span> y de esperanza de vida <span class="math inline">\(e_x\)</span></a></li>
  <li><a href="#paso-5-comparativo-entre-sexos---e_x-y-l_x-1" id="toc-paso-5-comparativo-entre-sexos---e_x-y-l_x-1" class="nav-link" data-scroll-target="#paso-5-comparativo-entre-sexos---e_x-y-l_x-1">Paso 5) Comparativo entre sexos - <span class="math inline">\(e_x\)</span> y <span class="math inline">\(l_x\)</span></a>
  <ul>
  <li><a href="#comparación-estadística-entre-sexos-bootstrap.-1" id="toc-comparación-estadística-entre-sexos-bootstrap.-1" class="nav-link" data-scroll-target="#comparación-estadística-entre-sexos-bootstrap.-1">5.1) Comparación estadística entre sexos (Bootstrap).</a></li>
  </ul></li>
  <li><a href="#paso-6-comparación-de-las-curvas-de-esperanza-de-vida-y-de-supervivencia-entre-cementerios" id="toc-paso-6-comparación-de-las-curvas-de-esperanza-de-vida-y-de-supervivencia-entre-cementerios" class="nav-link" data-scroll-target="#paso-6-comparación-de-las-curvas-de-esperanza-de-vida-y-de-supervivencia-entre-cementerios">Paso 6) Comparación de las curvas de esperanza de vida y de supervivencia entre cementerios</a></li>
  <li><a href="#paso-7-tamaño-mínimo-de-muestra-y-prueba-de-potencia-para-la-tabla-de-vida-elaborada" id="toc-paso-7-tamaño-mínimo-de-muestra-y-prueba-de-potencia-para-la-tabla-de-vida-elaborada" class="nav-link" data-scroll-target="#paso-7-tamaño-mínimo-de-muestra-y-prueba-de-potencia-para-la-tabla-de-vida-elaborada">Paso 7) Tamaño mínimo de muestra y prueba de potencia para la tabla de vida elaborada</a>
  <ul>
  <li><a href="#analítica-rápida-media-edad-al-morir-como-proxy-de-e_0" id="toc-analítica-rápida-media-edad-al-morir-como-proxy-de-e_0" class="nav-link" data-scroll-target="#analítica-rápida-media-edad-al-morir-como-proxy-de-e_0">7.1) Analítica rápida (media edad al morir como proxy de <span class="math inline">\(e_0\)</span>)</a></li>
  <li><a href="#bootstrap-de-e_0-con-el-mismo-esquema-de-tabla-de-vida" id="toc-bootstrap-de-e_0-con-el-mismo-esquema-de-tabla-de-vida" class="nav-link" data-scroll-target="#bootstrap-de-e_0-con-el-mismo-esquema-de-tabla-de-vida">7.2) Bootstrap de <span class="math inline">\(e_0\)</span> con el mismo esquema de tabla de vida</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#ejemplo-2.-tablas-de-vida" id="toc-ejemplo-2.-tablas-de-vida" class="nav-link" data-scroll-target="#ejemplo-2.-tablas-de-vida">Ejemplo 2. Tablas de vida</a>
  <ul>
  <li><a href="#tabla-de-vida-con-estimadores-hasta-la-esperanza-de-vida." id="toc-tabla-de-vida-con-estimadores-hasta-la-esperanza-de-vida." class="nav-link" data-scroll-target="#tabla-de-vida-con-estimadores-hasta-la-esperanza-de-vida.">1. Tabla de vida con estimadores hasta la esperanza de vida.</a>
  <ul>
  <li><a href="#paso-1.-cargar-la-base-de-datos-que-contiene-los-tres-estimadores-iniciales-x-nx-mx" id="toc-paso-1.-cargar-la-base-de-datos-que-contiene-los-tres-estimadores-iniciales-x-nx-mx" class="nav-link" data-scroll-target="#paso-1.-cargar-la-base-de-datos-que-contiene-los-tres-estimadores-iniciales-x-nx-mx">Paso 1. Cargar la base de datos que contiene los tres estimadores iniciales (<span class="math inline">\(x, Nx, mx\)</span>)</a></li>
  <li><a href="#paso-2.-construcción-de-la-tabla-de-vida-hasta-la-esperanza-de-vida" id="toc-paso-2.-construcción-de-la-tabla-de-vida-hasta-la-esperanza-de-vida" class="nav-link" data-scroll-target="#paso-2.-construcción-de-la-tabla-de-vida-hasta-la-esperanza-de-vida">Paso 2. Construcción de la tabla de vida hasta la esperanza de vida</a></li>
  <li><a href="#paso-3.-cálculo-de-estadísticos-demográficos-basados-en-la-tabla-de-vida" id="toc-paso-3.-cálculo-de-estadísticos-demográficos-basados-en-la-tabla-de-vida" class="nav-link" data-scroll-target="#paso-3.-cálculo-de-estadísticos-demográficos-basados-en-la-tabla-de-vida">Paso 3. Cálculo de estadísticos demográficos basados en la tabla de vida</a></li>
  <li><a href="#paso-4.-estimadores-de-estructura-de-edad---f_pre-f_post-c_x-v_x." id="toc-paso-4.-estimadores-de-estructura-de-edad---f_pre-f_post-c_x-v_x." class="nav-link" data-scroll-target="#paso-4.-estimadores-de-estructura-de-edad---f_pre-f_post-c_x-v_x.">Paso 4. Estimadores de estructura de edad - <span class="math inline">\(F_{(pre)},\ F_{(post)},\ c_{(x)},\  v_{(x)}\)</span>.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cuestionario" id="toc-cuestionario" class="nav-link" data-scroll-target="#cuestionario">Cuestionario</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/20200101_Life_expectancy_increases_with_age_already_achieved_-_chart.svg/1280px-20200101_Life_expectancy_increases_with_age_already_achieved_-_chart.svg.png" class="img-fluid" width="406"></p>
<p>Imagen tomada de <a href="https://commons.wikimedia.org/w/index.php?curid=134781849">RCraig09</a></p>
<p>La <strong>demografía</strong>, ciencia que estudia las poblaciones humanas, es fundamental para comprender la historia y evolución de <em>Homo sapiens</em>. Uno de los métodos más fascinantes para analizar la demografía de poblaciones pasadas es el uso de <strong>tablas de vida</strong> estáticas, que permiten un vistazo detallado a la mortalidad y la esperanza de vida en un momento particular.</p>
<p>Las <strong>tablas de vida</strong> son herramientas esenciales para la demografía y la ecología humana, pues proporcionan un retrato detallado de la mortalidad y de la esperanza de vida en diferentes grupos de edad. Esto permite analizar y comparar las características demográficas de poblaciones en distintas épocas y regiones.</p>
<p>Como señala <em>Coale (1972)</em>, “las tablas de vida son un registro histórico de la experiencia de una población con respecto a su mortalidad”. Según <em>Wachter (2014)</em>, “las tablas de vida estáticas son herramientas esenciales en la investigación demográfica, permitiéndonos desentrañar cómo las poblaciones humanas han evolucionado a lo largo del tiempo”. En palabras de <em>Carey (2001)</em>: “las tablas de vida estáticas nos brindan una visión instantánea de cómo las poblaciones están estructuradas por edades y géneros en un momento particular”.</p>
<p>Las <strong>tablas de vida</strong> permiten describir y analizar los patrones de <strong>supervivencia y mortalidad</strong> de una población a lo largo del tiempo, revelando cómo los organismos enfrentan riesgos diferenciales según su edad o etapa de desarrollo. A través de estas tablas, los ecólogos pueden identificar períodos críticos en el ciclo de vida, estimar la esperanza de vida, y comprender cómo factores ambientales y biológicos influyen en la dinámica poblacional.</p>
<p>Desde una perspectiva ecológica, las tablas de vida conectan a la <strong>historia natural</strong> con los procesos demográficos fundamentales. Son esenciales para inferir estrategias de vida, como las especies <strong>r-estrategas</strong> (de crecimiento rápido, con alta fecundidad y corta vida) o <strong>K-estrategas</strong> (de crecimiento lento, baja fecundidad y longevidad alta). Además, las tablas de vida son la base para construir <strong>modelos matriciales</strong> (como las matrices de Leslie y Lefkovitch) y para evaluar la <strong>tasa intrínseca de crecimiento poblacional (r)</strong>, la <strong>esperanza de vida al nacer (e₀)</strong> y la <strong>reproducción neta (R₀)</strong>.</p>
<p>Este capítulo propone dos ejercicios complementarios: (A) el análisis de <strong>censos de cementerios</strong>, donde se estudia la supervivencia humana como aproximación demográfica a poblaciones históricas, y (B) un ejercicio basado en el texto clásico de <strong>Gotelli (2001)</strong>, orientado a comprender los fundamentos teóricos de la tabla de vida en un contexto ecológico general.</p>
</section>
<section id="objetivos" class="level2">
<h2 class="anchored" data-anchor-id="objetivos">Objetivos</h2>
<ol type="1">
<li>Comprender el concepto y la estructura de una <strong>tabla de vida</strong> como herramienta analítica en ecología de poblaciones.</li>
<li>Aplicar procedimientos de cálculo de <strong>mortalidad, supervivencia, esperanza de vida y fecundidad</strong> a partir de datos observados.</li>
<li>Comparar patrones de supervivencia entre poblaciones humanas (cementerios) y poblaciones hipotéticas (caso de Gotelli, 2001).</li>
<li>Interpretar los resultados demográficos en términos de <strong>estrategias adaptativas</strong> y <strong>presiones ambientales</strong>.</li>
<li>Fortalecer habilidades de análisis en <strong>R</strong> y <strong>Excel</strong>, vinculando procedimientos cuantitativos con interpretaciones ecológicas.</li>
</ol>
</section>
<section id="competencias" class="level2">
<h2 class="anchored" data-anchor-id="competencias">Competencias</h2>
<p>Al finalizar este capítulo, se fortalecerán las siguientes competencias:</p>
<ul>
<li><strong>Construir e interpretar tablas de vida</strong>, diferenciando entre las de tipo estático (transversal) y las de cohorte (longitudinal).</li>
<li><strong>Calcular los parámetros demográficos</strong> básicos: tasas de supervivencia (Sx), mortalidad (qx), esperanza de vida (ex) y reproducción neta (R₀).</li>
<li><strong>Analizar la estructura etaria de una población</strong> y reconocer cómo se relaciona con la dinámica ecológica y el ambiente.</li>
<li><strong>Comparar estrategias de vida</strong> entre organismos, reconociendo patrones de selección r/K y su influencia sobre la estabilidad poblacional.</li>
<li><strong>Aplicar el método científico</strong> para interpretar resultados demográficos en contextos ecológicos reales y simulados.</li>
</ul>
<hr>
</section>
<section id="ejemplo-1.-tablas-de-vida-con-demografía-de-cementerios" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-1.-tablas-de-vida-con-demografía-de-cementerios">Ejemplo 1. Tablas de vida con demografía de cementerios</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://javier-2712.github.io/Manuales/4.manual_andivea/4.poblaciones/Cementerio.PNG" class="img-fluid figure-img" width="526"></p>
<p></p><figcaption class="figure-caption">Imagen tomada de González et al. (2023)</figcaption><p></p>
</figure>
</div>
<p>En este ejercicio, se emplean datos de dos <strong>cementerios de Santa Marta</strong> como fuente demográfica para construir una tabla de vida transversal o estática. Se utilizarán los registros de edad al morir para calcular:</p>
<ul>
<li>Frecuencia de muertes por intervalo de edad (Fx)</li>
<li>Proporción de individuos sobrevivientes (lx)</li>
<li>Tasa de mortalidad específica (qx)</li>
<li>Esperanza de vida al inicio del intervalo (ex)</li>
</ul>
<p>Los datos se encuentran en el archivo <code>cementerios.xlsx</code>, y los procedimientos incluyen limpieza de datos, construcción de intervalos etarios y aplicación de fórmulas demográficas. Este ejercicio permite comparar patrones de mortalidad entre diferentes localidades o épocas, evidenciando cómo la historia, el ambiente y la cultura afectan la supervivencia humana.</p>
</section>
<section id="objetivos-1" class="level2">
<h2 class="anchored" data-anchor-id="objetivos-1">Objetivos</h2>
<ul>
<li>Elaborar tablas de vida estáticas a partir de censos de cementerios.</li>
<li>Comprender cómo estas tablas permiten analizar la supervivencia y la esperanza de vida en diferentes grupos de edad.</li>
<li>Comparar diferencias de mortalidad y longevidad entre hombres y mujeres.</li>
</ul>
<hr>
</section>
<section id="competencias-1" class="level2">
<h2 class="anchored" data-anchor-id="competencias-1">Competencias</h2>
<ul>
<li><strong>Analíticas:</strong> Construir tablas de vida a partir de datos censales.</li>
<li><strong>Metodológicas:</strong> Aplicar fórmulas demográficas a datos ecológicos y humanos.</li>
<li><strong>Críticas:</strong> Evaluar las diferencias entre sexos y grupos de edad en términos de supervivencia y esperanza de vida.</li>
<li><strong>Comunicativas:</strong> Presentar resultados en tablas, gráficas y discusión comparativa.<br>
</li>
</ul>
</section>
<section id="apectos-generales-del-diseño-para-obtener-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="apectos-generales-del-diseño-para-obtener-los-datos">Apectos generales del diseño para obtener los datos</h2>
<p><img src="https://coopcrucial.com/wp-content/uploads/2020/11/jardines.jpg" class="img-fluid" width="447"></p>
<p>Imagen tomada de <a href="https://coopcrucial.com/jardines-de-paz/">coopcrucial.com</a></p>
<p>Se deben colectar datos de nacimiento, defunción y sexo de las personas censadas.<br>
En los cementerios, cada grupo de personas realiza un censo de por lo menos 200 tumbas seleccionadas al azar.En caso de mausoleos familiares, registrar solo una tumba.<br>
</p>
<p>La tabla debe tener las siguientes columnas:</p>
<table style="width:100%;">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>No</th>
<th>Año de nacimiento</th>
<th>Año de muerte</th>
<th>Edad al morir</th>
<th>Sexo (F/M)</th>
<th>Observaciones</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p>Se cuenta con un formato a manera de ejemplo en el siguiente <a href="https://universidadmag-my.sharepoint.com/:x:/g/personal/jrodriguez_unimagdalena_edu_co/EYwVnNlnz6ZGnMLiNeRMqdMBgSDJdnn9yhOT-LRmCYH8vg?e=2z7R3R">enlace de tabla</a> y luego descargar en formato <code>xlsx</code> para el informe. Adicionalmente, se elabora un croquis con la ubicación de las tumbas censadas y los recorridos realizados:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://javier-2712.github.io/Manuales/4.manual_andivea/4.poblaciones/Cementerio1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Ejemplo del diseño de muestreo del cementerio Jardines de Jerusalén en Santa Marta. Imagen tomada de González et al. (2023)</figcaption><p></p>
</figure>
</div>
<p><img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/14/ea/89/0c/san-miguel-cemetery.jpg?w=1200&amp;h=-1&amp;s=1" class="img-fluid" width="382"></p>
<p>[Imagen tomada de <a href="https://www.google.com/maps/contrib/100767267100033862050/photos">Andres Acosta</a>]</p>
<p><strong>Análisis de los resultados</strong>. Al final del ejercicio, se requiere comparar los resultados obtenidos con estudios locales y nacionales en Colombia. La discusión debe responder preguntas como: ¿Cuál de los dos sexos es más longevo?, ¿En qué clases de edad se observa mayor supervivencia?, ¿Qué disciplinas (ej. sociología, salud pública, antropología) complementan este análisis y qué hallazgos reportan? y ¿Qué estrategias se pueden implementar para mejorar la esperanza de vida en la ciudad?</p>
<p><strong>Cálculos a realizar</strong>. Luego de haber tabulado los datos,se construirán tablas de vida estáticas con los estimadores básicos (<span class="math inline">\(q_x\)</span>, <span class="math inline">\(l_x\)</span>, <span class="math inline">\(S_x\)</span>, <span class="math inline">\(e_x\)</span>), por cada cementerio.</p>
<p>A continuación se muestra un <strong>procedimiento en R</strong>, en el que se utilizan los datos censados, para la elaboración de la tabla de vida por cada cementerio, analizando los siguientes aspectos:</p>
<ul>
<li><p>Construir una tabla de vida por cada cementerio, incluida la esperanza de vida (<span class="math inline">\(e_x\)</span>).</p></li>
<li><p>Graficar algunos estimadores de supervivencia como <span class="math inline">\(l_x\)</span> y <span class="math inline">\(e_x\)</span> y compararlas entre cementerios.</p></li>
<li><p>Comparar los estimadores de supervivencia - <span class="math inline">\(l_x\)</span> y <span class="math inline">\(e_x\)</span> entre sexos y por cada cementerio.</p></li>
<li><p>Calcular el tamaño mínimo de muestra requerida para el número de tumbas que se deben censar.</p></li>
</ul>
<section id="proporción-de-sobrevivientes-por-clase-de-edad-l_x" class="level3">
<h3 class="anchored" data-anchor-id="proporción-de-sobrevivientes-por-clase-de-edad-l_x">Proporción de sobrevivientes por clase de edad (<span class="math inline">\(l_x\)</span>)</h3>
<p><span class="math inline">\(l_x = \frac{N_x}{N_0}\)</span></p>
<p>Donde:<br>
- (<span class="math inline">\(N_0\)</span>) = número inicial de individuos de la cohorte ficticia.<br>
- (<span class="math inline">\(N_x\)</span>) = número de sobrevivientes al inicio del intervalo de edad (<span class="math inline">\(x\)</span>).</p>
<section id="probabilidad-de-supervivencia-por-clase-de-edad-s_x" class="level4">
<h4 class="anchored" data-anchor-id="probabilidad-de-supervivencia-por-clase-de-edad-s_x">Probabilidad de supervivencia por clase de edad (<span class="math inline">\(S_x\)</span>)</h4>
<p><span class="math inline">\(S_x = \frac{N_{x+1}}{N_x}\)</span></p>
<p>Donde:<br>
- (<span class="math inline">\(N_{x+1}\)</span>) = número de individuos de la clase de edad siguiente <span class="math inline">\({x+1}\)</span>.<br>
- (<span class="math inline">\(N_x\)</span>) = número de sobrevivientes al inicio del intervalo de edad (<span class="math inline">\(x\)</span>).</p>
</section>
<section id="esperanza-de-vida-por-clase-de-edad-e_x" class="level4">
<h4 class="anchored" data-anchor-id="esperanza-de-vida-por-clase-de-edad-e_x">Esperanza de vida por clase de edad (<span class="math inline">\(e_x\)</span>)</h4>
<p>Se calcula a partir de los estimadores (L_x) y (T_x):</p>
<p><span class="math inline">\([ L_x = \frac{N_x + N_{x+1}}{2} ]\)</span></p>
<p><span class="math inline">\([ T_x = \sum\_{t \geq x} L_t ]\)</span></p>
<p><span class="math inline">\([ e_x = \frac{T_x}{L_x} ]\)</span></p>
<hr>
<blockquote class="blockquote">
<p><strong>Descripción general del ejercicio.</strong> A partir de las <strong>edades al morir</strong> de 600 individuos de cada cementerio censado, se construye una <strong>tabla de vida estática</strong> por clases de edad decenales. Se usa la <strong>cohorte ficticia</strong> con <span class="math inline">\(N_0=600\)</span> individuos y se calculan: <span class="math inline">\(N_x\)</span> (supervivientes al inicio del intervalo), <span class="math inline">\(L_x\)</span> (años-persona vividos en el intervalo), <span class="math inline">\(T_x\)</span> (acumulado hacia edades avanzadas) y <span class="math inline">\(e_x\)</span> (esperanza de vida) con la relación <span class="math inline">\(e_x = T_x / N_x\)</span>. El último intervalo es <strong>abierto</strong> y se aproxima con <span class="math inline">\(L_\omega \approx \tfrac{n}{2}\,N_\omega\)</span>.</p>
</blockquote>
<hr>
</section>
</section>
<section id="a.-cementerio-san-miguel---santa-marta" class="level3">
<h3 class="anchored" data-anchor-id="a.-cementerio-san-miguel---santa-marta">A. Cementerio San Miguel - Santa Marta</h3>
<section id="paso-1-librerías-y-lectura-de-la-base-de-datos" class="level4">
<h4 class="anchored" data-anchor-id="paso-1-librerías-y-lectura-de-la-base-de-datos">Paso 1) Librerías y lectura de la base de datos</h4>
<p>Se cargan las librerías y el archivo que cuenta con los datos del censo realizado al cementerio San Miguel - <code>cementerios.xlsx</code> (hoja “Datos San Miguel”). Si hay edades faltantes pero existen año de nacimiento y muerte, se calcula <span class="math inline">\(edad = muerte - nacimiento\)</span>, para asegurar un tamaño de muestra <span class="math inline">\(N_0=600\)</span> individuos censados.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl); </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr); </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr); </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr); </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2);</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos del censo - datos1</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>datos1 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"cementerios.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"San_Miguel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">id   =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">nac  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">NACIMIENTO</span><span class="st">`</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mue  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">MUERTE</span><span class="st">`</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">EDAD INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo =</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">SEXO</span><span class="st">`</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edad =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(edad) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mue) <span class="sc">&amp;</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nac), mue <span class="sc">-</span> nac, edad)) <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad), edad <span class="sc">&gt;=</span> 0L)    <span class="co"># Garantizar No = 600</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datos1)  <span class="co"># verificación del número de datos1</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 600</code></pre>
</div>
</div>
<hr>
</section>
<section id="paso-2-clases-de-edad-y-frecuencias-n_x" class="level4">
<h4 class="anchored" data-anchor-id="paso-2-clases-de-edad-y-frecuencias-n_x">Paso 2) Clases de edad y frecuencias <span class="math inline">\(n_x\)</span></h4>
<ul>
<li>Se definen las clases <strong>decenales</strong> de edad con intervalos de <span class="math inline">\(n=10\)</span> años (ancho = 10).</li>
<li>Se asigna a cada individuo a una clase con <code>cut()</code> <strong>sin etiquetas</strong>, recuperar el <strong>límite inferior</strong> <span class="math inline">\(x\)</span> de cada clase a partir de los cortes (evitando parsear texto como “110+”) y contar las <strong>frecuencias</strong> <span class="math inline">\(n_x\)</span> por clase.<br>
<strong>Definición:</strong> <span class="math inline">\(n_x\)</span> es el <strong>número de individuos que mueren</strong> en la clase de edad <span class="math inline">\([x, x+n)\)</span>.</li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ancho o tamaño de los intervalos de clase</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ancho  <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cortes o intervalos hasta cubrir la edad máxima observada</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>((<span class="fu">max</span>(datos1<span class="sc">$</span>edad) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> ancho) <span class="sc">*</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>              ancho, <span class="at">by =</span> ancho)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicio de la tabla de vida con las clases de edad y la frecuencia (nx)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>tbl_ini <span class="ot">&lt;-</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  datos1 <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># índice del intervalo (1,2,3, …)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">bin =</span> <span class="fu">cut</span>(edad, <span class="at">breaks =</span> cortes, <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># límite inferior del intervalo</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_ini =</span> cortes[bin],</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ¿es el último intervalo?</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">es_ultimo =</span> edad_ini <span class="sc">==</span> <span class="fu">max</span>(cortes) <span class="sc">-</span> ancho,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># etiquetar “a-b” para clases internas y “a+” para la última</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">clase =</span> <span class="fu">if_else</span>(es_ultimo,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(edad_ini, <span class="st">"+"</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(edad_ini, <span class="st">"-"</span>, edad_ini <span class="sc">+</span> ancho <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(clase, edad_ini, <span class="at">name =</span> <span class="st">"nx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(edad_ini)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla inicial</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>tbl_ini <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>edad_ini) <span class="sc">%&gt;%</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Cementerio San Miguel. Clases de edad y frecuencias de datos (nx)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Cementerio San Miguel. Clases de edad y frecuencias de datos (nx)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> clase </th>
   <th style="text-align:right;"> nx </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0-9 </td>
   <td style="text-align:right;"> 22 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10-19 </td>
   <td style="text-align:right;"> 18 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:right;"> 43 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 30-39 </td>
   <td style="text-align:right;"> 30 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40-49 </td>
   <td style="text-align:right;"> 45 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50-59 </td>
   <td style="text-align:right;"> 42 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 60-69 </td>
   <td style="text-align:right;"> 80 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 70-79 </td>
   <td style="text-align:right;"> 137 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 80-89 </td>
   <td style="text-align:right;"> 111 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 90-99 </td>
   <td style="text-align:right;"> 61 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 100-109 </td>
   <td style="text-align:right;"> 8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 110-119 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 120+ </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="paso-3-cálculo-del-resto-de-estimadores-de-la-tabla-de-vida" class="level4">
<h4 class="anchored" data-anchor-id="paso-3-cálculo-del-resto-de-estimadores-de-la-tabla-de-vida">Paso 3) Cálculo del resto de estimadores de la tabla de vida</h4>
<p>Primero se elabora una <strong>cohorte ficticia</strong> iniciando con <span class="math inline">\(N_0 = \sum_x n_x = 600\)</span> individuos. Para cada clase con límite inferior de la clase de edad <span class="math inline">\(x\)</span>:</p>
<ul>
<li><strong>Cohorte fictica de supervivientes al inicio de cada intervalo:</strong><br>
<span class="math display">\[N_x \;=\; \sum_{y \ge x} n_y \,.\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(N_x\)</span>: número de individuos vivos al inicio del intervalo de edad <span class="math inline">\(x\)</span>.<br>
</li>
<li><span class="math inline">\(n_y\)</span>: número de defunciones ocurridas a la edad <span class="math inline">\(y\)</span>.<br>
</li>
<li>la suma <span class="math inline">\(\sum_{y \ge x}\)</span> indica que se cuentan todas las muertes desde <span class="math inline">\(x\)</span> en adelante.<br>
</li>
</ul></li>
<li><strong>Proporción de supervivencia - Horario de supervivencia</strong><br>
<span class="math display">\[l_x = \frac{N_{x}}{N_0}\]</span><br>
<em>donde</em><br>

<ul>
<li><p><span class="math inline">\(l_x\)</span>​: proporción de individuos de la cohorte inicial que llegan vivos a la edad <span class="math inline">\(x\)</span>.</p></li>
<li><p><span class="math inline">\(N_x\)</span>​: número de individuos sobrevivientes al inicio del intervalo de edad <span class="math inline">\(x\)</span>.</p></li>
<li><p><span class="math inline">\(N_0\)</span>​: tamaño de la cohorte al nacer (el número de individuos con los que comienza la tabla de vida).<br>
</p></li>
</ul></li>
<li><strong>Probabilidad de supervivencia</strong><br>
<span class="math display">\[S_x = \frac{N_{x+1}}{N_x}\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(S_x\)</span> probabilidad de que un individuo de edad <span class="math inline">\(x\)</span> sobreviva al siguiente intervalo.<br>
</li>
<li><span class="math inline">\(N_x\)</span>​: número de individuos vivos al inicio del intervalo.<br>
</li>
<li><span class="math inline">\(N_{x+1}\)</span>​: número de individuos vivos al inicio del intervalo siguiente.<br>
</li>
</ul></li>
<li><strong>Años-persona vividos en el intervalo (aprox. muertes uniformes):</strong><br>
<span class="math display">\[L_x \;\approx\; n \cdot \frac{N_x + N_{x+1}}{2}\,\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(L_x\)</span>​: número de años-persona aportados por la cohorte en el intervalo. Variable requerida para el cálculo de <span class="math inline">\(e_x\)</span>.<br>
</li>
<li><span class="math inline">\(n\)</span>: amplitud del intervalo de edad (en este ejemplo: 10 años).<br>
</li>
<li><span class="math inline">\(\frac{N_x + N_{x+1}}{2}\)</span>​​: promedio de individuos vivos en el intervalo (asumiendo muertes distribuidas uniformemente).<br>
</li>
</ul></li>
<li><strong>Último intervalo abierto</strong> <span class="math inline">\(\omega\)</span>:<br>
<span class="math display">\[L_\omega \;\approx\; \frac{n}{2}\, N_\omega \,\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(L_\omega\)</span>​: años-persona vividos en el último intervalo.<br>
</li>
<li><span class="math inline">\(\omega\)</span>: número de individuos vivos al inicio del intervalo abierto.<br>
</li>
<li><span class="math inline">\(\frac{n}{2}\)</span>​: se aproxima con la mitad de la amplitud del intervalo, pues todos los sobrevivientes mueren dentro de ese mismo rango.&nbsp;</li>
</ul></li>
<li><strong>Acumulado hacia edades avanzadas:</strong><br>
<span class="math display">\[T_x \;=\; \sum_{y \ge x} L_y \,\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(T_x\)</span>​: total de años-persona que le restan a la cohorte a partir de la edad <span class="math inline">\(x\)</span>. Variable requerida para el cálculo de <span class="math inline">\(e_x\)</span>.<br>
</li>
<li><span class="math inline">\(L_y\)</span>​: años-persona vividos en cada intervalo igual o posterior a <span class="math inline">\(x\)</span>.<br>
</li>
</ul></li>
<li><strong>Esperanza de vida (años):</strong><br>
<span class="math display">\[e_x \;=\; \frac{T_x}{N_x}\,\]</span><br>
<em>donde</em><br>

<ul>
<li><span class="math inline">\(e_x\)</span>​: esperanza de vida a la edad <span class="math inline">\(x\)</span>.<br>
</li>
<li><span class="math inline">\(T_x\)</span>​: total de años-persona que restan por vivir a partir de <span class="math inline">\(x\)</span>.<br>
</li>
<li><span class="math inline">\(N_x\)</span>​: número de individuos vivos al inicio de la edad <span class="math inline">\(x\)</span>.<br>
</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimadores de la tabla de vida</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>N0  <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl_ini<span class="sc">$</span>nx)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>N_x <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(tbl_ini<span class="sc">$</span>nx)))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Sx  <span class="ot">&lt;-</span> (dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x) <span class="sc">/</span> N_x) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>       tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)     <span class="co"># Último valor es cero</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>lx  <span class="ot">&lt;-</span> <span class="fu">round</span>(N_x <span class="sc">/</span> N0, <span class="dv">2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Lx  <span class="ot">&lt;-</span> (N_x <span class="sc">+</span> dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Lx[<span class="fu">is.na</span>(Lx)] <span class="ot">&lt;-</span> (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">tail</span>(N_x, <span class="dv">1</span>)   <span class="co"># último abierto</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>Tx  <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx)))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ex  <span class="ot">&lt;-</span> <span class="fu">round</span>(Tx <span class="sc">/</span> N_x,<span class="dv">1</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Organización de la tabla de vida</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>tabla_vida_sm <span class="ot">&lt;-</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  tbl_ini <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nx =</span> N_x, <span class="at">Sx =</span> Sx, <span class="at">lx =</span> lx, <span class="at">Lx =</span> Lx, <span class="at">Tx =</span> Tx, <span class="at">ex =</span> ex,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">edad_med =</span> edad_ini <span class="sc">+</span> ancho<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla de vida</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>tabla_vida_sm <span class="sc">%&gt;%</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>edad_ini, <span class="sc">-</span>edad_med) <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Cementerio San Miguel. Clases de edad y frecuencias de datos (nx)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Cementerio San Miguel. Clases de edad y frecuencias de datos (nx)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> clase </th>
   <th style="text-align:right;"> nx </th>
   <th style="text-align:right;"> Nx </th>
   <th style="text-align:right;"> Sx </th>
   <th style="text-align:right;"> lx </th>
   <th style="text-align:right;"> Lx </th>
   <th style="text-align:right;"> Tx </th>
   <th style="text-align:right;"> ex </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0-9 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 5890 </td>
   <td style="text-align:right;"> 38750 </td>
   <td style="text-align:right;"> 64.6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10-19 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 578 </td>
   <td style="text-align:right;"> 0.97 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 5690 </td>
   <td style="text-align:right;"> 32860 </td>
   <td style="text-align:right;"> 56.9 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:right;"> 43 </td>
   <td style="text-align:right;"> 560 </td>
   <td style="text-align:right;"> 0.92 </td>
   <td style="text-align:right;"> 0.93 </td>
   <td style="text-align:right;"> 5385 </td>
   <td style="text-align:right;"> 27170 </td>
   <td style="text-align:right;"> 48.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 30-39 </td>
   <td style="text-align:right;"> 30 </td>
   <td style="text-align:right;"> 517 </td>
   <td style="text-align:right;"> 0.94 </td>
   <td style="text-align:right;"> 0.86 </td>
   <td style="text-align:right;"> 5020 </td>
   <td style="text-align:right;"> 21785 </td>
   <td style="text-align:right;"> 42.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40-49 </td>
   <td style="text-align:right;"> 45 </td>
   <td style="text-align:right;"> 487 </td>
   <td style="text-align:right;"> 0.91 </td>
   <td style="text-align:right;"> 0.81 </td>
   <td style="text-align:right;"> 4645 </td>
   <td style="text-align:right;"> 16765 </td>
   <td style="text-align:right;"> 34.4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50-59 </td>
   <td style="text-align:right;"> 42 </td>
   <td style="text-align:right;"> 442 </td>
   <td style="text-align:right;"> 0.90 </td>
   <td style="text-align:right;"> 0.74 </td>
   <td style="text-align:right;"> 4210 </td>
   <td style="text-align:right;"> 12120 </td>
   <td style="text-align:right;"> 27.4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 60-69 </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 0.80 </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 3600 </td>
   <td style="text-align:right;"> 7910 </td>
   <td style="text-align:right;"> 19.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 70-79 </td>
   <td style="text-align:right;"> 137 </td>
   <td style="text-align:right;"> 320 </td>
   <td style="text-align:right;"> 0.57 </td>
   <td style="text-align:right;"> 0.53 </td>
   <td style="text-align:right;"> 2515 </td>
   <td style="text-align:right;"> 4310 </td>
   <td style="text-align:right;"> 13.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 80-89 </td>
   <td style="text-align:right;"> 111 </td>
   <td style="text-align:right;"> 183 </td>
   <td style="text-align:right;"> 0.39 </td>
   <td style="text-align:right;"> 0.30 </td>
   <td style="text-align:right;"> 1275 </td>
   <td style="text-align:right;"> 1795 </td>
   <td style="text-align:right;"> 9.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 90-99 </td>
   <td style="text-align:right;"> 61 </td>
   <td style="text-align:right;"> 72 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 0.12 </td>
   <td style="text-align:right;"> 415 </td>
   <td style="text-align:right;"> 520 </td>
   <td style="text-align:right;"> 7.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 100-109 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 0.27 </td>
   <td style="text-align:right;"> 0.02 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 105 </td>
   <td style="text-align:right;"> 9.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 110-119 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.67 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 35 </td>
   <td style="text-align:right;"> 11.7 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 120+ </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 5.0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x" class="level4">
<h4 class="anchored" data-anchor-id="paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x">Paso 4) Gráficos: supervivencia <span class="math inline">\(l_x\)</span> y de esperanza de vida <span class="math inline">\(e_x\)</span></h4>
<p>A continuación se graficarán los estimadores <span class="math inline">\(l_x = N_x/N_0\)</span> como <strong>supervivencia proporcional</strong> y <span class="math inline">\(e_x\)</span> como <strong>años esperados por sobreviviente</strong> a la edad <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de esperanza de vida (ex)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>g_lx <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tabla_vida_sm, <span class="fu">aes</span>(edad_med, lx)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span>  <span class="fu">expression</span>(<span class="st">"Supervivencia"</span><span class="sc">~</span>(l[x])),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supervivencia proporcional (l\u2093 = Nx / No)"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del horario de supervivencia (lx)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>g_ex <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tabla_vida_sm, <span class="fu">aes</span>(edad_med, ex)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span> <span class="fu">expression</span>(e[x]<span class="sc">~</span><span class="st">"(años)"</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Esperanza de vida (e\u2093 = Tx / Nx)"</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>g_lx</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g_ex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="paso-5-comparativo-entre-sexos---e_x-y-l_x" class="level4">
<h4 class="anchored" data-anchor-id="paso-5-comparativo-entre-sexos---e_x-y-l_x">Paso 5) Comparativo entre sexos - <span class="math inline">\(e_x\)</span> y <span class="math inline">\(l_x\)</span></h4>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insumos requeridos para la figura (Insumos del Paso 1)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>datos1 <span class="ot">&lt;-</span> datos1 <span class="co"># Datos del censo al cementerio</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ancho  <span class="ot">&lt;-</span> <span class="dv">10</span>     <span class="co"># Amplitud de los irtervalos de edad en la tv</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> cortes <span class="co"># Intervalos hasta cubrir la edad máxima observada</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># etiquetas para los intervalos (última como "a+")</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>starts <span class="ot">&lt;-</span> <span class="fu">head</span>(cortes, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>labs   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(starts, <span class="st">"-"</span>, starts <span class="sc">+</span> ancho <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>labs[<span class="fu">length</span>(labs)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(starts[<span class="fu">length</span>(starts)], <span class="st">"+"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>tbl_sex <span class="ot">&lt;-</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  datos1 <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">clase =</span> <span class="fu">cut</span>(edad,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> cortes,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">right =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> labs),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_ini =</span> <span class="fu">as.integer</span>(<span class="fu">sub</span>(<span class="st">"-.*"</span>, <span class="st">""</span>, <span class="fu">as.character</span>(clase)))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo, clase, edad_ini, <span class="at">name =</span> <span class="st">"nx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sexo, edad_ini)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de vida por cada sexo</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>tv_sex <span class="ot">&lt;-</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  tbl_sex <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(edad_ini, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">N0  =</span> <span class="fu">sum</span>(nx),                    <span class="co"># radix por sexo</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_x =</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(nx))),       <span class="co"># supervivientes al inicio del intervalo</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lx  =</span> (N_x <span class="sc">+</span> <span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho,      <span class="co"># años-persona en el intervalo</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lx  =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(Lx), (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">last</span>(N_x), Lx),         <span class="co"># último intervalo abierto</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tx  =</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx))),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ex  =</span> Tx <span class="sc">/</span> N_x,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">lx  =</span> N_x <span class="sc">/</span> N0,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_med =</span> edad_ini <span class="sc">+</span> ancho<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Figuras ---</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Esperanza de vida (e_x) por sexo</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>g_ex_sex <span class="ot">&lt;-</span> </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tv_sex, <span class="fu">aes</span>(<span class="at">x =</span> edad_med, </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ex, </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años, punto medio del intervalo)"</span>,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(e[x]<span class="sc">~</span><span class="st">"(años)"</span>),</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Esperanza de vida (e\u2093) por sexo"</span>) <span class="sc">+</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Supervivencia (lx) por sexo</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>g_lx_sex <span class="ot">&lt;-</span> </span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tv_sex, <span class="fu">aes</span>(<span class="at">x =</span> edad_med, </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lx, </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años, punto medio del intervalo)"</span>,</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(l[x]),</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supervivencia (l\u2093 = N\u2093 / N\u2092) por sexo"</span>) <span class="sc">+</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>g_ex_sex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>g_lx_sex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Patrones observados por sexos</strong></p>
<ul>
<li><p><strong>Figura de</strong> <span class="math inline">\(e_x\)</span>​. La curva de las muejeres está <strong>por encima</strong> en la mayoría de las edades, indicando que ese sexo presenta <strong>mayor esperanza de vida</strong>, aunque los hombres presentan mayor longevidad.</p></li>
<li><p><strong>Figura de</strong> <span class="math inline">\(l_x\)</span>​. un <span class="math inline">\(l_x\)</span>​ El patrón presentado es similar al de la figura anterior.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla base por sexo</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>resumen_e0 <span class="ot">&lt;-</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  tv_sex <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(edad_ini, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">1</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>  <span class="co"># toma el primer intervalo (x = 0)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(sexo, <span class="at">N0 =</span> N0, <span class="at">e0 =</span> <span class="fu">round</span>(ex, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de la esperanza de vida</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>resumen_e0 <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Esperanza de vida al nacer (e\u2092) por sexo"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Esperanza de vida al nacer (eₒ) por sexo</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> sexo </th>
   <th style="text-align:center;"> N0 </th>
   <th style="text-align:center;"> e0 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> F </td>
   <td style="text-align:center;"> 285 </td>
   <td style="text-align:center;"> 68.05 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> M </td>
   <td style="text-align:center;"> 315 </td>
   <td style="text-align:center;"> 61.38 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Las <strong>mujeres viven en promedio ~6.7 años más que los hombres</strong>. Este patrón es consistente con tendencias observadas en muchas poblaciones humanas:</p>
<ul>
<li><p>Las mujeres suelen tener ventajas biológicas (resistencia inmunológica, menor mortalidad en edades tempranas).</p></li>
<li><p>También influyen factores socioculturales (riesgos ocupacionales, conductas de riesgo más comunes en hombres).</p></li>
</ul>
<hr>
<section id="comparación-estadística-entre-sexos-bootstrap." class="level5">
<h5 class="anchored" data-anchor-id="comparación-estadística-entre-sexos-bootstrap.">5.1) Comparación estadística entre sexos (Bootstrap).</h5>
<p><strong>Bootstrap</strong> es un método estadístico y compuacional de remuestreo, que permite evaluar la <strong>incertidumbre</strong> de una estimación (con esperanza de vida <span class="math inline">\(e_0\)</span>). Consiste en <strong>reutilizar los datos de campo</strong>, para generar muchas muestras aleatorias (con reemplazo) a partir del ese conjunto original y en cada una se recalcula el estimador de interés. Al repetir este proceso miles de veces se obtiene una <strong>distribución de valores simulados</strong>, que refleja la variabilidad que tendría el estimador si repitiéramos el estudio muchas veces en condiciones similares (si aumentaramos el esfuerzo de muestreo).</p>
<p>En este ejercicio, se alica la prueba de Bootstrap para comparar la esperanza de vida entre hombres y mujeres. A partir de la distribución de diferencias (<span class="math inline">\(e_0^{(F)} - e_0^{(M)}\)</span>) obtenida por remuestreo. Con lo anterior se obtienen <strong>intervalos de confianza (IC 95%)</strong> y la significancia de la comparación entre sexos (<strong>p-valor</strong>). Si el <strong>IC</strong> no incluye el cero (como ocurrirá en este ejercicio), se puede confirmar que la diferencia observada no es producto del azar, sino que refleja un patrón real y en ese sentido, las mujeres presentarán una mayor esperanza de vida que los hombres.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bootstrap estratificado para la diferencia de e0 entre sexos ---</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir las categorías de sexos</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>)  <span class="co"># o c("M","F"), puede ser A, B</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegurar datos y ancho</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"datos1"</span>)) {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  datos1 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"cemementerios.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"San_Miguel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">edad =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">EDAD INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">nac  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">NACIMIENTO</span><span class="st">`</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">mue  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">MUERTE</span><span class="st">`</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">sexo =</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">SEXO</span><span class="st">`</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">edad =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(edad) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mue) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(nac), mue <span class="sc">-</span> nac, edad)) <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad), edad <span class="sc">&gt;=</span> 0L)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"ancho"</span>)) ancho <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Función que calcula e0 desde un vector de edades (misma lógica de la tabla de vida)</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>e0_from_edades <span class="ot">&lt;-</span> <span class="cf">function</span>(edades, <span class="at">ancho =</span> <span class="dv">10</span>) {</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  edades <span class="ot">&lt;-</span> edades[<span class="fu">is.finite</span>(edades) <span class="sc">&amp;</span> edades <span class="sc">&gt;=</span> <span class="dv">0</span>]</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(edades) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  cortes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>((<span class="fu">max</span>(edades) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>ancho) <span class="sc">*</span> ancho, <span class="at">by =</span> ancho)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">cut</span>(edades, <span class="at">breaks =</span> cortes, <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include_lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  nx  <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">tabulate</span>(bin, <span class="at">nbins =</span> <span class="fu">length</span>(cortes) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(nx) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  N_x <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(nx)))</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  Lx  <span class="ot">&lt;-</span> (N_x <span class="sc">+</span> dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  Lx[<span class="fu">is.na</span>(Lx)] <span class="ot">&lt;-</span> (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">tail</span>(N_x, <span class="dv">1</span>)     <span class="co"># último intervalo abierto</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  Tx  <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx)))</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  e0  <span class="ot">&lt;-</span> Tx[<span class="dv">1</span>] <span class="sc">/</span> N_x[<span class="dv">1</span>]</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  e0</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar estratos por sexo (tomamos sólo los dos con datos)</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  datos1 <span class="sc">%&gt;%</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sexo)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(sex_levels) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Se requiere al menos dos sexos con datos para el contraste."</span>)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> sex_levels[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]  <span class="co"># usar los dos principales (p.ej., 'F' y 'M')</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>edades_A <span class="ot">&lt;-</span> datos1<span class="sc">$</span>edad[datos1<span class="sc">$</span>sexo <span class="sc">==</span> sex_levels[<span class="dv">1</span>]]</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>edades_B <span class="ot">&lt;-</span> datos1<span class="sc">$</span>edad[datos1<span class="sc">$</span>sexo <span class="sc">==</span> sex_levels[<span class="dv">2</span>]]</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">&lt;-</span> <span class="fu">length</span>(edades_A); nB <span class="ot">&lt;-</span> <span class="fu">length</span>(edades_B)</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co"># e0 observado por sexo y diferencia</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>e0_A <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(edades_A, <span class="at">ancho =</span> ancho)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>e0_B <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(edades_B, <span class="at">ancho =</span> ancho)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>delta_obs <span class="ot">&lt;-</span> e0_B <span class="sc">-</span> e0_A    <span class="co"># por convención: B - A (si tus etiquetas son M/F, típicamente M - F)</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>delta_boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>  samp_A <span class="ot">&lt;-</span> <span class="fu">sample</span>(edades_A, <span class="at">size =</span> nA, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  samp_B <span class="ot">&lt;-</span> <span class="fu">sample</span>(edades_B, <span class="at">size =</span> nB, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  e0A_b  <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(samp_A, <span class="at">ancho =</span> ancho)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  e0B_b  <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(samp_B, <span class="at">ancho =</span> ancho)</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  e0B_b <span class="sc">-</span> e0A_b</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo percentil y p-valor aproximado de dos colas</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(delta_boot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="co"># p-valor bilateral consistente con el IC percentil</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(delta_boot <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(delta_boot <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co"># (Opcional) Histograma de la distribución bootstrap de la diferencia</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">delta =</span> delta_boot), <span class="fu">aes</span>(<span class="at">x =</span> delta)) <span class="sc">+</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> delta_obs, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Δ eo = eo("</span>, sex_levels[<span class="dv">2</span>], <span class="st">") - eo("</span>, sex_levels[<span class="dv">1</span>], <span class="st">")"</span>),</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Bootstrap estratificado de la diferencia de e0 entre sexos"</span>) <span class="sc">+</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Análisis del patrón gráfico encontrado.</strong></p>
<p>El histograma representa la <strong>distribución bootstrap</strong> de la diferencia <span class="math inline">\(\Delta e_0 = e_0(F) - e_0(M)\)</span>. Esta distribución bootstrap de <span class="math inline">\(Δ𝑒_0\)</span> es estratificada por sexos. Con una mediana ≈ 6–7 años (línea punteada central), con IC del 95% (percentiles): ≈ 2–3 a 10–11 años (líneas punteadas laterales).</p>
<p>Este indica que, en la muestra de 600 tumbas censadas en el cementerio de San Miguel, las mujeres viven en promedio más años que los hombres y la diferencia está respaldada estadísticamente por el bootstrap.</p>
<p>Las líneas punteadas marcan el intervalo de confianza - <strong>IC del 95%</strong> (percentil). Estos IC indican lo siguiente:</p>
<ul>
<li><p>El intervalo no incluye el valor 0 que representa al límite inferior que está cerca de ~2 años.</p></li>
<li><p>Eso significa que, bajo el remuestreo que genera Bootstrap, <strong>casi nunca se presentará una diferencia negativa</strong> (donde la esperanza de vida <span class="math inline">\(e_x\)</span> de M &gt; F).</p></li>
<li><p>Las mujeres (F) tienen, en promedio, una <strong>esperanza de vida inicial</strong> (<span class="math inline">\(e_0\)</span>) mayor que los hombres (M).</p></li>
<li><p>La magnitud de la diferencia en la esperanza de vida entre sexos, ronda al rededor de los <strong>5–7 años</strong>, como lo muestra la mediana bootstrap.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen numérico</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>res_boot <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo_A =</span> sex_levels[<span class="dv">1</span>],</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo_B =</span> sex_levels[<span class="dv">2</span>],</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">e0_A   =</span> <span class="fu">round</span>(e0_A,<span class="dv">1</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">e0_B   =</span> <span class="fu">round</span>(e0_B,<span class="dv">1</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diff_B_A =</span> <span class="fu">round</span>(delta_obs,<span class="dv">1</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI2.5  =</span> <span class="fu">round</span>(<span class="fu">unname</span>(ci[<span class="dv">1</span>]),<span class="dv">1</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI97.5 =</span> <span class="fu">round</span>(<span class="fu">unname</span>(ci[<span class="dv">2</span>]),<span class="dv">1</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">valor_p_dos_colas =</span> <span class="fu">round</span>(pval,<span class="dv">2</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> B</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla base requerida</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>res_boot <span class="sc">%&gt;%</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resultados numéricos del Bootstrap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Resultados numéricos del Bootstrap</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> sexo_A </th>
   <th style="text-align:left;"> sexo_B </th>
   <th style="text-align:right;"> e0_A </th>
   <th style="text-align:right;"> e0_B </th>
   <th style="text-align:right;"> diff_B_A </th>
   <th style="text-align:right;"> CI2.5 </th>
   <th style="text-align:right;"> CI97.5 </th>
   <th style="text-align:right;"> valor_p_dos_colas </th>
   <th style="text-align:right;"> B </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 61.4 </td>
   <td style="text-align:right;"> 68.1 </td>
   <td style="text-align:right;"> 6.7 </td>
   <td style="text-align:right;"> 2.8 </td>
   <td style="text-align:right;"> 10.9 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>Análisis del resultado tabular.</strong></p>
<p><strong>La esperanza de vida - e₀ de hombres (M):</strong> ~61.4 años y <strong>e₀ de mujeres (F):</strong> ~68.1 años. La <strong>diferencia observada (F – M):</strong> ~6.7 años de mayor esperanza de vida en las mujeres. El <strong>IC</strong> al <strong>95%:</strong> (2.8, 10.9), por ser positivo, indica que la esperanza de vida femenina es mayor, mostrando que el aumento en dicha esperanza está entre 2.8 y 11 años. El <strong>valor p</strong> obtenido de cero (&lt;&lt;0.05), es coherente con el IC, indicando que las diferencias en la esperanza de vida entre sexos es altamente significativa.</p>
<p>En este sentido se vuelve a demostrar que <strong>las mujeres tienen una esperanza de vida significativamente mayor que los hombres (≈7 años de ventaja)</strong>. El IC 95% confirma que la diferencia es robusta (mínimo ≈3 años, máximo ≈11).</p>
<p>A partir del censo de 600 tumbas, la <strong>esperanza de vida al inicio de la tabla</strong> ($e_0$) fue de <strong>61.4 años en hombres</strong> y <strong>68.1 años en mujeres</strong>, lo que representa una <strong>ventaja femenina de 6.7 años</strong>. El intervalo de confianza obtenido mediante bootstrap (IC 95%: 2.8 – 10.9) se mantuvo siempre positivo y confirma que la diferencia es robusta (mínimo ≈3 años, máximo ≈11 años de mayor esperanza de vida), demostrando que la esperanza de vida en las mujeres es <strong>estadísticamente mayor</strong> que la de los hombres. Este resultado es consistente con el patrón demográfico descrito en poblaciones humanas: las mujeres suelen presentar <strong>mayor supervivencia acumulada</strong> y, en consecuencia, una esperanza de vida superior.</p>
<hr>
</section>
</section>
</section>
<section id="b.-cementerio-jardines-de-paz---santa-marta" class="level3">
<h3 class="anchored" data-anchor-id="b.-cementerio-jardines-de-paz---santa-marta">B. Cementerio Jardines de Paz - Santa Marta</h3>
<section id="pasos-1-a-3-librerías-y-lectura-de-la-base-de-datos" class="level4">
<h4 class="anchored" data-anchor-id="pasos-1-a-3-librerías-y-lectura-de-la-base-de-datos">Pasos 1 a 3) Librerías y lectura de la base de datos</h4>
<p>Se fusionan los tres pasos inciiales, para resumir el procedimiento de construir la tabla de vida de esta muestra de cementerios. El número de intervalos es menor, porque los individuos en esta muestra son menos longevos que los del primer cementerio.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 1)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos del censo - datos2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"cementerios.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Jardines_Paz"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">id   =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nac  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">NACIMIENTO</span><span class="st">`</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mue  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">MUERTE</span><span class="st">`</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">EDAD INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo =</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">SEXO</span><span class="st">`</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edad =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(edad) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mue) <span class="sc">&amp;</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(nac), mue <span class="sc">-</span> nac, edad)) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad), edad <span class="sc">&gt;=</span> 0L)    <span class="co"># Garantizar No = 600</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datos2)  <span class="co"># verificación del número de datos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 600</code></pre>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 2)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ancho o tamaño de los intervalos de clase</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ancho  <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cortes o intervalos hasta cubrir la edad máxima observada</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>((<span class="fu">max</span>(datos2<span class="sc">$</span>edad) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> ancho) <span class="sc">*</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>              ancho, <span class="at">by =</span> ancho)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Inicio de la tabla de vida con las clases de edad y la frecuencia (nx)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>tbl_ini <span class="ot">&lt;-</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># índice del intervalo (1,2,3, …)</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">bin =</span> <span class="fu">cut</span>(edad, <span class="at">breaks =</span> cortes, <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># límite inferior del intervalo</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_ini =</span> cortes[bin],</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ¿es el último intervalo?</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">es_ultimo =</span> edad_ini <span class="sc">==</span> <span class="fu">max</span>(cortes) <span class="sc">-</span> ancho,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># etiquetar “a-b” para clases internas y “a+” para la última</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">clase =</span> <span class="fu">if_else</span>(es_ultimo,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(edad_ini, <span class="st">"+"</span>),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(edad_ini, <span class="st">"-"</span>, edad_ini <span class="sc">+</span> ancho <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(clase, edad_ini, <span class="at">name =</span> <span class="st">"nx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(edad_ini)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimadores de la tabla de vida</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>N0  <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl_ini<span class="sc">$</span>nx)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>N_x <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(tbl_ini<span class="sc">$</span>nx)))</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>Sx <span class="ot">&lt;-</span> (dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x) <span class="sc">/</span> N_x) <span class="sc">|&gt;</span> </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>       tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)     <span class="co"># Último valor es cero</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>lx  <span class="ot">&lt;-</span> <span class="fu">round</span>(N_x <span class="sc">/</span> N0, <span class="dv">2</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>Lx  <span class="ot">&lt;-</span> (N_x <span class="sc">+</span> dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>Lx[<span class="fu">is.na</span>(Lx)] <span class="ot">&lt;-</span> (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">tail</span>(N_x, <span class="dv">1</span>)   <span class="co"># último abierto</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>Tx  <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx)))</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>ex  <span class="ot">&lt;-</span> <span class="fu">round</span>(Tx <span class="sc">/</span> N_x,<span class="dv">1</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Organización de la tabla de vida</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>tabla_vida_jp <span class="ot">&lt;-</span> </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  tbl_ini <span class="sc">%&gt;%</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nx =</span> N_x, <span class="at">Sx =</span> Sx, <span class="at">lx =</span> lx, <span class="at">Lx =</span> Lx, <span class="at">Tx =</span> Tx, <span class="at">ex =</span> ex,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">edad_med =</span> edad_ini <span class="sc">+</span> ancho<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla de vida</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>tabla_vida_jp <span class="sc">%&gt;%</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>edad_ini, <span class="sc">-</span>edad_med) <span class="sc">%&gt;%</span> </span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Cementerio Jardines de Paz. Clases de edad y frecuencias de datos (nx)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Cementerio Jardines de Paz. Clases de edad y frecuencias de datos (nx)</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> clase </th>
   <th style="text-align:right;"> nx </th>
   <th style="text-align:right;"> Nx </th>
   <th style="text-align:right;"> Sx </th>
   <th style="text-align:right;"> lx </th>
   <th style="text-align:right;"> Lx </th>
   <th style="text-align:right;"> Tx </th>
   <th style="text-align:right;"> ex </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0-9 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:right;"> 0.97 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 5920 </td>
   <td style="text-align:right;"> 37050 </td>
   <td style="text-align:right;"> 61.8 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10-19 </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 584 </td>
   <td style="text-align:right;"> 0.96 </td>
   <td style="text-align:right;"> 0.97 </td>
   <td style="text-align:right;"> 5725 </td>
   <td style="text-align:right;"> 31130 </td>
   <td style="text-align:right;"> 53.3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20-29 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 561 </td>
   <td style="text-align:right;"> 0.93 </td>
   <td style="text-align:right;"> 0.94 </td>
   <td style="text-align:right;"> 5420 </td>
   <td style="text-align:right;"> 25405 </td>
   <td style="text-align:right;"> 45.3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 30-39 </td>
   <td style="text-align:right;"> 59 </td>
   <td style="text-align:right;"> 523 </td>
   <td style="text-align:right;"> 0.89 </td>
   <td style="text-align:right;"> 0.87 </td>
   <td style="text-align:right;"> 4935 </td>
   <td style="text-align:right;"> 19985 </td>
   <td style="text-align:right;"> 38.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 40-49 </td>
   <td style="text-align:right;"> 40 </td>
   <td style="text-align:right;"> 464 </td>
   <td style="text-align:right;"> 0.91 </td>
   <td style="text-align:right;"> 0.77 </td>
   <td style="text-align:right;"> 4440 </td>
   <td style="text-align:right;"> 15050 </td>
   <td style="text-align:right;"> 32.4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 50-59 </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 424 </td>
   <td style="text-align:right;"> 0.85 </td>
   <td style="text-align:right;"> 0.71 </td>
   <td style="text-align:right;"> 3925 </td>
   <td style="text-align:right;"> 10610 </td>
   <td style="text-align:right;"> 25.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 60-69 </td>
   <td style="text-align:right;"> 90 </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.60 </td>
   <td style="text-align:right;"> 3160 </td>
   <td style="text-align:right;"> 6685 </td>
   <td style="text-align:right;"> 18.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 70-79 </td>
   <td style="text-align:right;"> 111 </td>
   <td style="text-align:right;"> 271 </td>
   <td style="text-align:right;"> 0.59 </td>
   <td style="text-align:right;"> 0.45 </td>
   <td style="text-align:right;"> 2155 </td>
   <td style="text-align:right;"> 3525 </td>
   <td style="text-align:right;"> 13.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 80-89 </td>
   <td style="text-align:right;"> 103 </td>
   <td style="text-align:right;"> 160 </td>
   <td style="text-align:right;"> 0.36 </td>
   <td style="text-align:right;"> 0.27 </td>
   <td style="text-align:right;"> 1085 </td>
   <td style="text-align:right;"> 1370 </td>
   <td style="text-align:right;"> 8.6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 90+ </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 285 </td>
   <td style="text-align:right;"> 285 </td>
   <td style="text-align:right;"> 5.0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-4-gráficos-supervivencia-l_x-y-de-esperanza-de-vida-e_x-1">Paso 4) Gráficos: supervivencia <span class="math inline">\(l_x\)</span> y de esperanza de vida <span class="math inline">\(e_x\)</span></h4>
<p>A continuación se graficarán los estimadores <span class="math inline">\(l_x = N_x/N_0\)</span> como <strong>supervivencia proporcional</strong> y <span class="math inline">\(e_x\)</span> como <strong>años esperados por sobreviviente</strong> a la edad <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura de esperanza de vida (ex)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>g_lx <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tabla_vida_jp, <span class="fu">aes</span>(edad_med, lx)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span>  <span class="fu">expression</span>(<span class="st">"Supervivencia"</span><span class="sc">~</span>(l[x])),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supervivencia proporcional (l\u2093 = Nx / No)"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Figura del horario de supervivencia (lx)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>g_ex <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tabla_vida_jp, <span class="fu">aes</span>(edad_med, ex)) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span> <span class="fu">expression</span>(e[x]<span class="sc">~</span><span class="st">"(años)"</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Esperanza de vida (e\u2093 = Tx / Nx)"</span>) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>g_lx</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>g_ex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="paso-5-comparativo-entre-sexos---e_x-y-l_x-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-5-comparativo-entre-sexos---e_x-y-l_x-1">Paso 5) Comparativo entre sexos - <span class="math inline">\(e_x\)</span> y <span class="math inline">\(l_x\)</span></h4>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insumos requeridos para la figura (Insumos del Paso 1)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>datos2 <span class="ot">&lt;-</span> datos2 <span class="co"># Datos del censo al cementerio</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ancho  <span class="ot">&lt;-</span> <span class="dv">10</span>     <span class="co"># Amplitud de los irtervalos de edad en la tv</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cortes <span class="ot">&lt;-</span> cortes <span class="co"># Intervalos hasta cubrir la edad máxima observada</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># etiquetas para los intervalos (última como "a+")</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>starts <span class="ot">&lt;-</span> <span class="fu">head</span>(cortes, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>labs   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(starts, <span class="st">"-"</span>, starts <span class="sc">+</span> ancho <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>labs[<span class="fu">length</span>(labs)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(starts[<span class="fu">length</span>(starts)], <span class="st">"+"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>tbl_sex <span class="ot">&lt;-</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">clase =</span> <span class="fu">cut</span>(edad,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">breaks =</span> cortes,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">right =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> labs),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_ini =</span> <span class="fu">as.integer</span>(<span class="fu">sub</span>(<span class="st">"-.*"</span>, <span class="st">""</span>, <span class="fu">as.character</span>(clase)))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo, clase, edad_ini, <span class="at">name =</span> <span class="st">"nx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sexo, edad_ini)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de vida por cada sexo</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>tv_sex <span class="ot">&lt;-</span> </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  tbl_sex <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(edad_ini, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">N0  =</span> <span class="fu">sum</span>(nx),                    <span class="co"># radix por sexo</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">N_x =</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(nx))),       <span class="co"># supervivientes al inicio del intervalo</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lx  =</span> (N_x <span class="sc">+</span> <span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho,      <span class="co"># años-persona en el intervalo</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lx  =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(Lx), (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">last</span>(N_x), Lx),         <span class="co"># último intervalo abierto</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tx  =</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx))),</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ex  =</span> Tx <span class="sc">/</span> N_x,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">lx  =</span> N_x <span class="sc">/</span> N0,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">edad_med =</span> edad_ini <span class="sc">+</span> ancho<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Figuras ---</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Esperanza de vida (e_x) por sexo</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>g_ex_sex <span class="ot">&lt;-</span> </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tv_sex, <span class="fu">aes</span>(<span class="at">x =</span> edad_med, </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> ex, </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años, punto medio del intervalo)"</span>,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(e[x]<span class="sc">~</span><span class="st">"(años)"</span>),</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Esperanza de vida (e\u2093) por sexo"</span>) <span class="sc">+</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Supervivencia (lx) por sexo</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>g_lx_sex <span class="ot">&lt;-</span> </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(tv_sex, <span class="fu">aes</span>(<span class="at">x =</span> edad_med, </span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> lx, </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años, punto medio del intervalo)"</span>,</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(l[x]),</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supervivencia (l\u2093 = N\u2093 / N\u2092) por sexo"</span>) <span class="sc">+</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>g_ex_sex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g_lx_sex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Patrones observados por sexos</strong></p>
<ul>
<li><p><strong>Figura de</strong> <span class="math inline">\(e_x\)</span>​. A pesar que la curva de las mujeres está <strong>por encima</strong>, casi se iguala en los últimos intervalos de edades.</p></li>
<li><p><strong>Figura de</strong> <span class="math inline">\(l_x\)</span>​. El patrón es inverso al de la figura anterior, porque la separación en la supervivencia se da en los últimos intervalos.</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla base por sexo</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>resumen_e0 <span class="ot">&lt;-</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  tv_sex <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(edad_ini, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">1</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>  <span class="co"># toma el primer intervalo (x = 0)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(sexo, <span class="at">N0 =</span> N0, <span class="at">e0 =</span> <span class="fu">round</span>(ex, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>resumen_e0 <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Esperanza de vida al nacer (e\u2092) por sexo"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"c"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Esperanza de vida al nacer (eₒ) por sexo</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> sexo </th>
   <th style="text-align:center;"> N0 </th>
   <th style="text-align:center;"> e0 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> F </td>
   <td style="text-align:center;"> 286 </td>
   <td style="text-align:center;"> 66.26 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> M </td>
   <td style="text-align:center;"> 314 </td>
   <td style="text-align:center;"> 57.64 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Similar al primer cementerio, las <strong>mujeres viven en promedio ~7.12 años más que los hombres</strong>.</p>
<hr>
<section id="comparación-estadística-entre-sexos-bootstrap.-1" class="level5">
<h5 class="anchored" data-anchor-id="comparación-estadística-entre-sexos-bootstrap.-1">5.1) Comparación estadística entre sexos (Bootstrap).</h5>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Bootstrap estratificado para la diferencia de e0 entre sexos ---</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir las categorías de sexos</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>)  <span class="co"># o c("M","F"), puede ser A, B</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegurar datos y ancho</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"datos2"</span>)) {</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"cemementerios.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Jardines_Paz"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">edad =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">EDAD INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">nac  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">NACIMIENTO</span><span class="st">`</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">mue  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">MUERTE</span><span class="st">`</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">sexo =</span> <span class="fu">as.character</span>(<span class="st">`</span><span class="at">SEXO</span><span class="st">`</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">edad =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(edad) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mue) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(nac), mue <span class="sc">-</span> nac, edad)) <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad), edad <span class="sc">&gt;=</span> 0L)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"ancho"</span>)) ancho <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Función que calcula e0 desde un vector de edades (misma lógica de la tabla de vida)</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>e0_from_edades <span class="ot">&lt;-</span> <span class="cf">function</span>(edades, <span class="at">ancho =</span> <span class="dv">10</span>) {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  edades <span class="ot">&lt;-</span> edades[<span class="fu">is.finite</span>(edades) <span class="sc">&amp;</span> edades <span class="sc">&gt;=</span> <span class="dv">0</span>]</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(edades) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  cortes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>((<span class="fu">max</span>(edades) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>ancho) <span class="sc">*</span> ancho, <span class="at">by =</span> ancho)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">cut</span>(edades, <span class="at">breaks =</span> cortes, <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include_lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  nx  <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">tabulate</span>(bin, <span class="at">nbins =</span> <span class="fu">length</span>(cortes) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(nx) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  N_x <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(nx)))</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  Lx  <span class="ot">&lt;-</span> (N_x <span class="sc">+</span> dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  Lx[<span class="fu">is.na</span>(Lx)] <span class="ot">&lt;-</span> (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">tail</span>(N_x, <span class="dv">1</span>)     <span class="co"># último intervalo abierto</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  Tx  <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx)))</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  e0  <span class="ot">&lt;-</span> Tx[<span class="dv">1</span>] <span class="sc">/</span> N_x[<span class="dv">1</span>]</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  e0</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar estratos por sexo (tomamos sólo los dos con datos)</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> </span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  datos2 <span class="sc">%&gt;%</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo, <span class="at">name =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sexo)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(sex_levels) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Se requiere al menos dos sexos con datos para el contraste."</span>)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>sex_levels <span class="ot">&lt;-</span> sex_levels[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]  <span class="co"># usar los dos principales (p.ej., 'F' y 'M')</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>edades_A <span class="ot">&lt;-</span> datos2<span class="sc">$</span>edad[datos2<span class="sc">$</span>sexo <span class="sc">==</span> sex_levels[<span class="dv">1</span>]]</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>edades_B <span class="ot">&lt;-</span> datos2<span class="sc">$</span>edad[datos2<span class="sc">$</span>sexo <span class="sc">==</span> sex_levels[<span class="dv">2</span>]]</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>nA <span class="ot">&lt;-</span> <span class="fu">length</span>(edades_A); nB <span class="ot">&lt;-</span> <span class="fu">length</span>(edades_B)</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="co"># e0 observado por sexo y diferencia</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>e0_A <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(edades_A, <span class="at">ancho =</span> ancho)</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>e0_B <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(edades_B, <span class="at">ancho =</span> ancho)</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>delta_obs <span class="ot">&lt;-</span> e0_B <span class="sc">-</span> e0_A    <span class="co"># por convención: B - A (si tus etiquetas son M/F, típicamente M - F)</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>delta_boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>  samp_A <span class="ot">&lt;-</span> <span class="fu">sample</span>(edades_A, <span class="at">size =</span> nA, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>  samp_B <span class="ot">&lt;-</span> <span class="fu">sample</span>(edades_B, <span class="at">size =</span> nB, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>  e0A_b  <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(samp_A, <span class="at">ancho =</span> ancho)</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>  e0B_b  <span class="ot">&lt;-</span> <span class="fu">e0_from_edades</span>(samp_B, <span class="at">ancho =</span> ancho)</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>  e0B_b <span class="sc">-</span> e0A_b</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo percentil y p-valor aproximado de dos colas</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(delta_boot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a><span class="co"># p-valor bilateral consistente con el IC percentil</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(delta_boot <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(delta_boot <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="co"># (Opcional) Histograma de la distribución bootstrap de la diferencia</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">delta =</span> delta_boot), <span class="fu">aes</span>(<span class="at">x =</span> delta)) <span class="sc">+</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> delta_obs, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"Δ eo = eo("</span>, sex_levels[<span class="dv">2</span>], <span class="st">") - eo("</span>, sex_levels[<span class="dv">1</span>], <span class="st">")"</span>),</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Bootstrap estratificado de la diferencia de e0 entre sexos"</span>) <span class="sc">+</span></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Análisis del patrón gráfico encontrado.</strong></p>
<p>Este histograma muestra la distribución bootstrap de <span class="math inline">\(\Delta e_0\)</span>, con mediana ≈ <strong>9</strong> años (línea punteada) (desplazada a la derecha respecto a San Miguel, que presentó una mediana ≈ 6–7 años). El <strong>IC 95% (percentiles):</strong> ≈ <strong>4.5</strong> a <strong>13.5</strong> años (En San Miguel fue ≈ 2–3 a 10–11 años).En este sentido, diferencia mayor que en San Miguel fue, ~ <strong>8–10 años</strong> (mediana ~9).</p>
<p>De esta manera se puede decir que si bien, en ambos cementerios se muestra que la esperanza de vida de las mujeres es mayor, en Jardines de Paz aumenta la diferencia (≈ +2–3 años más que San Miguel)</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen numérico</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>res_boot <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo_A =</span> sex_levels[<span class="dv">1</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sexo_B =</span> sex_levels[<span class="dv">2</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">e0_A   =</span> <span class="fu">round</span>(e0_A,<span class="dv">1</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">e0_B   =</span> <span class="fu">round</span>(e0_B,<span class="dv">1</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diff_B_A =</span> <span class="fu">round</span>(delta_obs,<span class="dv">1</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI2.5  =</span> <span class="fu">round</span>(<span class="fu">unname</span>(ci[<span class="dv">1</span>]),<span class="dv">1</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI97.5 =</span> <span class="fu">round</span>(<span class="fu">unname</span>(ci[<span class="dv">2</span>]),<span class="dv">1</span>),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">valor_p_dos_colas =</span> <span class="fu">round</span>(pval,<span class="dv">2</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> B</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla base requerida</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>res_boot <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resultados numéricos del Bootstrap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Resultados numéricos del Bootstrap</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> sexo_A </th>
   <th style="text-align:left;"> sexo_B </th>
   <th style="text-align:right;"> e0_A </th>
   <th style="text-align:right;"> e0_B </th>
   <th style="text-align:right;"> diff_B_A </th>
   <th style="text-align:right;"> CI2.5 </th>
   <th style="text-align:right;"> CI97.5 </th>
   <th style="text-align:right;"> valor_p_dos_colas </th>
   <th style="text-align:right;"> B </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> M </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 57.6 </td>
   <td style="text-align:right;"> 66.3 </td>
   <td style="text-align:right;"> 8.6 </td>
   <td style="text-align:right;"> 4.7 </td>
   <td style="text-align:right;"> 12.2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>Análisis del resultado tabular.</strong></p>
<p><strong>La esperanza de vida - e₀ de hombres (M):</strong> ~57.6 años y <strong>e₀ de mujeres (F):</strong> ~66.3 años. La <strong>diferencia observada (F – M):</strong> ~8.6 años de mayor esperanza de vida en las mujeres. El <strong>IC</strong> al <strong>95%:</strong> (4.7, 12.2), por ser positivo, indica que la esperanza de vida femenina es mayor, mostrando que el aumento en dicha esperanza está entre 2.8 y 11 años. El <strong>valor p</strong> obtenido de cero (&lt;&lt;0.05), es coherente con el IC, indicando que las diferencias en la esperanza de vida entre sexos es altamente significativa.</p>
<p>En este sentido se vuelve a demostrar que <strong>las mujeres tienen una esperanza de vida significativamente mayor que los hombres (≈9 años de ventaja, superior a la ventaja de 7 años del primer cementerio)</strong>. El IC 95% confirma que la diferencia es robusta (mínimo ≈ 4 años, máximo ≈ 12).</p>
<hr>
</section>
</section>
<section id="paso-6-comparación-de-las-curvas-de-esperanza-de-vida-y-de-supervivencia-entre-cementerios" class="level4">
<h4 class="anchored" data-anchor-id="paso-6-comparación-de-las-curvas-de-esperanza-de-vida-y-de-supervivencia-entre-cementerios">Paso 6) Comparación de las curvas de esperanza de vida y de supervivencia entre cementerios</h4>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar y etiquetar</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  tabla_vida_sm <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cementerio =</span> <span class="st">"San Miguel"</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  tabla_vida_jp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cementerio =</span> <span class="st">"Jardines de Paz"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># g_lx: Supervivencia proporcional (l_x)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>g_lx <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comp, <span class="fu">aes</span>(edad_med, lx, <span class="at">color =</span> cementerio)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Supervivencia"</span><span class="sc">~</span>(l[x])),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Supervivencia proporcional por cementerio"</span>) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># g_ex: Esperanza de vida (e_x)</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>g_ex <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comp, <span class="fu">aes</span>(edad_med, ex, <span class="at">color =</span> cementerio)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Edad (años)"</span>, <span class="at">y =</span> <span class="fu">expression</span>(e[x]<span class="sc">~</span><span class="st">"(años)"</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Esperanza de vida por cementerio"</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>g_lx </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>g_ex</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="paso-7-tamaño-mínimo-de-muestra-y-prueba-de-potencia-para-la-tabla-de-vida-elaborada" class="level4">
<h4 class="anchored" data-anchor-id="paso-7-tamaño-mínimo-de-muestra-y-prueba-de-potencia-para-la-tabla-de-vida-elaborada">Paso 7) Tamaño mínimo de muestra y prueba de potencia para la tabla de vida elaborada</h4>
<p>Esta prueba se enfoca en calcular cuántas <strong>tumbas</strong> se requieren censar para estimar con <strong>precisión</strong> a la <strong>esperanza de vida</strong> (<span class="math inline">\(e_0\)</span>) y a la <strong>supervivencia</strong> (<span class="math inline">\(l_x\)</span>). Se proponen a contiuación dos enfoques complementarios.</p>
<ol type="1">
<li><p><strong>Analítica rápida</strong>. Tomada de <strong>Sokal &amp; Rohlf, 1995</strong> (Biometry) usando la <strong>media de la edad al morir</strong> como <em>proxy</em> de la esperanza de vida - <span class="math inline">\(e_0\)</span> (población estacionaria). Para margen objetivo <span class="math inline">\(h\)</span> (semi–ancho del IC al 95%) y desviación estándar <span class="math inline">\(s\)</span> de la edad:<br>
<span class="math display">\[
n \;\approx\; \left(\frac{z_{1-\alpha/2}\, s}{h}\right)^2\
\]</span><br>
donde,<br>
</p>
<ul>
<li><span class="math inline">\(n\)</span>: tamaño de muestra requerido (<strong>redondear hacia arriba</strong>).<br>
</li>
<li><span class="math inline">\(z_{1-\alpha/2}\)</span>​: cuantil de la normal estándar para el nivel de confianza (p.ej., <strong>1.96</strong> para 95%).<br>
</li>
<li><span class="math inline">\(s\)</span>: <strong>desviación estándar</strong> de la edad al morir (de un piloto/estudio previo). Si se conoce σ, úsala.</li>
<li><span class="math inline">\(h\)</span>: <strong>semi-ancho deseado del IC</strong> (tolerancia de error absoluto en años) para la media de la edad (usada como <em>proxy</em> de e0e_0e0​ bajo población estacionaria).<br>
</li>
<li><span class="math inline">\(\alpha\)</span>: nivel de significancia del IC (0.05 para 95%).<br>
</li>
</ul>
<p>Además, se asume que la muestra es obtenida de un diseño aleatorio, con datos independientes y con distribución normal. Si la muestra es muy pequeña, se debe usar <span class="math inline">\(t\)</span> en ves de <span class="math inline">\(z\)</span>.</p></li>
</ol>
<p>En esta prueba se toma como referencia a la <strong>media de la edad al morir</strong> como aproximación de la <strong>esperanza de vida al nacer</strong> (<span class="math inline">\(e_0\)</span>). La idea es responder a la pregunta:</p>
<pre><code>&gt; ¿Cuántas tumbas se deben censar para que la estimación de la
&gt; esperanza de vida tenga una precisión aceptable?</code></pre>
<p>El criterio de precisión que se fijará es de <strong>un margen de error de ±1 año</strong> en el intervalo de confianza del 95%.</p>
<ol start="2" type="1">
<li><strong>Bootstrap específico de</strong> <span class="math inline">\(e_0\)</span> (más acorde a este ejercicio): basada en el remuestreo de la distribución observada de edades y calculándo a <span class="math inline">\(e_0\)</span> a través de tabla de vida (mismo <code>ancho</code>). Se busca el tamaño de muestra - <span class="math inline">\(n\)</span> mínimo cuyo IC-95% tenga una <strong>semi-anchura</strong> <span class="math inline">\(\le h_{e0}\)</span> (por ejemplo, <span class="math inline">\(h_{e0}=1\)</span> año).</li>
</ol>
<hr>
<section id="analítica-rápida-media-edad-al-morir-como-proxy-de-e_0" class="level5">
<h5 class="anchored" data-anchor-id="analítica-rápida-media-edad-al-morir-como-proxy-de-e_0">7.1) Analítica rápida (media edad al morir como proxy de <span class="math inline">\(e_0\)</span>)</h5>
<p>Como la muestra de 600 tumbas censadas es igual para los dos cementerios, se utilizarán los datos de San Miguel, lo cual aplica también para Jardines de Paz.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"datos"</span>)) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl); </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"cementerios.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"San_Miguel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">transmute</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">edad =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">EDAD INDIVIDUO</span><span class="st">`</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">nac  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">NACIMIENTO</span><span class="st">`</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">mue  =</span> <span class="fu">as.integer</span>(<span class="st">`</span><span class="at">MUERTE</span><span class="st">`</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">edad =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(edad) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mue) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(nac), mue <span class="sc">-</span> nac, edad)) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(edad), edad <span class="sc">&gt;=</span> 0L)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span> <span class="fl">0.05</span>   <span class="co"># 95% de confianza</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>h_mean <span class="ot">&lt;-</span> <span class="dv">1</span>      <span class="co"># margen objetivo (años) para la media</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>z      <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>s_edad <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">sd</span>(datos<span class="sc">$</span>edad, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>n_obs  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>n_req_mean <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((z <span class="sc">*</span> s_edad <span class="sc">/</span> h_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>h_obs_mean <span class="ot">&lt;-</span> z <span class="sc">*</span> s_edad <span class="sc">/</span> <span class="fu">sqrt</span>(n_obs)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metodo                =</span> <span class="st">"Analítico (media edad como proxy de e_0)"</span>,</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n requerido</span><span class="st">`</span>         <span class="ot">=</span> n_req_mean,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n observado</span><span class="st">`</span>         <span class="ot">=</span> n_obs,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">h objetivo (años)</span><span class="st">`</span>   <span class="ot">=</span> h_mean,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">h logrado con n_obs</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(h_obs_mean, <span class="dv">2</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados de la prueba analítica rápida</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>tabla <span class="sc">%&gt;%</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resultados de la prueba analítica rápida"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Resultados de la prueba analítica rápida</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Metodo </th>
   <th style="text-align:right;"> n requerido </th>
   <th style="text-align:right;"> n observado </th>
   <th style="text-align:right;"> h objetivo (años) </th>
   <th style="text-align:right;"> h logrado con n_obs </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Analítico (media edad como proxy de e_0) </td>
   <td style="text-align:right;"> 2478 </td>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2.03 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>Resultado obtenido:</strong></p>
<p>Según esta prueba, serían necesarias aproximadamente <strong>2220 tumbas</strong> para lograr una estimación de la media de edad con un error máximo de ±1 año.</p>
<p><span class="math display">\[n  \approx\; \left(\frac{z_{0.975}\, s}{h}\right)^2\]</span></p>
<p>El censo realizado cuenta con <strong>600 tumbas</strong>. Esto es bastante menor al tamaño recomendado para el nivel de precisión exigido.</p>
<p>La tabla también te reportó:</p>
<p><span class="math display">\[
h_{\text{con 600}} = \frac{z \cdot s}{\sqrt{600}}\
\]</span></p>
<p>Por ejemplo, si la desviación estándar <span class="math inline">\(s\)</span> de la edad fuese de 20 años:</p>
<p><span class="math display">\[
h = \frac{1.96 \cdot 20}{\sqrt{600}}\
\]</span></p>
<p>Si <span class="math inline">\(s=25\)</span></p>
<p>Es decir, con 600 tumbas probablemente el margen real este entre ±1.5 y ±2 años. Con la muestra actual de 600 tumbas, la media de edad al morir se estima con un <strong>margen mayor a ±1 año</strong>, cercano a <strong>±1.5 – 2 años</strong> (dependiendo de la variabilidad real de las edades). Es decir, <strong>no se alcanza la meta de ±1 año</strong>, pero se puede obtener un resultado razonable para rangos de edad un poco más amplios.</p>
<hr>
</section>
<section id="bootstrap-de-e_0-con-el-mismo-esquema-de-tabla-de-vida" class="level5">
<h5 class="anchored" data-anchor-id="bootstrap-de-e_0-con-el-mismo-esquema-de-tabla-de-vida">7.2) Bootstrap de <span class="math inline">\(e_0\)</span> con el mismo esquema de tabla de vida</h5>
<p>En este análisis se aplica un enfoque de <strong>simulación bootstrap</strong> para evaluar cuánta <strong>precisión</strong> se alcanza al estimar la <strong>esperanza de vida al nacer (</strong><span class="math inline">\(e_0\)</span>​) con distintos tamaños de muestra (número de tumbas censadas). El criterio fijado es de un <strong>margen de error de ±1 año</strong> en el intervalo de confianza del 95%.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"ancho"</span>)) ancho <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>e0_edades <span class="ot">&lt;-</span> <span class="cf">function</span>(edades, <span class="at">ancho =</span> <span class="dv">10</span>) {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  cortes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>((<span class="fu">max</span>(edades) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>ancho) <span class="sc">*</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                ancho, <span class="at">by =</span> ancho)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  bin    <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">cut</span>(edades, <span class="at">breaks =</span> cortes, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">include_lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  nx_tbl <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(bin), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  nx_tbl<span class="sc">$</span>bin <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(nx_tbl<span class="sc">$</span>bin)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  nx_tbl <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(nx_tbl, bin)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  nx     <span class="ot">&lt;-</span> nx_tbl<span class="sc">$</span>Freq</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(nx) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA_real_</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  N_x <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(nx)))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  Lx  <span class="ot">&lt;-</span> (N_x <span class="sc">+</span> dplyr<span class="sc">::</span><span class="fu">lead</span>(N_x))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> ancho</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  Lx[<span class="fu">is.na</span>(Lx)] <span class="ot">&lt;-</span> (ancho<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">tail</span>(N_x, <span class="dv">1</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  Tx  <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx)))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  e0  <span class="ot">&lt;-</span> Tx[<span class="dv">1</span>] <span class="sc">/</span> N_x[<span class="dv">1</span>]</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(e0)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>n_obs  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>grid_n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(<span class="dv">100</span>, n_obs), n_obs, <span class="at">by =</span> <span class="dv">50</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>B      <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>h_e0   <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(grid_n, <span class="cf">function</span>(ni) {</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  e0_vals <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    edades_i <span class="ot">&lt;-</span> <span class="fu">sample</span>(datos<span class="sc">$</span>edad, <span class="at">size =</span> ni, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">e0_edades</span>(edades_i, <span class="at">ancho =</span> ancho)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  e0_vals <span class="ot">&lt;-</span> e0_vals[<span class="fu">is.finite</span>(e0_vals)]</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(e0_vals, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">n =</span> ni,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">e0_mediana =</span> <span class="fu">round</span>(<span class="fu">unname</span>(q[<span class="dv">2</span>]),<span class="dv">2</span>),</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">e0_menor     =</span> <span class="fu">round</span>(<span class="fu">unname</span>(q[<span class="dv">1</span>]),<span class="dv">2</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">e0_mayor    =</span> <span class="fu">round</span>(<span class="fu">unname</span>(q[<span class="dv">3</span>]),<span class="dv">2</span>),</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">semianchura=</span> <span class="fu">round</span>((q[<span class="dv">3</span>] <span class="sc">-</span> q[<span class="dv">1</span>]) <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>res_boot <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(res)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados de la prueba Bootstrap</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>res_boot <span class="sc">%&gt;%</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resultados de la prueba Bootstrap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Resultados de la prueba Bootstrap</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> e0_mediana </th>
   <th style="text-align:right;"> e0_menor </th>
   <th style="text-align:right;"> e0_mayor </th>
   <th style="text-align:right;"> semianchura </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 64.20 </td>
   <td style="text-align:right;"> 55.40 </td>
   <td style="text-align:right;"> 69.20 </td>
   <td style="text-align:right;"> 6.90 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> 64.77 </td>
   <td style="text-align:right;"> 60.13 </td>
   <td style="text-align:right;"> 68.74 </td>
   <td style="text-align:right;"> 4.30 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 64.50 </td>
   <td style="text-align:right;"> 60.40 </td>
   <td style="text-align:right;"> 67.75 </td>
   <td style="text-align:right;"> 3.68 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 64.58 </td>
   <td style="text-align:right;"> 61.60 </td>
   <td style="text-align:right;"> 67.68 </td>
   <td style="text-align:right;"> 3.04 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:right;"> 64.50 </td>
   <td style="text-align:right;"> 61.67 </td>
   <td style="text-align:right;"> 67.53 </td>
   <td style="text-align:right;"> 2.93 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 64.67 </td>
   <td style="text-align:right;"> 61.88 </td>
   <td style="text-align:right;"> 66.97 </td>
   <td style="text-align:right;"> 2.54 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 64.58 </td>
   <td style="text-align:right;"> 62.02 </td>
   <td style="text-align:right;"> 67.05 </td>
   <td style="text-align:right;"> 2.51 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 450 </td>
   <td style="text-align:right;"> 64.53 </td>
   <td style="text-align:right;"> 62.27 </td>
   <td style="text-align:right;"> 66.62 </td>
   <td style="text-align:right;"> 2.18 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 64.67 </td>
   <td style="text-align:right;"> 62.32 </td>
   <td style="text-align:right;"> 66.70 </td>
   <td style="text-align:right;"> 2.19 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 550 </td>
   <td style="text-align:right;"> 64.56 </td>
   <td style="text-align:right;"> 62.38 </td>
   <td style="text-align:right;"> 66.76 </td>
   <td style="text-align:right;"> 2.19 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:right;"> 64.53 </td>
   <td style="text-align:right;"> 62.43 </td>
   <td style="text-align:right;"> 66.54 </td>
   <td style="text-align:right;"> 2.05 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>La tabla muestra cómo cambia la estimación de la <strong>esperanza de vida al nacer (</strong><span class="math inline">\(e_0\)</span>​) y su intervalo de confianza al aumentar el tamaño de muestra. En todos los tamaños de muestra, la mediana de <span class="math inline">\(e_0\)</span>​ se mantiene cercana a <strong>64.5 años</strong>, lo cual indica que el valor central de la esperanza de vida no cambia mucho, incluso con pocas tumbas (al rededor de 65).</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n_recomendado <span class="ot">&lt;-</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  res_boot <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(semianchura <span class="sc">&lt;=</span> h_e0) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_min</span>(n, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(n)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">h_e0 objetivo (años)</span><span class="st">`</span> <span class="ot">=</span> h_e0,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n recomendado</span><span class="st">`</span>        <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(n_recomendado)<span class="sc">==</span><span class="dv">0</span>, <span class="cn">NA_integer_</span>, n_recomendado),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n observado</span><span class="st">`</span>          <span class="ot">=</span> n_obs</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados del objetivo de 1 año</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>res_boot <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Resultados del objetivo de un margen de un año"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Resultados del objetivo de un margen de un año</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> e0_mediana </th>
   <th style="text-align:right;"> e0_menor </th>
   <th style="text-align:right;"> e0_mayor </th>
   <th style="text-align:right;"> semianchura </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 64.20 </td>
   <td style="text-align:right;"> 55.40 </td>
   <td style="text-align:right;"> 69.20 </td>
   <td style="text-align:right;"> 6.90 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 150 </td>
   <td style="text-align:right;"> 64.77 </td>
   <td style="text-align:right;"> 60.13 </td>
   <td style="text-align:right;"> 68.74 </td>
   <td style="text-align:right;"> 4.30 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 64.50 </td>
   <td style="text-align:right;"> 60.40 </td>
   <td style="text-align:right;"> 67.75 </td>
   <td style="text-align:right;"> 3.68 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 250 </td>
   <td style="text-align:right;"> 64.58 </td>
   <td style="text-align:right;"> 61.60 </td>
   <td style="text-align:right;"> 67.68 </td>
   <td style="text-align:right;"> 3.04 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 300 </td>
   <td style="text-align:right;"> 64.50 </td>
   <td style="text-align:right;"> 61.67 </td>
   <td style="text-align:right;"> 67.53 </td>
   <td style="text-align:right;"> 2.93 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 350 </td>
   <td style="text-align:right;"> 64.67 </td>
   <td style="text-align:right;"> 61.88 </td>
   <td style="text-align:right;"> 66.97 </td>
   <td style="text-align:right;"> 2.54 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 64.58 </td>
   <td style="text-align:right;"> 62.02 </td>
   <td style="text-align:right;"> 67.05 </td>
   <td style="text-align:right;"> 2.51 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 450 </td>
   <td style="text-align:right;"> 64.53 </td>
   <td style="text-align:right;"> 62.27 </td>
   <td style="text-align:right;"> 66.62 </td>
   <td style="text-align:right;"> 2.18 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 64.67 </td>
   <td style="text-align:right;"> 62.32 </td>
   <td style="text-align:right;"> 66.70 </td>
   <td style="text-align:right;"> 2.19 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 550 </td>
   <td style="text-align:right;"> 64.56 </td>
   <td style="text-align:right;"> 62.38 </td>
   <td style="text-align:right;"> 66.76 </td>
   <td style="text-align:right;"> 2.19 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 600 </td>
   <td style="text-align:right;"> 64.53 </td>
   <td style="text-align:right;"> 62.43 </td>
   <td style="text-align:right;"> 66.54 </td>
   <td style="text-align:right;"> 2.05 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>El objetivo es <span class="math inline">\(h_{e0}\)</span>​=1 año. <strong>n recomendado:</strong> <code>NA</code>. Esto significa que <strong>con ningún tamaño de muestra hasta 600 tumbas</strong> se alcanzó la precisión de ±1 año.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_boot, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> semianchura)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> h_e0, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tamaño de muestra (n tumbas)"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Semianchura del IC 95% de e0 (años)"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Precisión de e0 vs tamaño de muestra (bootstrap)"</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4.3.t.vida_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En la figura se observa cómo <strong>la precisión mejora al aumentar el tamaño de muestra</strong> (la curva desciende a medida se censan más tumbas), sin embargo, la línea horizontal punteada (objetivo de ±1 año) nunca es alcanzada. Lo que sí se logra es una estabilización en torno a <strong>±2 años</strong>, lo cual representa el límite de precisión posible con este conjunto de datos. Lo anterior sugiere que para esta precisión estadística se debería aumentar el tamaño de la muestra (aproximadamente 2500 tumbas) o manejar un margen de error de ±2 años que sigue siendo muy apropiado para este tipo de trabajos demográficos.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body" title="Interpretación de la precisión y la diferencia entre sexos">
<p>En el análisis general inicial, con el censo de <strong>600 tumbas</strong>, la estimación de la esperanza de vida al nacer ((<span class="math inline">\(e_0\)</span>)) alcanzó una <strong>precisión de aproximadamente ±2 años</strong>. Esto significa que, si se repite el estudio muchas veces, la media de (<span class="math inline">\(e_0\)</span>) podría variar dentro de ese rango de incertidumbre.</p>
<p>Ahora bien, al separar por sexos se obtuvo:</p>
<ul>
<li>Hombres: (<span class="math inline">\(e_0\)</span> = 61.4) años<br>
</li>
<li>Mujeres: (<span class="math inline">\(e_0\)</span> = 68.1) años<br>
</li>
<li>Diferencia: (6.7) años</li>
</ul>
<p>El intervalo de confianza obtenido por Bootstrap para esta diferencia fue <strong>IC 95%: 2.8 – 10.9 años</strong>. Como el intervalo <strong>nunca incluye el cero</strong>, permite concluir que la <strong>ventaja femenina en la esperanza de vida es estadísticamente robusta</strong>. Incluso considerando la incertidumbre de ±2 años en cada grupo, la diferencia observada supera claramente ese margen.</p>
<p>Aunque las estimaciones puntuales de (<span class="math inline">\(e_0\)</span>) no alcanzan una precisión estricta de ±1 año, sí son lo suficientemente estables como para mostrar que la <strong>esperanza de vida en las mujeres es consistentemente mayor que en los hombres</strong>. Esto ilustra cómo, en ecología y demografía, la capacidad de detectar diferencias significativas no depende solo de la precisión absoluta de cada estimador, sino de la <strong>magnitud relativa de la diferencia entre grupos</strong>.</p>
</div>
</div>
<hr>
</section>
</section>
</section>
</section>
<section id="ejemplo-2.-tablas-de-vida" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-2.-tablas-de-vida">Ejemplo 2. Tablas de vida</h2>
<p>En este ejercicio se trabajará con el conjunto de datos <code>gotelli.xlsx</code>, extraído del texto <strong>Gotelli (2001).</strong> Este caso presenta una población hipotética de organismos con una distribución de edades definida, que permite calcular las tasas de supervivencia y fecundidad para estimar la <strong>reproducción neta (R₀)</strong> y la <strong>tasa intrínseca de aumento (r)</strong>.</p>
<p>El objetivo de este ejercicio es comprender la lógica matemática detrás de la tabla de vida y su aplicación en la modelación ecológica. A partir de la información dada, los estudiantes desarrollarán paso a paso el cálculo de los parámetros demográficos y discutirán los resultados en términos de <strong>estrategias de historia de vida</strong>. En este sentido se requiere obtener la siguiente información demográfica:</p>
<ol type="1">
<li><p>Construir una <strong>tabla de vida</strong> por edades (<span class="math inline">\(x\)</span>), que incluya estadísticos generales como la esperanza de vida (<span class="math inline">\(e_x\)</span>), la tasa reproductiva neta (<span class="math inline">\(R_0\)</span>), El tiempo generacional (<span class="math inline">\(T\)</span>), las tasas de crecimiento instantáneo (<span class="math inline">\(r\)</span>) y neto (<span class="math inline">\(\lambda\)</span>).</p></li>
<li><p>Calcular algunos estimadores asociados a la <strong>estructura de edades</strong> como los <strong>vectores de distribución estable de edades</strong> (<span class="math inline">\(c_x\)</span>) y el <strong>valor reproductivo</strong> (<span class="math inline">\(v_x\)</span>).</p></li>
<li><p>Realizar una <strong>modelación matricial de estructura de edades</strong>, pa lo cual se requiere calcular las <strong>fecundidades pre y post reporductivas</strong> (<span class="math inline">\(F_{pre}\)</span> y <span class="math inline">\(F_{post}\)</span>), la <strong>matriz de Leslie</strong> (<span class="math inline">\(L\)</span>) y la figura de la proyección matricial multi edad que se visualiza un una tabla proyectada a futuro y en una figura del modelo de proyecció de (<span class="math inline">\(N_x\)</span>).</p></li>
<li><p>De igual forma se calculará de forma matricial a los <strong>vectores de distribución estable de edades</strong> (<span class="math inline">\(c_x\)</span>) y del <strong>valor reproductivo</strong> (<span class="math inline">\(v_x\)</span>), para compararlos con los obtenidos en el paso 2, con la tabla de vida.</p></li>
</ol>
<hr>
<section id="tabla-de-vida-con-estimadores-hasta-la-esperanza-de-vida." class="level4">
<h4 class="anchored" data-anchor-id="tabla-de-vida-con-estimadores-hasta-la-esperanza-de-vida.">1. Tabla de vida con estimadores hasta la esperanza de vida.</h4>
<p><strong>Librerías requeridas</strong></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<section id="paso-1.-cargar-la-base-de-datos-que-contiene-los-tres-estimadores-iniciales-x-nx-mx" class="level5">
<h5 class="anchored" data-anchor-id="paso-1.-cargar-la-base-de-datos-que-contiene-los-tres-estimadores-iniciales-x-nx-mx">Paso 1. Cargar la base de datos que contiene los tres estimadores iniciales (<span class="math inline">\(x, Nx, mx\)</span>)</h5>
<p>Donde, <span class="math inline">\(x\)</span> es la columna que organiza a los datos por edades (<span class="math inline">\(x\)</span>), <span class="math inline">\(N_x\)</span> son las densidades de la población por cada edad y <span class="math inline">\(m_x\)</span> es la materinidad o el proedio de crías por cada edad.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"gotelli.xlsx"</span>) </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Organización de la tabla inicial</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  tabla <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x  =</span> <span class="fu">as.numeric</span>(x),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nx =</span> <span class="fu">as.numeric</span>(Nx),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mx =</span> <span class="fu">as.numeric</span>(mx)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(x)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la tabla base requerida</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>tabla <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Tabla de vida con los estimadores iniciales"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla de vida con los estimadores iniciales</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> x </th>
   <th style="text-align:right;"> Nx </th>
   <th style="text-align:right;"> mx </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 0.0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 423 </td>
   <td style="text-align:right;"> 0.5 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1.4 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 1.0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 0.5 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<hr>
</section>
<section id="paso-2.-construcción-de-la-tabla-de-vida-hasta-la-esperanza-de-vida" class="level5">
<h5 class="anchored" data-anchor-id="paso-2.-construcción-de-la-tabla-de-vida-hasta-la-esperanza-de-vida">Paso 2. Construcción de la tabla de vida hasta la esperanza de vida</h5>
<p>A continuación se construye la tabla de vida (tabla_v) con los estimadores demográficos iniciales, los cuales servirán de insumo para el los estadísticos demográficos del siguiente paso. Se relacionan las ecuaciones requeridas:<br>
</p>
<p><span class="math inline">\(B_x = m_x N_x\)</span> Número de nacimientos<br>
<span class="math inline">\(l_x = \dfrac{N_x}{N_0}\)</span> Probabilidad de supervivencia<br>
<span class="math inline">\(d_x = l_x - l_{x+1}\)</span> Probabilidad de muertes<br>
<span class="math inline">\(q_x = \dfrac{d_x}{l_x}\)</span> Tasa de mortalidad<br>
<span class="math inline">\(p_x = 1 - q_x\)</span> = <span class="math inline">\(S_x\)</span> Supervivencia<br>
<span class="math inline">\(S_x = \dfrac{N_{x+1}}{N_x}\)</span>&nbsp;Supervivencia = <span class="math inline">\(S_x\)</span><br>
<span class="math inline">\(L_x = \dfrac{N_x + N_{x+1}}{2}\)</span> Estimador requerido para <span class="math inline">\(e_x\)</span><br>
<span class="math inline">\(T_x = \sum\_{t \ge x}\)</span>&nbsp;<span class="math inline">\(L_t\)</span>&nbsp;Estimador un requerido para <span class="math inline">\(e_x\)</span><br>
<span class="math inline">\(e_x = \dfrac{T_x}{L_x}\)</span> Esperanza de vida <span class="math inline">\(e_x\)</span><br>
</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tabla_v <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  tabla <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Bx      =</span> Nx <span class="sc">*</span> mx,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">N0      =</span> <span class="fu">first</span>(Nx), </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">mx+1</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">lead</span>(mx, <span class="at">default =</span> <span class="dv">0</span>),   <span class="co"># Requerido para Fx post</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lx      =</span> Nx <span class="sc">/</span> N0,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">lx+1</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">lead</span>(lx, <span class="at">default =</span> <span class="dv">0</span>),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">dx      =</span> lx <span class="sc">-</span> <span class="st">`</span><span class="at">lx+1</span><span class="st">`</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">qx      =</span> <span class="fu">if_else</span>(lx <span class="sc">&gt;</span> <span class="dv">0</span>, dx <span class="sc">/</span> lx, <span class="cn">NA_real_</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">px      =</span> <span class="dv">1</span> <span class="sc">-</span> qx,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Nx+1</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">lead</span>(Nx, <span class="at">default =</span> <span class="dv">0</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sx      =</span> <span class="st">`</span><span class="at">Nx+1</span><span class="st">`</span> <span class="sc">/</span> Nx,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lx      =</span> (Nx <span class="sc">+</span> <span class="st">`</span><span class="at">Nx+1</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tx      =</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(Lx))),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ex      =</span> Tx <span class="sc">/</span> Lx,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">lx.mx</span><span class="st">`</span>   <span class="ot">=</span> lx <span class="sc">*</span> mx,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">x.lx.mx</span><span class="st">`</span> <span class="ot">=</span> x  <span class="sc">*</span> <span class="st">`</span><span class="at">lx.mx</span><span class="st">`</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>tabla_v <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, Nx, mx, Bx, lx, dx, qx, px, Sx, </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">lx.mx</span><span class="st">`</span>, <span class="st">`</span><span class="at">x.lx.mx</span><span class="st">`</span>, Lx, Tx, ex) <span class="sc">%&gt;%</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Tabla de vida hasta eₓ"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla de vida hasta eₓ</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> x </th>
   <th style="text-align:right;"> Nx </th>
   <th style="text-align:right;"> mx </th>
   <th style="text-align:right;"> Bx </th>
   <th style="text-align:right;"> lx </th>
   <th style="text-align:right;"> dx </th>
   <th style="text-align:right;"> qx </th>
   <th style="text-align:right;"> px </th>
   <th style="text-align:right;"> Sx </th>
   <th style="text-align:right;"> lx.mx </th>
   <th style="text-align:right;"> x.lx.mx </th>
   <th style="text-align:right;"> Lx </th>
   <th style="text-align:right;"> Tx </th>
   <th style="text-align:right;"> ex </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 0.15 </td>
   <td style="text-align:right;"> 0.85 </td>
   <td style="text-align:right;"> 0.85 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 461.5 </td>
   <td style="text-align:right;"> 1178.0 </td>
   <td style="text-align:right;"> 2.55 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 423 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 211.5 </td>
   <td style="text-align:right;"> 0.85 </td>
   <td style="text-align:right;"> 0.33 </td>
   <td style="text-align:right;"> 0.39 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.61 </td>
   <td style="text-align:right;"> 0.42 </td>
   <td style="text-align:right;"> 0.42 </td>
   <td style="text-align:right;"> 341.5 </td>
   <td style="text-align:right;"> 716.5 </td>
   <td style="text-align:right;"> 2.10 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1.4 </td>
   <td style="text-align:right;"> 364.0 </td>
   <td style="text-align:right;"> 0.52 </td>
   <td style="text-align:right;"> 0.13 </td>
   <td style="text-align:right;"> 0.25 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.75 </td>
   <td style="text-align:right;"> 0.73 </td>
   <td style="text-align:right;"> 1.46 </td>
   <td style="text-align:right;"> 227.5 </td>
   <td style="text-align:right;"> 375.0 </td>
   <td style="text-align:right;"> 1.65 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 195.0 </td>
   <td style="text-align:right;"> 0.39 </td>
   <td style="text-align:right;"> 0.29 </td>
   <td style="text-align:right;"> 0.74 </td>
   <td style="text-align:right;"> 0.26 </td>
   <td style="text-align:right;"> 0.26 </td>
   <td style="text-align:right;"> 0.39 </td>
   <td style="text-align:right;"> 1.17 </td>
   <td style="text-align:right;"> 122.5 </td>
   <td style="text-align:right;"> 147.5 </td>
   <td style="text-align:right;"> 1.20 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 0.10 </td>
   <td style="text-align:right;"> 1.00 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.00 </td>
   <td style="text-align:right;"> 0.05 </td>
   <td style="text-align:right;"> 0.20 </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 25.0 </td>
   <td style="text-align:right;"> 1.00 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>El conjunto de estimadores de esta tabla de vida describe una población donde <strong>La reproducción está concentrada en edades intermedias</strong> (pico en <span class="math inline">\(m_2\)</span>). La <strong>supervivencia declina progresivamente</strong>, con un fuerte cuello de botella hacia las edades mayores. <strong>La esperanza de vida disminuye rápido</strong>, mostrando que la mayoría de los individuos contribuyen a la población solo en las primeras etapas de su vida reproductiva.</p>
<p>En términos de dinámica poblacional, este tipo de <strong>estrategia combina la alta fecundidad en etapas intermedias con una supervivencia moderada (tradeoff)</strong>, asegurando el mantenimiento de la población, mientras aún persisten riesgos considerables de mortalidad en las etapas juveniles y seniles.</p>
<hr>
</section>
<section id="paso-3.-cálculo-de-estadísticos-demográficos-basados-en-la-tabla-de-vida" class="level5">
<h5 class="anchored" data-anchor-id="paso-3.-cálculo-de-estadísticos-demográficos-basados-en-la-tabla-de-vida">Paso 3. Cálculo de estadísticos demográficos basados en la tabla de vida</h5>
<p>En este paso Se utilizan las columnas finales de la anterior tabla de vida, para calcular los estadísticos demográficos generales, que brindan información de cómo aumenta o disminuye la población en el tiempo.</p>
<p>Primero se calculan los siguientes estadísticos generales:<br>
<span class="math inline">\(R_0 = \sum l_x m_x\)</span>; Tasa reproductiva neta<br>
<span class="math inline">\(T = \dfrac{\sum x,l_x m_x}{\sum l_x m_x}\)</span>; Tiempo Generacional (Tg)<br>
<span class="math inline">\(r_{\text{est}} = \dfrac{\ln R_0}{T}\)</span>; Tasa cre crecimiento istantáneo estimada<br>
Las siguientes ecuaciones permiten generar columnas adicionales en la tabla de vida, que son requeridas para el cálculo de los estadísticos demográficos generales como <span class="math inline">\(r\)</span> y <span class="math inline">\(\lambda\)</span>. La ecuación de euler - lotka, permite encontrar un valor de <span class="math inline">\(r\)</span> tal que la sumatoria de los estimadores de supervivencia y de maternidad sea igual a 1, como se muestra a continuación:</p>
<p><span class="math inline">\(\;e^{-r. x};\)</span> y&nbsp;Formula requerida para la ecuación de euler<br>
<span class="math inline">\(\;e^{-r. x}.l_x m_x\)</span>;&nbsp;Formula requerida para la ecuación de euler<br>
<span class="math inline">\(\sum_{x} l_x, m_x, e^{-r x} = 1\)</span> Ecuación de euler<br>
</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  1. Estadísticos generales </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Ro <span class="ot">&lt;-</span> <span class="fu">sum</span>(tabla_v<span class="sc">$</span><span class="st">`</span><span class="at">lx.mx</span><span class="st">`</span>,   <span class="at">na.rm =</span> <span class="cn">TRUE</span>)        <span class="co"># Tasa reproductiva neta</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>Tg <span class="ot">&lt;-</span> <span class="fu">sum</span>(tabla_v<span class="sc">$</span><span class="st">`</span><span class="at">x.lx.mx</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> Ro   <span class="co"># Tiempo generacional</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>r_est <span class="ot">&lt;-</span> <span class="fu">log</span>(Ro) <span class="sc">/</span> Tg                             <span class="co"># r estimado</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Función de euler</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>euler <span class="ot">&lt;-</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(rr) </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(tabla_v<span class="sc">$</span>lx <span class="sc">*</span> tabla_v<span class="sc">$</span>mx <span class="sc">*</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">exp</span>(<span class="sc">-</span>rr <span class="sc">*</span> tabla_v<span class="sc">$</span>x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Cálculo de r exacto</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(euler, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">round</span>(r,<span class="dv">3</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Cálculo de lambda</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(r)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Organización de los estadísticos generales</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>estad <span class="ot">&lt;-</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Tasa reprod. neta (Ro)</span><span class="st">`</span>      <span class="ot">=</span> Ro,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Tiempo generacional (T)</span><span class="st">`</span>     <span class="ot">=</span> Tg,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">r_est = ln(R0)/T</span><span class="st">`</span>            <span class="ot">=</span> r_est,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">r (Euler)</span><span class="st">`</span>                   <span class="ot">=</span> r,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">λ = exp(r)</span><span class="st">`</span>                  <span class="ot">=</span> lambda</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Tabulación</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>estad <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">3</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Estadísticos demográficos generales"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Estadísticos demográficos generales</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> Tasa reprod. neta (Ro) </th>
   <th style="text-align:right;"> Tiempo generacional (T) </th>
   <th style="text-align:right;"> r_est = ln(R0)/T </th>
   <th style="text-align:right;"> r (Euler) </th>
   <th style="text-align:right;"> λ = exp(r) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1.591 </td>
   <td style="text-align:right;"> 2.042 </td>
   <td style="text-align:right;"> 0.227 </td>
   <td style="text-align:right;"> 0.236 </td>
   <td style="text-align:right;"> 1.266 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Se obtienen los siguientes estadísticos demográficos generales:</p>
<p><span class="math inline">\(R_0 \approx 1.591\)</span>: cada individuo deja en promedio <strong>1.6 descendientes efectivos</strong>, lo que asegura un crecimiento leve de la población.<br>
<span class="math inline">\(T \approx 2.04\)</span> intervalos de tiempo: <strong>el tiempo generacional</strong> es corto, lo que refleja que la reproducción ocurre relativamente temprano en el ciclo de vida.<br>
<span class="math inline">\(r_{est} \approx 0.227\)</span> indiv./indiv.<em>t y</em> <span class="math inline">\(r \approx 0.236\)</span> indiv./indiv.t: <strong>la tasa intrínseca de crecimiento instantáneo</strong> se ubica alrededor de 23.6% por intervalo de tiempo, confirmando que la población tiene un aumento positivo.<br>
<span class="math inline">\(\lambda \approx 1.266\)</span>: la población presenta una <strong>tasa finita de crecimiento</strong> equivalente a un aumento del <strong>27%</strong> por intervalo de tiempo.</p>
<hr>
</section>
<section id="paso-4.-estimadores-de-estructura-de-edad---f_pre-f_post-c_x-v_x." class="level5">
<h5 class="anchored" data-anchor-id="paso-4.-estimadores-de-estructura-de-edad---f_pre-f_post-c_x-v_x.">Paso 4. Estimadores de estructura de edad - <span class="math inline">\(F_{(pre)},\ F_{(post)},\ c_{(x)},\  v_{(x)}\)</span>.</h5>
<p>Este procedimiento es requerido para realizar la <strong>modelación matricial de estructura de edades</strong>, utilizando como base a la matriz de Leslie - <span class="math inline">\(L\)</span>, que al multiplicarse por el vector de densidades (<span class="math inline">\(N_x\)</span>), permite proyectar el aumento o disminución de la población en periodos posteriores. <span class="math inline">\(L\)</span> es una matriz constante y para construirla se requiere contar con los vectores de fecundidad (<span class="math inline">\(F_x\)</span>) - que representan los valores de la primera fila de la matriz y los vectores de supervivencia (<span class="math inline">\(S_x\)</span>) - Que representan los valores de la sub-diagonal - el resto de valores son ceros. Además, hay que tener en cuenta si el censo es <em>pre o post reproductivo</em>, dado a que cada uno, genera una ecuación específica para <span class="math inline">\(F_x\)</span>.</p>
<p><strong>Fecundidad pre-reproductiva:</strong> <span class="math inline">\(F_{pre} = S_0 * m_x\)</span>, con <span class="math inline">\(S_0 = S_x\)</span> en la edad 0 (supervivencia de crías hasta el siguiente censo, lo cual coresponde a un valor constante).<br>
</p>
<p><strong>Fecundidad post-reproductiva:</strong> <span class="math inline">\(F_{post} = S_x * m_{x+1}\)</span>.</p>
<p>Los sigientes vectores (<span class="math inline">\(v_x\)</span> y <span class="math inline">\(c_x\)</span>) también se calculan a partir de la tabla de vida elaborada en los pasos anteriores (tabla_v). En pasos posteriores, se volverán a calcular algunos estadísticos demográficos como <span class="math inline">\(v_x\)</span> y <span class="math inline">\(c_x\)</span> pero de forma matricial, para compararos con los calculados a continuación.</p>
<ul>
<li><p>Ecuaciones de la distribución o estructura estable de edades <span class="math inline">\(c_{(x)}\)</span><br>
<span class="math inline">\(l_x.e^{-r x}\)</span><br>
<span class="math inline">\(c_{(x)} = (l_x.e^{-r.x}) / \sum(l_x.e^{-r.x})\)</span> (estructura estable).<br>
</p></li>
<li><p>Ecuaciones del valor reproductivo <span class="math inline">\(v_{(x)}\)</span><br>
<span class="math inline">\(e^{rx}/lx\)</span><br>
<span class="math inline">\(e^{-ry}.l_y.m_y\)</span> donde <span class="math inline">\(y = x + 1\)</span><br>
<span class="math inline">\(\sum(e^{-ry}.l_y.m_y)\)</span><br>
<span class="math inline">\(v_{(x)} = (e^{rx}/l_x) .\sum(e^{-ry}.l_y.m_y)\)</span>.<br>
<span class="math inline">\(v_{(x)}.norm\)</span> con <span class="math inline">\(v_{(0)}=1\)</span> Se normaliza a <span class="math inline">\(v_{(x)}\)</span> para que el primer valor = 1</p></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Primer valor de S_x, para calcular S_0</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>S0 <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">any</span>(tabla_v<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  tabla_v<span class="sc">$</span>Sx[<span class="fu">which</span>(tabla_v<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>)[<span class="dv">1</span>]]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  tabla_v<span class="sc">$</span>Sx[<span class="dv">1</span>]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de vida para estimar Fx pre y post, cx y vx</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>tabla2 <span class="ot">&lt;-</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  tabla_v <span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1.) Cálculo de F ´re y post</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fpre  =</span> S0 <span class="sc">*</span> mx,      <span class="co"># Fecundidad pre reprod.</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fpost =</span> Sx <span class="sc">*</span> <span class="st">`</span><span class="at">mx+1</span><span class="st">`</span>,  <span class="co"># Fecundidad post reprod.</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2.) Cálculo de distrib. estable c(x)</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">lx.e_rx</span><span class="st">`</span> <span class="ot">=</span> lx <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> x), <span class="co"># Estimador de cx</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cx        =</span> <span class="st">`</span><span class="at">lx.e_rx</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">lx.e_rx</span><span class="st">`</span>, </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># cx</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3.) Cálculo del valor reproductivo v(x)</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">erx_lx      =</span> <span class="fu">exp</span>(r <span class="sc">*</span> x) <span class="sc">/</span> lx,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">e_ry_ly_my</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>r <span class="sc">*</span> x) <span class="sc">*</span> lx <span class="sc">*</span> mx,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Se_ry_ly_my</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(<span class="st">`</span><span class="at">e_ry_ly_my</span><span class="st">`</span>))),</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">vx          =</span> erx_lx <span class="sc">*</span> <span class="st">`</span><span class="at">Se_ry_ly_my</span><span class="st">`</span>,</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">vx_norm     =</span> vx <span class="sc">/</span> vx[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Organización de la segunda tabla de vida - tabla2</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    x, Nx, mx, Sx,        <span class="co"># Estimadores iniciales</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    Fpre, Fpost,          <span class="co"># F pre y post</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">lx.e_rx</span><span class="st">`</span>, cx,        <span class="co"># Distrib estable c(x)</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    erx_lx, <span class="st">`</span><span class="at">e_ry_ly_my</span><span class="st">`</span>, <span class="co"># Valor reprod. v(x)</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Se_ry_ly_my</span><span class="st">`</span>, vx, vx_norm</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(., <span class="dv">3</span>)))</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  tabla2,</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption   =</span> <span class="st">"Tabla 2 — Estimadores de estructura de edad"</span>,</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"x"</span>,<span class="st">"Nx"</span>,<span class="st">"mx"</span>,<span class="st">"Sx"</span>,</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"F(pre)"</span>,<span class="st">"F(post)"</span>,</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lx.e-rx"</span>,<span class="st">"c(x)"</span>,</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"erx/lx"</span>,<span class="st">"e-ry.(ly.my)"</span>,</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Se-ry(ly.my)"</span>,<span class="st">"v(x)"</span>,<span class="st">"v(x).norm"</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">TRUE</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Tabla 2 — Estimadores de estructura de edad</caption>
 <thead>
  <tr>
   <th style="text-align:right;"> x </th>
   <th style="text-align:right;"> Nx </th>
   <th style="text-align:right;"> mx </th>
   <th style="text-align:right;"> Sx </th>
   <th style="text-align:right;"> F(pre) </th>
   <th style="text-align:right;"> F(post) </th>
   <th style="text-align:right;"> lx.e-rx </th>
   <th style="text-align:right;"> c(x) </th>
   <th style="text-align:right;"> erx/lx </th>
   <th style="text-align:right;"> e-ry.(ly.my) </th>
   <th style="text-align:right;"> Se-ry(ly.my) </th>
   <th style="text-align:right;"> v(x) </th>
   <th style="text-align:right;"> v(x).norm </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 0.0 </td>
   <td style="text-align:right;"> 0.846 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.423 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 0.450 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 1.000 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 423 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.615 </td>
   <td style="text-align:right;"> 0.423 </td>
   <td style="text-align:right;"> 0.861 </td>
   <td style="text-align:right;"> 0.668 </td>
   <td style="text-align:right;"> 0.300 </td>
   <td style="text-align:right;"> 1.497 </td>
   <td style="text-align:right;"> 0.334 </td>
   <td style="text-align:right;"> 1.000 </td>
   <td style="text-align:right;"> 1.496 </td>
   <td style="text-align:right;"> 1.497 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 1.4 </td>
   <td style="text-align:right;"> 0.750 </td>
   <td style="text-align:right;"> 1.184 </td>
   <td style="text-align:right;"> 0.750 </td>
   <td style="text-align:right;"> 0.324 </td>
   <td style="text-align:right;"> 0.146 </td>
   <td style="text-align:right;"> 3.083 </td>
   <td style="text-align:right;"> 0.454 </td>
   <td style="text-align:right;"> 0.666 </td>
   <td style="text-align:right;"> 2.052 </td>
   <td style="text-align:right;"> 2.053 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 0.256 </td>
   <td style="text-align:right;"> 0.846 </td>
   <td style="text-align:right;"> 0.128 </td>
   <td style="text-align:right;"> 0.192 </td>
   <td style="text-align:right;"> 0.086 </td>
   <td style="text-align:right;"> 5.205 </td>
   <td style="text-align:right;"> 0.192 </td>
   <td style="text-align:right;"> 0.212 </td>
   <td style="text-align:right;"> 1.101 </td>
   <td style="text-align:right;"> 1.102 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.423 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 0.039 </td>
   <td style="text-align:right;"> 0.017 </td>
   <td style="text-align:right;"> 25.702 </td>
   <td style="text-align:right;"> 0.019 </td>
   <td style="text-align:right;"> 0.019 </td>
   <td style="text-align:right;"> 0.500 </td>
   <td style="text-align:right;"> 0.500 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>La <strong>fecundidad pre-reproductiva</strong> (<span class="math inline">\(F_{pre}\)</span>) refleja un aumento progresivo hasta un máximo en la edad <span class="math inline">\(x=2\)</span> (<span class="math inline">\(F_{pre} \approx 1.18\)</span>). La <strong>fecundidad post-reproductiva</strong> (<span class="math inline">\(F_{post}\)</span>), en cambio, concentra el mayor aporte en <span class="math inline">\(x=1\)</span> (<span class="math inline">\(F_{post} \approx 0.86\)</span>), y declina abruptamente a partir de <span class="math inline">\(x=3\)</span>. Lo anterior evidencia que <strong>la ventana reproductiva principal se concentra en edades intermedias (1–2)</strong>, donde la combinación de fecundidad y supervivencia es más favorable.</p>
<p><strong>La distribución estable de edades</strong> <span class="math inline">\(c_x\)</span> muestra que la mayor proporción de individuos se concentra en edades tempranas (<span class="math inline">\(x=0\)</span>, con <span class="math inline">\(c_x \approx 0.61\)</span>), seguida de <span class="math inline">\(x=1\)</span> (<span class="math inline">\(c_x \approx 0.27\)</span>). Edades más avanzadas (<span class="math inline">\(x=3\)</span> y <span class="math inline">\(x=4\)</span>) casi no contribuyen a la distribución estable (<span class="math inline">\(c_x &lt; 0.05\)</span>). Esto se asocia a una <strong>población juvenil dominante</strong>, típica de especies con alta fecundidad y mortalidad temprana.</p>
<p>El <strong>valor reproductivo</strong> (<span class="math inline">\(v_x\)</span>) más bajo, se presenta en la edad inicial (<span class="math inline">\(v_x=0.48\)</span>, normalizado como <span class="math inline">\(v_x^{norm}=1\)</span>), pero aumenta marcadamente en las edades intermedias: <span class="math inline">\(v_x^{norm} \approx 2.25\)</span> en <span class="math inline">\(x=1\)</span>; <span class="math inline">\(v_x^{norm} \approx 3.77\)</span> en <span class="math inline">\(x=2\)</span> (máximo aporte relativo). A edades avanzadas (<span class="math inline">\(x=3,4\)</span>), aunque la fecundidad es baja, los valores reproductivos aún se mantienen por encima de 1, pero con un peso mucho menor que en los Edades intermedios. Esto confirma que <strong>los individuos más jóvenes tienen potencial, pero los intermedios son el motor real del crecimiento poblacional</strong>.</p>
<p><strong>Nota:</strong> en el proximo capítulo se utilizarán estos datos para la modelación matricial por estructura de edad.</p>
<hr>
</section>
</section>
</section>
<section id="cuestionario" class="level2">
<h2 class="anchored" data-anchor-id="cuestionario">Cuestionario</h2>
<ol type="1">
<li>Explique en sus propias palabras qué representa una <strong>tabla de vida</strong> y cómo se diferencia una tabla de cohorte de una transversal.</li>
<li>A partir de los resultados del ejercicio de cementerios, describa los principales patrones de <strong>mortalidad y esperanza de vida</strong>, y proponga dos hipótesis ecológicas o históricas que puedan explicarlos.</li>
<li>En el ejercicio de Gotelli (2001), interprete los valores obtenidos para <strong>R₀</strong> y <strong>r</strong>. ¿Qué indican estos parámetros sobre el crecimiento o declive de la población?</li>
<li>Comparar los resultados de ambos ejercicios. ¿Qué semejanzas y diferencias se encuentran entre los patrones de supervivencia humana y los de organismos naturales?</li>
<li>¿Por qué las <strong>tablas de vida</strong> son fundamentales para la conservación, el manejo poblacional y la predicción del impacto ambiental en especies silvestres?</li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>